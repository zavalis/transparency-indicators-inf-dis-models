<?xml version="1.0" encoding="UTF-8"?>
<OAI-PMH xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.openarchives.org/OAI/2.0/ http://www.openarchives.org/OAI/2.0/OAI-PMH.xsd">
  <responseDate>2022-03-11T00:55:28Z</responseDate>
  <request verb="GetRecord" identifier="oai:pubmedcentral.nih.gov:8030732" metadataPrefix="pmc">https:/www.ncbi.nlm.nih.gov/pmc/oai/oai.cgi</request>
  <GetRecord>
    <record>
      <header>
        <identifier>oai:pubmedcentral.nih.gov:8030732</identifier>
        <datestamp>2021-04-09</datestamp>
        <setSpec>pheelsevier</setSpec>
        <setSpec>pmc-open</setSpec>
      </header>
      <metadata>
        <article xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xsi:schemaLocation="https://jats.nlm.nih.gov/ns/archiving/1.3/ https://jats.nlm.nih.gov/archiving/1.3/xsd/JATS-archivearticle1-3-mathml3.xsd" article-type="research-article">
          <front>
            <journal-meta>
              <journal-id journal-id-type="nlm-ta">Annu Rev Control</journal-id>
              <journal-id journal-id-type="iso-abbrev">Annu Rev Control</journal-id>
              <journal-title-group>
                <journal-title>Annual Reviews in Control</journal-title>
              </journal-title-group>
              <issn pub-type="ppub">1367-5788</issn>
              <issn pub-type="epub">1367-5788</issn>
              <publisher>
                <publisher-name>Published by Elsevier Ltd.</publisher-name>
              </publisher>
            </journal-meta>
            <article-meta>
              <article-id pub-id-type="accession">PMC8030732</article-id>
              <article-id pub-id-type="pmcid">PMC8030732</article-id>
              <article-id pub-id-type="pmc-uid">8030732</article-id>
              <article-id pub-id-type="pmid">33850441</article-id>
              <article-id pub-id-type="pii">S1367-5788(21)00016-X</article-id>
              <article-id pub-id-type="doi">10.1016/j.arcontrol.2021.03.008</article-id>
              <article-categories>
                <subj-group subj-group-type="heading">
                  <subject>Article</subject>
                </subj-group>
              </article-categories>
              <title-group>
                <article-title>Forecasting COVID-19 cases based on a parameter-varying stochastic SIR model</article-title>
              </title-group>
              <contrib-group>
                <contrib contrib-type="author" id="au000001">
                  <name>
                    <surname>Hespanha</surname>
                    <given-names>João P.</given-names>
                  </name>
                  <xref rid="aff1" ref-type="aff">a</xref>
                  <xref rid="cor1" ref-type="corresp">⁎</xref>
                </contrib>
                <contrib contrib-type="author" id="au000002">
                  <name>
                    <surname>Chinchilla</surname>
                    <given-names>Raphael</given-names>
                  </name>
                  <xref rid="aff1" ref-type="aff">a</xref>
                </contrib>
                <contrib contrib-type="author" id="au000003">
                  <name>
                    <surname>Costa</surname>
                    <given-names>Ramon R.</given-names>
                  </name>
                  <xref rid="aff2" ref-type="aff">b</xref>
                </contrib>
                <contrib contrib-type="author" id="au000004">
                  <name>
                    <surname>Erdal</surname>
                    <given-names>Murat K.</given-names>
                  </name>
                  <xref rid="aff1" ref-type="aff">a</xref>
                </contrib>
                <contrib contrib-type="author" id="au000005">
                  <name>
                    <surname>Yang</surname>
                    <given-names>Guosong</given-names>
                  </name>
                  <xref rid="aff1" ref-type="aff">a</xref>
                </contrib>
                <aff id="aff1"><label>a</label>University of California, Santa Barbara, USA</aff>
                <aff id="aff2"><label>b</label>Federal University of Rio de Janeiro, Brazil</aff>
              </contrib-group>
              <author-notes>
                <corresp id="cor1"><label>⁎</label>Corresponding author.</corresp>
              </author-notes>
              <pub-date pub-type="pmc-release">
                <day>8</day>
                <month>4</month>
                <year>2021</year>
              </pub-date>
              <!-- PMC Release delay is 0 months and 0 days and was based on <pub-date
						pub-type="epub">.-->
              <pub-date pub-type="ppub">
                <year>2021</year>
              </pub-date>
              <pub-date pub-type="epub">
                <day>8</day>
                <month>4</month>
                <year>2021</year>
              </pub-date>
              <volume>51</volume>
              <fpage>460</fpage>
              <lpage>476</lpage>
              <history>
                <date date-type="received">
                  <day>30</day>
                  <month>12</month>
                  <year>2020</year>
                </date>
                <date date-type="rev-recd">
                  <day>22</day>
                  <month>2</month>
                  <year>2021</year>
                </date>
                <date date-type="accepted">
                  <day>25</day>
                  <month>3</month>
                  <year>2021</year>
                </date>
              </history>
              <permissions>
                <copyright-statement>© 2021 Published by Elsevier Ltd.</copyright-statement>
                <copyright-year>2021</copyright-year>
                <copyright-holder/>
                <license>
                  <license-p>Since January 2020 Elsevier has created a COVID-19 resource centre with free information in English and Mandarin on the novel coronavirus COVID-19. The COVID-19 resource centre is hosted on Elsevier Connect, the company's public news and information website. Elsevier hereby grants permission to make all its COVID-19-related research that is available on the COVID-19 resource centre - including this research content - immediately available in PubMed Central and other publicly funded repositories, such as the WHO COVID database with rights for unrestricted research re-use and analyses in any form or by any means with acknowledgement of the original source. These permissions are granted for free by Elsevier for as long as the COVID-19 resource centre remains active.</license-p>
                </license>
              </permissions>
              <abstract id="d1e253">
                <p>We address the prediction of the number of new cases and deaths for the coronavirus disease 2019 (COVID-19) over a future horizon from historical data (forecasting). We use a model-based approach based on a stochastic Susceptible–Infections–Removed (SIR) model with time-varying parameters, which captures the evolution of the disease dynamics in response to changes in social behavior, non-pharmaceutical interventions, and testing rates. We show that, in the presence of asymptomatic cases, such model includes internal parameters and states that cannot be uniquely identified solely on the basis of measurements of new cases and deaths, but this does not preclude the construction of reliable forecasts for future values of these measurements. Such forecasts and associated confidence intervals can be computed using an iterative algorithm based on nonlinear optimization solvers, without the need for Monte Carlo sampling. Our results have been validated on an extensive COVID-19 dataset covering the period from March through December 2020 on 144 regions around the globe.</p>
              </abstract>
              <kwd-group id="d1e259">
                <title>Keywords</title>
                <kwd>Epidemic models</kwd>
                <kwd>System identification</kwd>
                <kwd>Estimation</kwd>
              </kwd-group>
            </article-meta>
          </front>
          <body>
            <sec id="sec1">
              <label>1</label>
              <title>Introduction</title>
              <p id="d1e278">The recent global epidemics of SARS first reported in 2003, Swine flu in 2009, MERS in 2012, Western African Ebola in 2013, Zika in 2015, and COVID-19 in 2019, identified building epidemic models specifically aimed at forecasting the propagation of contagious diseases as a key need to guide epidemic response (<xref rid="b33" ref-type="bibr">Morgan, 2019</xref>, <xref rid="b38" ref-type="bibr">Shearer et al., 2020</xref>). Motivated by this need, the main goal of this paper is to compute forecasts for the number of new cases and deaths due to the COVID-19 outbreak to aid decision makers in provisioning healthcare resources or imposing nonpharmaceutical interventions. In this context, forecasts must reliably provide measures of confidence to enable decision makers to plan for worst-case scenarios. We construct such forecasts using a time-varying stochastic Susceptible–Infected–Removed (SIR) epidemic model, that is fitted to daily measurements of new cases and deaths.</p>
              <p id="d1e285">SIR epidemic models are based on the assumption that each individual of a population is in one of three basic states: <italic>susceptible</italic> to infection, but not yet infected by the virus; <italic>infective</italic> and thus contagious; and <italic>removed</italic> from the infective state either because the individual developed antibodies and is no longer susceptible to the infection or because the individual passed away. In this paper, we consider <italic>compartmental</italic> SIR models that are focused on counting the number of individuals in each of the states (also known as compartments). The estimation of the state and parameters of an SIR models is typically based on a measurement model that maps the model’s state to time series of measurements that typically include daily counts of newly discovered infected patients and deaths.</p>
              <p id="d1e299">The SIR dynamics and measurements depend on a number of key parameters that include the <italic>infection rate</italic> that can be interpreted as the probability that a susceptible individual will become infected due to interactions with infected individuals; the <italic>removal rate</italic> that can be regarded as the probability that an individual leaves the infective state; the <italic>deaths reporting rate</italic> that can be regarded as the probability that a new death is reported; and the <italic>new-cases reporting rate</italic> that can be regarded as the probability that a new infection is reported. These parameters are strongly influenced by biological properties of the pathogen that causes the disease, such as its ability to travel from individual to individual, the body’s natural ability to fight it, and whether or not the disease exhibits noticeable symptoms when an individual is infected. However, all these parameters are also strongly influenced by external sources, which from the perspective of an SIR model, often dominate in determining their values:</p>
              <p id="d1e313">
                <list list-type="simple" id="d1e315">
                  <list-item id="lst1">
                    <label>1.</label>
                    <p id="d1e319">The infection rate is greatly modulated by the degree to which the population is engaging in social distancing, which in turn depends on media coverage of the epidemic and nonpharmaceutical interventions.</p>
                  </list-item>
                  <list-item id="lst2">
                    <label>2.</label>
                    <p id="d1e324">The removal rate expresses the rate by which patients leave the state in which they can pass the disease to susceptible patients, which may be quite different from the rate at which they get cured (or die). This rate is thus strongly effected by social behavior and policies regarding quarantine, contact tracing and testing, since a patient can stop infecting others much earlier than cure/death.</p>
                  </list-item>
                  <list-item id="lst3">
                    <label>3.</label>
                    <p id="d1e329">In the absence of testing of asymptomatic individuals, the reporting rate is essentially the fraction of symptomatic patients; otherwise it will depend strongly on the policies in effect regarding the testing of asymptomatic individuals.</p>
                  </list-item>
                </list>
              </p>
              <p id="d1e331">The strong dependence of the SIR parameters on social factors prevents extrapolating their values across time and space: one cannot estimate the value of a parameter in one region/time and expect it to remain the same in a different region or even in the same region at a later time. These observations motivate two key choices behind this work: All SIR parameters need to be learned from data collected on a relatively homogeneous region of space and the parameter values must be allowed to drift over time.</p>
              <p id="d1e333">Motivated by the observations above, we introduce in Section <xref rid="sec2" ref-type="sec">2</xref> a stochastic SIR model with three sources of stochasticity: First, we introduce a stochastic component to the number of individuals that transition between states; second, we assume that daily measurements for the number of new cases and deaths are corrupted by (stochastic) noise; and finally, we take the key model parameters as random walks that drift over time. The variances associated with all these stochastic components need to be learned from data and, for the reasons outlined above, we do not extrapolate their values across different countries/regions.</p>
              <p id="d1e340">From a methodological perspective, we regard forecasting as computing the a posteriori distribution of the random variables that we want to estimate, and subsequently extracting from those distributions point estimates and associated confidence intervals. The a posteriori distributions depend on unknown parameters that are estimated using maximum likelihood. The key challenge of this approach is that, because the SIR model is nonlinear, it is not possible to compute in closed form the likelihood function and the corresponding a posteriori distributions for the variables that we want to forecast. We overcome this by essentially using Laplace’s method to approximate the integral that appears in the formula of the likelihood function. We show in Section <xref rid="sec3" ref-type="sec">3</xref> that this approach enables the computation of the maximum likelihood values for the unknown parameters and the a posteriori point estimates and associated error covariances through a single deterministic optimization that can be solved numerically. For large datasets this optimization may be computationally difficult, so we propose an iterative algorithm that alternates between two smaller optimizations for which the computation required by a 2nd order numerical solver scales linearly with the length of the dataset and the forecasting horizon. This approach is quite general and can be used for much more general estimation/forecasting problems.</p>
              <p id="d1e347">Our modeling and forecasting approaches were validated on an extensive collection of COVID-19 datasets. For 144 regions around the world, we computed weekly 7, 14, and 21 days-ahead forecasts from March to December of 2020 for the number of new cases and deaths due to COVID-19. These forecasts and all the associated initial conditions and parameter estimates were computed solely using past data and then compared with the actual (future) data. We started to produce forecasts with as little as 21 days of data, but it generally took 4–5 weeks of data to start getting confidence intervals that are somewhat tight.</p>
              <p id="d1e349">We show formally in Section <xref rid="sec2.3" ref-type="sec">2.3</xref> and observe numerically through the results in Section <xref rid="sec4" ref-type="sec">4</xref>, that an SIR model that includes an unknown reporting rate is unidentifiable, in the sense that multiple sets of parameters can explain the same observed data with equal likelihood (in the sense of maximum likelihood). This means that there is a fundamental ambiguity in estimating SIR model parameters from measurements of new cases and deaths; an observation that is often ignored but had been made in prior work (<xref rid="b12" ref-type="bibr">Comunian, Gaburro, &amp; Giudici, 2020</xref>). However, this ambiguity does not prevent the computation of reliable forecasts for the daily number of news cases and deaths. This is because the ambiguity exists in parameter space but not on the space of the variables that we are trying to forecast. In essence, while multiple sets of parameters may have the same likelihood, they result in consistent forecasts.</p>
              <p id="d1e368">To study the importance of parameter drift, we compare our proposed stochastic SIR model with a hierarchy of simpler models for which we take the infection, new-cases and/or deaths reporting rates to be constant, rather than time-varying; and also consider a more complex model with a time-varying removal rate. Across a large number of countries/regions, we conclude that taking all of these parameters, or even just the infection rate, to be constant leads to poor results; either resulting in gross violations of the confidence intervals or to overly wide confidence intervals for the forecasts. This is especially noticeable (and not surprising) in regions that show multiple waves of infection, which could never be explained by a constant parameter SIR model. The numerical results also show that, in general, taking all parameters to be time varying does not result in forecasts that are significantly better than those obtained by assuming that the death rate is constant. In fact, for most countries/regions assuming constant removal and death rates result in more accurate forecast.</p>
              <sec id="d1e370">
                <title>Related work</title>
                <p id="d1e373">The basic SIR epidemic model with the number of new cases proportional to the product of the numbers of susceptible and infected individuals can be traced as far back as the work of <xref rid="b20" ref-type="bibr">Hamer (1906)</xref>. Since then, SIR models have evolved in multiple directions, including incorporating stochastic effects (<xref rid="b2" ref-type="bibr">Andersson and Britton, 2000</xref>, <xref rid="b3" ref-type="bibr">Ball and Neal, 2002</xref>, <xref rid="b4" ref-type="bibr">Beretta et al., 1988</xref>, <xref rid="b5" ref-type="bibr">Beretta et al., 1998</xref>, <xref rid="b6" ref-type="bibr">Beretta and Takeuchi, 1995</xref>, <xref rid="b24" ref-type="bibr">Ji and Jiang, 2014</xref>, <xref rid="b26" ref-type="bibr">King et al., 2015</xref>, <xref rid="b41" ref-type="bibr">Tornatore et al., 2005</xref>), the addition of new compartments corresponding to different states of the disease (<xref rid="b10" ref-type="bibr">Capasso, 2008</xref>, <xref rid="b17" ref-type="bibr">Efimov and Ushirobira, 2020</xref>, <xref rid="b19" ref-type="bibr">Giordano et al., 2020</xref>, <xref rid="b23" ref-type="bibr">IHME COVID-19, 2020</xref>, <xref rid="b25" ref-type="bibr">Keeling and Rohani, 2008</xref>, <xref rid="b27" ref-type="bibr">Köhler et al., 2020</xref>, <xref rid="b34" ref-type="bibr">Peng et al., 2020</xref>, <xref rid="b42" ref-type="bibr">Xia et al., 2015</xref>), and considering a network of interacting populations (<xref rid="b16" ref-type="bibr">Della Rossa et al., 2020</xref>, <xref rid="b31" ref-type="bibr">Mei et al., 2017</xref>, <xref rid="b35" ref-type="bibr">y Piontti et al., 2019</xref>, <xref rid="b40" ref-type="bibr">Stolerman et al., 2015</xref>, <xref rid="b43" ref-type="bibr">Youssef and Scoglio, 2011</xref>). The reader is referred to (<xref rid="b22" ref-type="bibr">Hethcote, 2000</xref>) for an historical perspective on deterministic SIR-like epidemic models and their analysis and to the monograph (<xref rid="b8" ref-type="bibr">Brauer, Castillo-Chavez, &amp; Feng, 2019</xref>) for the application of such models to several diseases.</p>
                <p id="d1e405">A common feature to many recent models is the addition of states to address the existence of individuals that are infected and can transmit the disease, but are asymptomatic and thus are not accounted for as infected in official reports (<xref rid="b10" ref-type="bibr">Capasso, 2008</xref>, <xref rid="b19" ref-type="bibr">Giordano et al., 2020</xref>, <xref rid="b23" ref-type="bibr">IHME COVID-19, 2020</xref>, <xref rid="b27" ref-type="bibr">Köhler et al., 2020</xref>, <xref rid="b28" ref-type="bibr">Li et al., 2020</xref>, <xref rid="b42" ref-type="bibr">Xia et al., 2015</xref>, <xref rid="b44" ref-type="bibr">Zou et al., 2020</xref>). The addition of states has also been used to account for individuals under quarantine (<xref rid="b28" ref-type="bibr">Li et al., 2020</xref>, <xref rid="b34" ref-type="bibr">Peng et al., 2020</xref>), infected but not yet infective (<xref rid="b17" ref-type="bibr">Efimov and Ushirobira, 2020</xref>, <xref rid="b23" ref-type="bibr">IHME COVID-19, 2020</xref>, <xref rid="b27" ref-type="bibr">Köhler et al., 2020</xref>, <xref rid="b28" ref-type="bibr">Li et al., 2020</xref>, <xref rid="b34" ref-type="bibr">Peng et al., 2020</xref>), asymptomatic but diagnosed through testing (<xref rid="b19" ref-type="bibr">Giordano et al., 2020</xref>, <xref rid="b27" ref-type="bibr">Köhler et al., 2020</xref>), and hospitalized (<xref rid="b28" ref-type="bibr">Li et al., 2020</xref>, <xref rid="b42" ref-type="bibr">Xia et al., 2015</xref>). The inclusion of more states and the associated parameters that determine the rates of transfer between states, facilitates matching measurements with the model outputs. However, it also makes the model identification problem more formidable, especially because most of these parameters may change as the epidemic evolves. In fact, it was shown in <xref rid="b37" ref-type="bibr">Roda, Varughese, Han, and Li (2020)</xref> that adding an “exposed” (E) state (i.e., infected but not yet infective) to a basic SIR model, actually results in a worse value for the Akaike Information Criterion. This essentially means that, while an SEIR model can better represent the data, this improvement does not suffice to justify the additional model complexity.</p>
                <p id="d1e438">It is widely accepted that beyond the initial outbreak, the parameters of an SIR model vary in response to changes in social behavior and medical advances. A common approach to address this consists of breaking the epidemic into stages and identifying a different set of model parameters for each stage (<xref rid="b19" ref-type="bibr">Giordano et al., 2020</xref>, <xref rid="b42" ref-type="bibr">Xia et al., 2015</xref>), with the times of the transitions between stages typically selected to coincide with the introduction of nonpharmaceutical measures. The model used in <xref rid="b39" ref-type="bibr">Srivastava, Xu, and Prasanna (2020)</xref> assumes piecewise constant infection rates that remain constant over an intervals of length <inline-formula><mml:math id="d1e450" display="inline" altimg="si1.svg"><mml:mi>J</mml:mi></mml:math></inline-formula>, that is learned from data. The model in <xref rid="b9" ref-type="bibr">Calafiore, Novara, and Possieri (2020)</xref> expresses the time-varying parameters through a linear combination of pre-specified time functions, with the coefficients of these linear combinations identified from data. This permits more realistic smooth variations of the parameters, but makes the forecast highly dependent on the choice of the basis functions, which must be pre-specified and not learned from data. In <xref rid="b1" ref-type="bibr">Al-Salti, Al-Musalhi, Elmojtaba, and Gandhi (2020)</xref>, the infection rate is assumed to be monotone decreasing, evolving according to a deterministic differential equation that depends on 3 parameters that can be adjusted. The model (<xref rid="b23" ref-type="bibr">IHME COVID-19, 2020</xref>) considers a time-varying infection rate that is assumed to be a linear combination of a set of explanatory covariates that include seasonality, mobility, testing rates, and mask use. The coefficients of this linear combination are estimated from data.</p>
                <p id="d1e468">Stochastic SIR models appeared in many flavors: <xref rid="b4" ref-type="bibr">Beretta et al. (1988)</xref> and <xref rid="b6" ref-type="bibr">Beretta and Takeuchi (1995)</xref> considered stochasticity in the delay from the time an individual gets infected until he/she becomes infective, leading to an integral differential equation with delays; <xref rid="b24" ref-type="bibr">Ji and Jiang (2014)</xref> introduced stochasticity in the form of an additive stochastic perturbation, resulting in a stochastic differential equation; and both these sources of stochasticity appear combined in <xref rid="b5" ref-type="bibr">Beretta et al. (1998)</xref> and <xref rid="b41" ref-type="bibr">Tornatore et al. (2005)</xref>. A fundamentally different stochastic model was proposed in <xref rid="b3" ref-type="bibr">Ball and Neal (2002)</xref>, where individuals enter and exit the infective state at points on Poisson processes. It considers different rates for the Poisson processes regarding on whether individuals share the same household, workplace, etc. A more conventional SEIR model in the form of a continuous-time Markov process was considered in <xref rid="b26" ref-type="bibr">King et al. (2015)</xref>. As in <xref rid="b5" ref-type="bibr">Beretta et al., 1998</xref>, <xref rid="b24" ref-type="bibr">Ji and Jiang, 2014</xref> and <xref rid="b41" ref-type="bibr">Tornatore et al. (2005)</xref>, our paper considers additive stochastic perturbations, whose variances are estimated from data. However, we shall see that our numerical results for COVID-19 indicate that this stochastic effect rapidly becomes negligible as the epidemic progresses. The key stochastic component to our model will turn out to be the SIR model parameters, which we regard as realizations of Gaussian random walks with unknown variances that must be learned from data.</p>
                <p id="d1e508">The identification of SIR models based on fitting <italic>cumulative</italic> data of the total number of cases and recoveries since the start of the epidemic has been widely used in the literature (<xref rid="b9" ref-type="bibr">Calafiore et al., 2020</xref>, <xref rid="b12" ref-type="bibr">Comunian et al., 2020</xref>, <xref rid="b17" ref-type="bibr">Efimov and Ushirobira, 2020</xref>, <xref rid="b19" ref-type="bibr">Giordano et al., 2020</xref>, <xref rid="b27" ref-type="bibr">Köhler et al., 2020</xref>, <xref rid="b34" ref-type="bibr">Peng et al., 2020</xref>, <xref rid="b40" ref-type="bibr">Stolerman et al., 2015</xref>, <xref rid="b42" ref-type="bibr">Xia et al., 2015</xref>, <xref rid="b44" ref-type="bibr">Zou et al., 2020</xref>). However, it was shown in <xref rid="b26" ref-type="bibr">King et al. (2015)</xref> that the use of cumulative data can lead to non-independent successive errors, resulting in confidence intervals that suggest a degree of precision that is not consistent with the data. In view of this, and as in <xref rid="b37" ref-type="bibr">Roda et al. (2020)</xref> and <xref rid="b39" ref-type="bibr">Srivastava et al. (2020)</xref>, our identification procedure is based on daily counts of new patients and deaths, rather than cumulative counts of infected, removed, and dead patients.</p>
                <p id="d1e531">An additional aspect in which our work differs from a large number of previous works on epidemic forecast is that we learn all model parameters from data, whereas much of the prior work relies on a combination of fitted parameters with “clinical information” (<xref rid="b19" ref-type="bibr">Giordano et al., 2020</xref>, <xref rid="b27" ref-type="bibr">Köhler et al., 2020</xref>, <xref rid="b28" ref-type="bibr">Li et al., 2020</xref>, <xref rid="b34" ref-type="bibr">Peng et al., 2020</xref>, <xref rid="b42" ref-type="bibr">Xia et al., 2015</xref>). As noted above, we opted to avoid relying on external data as all SIR parameters are strongly dependent on social behavior that is hard to extrapolate over time and space. Notable works that are mostly data driven include (<xref rid="b9" ref-type="bibr">Calafiore et al., 2020</xref>, <xref rid="b12" ref-type="bibr">Comunian et al., 2020</xref>, <xref rid="b23" ref-type="bibr">IHME COVID-19, 2020</xref>). However, <xref rid="b23" ref-type="bibr">IHME COVID-19 (2020)</xref> brings to the epidemic model a large corpus of external data in the form of covariates which are assumed to “explain” the future evolution of model parameters.</p>
              </sec>
            </sec>
            <sec id="sec2">
              <label>2</label>
              <title>SIR stochastic modeling</title>
              <p id="d1e552">Denoting by <inline-formula><mml:math id="d1e555" display="inline" altimg="si2.svg"><mml:mrow><mml:mi>ν</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> the number of patients that were infected during day <inline-formula><mml:math id="d1e568" display="inline" altimg="si3.svg"><mml:mi>t</mml:mi></mml:math></inline-formula> and by <inline-formula><mml:math id="d1e573" display="inline" altimg="si4.svg"><mml:mrow><mml:mi>ρ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> the number of removed patients on day <inline-formula><mml:math id="d1e587" display="inline" altimg="si3.svg"><mml:mi>t</mml:mi></mml:math></inline-formula> (i.e., patients that exited the infective state either through death or recovery), we have that <disp-formula-group id="fd1"><disp-formula id="fd1a"><label>(1a)</label><mml:math id="d1e600" display="block" altimg="si6.svg"><mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo id="mmlalignd1e619" linebreak="goodbreak">=</mml:mo><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">−</mml:mo><mml:mi>ν</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="fd1b"><label>(1b)</label><mml:math id="d1e643" display="block" altimg="si7.svg"><mml:mrow><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo id="mmlalignd1e662" linebreak="goodbreak" indentalign="id" indenttarget="mmlalignd1e619">=</mml:mo><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">+</mml:mo><mml:mi>ν</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">−</mml:mo><mml:mi>ρ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="fd1c"><label>(1c)</label><mml:math id="d1e698" display="block" altimg="si8.svg"><mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo id="mmlalignd1e717" linebreak="goodbreak" indentalign="id" indenttarget="mmlalignd1e619">=</mml:mo><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">+</mml:mo><mml:mi>ρ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></disp-formula-group>
where <inline-formula><mml:math id="d1e742" display="inline" altimg="si9.svg"><mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="d1e756" display="inline" altimg="si10.svg"><mml:mrow><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="d1e769" display="inline" altimg="si11.svg"><mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> denote the cumulative numbers of individuals susceptible to the infection, infective patients, and removed patients, respectively, at the start of day <inline-formula><mml:math id="d1e782" display="inline" altimg="si3.svg"><mml:mi>t</mml:mi></mml:math></inline-formula>. A <italic>classical SIR model</italic> postulates that <disp-formula id="fd2"><label>(2)</label><mml:math id="d1e797" display="block" altimg="si13.svg"><mml:mrow><mml:mi>ρ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">=</mml:mo><mml:mi>γ</mml:mi><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mi>ν</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">=</mml:mo><mml:mfrac><mml:mrow><mml:mi>β</mml:mi><mml:mspace width="0.16667em"/><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="d1e872" display="inline" altimg="si14.svg"><mml:mi>γ</mml:mi></mml:math></inline-formula> denotes the <italic>removal rate</italic>, which corresponds to the fraction of patients that leave the infective state on a particular day; <inline-formula><mml:math id="d1e880" display="inline" altimg="si15.svg"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> the total population; and <inline-formula><mml:math id="d1e891" display="inline" altimg="si16.svg"><mml:mrow><mml:mi>β</mml:mi><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>∕</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> the fraction of susceptible individuals that become infected on day <inline-formula><mml:math id="d1e915" display="inline" altimg="si3.svg"><mml:mi>t</mml:mi></mml:math></inline-formula>. This model assumes that this fraction is proportional to the fraction <inline-formula><mml:math id="d1e920" display="inline" altimg="si18.svg"><mml:mrow><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>∕</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> of the population that is infective and the proportionality constant <inline-formula><mml:math id="d1e942" display="inline" altimg="si19.svg"><mml:mi>β</mml:mi></mml:math></inline-formula> is known as the <italic>infection rate.</italic>
</p>
              <p id="d1e949">We consider two key deviations from this classical SIR model</p>
              <p id="d1e951">
                <list list-type="simple" id="d1e953">
                  <list-item id="lst4">
                    <label>(i)</label>
                    <p id="d1e957">We add stochasticity, by regarding the daily number of new infective patients <inline-formula><mml:math id="d1e960" display="inline" altimg="si2.svg"><mml:mrow><mml:mi>ν</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and the daily number of removed patients <inline-formula><mml:math id="d1e973" display="inline" altimg="si4.svg"><mml:mrow><mml:mi>ρ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> as random variables whose means are given by <xref rid="fd2" ref-type="disp-formula">(2)</xref> but exhibit day-to-day stochastic variability.</p>
                  </list-item>
                  <list-item id="lst5">
                    <label>(ii)</label>
                    <p id="d1e992">We take the infection rate <inline-formula><mml:math id="d1e995" display="inline" altimg="si22.svg"><mml:mrow><mml:mi>β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> to be time-varying and the realization of a random process that reflects the changes in population behavior over time.</p>
                  </list-item>
                </list>
              </p>
              <p id="d1e1007">These modifications lead to a <italic>stochastic SIR model</italic> that replaces <xref rid="fd2" ref-type="disp-formula">(2)</xref> by <disp-formula id="d1e1019"><mml:math id="d1e1022" display="block" altimg="si23.svg"><mml:mrow><mml:mi>ρ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">=</mml:mo><mml:mi>γ</mml:mi><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">+</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mi>ν</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">=</mml:mo><mml:mi>β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">+</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="d1e1137" display="inline" altimg="si24.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="d1e1155" display="inline" altimg="si25.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are zero-mean independent Gaussian random variables that account for the daily stochastic variability of <inline-formula><mml:math id="d1e1173" display="inline" altimg="si2.svg"><mml:mrow><mml:mi>ν</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="d1e1186" display="inline" altimg="si4.svg"><mml:mrow><mml:mi>ρ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>; and the infection rate <inline-formula><mml:math id="d1e1200" display="inline" altimg="si22.svg"><mml:mrow><mml:mi>β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is also a random process. In Section <xref rid="sec4.4" ref-type="sec">4.4</xref>, we also consider a variation of this model with a stochastic time-varying removal rate <inline-formula><mml:math id="d1e1218" display="inline" altimg="si29.svg"><mml:mrow><mml:mi>γ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, but we shall see that this does not appear to introduce significant improvements to the quality of our forecasts.</p>
              <sec id="sec2.1">
                <label>2.1</label>
                <title>Measurement model</title>
                <p id="d1e1235">To identify the dynamics <xref rid="fd3" ref-type="disp-formula">(3)</xref> and produce forecasts we use (noisy) measurement of daily new cases, of the form <disp-formula id="d1e1244"><mml:math id="d1e1247" display="block" altimg="si30.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">=</mml:mo><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>ν</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">+</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where the <inline-formula><mml:math id="d1e1303" display="inline" altimg="si31.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> denote zero-mean independent random variables that account for stochastic errors in the daily counts of new reported cases and <inline-formula><mml:math id="d1e1322" display="inline" altimg="si32.svg"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">∈</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> the fraction of infected patients that are reported as new cases on day <inline-formula><mml:math id="d1e1348" display="inline" altimg="si3.svg"><mml:mi>t</mml:mi></mml:math></inline-formula>. The need to consider values <inline-formula><mml:math id="d1e1353" display="inline" altimg="si34.svg"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> arises from the observation that a significant fraction of the newly infected patients may not be reported because they are asymptomatic, they have not been tested, or simply because their disease has not been reported to the entity that is keeping track of new cases. It is important to model <inline-formula><mml:math id="d1e1370" display="inline" altimg="si35.svg"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> as a time-varying parameter because, as a pandemic progresses, one should expect significant variations in the number of asymptotic people that get tested and reported. In the sequel, we refer to <inline-formula><mml:math id="d1e1384" display="inline" altimg="si35.svg"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> as the <italic>new-cases reporting rate</italic>, with the understanding that this parameter actually depends on a large number of factors aside from the actual testing rate of the population.</p>
                <p id="d1e1399">The use of a measurement model based on daily new cases, rather than on the cumulative number of cases, is strongly supported by the results in <xref rid="b26" ref-type="bibr">King et al. (2015)</xref> showing that identification based on cumulative measurements with uncorrelated noise leads to an underestimate of uncertainty.</p>
                <p id="d1e1405">In addition to daily counts of new cases, we also assume that we have available measurements that are roughly proportional to the number of infections, such as the daily number of deaths, the number of hospitalized patients, or the number of patients in intensive care units (ICU). The results presented here use only the number of deaths, which is available for a very large number of countries and regions. This measurement model takes the form: <disp-formula id="d1e1410"><mml:math id="d1e1413" display="block" altimg="si37.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">=</mml:mo><mml:mi>ω</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">+</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="d1e1469" display="inline" altimg="si38.svg"><mml:mrow><mml:mi>ω</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> denotes the <italic>deaths reporting rate</italic>, which corresponds to the expected value of the fraction of infective patients that is likely to be reported as dead due to the epidemic on day <inline-formula><mml:math id="d1e1486" display="inline" altimg="si3.svg"><mml:mi>t</mml:mi></mml:math></inline-formula>; and where the <inline-formula><mml:math id="d1e1491" display="inline" altimg="si40.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are zero-mean independent random variables that account for stochastic errors. In practice, a fraction of the pandemic-related deaths may not be reported as such because of asymptomatic cases, so the deaths reporting rate <inline-formula><mml:math id="d1e1509" display="inline" altimg="si38.svg"><mml:mrow><mml:mi>ω</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> must actually reflect the fraction of infected patients that died <italic>and</italic> whose death was associated with the pandemic. Variability in <inline-formula><mml:math id="d1e1526" display="inline" altimg="si38.svg"><mml:mrow><mml:mi>ω</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> thus arises from a combination of factors that include medical advances in treating the disease, load on the healthcare system that may limit the patients’ access to healthcare resources, as well as testing and the policy used to determine which deaths are attributed to the pandemic.</p>
              </sec>
              <sec id="sec2.2">
                <label>2.2</label>
                <title>Full time-varying model</title>
                <p id="d1e1543">The conservation law <disp-formula id="d1e1548"><mml:math id="d1e1551" display="block" altimg="si43.svg"><mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">+</mml:mo><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">+</mml:mo><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">=</mml:mo><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">+</mml:mo><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">+</mml:mo><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">≕</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>enable us to eliminate one of the three state variables in <xref rid="fd1" ref-type="disp-formula">(1)</xref> and write the full model presented above in terms of the numbers of removed <inline-formula><mml:math id="d1e1635" display="inline" altimg="si11.svg"><mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and unsusceptible <inline-formula><mml:math id="d1e1649" display="inline" altimg="si45.svg"><mml:mrow><mml:mi>U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">≔</mml:mo><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">+</mml:mo><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="d1e1684" display="inline" altimg="si46.svg"><mml:mrow><mml:mo>∀</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula> individuals, leading to <disp-formula-group id="fd3"><disp-formula id="fd3a"><label>(3a)</label><mml:math id="d1e1700" display="block" altimg="si47.svg"><mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo id="mmlalignd1e1694" linebreak="goodbreak">=</mml:mo><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">+</mml:mo><mml:mi>γ</mml:mi><mml:mrow><mml:mo class="bigl" fence="true">(</mml:mo><mml:mrow><mml:mi>U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo class="bigr" fence="true">)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">+</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="fd3b"><label>(3b)</label><mml:math id="d1e1781" display="block" altimg="si48.svg"><mml:mrow><mml:mi>U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo id="mmlalignd1e1775" linebreak="goodbreak" indentalign="id" indenttarget="mmlalignd1e1694">=</mml:mo><mml:mi>U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">+</mml:mo><mml:mi>β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo class="bigl" fence="true">(</mml:mo><mml:mrow><mml:mi>U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo class="bigr" fence="true">)</mml:mo></mml:mrow><mml:mrow><mml:mo class="Bigl" fence="true">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo class="Bigr" fence="true">)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">+</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="fd3c"><label>(3c)</label><mml:math id="d1e1900" display="block" altimg="si49.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo id="mmlalignd1e1895" linebreak="goodbreak" indentalign="id" indenttarget="mmlalignd1e1694">=</mml:mo><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo class="Bigl" fence="true">(</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo class="bigl" fence="true">(</mml:mo><mml:mrow><mml:mi>U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo class="bigr" fence="true">)</mml:mo></mml:mrow><mml:mrow><mml:mo class="Bigl" fence="true">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo class="Bigr" fence="true">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo class="Bigr" fence="true">)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">+</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="fd3d"><label>(3d)</label><mml:math id="d1e2041" display="block" altimg="si50.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo id="mmlalignd1e2036" linebreak="goodbreak" indentalign="id" indenttarget="mmlalignd1e1694">=</mml:mo><mml:mi>ω</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo class="bigl" fence="true">(</mml:mo><mml:mrow><mml:mi>U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo class="bigr" fence="true">)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">+</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></disp-formula-group>
where we used the facts that <inline-formula><mml:math id="d1e2121" display="inline" altimg="si51.svg"><mml:mrow><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mi>U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">−</mml:mo><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="d1e2156" display="inline" altimg="si52.svg"><mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">−</mml:mo><mml:mi>U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="d1e2189" display="inline" altimg="si46.svg"><mml:mrow><mml:mo>∀</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula>. This selection of states has the benefit that the dynamics in <xref rid="fd3a" ref-type="disp-formula">(3a)</xref>–<xref rid="fd3b" ref-type="disp-formula">(3b)</xref> have independent disturbances <inline-formula><mml:math id="d1e2206" display="inline" altimg="si25.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="d1e2224" display="inline" altimg="si24.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, which would not be the case, e.g., if we were to work with the states <inline-formula><mml:math id="d1e2242" display="inline" altimg="si11.svg"><mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="d1e2256" display="inline" altimg="si10.svg"><mml:mrow><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
                <p id="d1e2268">The key problem under consideration is to use measurements <inline-formula><mml:math id="d1e2271" display="inline" altimg="si58.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="d1e2289" display="inline" altimg="si59.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> taken over a window of time <inline-formula><mml:math id="d1e2307" display="inline" altimg="si60.svg"><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> to produce forecasts for the values of the same measurements on a future horizon <inline-formula><mml:math id="d1e2335" display="inline" altimg="si61.svg"><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. To solve this problem we use the model <xref rid="fd3" ref-type="disp-formula">(3)</xref> to compute the a posteriori distribution of the forecasts given the available measurements, with all model parameters in <xref rid="fd3" ref-type="disp-formula">(3)</xref> learned from the available measurements. These parameters include the removal rate <inline-formula><mml:math id="d1e2383" display="inline" altimg="si14.svg"><mml:mi>γ</mml:mi></mml:math></inline-formula>, the original population <inline-formula><mml:math id="d1e2389" display="inline" altimg="si15.svg"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, the infection rate <inline-formula><mml:math id="d1e2399" display="inline" altimg="si22.svg"><mml:mrow><mml:mi>β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, the deaths reporting rate <inline-formula><mml:math id="d1e2412" display="inline" altimg="si38.svg"><mml:mrow><mml:mi>ω</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and the new-cases reporting rate <inline-formula><mml:math id="d1e2425" display="inline" altimg="si35.svg"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. We take the time-varying parameters to be Gaussian random walks of the form <disp-formula-group id="fd4"><disp-formula id="fd4a"><label>(4a)</label><mml:math id="d1e2447" display="block" altimg="si67.svg"><mml:mrow><mml:mi id="mmlalignd1e2414">β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">=</mml:mo><mml:mi>β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">+</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="fd4b"><label>(4b)</label><mml:math id="d1e2495" display="block" altimg="si68.svg"><mml:mrow><mml:mi id="mmlalignd1e2462">ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">=</mml:mo><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">+</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="fd4c"><label>(4c)</label><mml:math id="d1e2543" display="block" altimg="si69.svg"><mml:mrow><mml:mi id="mmlalignd1e2510">ω</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">=</mml:mo><mml:mi>ω</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">+</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ω</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></disp-formula-group>
where the <inline-formula><mml:math id="d1e2592" display="inline" altimg="si70.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="d1e2610" display="inline" altimg="si71.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ω</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="d1e2629" display="inline" altimg="si72.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are independent zero-mean Gaussian processes with unknown variances, which are independent of the disturbances and measurement noise in <xref rid="fd3" ref-type="disp-formula">(3)</xref>. In practice, the specific realizations of these random processes will depend on a multitude of events, including the population’s behavior, the enforcement of non-pharmaceutical interventions, the availability and policies regarding testing of symptomatic and asymptomatic individuals, quarantine policies and practice, etc.</p>
                <p id="d1e2650">Under the model <xref rid="fd4a" ref-type="disp-formula">(4a)</xref> with zero-mean Gaussian increments, given a specific value for the parameter <inline-formula><mml:math id="d1e2657" display="inline" altimg="si19.svg"><mml:mi>β</mml:mi></mml:math></inline-formula> at day <inline-formula><mml:math id="d1e2662" display="inline" altimg="si3.svg"><mml:mi>t</mml:mi></mml:math></inline-formula>, the most likely value of <inline-formula><mml:math id="d1e2668" display="inline" altimg="si19.svg"><mml:mi>β</mml:mi></mml:math></inline-formula> at day <inline-formula><mml:math id="d1e2673" display="inline" altimg="si76.svg"><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> is still <inline-formula><mml:math id="d1e2683" display="inline" altimg="si22.svg"><mml:mrow><mml:mi>β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <italic>in the absence of any additional information.</italic> However, given numerical values for future measurements <xref rid="fd3c" ref-type="disp-formula">(3c)</xref>–<xref rid="fd3d" ref-type="disp-formula">(3d)</xref>, the <italic>a posteriori</italic> distribution of <inline-formula><mml:math id="d1e2711" display="inline" altimg="si22.svg"><mml:mrow><mml:mi>β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> will change and <inline-formula><mml:math id="d1e2725" display="inline" altimg="si22.svg"><mml:mrow><mml:mi>β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> will generally not be the most likely value for <inline-formula><mml:math id="d1e2738" display="inline" altimg="si80.svg"><mml:mrow><mml:mi>β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. It is thus important to emphasize that the random walk model in <xref rid="fd4" ref-type="disp-formula">(4)</xref> simply encodes an a priori assumption on the evolution of the time-varying parameters. We shall see in the numerical results shown in Section <xref rid="sec4" ref-type="sec">4</xref> that the estimates for these parameters derived from their a posteriori distributions will not have zero-mean increments.</p>
                <p id="d1e2763">Zero-mean independent increments for the parameters can be viewed as a very weak model that makes no a priori assumptions on how each parameter will vary from one day to the next. This assumption reflects the desire expressed in the introduction to make as few assumptions as possible on the evolution of the epidemic parameters.</p>
                <p id="d1e2767">In terms of forecasting, the use of zero-mean increments in <xref rid="fd4" ref-type="disp-formula">(4)</xref> that are independent across time means that the past measurements collected up to time <inline-formula><mml:math id="d1e2774" display="inline" altimg="si81.svg"><mml:mi>T</mml:mi></mml:math></inline-formula> provide no information about the value of future increments <inline-formula><mml:math id="d1e2779" display="inline" altimg="si70.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="d1e2798" display="inline" altimg="si72.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="d1e2816" display="inline" altimg="si71.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ω</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="d1e2834" display="inline" altimg="si85.svg"><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">&gt;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> and thus their most likely a posteriori value is still zero. Consequently, the mean a posteriori values of <inline-formula><mml:math id="d1e2844" display="inline" altimg="si22.svg"><mml:mrow><mml:mi>β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="d1e2858" display="inline" altimg="si35.svg"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="d1e2871" display="inline" altimg="si38.svg"><mml:mrow><mml:mi>ω</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> will remain constant after time <inline-formula><mml:math id="d1e2884" display="inline" altimg="si81.svg"><mml:mi>T</mml:mi></mml:math></inline-formula>. However, the past data does provide information about the (unknown) variances of these increments and therefore the future forecasts will take into account that the a posteriori variance of the parameters grows linearly with time at a rate determined by the estimated increments’ variances, which will be directly reflected in the confidence intervals associated with the forecasts.</p>
                <p id="d1e2888">
                  <statement id="rmk1">
                    <label>Remark 1</label>
                    <title>Hospitalization and ICU Use</title>
                    <p id="d1e2895">When we have available daily measurements of the number of hospitalized patients <inline-formula><mml:math id="d1e2898" display="inline" altimg="si90.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>H</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and/or the number of patients in ICU units <inline-formula><mml:math id="d1e2916" display="inline" altimg="si91.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">ICU</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, the model <xref rid="fd3" ref-type="disp-formula">(3)</xref> can be expanded to include measurements of the form <disp-formula-group id="d1e2942"><disp-formula id="d1e2943"><mml:math id="d1e2944" display="block" altimg="si92.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>H</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo id="mmlalignd1e2908" linebreak="goodbreak">=</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>H</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo class="bigl" fence="true">(</mml:mo><mml:mrow><mml:mi>U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo class="bigr" fence="true">)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">+</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>H</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="d1e3024"><mml:math id="d1e3025" display="block" altimg="si93.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">ICU</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo id="mmlalignd1e2988" linebreak="goodbreak" indentalign="id" indenttarget="mmlalignd1e2908">=</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">ICU</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo class="bigl" fence="true">(</mml:mo><mml:mrow><mml:mi>U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo class="bigr" fence="true">)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">+</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">ICU</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></disp-formula-group> and all the results in this paper extend trivially to this enlarged set of measurements.  □</p>
                  </statement>
                </p>
              </sec>
              <sec id="sec2.3">
                <label>2.3</label>
                <title>Identifiability and forecastability</title>
                <p id="d1e3113">For every value of the constants <inline-formula><mml:math id="d1e3116" display="inline" altimg="si94.svg"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo>¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mo>¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, making the change of variables <disp-formula-group id="fd5"><disp-formula id="fd5a"><label>(5a)</label><mml:math id="d1e3160" display="block" altimg="si95.svg"><mml:mrow><mml:msub id="mmlalignd1e3111"><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo>¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi id="mmlalignd1e3136">β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>→</mml:mo><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mo>¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo>¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mi>β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="fd5b"><label>(5b)</label><mml:math id="d1e3259" display="block" altimg="si96.svg"><mml:mrow><mml:mi id="mmlalignd1e3210">ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>→</mml:mo><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mo>¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi id="mmlalignd1e3260">ω</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>→</mml:mo><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mo>¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mi>ω</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="fd5c"><label>(5c)</label><mml:math id="d1e3364" display="block" altimg="si97.svg"><mml:mrow><mml:mi id="mmlalignd1e3315">R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>→</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo>¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">−</mml:mo><mml:mfrac><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mo>¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi id="mmlalignd1e3394">U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>→</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo>¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">−</mml:mo><mml:mfrac><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mo>¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></disp-formula-group>
in the model <xref rid="fd3" ref-type="disp-formula">(3)</xref> results in precisely the same measurements <inline-formula><mml:math id="d1e3531" display="inline" altimg="si58.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="d1e3549" display="inline" altimg="si59.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for the same measurement noise <inline-formula><mml:math id="d1e3567" display="inline" altimg="si31.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="d1e3586" display="inline" altimg="si40.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and disturbances <disp-formula-group id="fd6"><disp-formula id="fd6a"><label>(6a)</label><mml:math id="d1e3612" display="block" altimg="si102.svg"><mml:mrow><mml:msub id="mmlalignd1e3559"><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>→</mml:mo><mml:mfrac><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mo>¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="2em" id="mmlalignd1e3618"/><mml:msub id="mmlalignd1e3621"><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>→</mml:mo><mml:mfrac><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mo>¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="2em" id="mmlalignd1e3680"/></mml:mrow></mml:math></disp-formula><disp-formula id="fd6b"><label>(6b)</label><mml:math id="d1e3741" display="block" altimg="si103.svg"><mml:mrow><mml:msub id="mmlalignd1e3688"><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>→</mml:mo><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mo>¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo>¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub id="mmlalignd1e3767"><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>→</mml:mo><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mo>¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub id="mmlalignd1e3828"><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ω</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>→</mml:mo><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mo>¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ω</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></disp-formula-group>
which means that the joint distribution of the outputs of the model <xref rid="fd3" ref-type="disp-formula">(3)</xref> would not change under the given transformation, if we were to adjust the (unknown) variances of the disturbances to match <xref rid="fd6" ref-type="disp-formula">(6)</xref>. It turns out that <xref rid="fd5" ref-type="disp-formula">(5)</xref>–<xref rid="fd6" ref-type="disp-formula">(6)</xref> corresponds to the only time-invariant affine transformation of <inline-formula><mml:math id="d1e3964" display="inline" altimg="si104.svg"><mml:mrow><mml:mi>U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="d1e3978" display="inline" altimg="si11.svg"><mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> that preserves the structure of the SIR model <xref rid="fd3" ref-type="disp-formula">(3)</xref> without changing the outputs.</p>
                <p id="d1e3994">A key consequence of the above observation is that, in the absence of additional information, the model outputs do not permit the identification of the original population <inline-formula><mml:math id="d1e3997" display="inline" altimg="si15.svg"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> nor the initial new-cases reporting rate <inline-formula><mml:math id="d1e4007" display="inline" altimg="si107.svg"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>; as the true values of these parameters could be replaced by arbitrary values <inline-formula><mml:math id="d1e4020" display="inline" altimg="si108.svg"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo>¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="d1e4036" display="inline" altimg="si109.svg"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mo>¯</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> without changing the outputs distribution. Moreover, any estimates of the remaining parameters can only be known up to the transformation in <xref rid="fd5" ref-type="disp-formula">(5)</xref>–<xref rid="fd6" ref-type="disp-formula">(6)</xref>. In spite of this, and precisely because this transformation does not affect the output’s probability distribution, it remains possible to produce forecasts of future outputs, even if states estimates will have fundamental ambiguities. This argument shows that the model <xref rid="fd3" ref-type="disp-formula">(3)</xref> is <italic>not identifiable</italic>, in the sense that the measurements available do not suffice to identify unique values for the states and parameters (<xref rid="b12" ref-type="bibr">Comunian et al., 2020</xref>, <xref rid="b32" ref-type="bibr">Miao et al., 2011</xref>).</p>
                <p id="d1e4074">The lack of state/parameter identifiability of <xref rid="fd3" ref-type="disp-formula">(3)</xref>, enable us to simplify this model by setting arbitrary values for <inline-formula><mml:math id="d1e4081" display="inline" altimg="si15.svg"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="d1e4091" display="inline" altimg="si107.svg"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <italic>without compromising the quality of the forecasts.</italic> We shall see in our numerical results that, once this ambiguity has been resolved, we obtain a posteriori probability density function of future outputs with finite error covariances, which means that the outputs of <xref rid="fd3" ref-type="disp-formula">(3)</xref> are <italic>forecastable</italic>.</p>
                <p id="d1e4114">
                  <statement id="rmk2">
                    <label>Remark 2</label>
                    <p id="d1e4119">It should be noted that the transformation in <xref rid="fd5" ref-type="disp-formula">(5)</xref> can result in (not physically meaningful) negative values for <inline-formula><mml:math id="d1e4126" display="inline" altimg="si11.svg"><mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="d1e4139" display="inline" altimg="si104.svg"><mml:mrow><mml:mi>U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> if we pick <inline-formula><mml:math id="d1e4153" display="inline" altimg="si108.svg"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo>¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> too small. It may also result in rates <inline-formula><mml:math id="d1e4168" display="inline" altimg="si115.svg"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> larger than 1, if the initial rate <inline-formula><mml:math id="d1e4173" display="inline" altimg="si107.svg"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> was smaller than 1 and it increased to values above that initial one. However, regardless of whether or not these estimates are “physically meaningful” the forecasts will remain unchanged. □</p>
                  </statement>
                </p>
              </sec>
            </sec>
            <sec id="sec3">
              <label>3</label>
              <title>Nonlinear system identification and forecasting</title>
              <p id="d1e4192">We are interested in predicting the future states and outputs of a general stochastic nonlinear system of the form<xref rid="fn1" ref-type="fn">1</xref>
<disp-formula id="fd7a"><label>(7a)</label><mml:math id="d1e4233" display="block" altimg="si119.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">+</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mo linebreak="goodbreak">∀</mml:mo><mml:mi>t</mml:mi><mml:mo linebreak="goodbreak">∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>based on a finite set of measurements <disp-formula id="fd7b"><label>(7b)</label><mml:math id="d1e4310" display="block" altimg="si120.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">+</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mo linebreak="goodbreak">∀</mml:mo><mml:mi>t</mml:mi><mml:mo linebreak="goodbreak">∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> where <inline-formula><mml:math id="d1e4378" display="inline" altimg="si121.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> denotes the state of the system, <inline-formula><mml:math id="d1e4403" display="inline" altimg="si122.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> the measured output, <inline-formula><mml:math id="d1e4428" display="inline" altimg="si123.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> a stochastic disturbance, and <inline-formula><mml:math id="d1e4453" display="inline" altimg="si124.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> a stochastic measurement noise. The system dynamics in <xref rid="fd7a" ref-type="disp-formula">(7a)</xref>, the measurements equation in <xref rid="fd7b" ref-type="disp-formula">(7b)</xref>, and the probability distributions of <inline-formula><mml:math id="d1e4487" display="inline" altimg="si125.svg"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="d1e4497" display="inline" altimg="si126.svg"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> depend on an unknown parameter vector <inline-formula><mml:math id="d1e4508" display="inline" altimg="si127.svg"><mml:mi>θ</mml:mi></mml:math></inline-formula> taking value in a given set <inline-formula><mml:math id="d1e4513" display="inline" altimg="si128.svg"><mml:mrow><mml:mi>Θ</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">⊂</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>.</p>
              <p id="d1e4532">Measurements are available for (past) times <inline-formula><mml:math id="d1e4535" display="inline" altimg="si129.svg"><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for some integer <inline-formula><mml:math id="d1e4558" display="inline" altimg="si130.svg"><mml:mrow><mml:mi>T</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and our goal is to forecast the state and output for future times <inline-formula><mml:math id="d1e4568" display="inline" altimg="si131.svg"><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for some integer <inline-formula><mml:math id="d1e4600" display="inline" altimg="si132.svg"><mml:mrow><mml:mi>P</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. Towards this goal, we need to compute a maximum likelihood estimate <inline-formula><mml:math id="d1e4610" display="inline" altimg="si133.svg"><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:math></inline-formula> for <inline-formula><mml:math id="d1e4620" display="inline" altimg="si127.svg"><mml:mi>θ</mml:mi></mml:math></inline-formula>
<disp-formula id="fd8"><label>(8)</label><mml:math id="d1e4631" display="block" altimg="si135.svg"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover><mml:mo linebreak="goodbreak">=</mml:mo><mml:munder><mml:mrow><mml:mo class="qopname">arg max</mml:mo></mml:mrow><mml:mrow><mml:mi>θ</mml:mi><mml:mo linebreak="badbreak">∈</mml:mo><mml:mi>Θ</mml:mi></mml:mrow></mml:munder><mml:mo class="qopname">log</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="d1e4696" display="inline" altimg="si136.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>⋅</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> denotes the likelihood function, and then use this estimate to compute the a posteriori conditional distributions of the past and future states and future outputs, given the measurements: <disp-formula id="fd9"><label>(9)</label><mml:math id="d1e4720" display="block" altimg="si137.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo linebreak="badbreak">+</mml:mo></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>This could be accomplished by first computing the estimate <inline-formula><mml:math id="d1e4837" display="inline" altimg="si133.svg"><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:math></inline-formula> that minimizes <xref rid="fd8" ref-type="disp-formula">(8)</xref> and subsequently using an extended Kalman filter (or a variation of it, like an unscented Kalman filter) to compute the conditional distribution of the future states and outputs in <xref rid="fd9" ref-type="disp-formula">(9)</xref>. The procedure proposed here jointly computes <xref rid="fd8" ref-type="disp-formula">(8)</xref>, <xref rid="fd9" ref-type="disp-formula">(9)</xref>, without explicitly computing the output likelihood function that appears in <xref rid="fd8" ref-type="disp-formula">(8)</xref>.</p>
              <sec id="sec3.1">
                <label>3.1</label>
                <title>Maximum likelihood estimation</title>
                <p id="d1e4868">For nonlinear systems, it is generally hard to compute the probability distribution of the measured outputs that appears in the maximum likelihood optimization in <xref rid="fd8" ref-type="disp-formula">(8)</xref>. However, even though the dynamics in <xref rid="fd7a" ref-type="disp-formula">(7)</xref> are nonlinear, it is straightforward to compute the joint distribution of the state and output for this model under mild Markovian assumptions, as noted in the following result, which will be proved in Section <xref rid="sec3.3" ref-type="sec">3.3</xref>.</p>
                <p id="d1e4883">
                  <statement id="lem1">
                    <label>Lemma 1</label>
                    <p id="d1e4888">
                      <italic>Assume that the disturbances and noise at each time</italic>
                      <inline-formula>
                        <mml:math id="d1e4894" display="inline" altimg="si3.svg">
                          <mml:mi>t</mml:mi>
                        </mml:math>
                      </inline-formula>
                      <italic>are conditionally independent of all past disturbances and noise, given the state at time</italic>
                      <inline-formula>
                        <mml:math id="d1e4902" display="inline" altimg="si3.svg">
                          <mml:mi>t</mml:mi>
                        </mml:math>
                      </inline-formula>
                      <italic>, specifically:</italic>
                      <disp-formula id="fd10">
                        <label>(10)</label>
                        <mml:math id="d1e4916" display="block" altimg="si141.svg">
                          <mml:mrow>
                            <mml:msub id="mmlalignd1e4843">
                              <mml:mrow>
                                <mml:mi>p</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>d</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>t</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mo>,</mml:mo>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>w</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>t</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>d</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>t</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>,</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>w</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>t</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>|</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>x</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>t</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>,</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>d</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>t</mml:mi>
                                  <mml:mo linebreak="badbreak">−</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>,</mml:mo>
                              <mml:mo>…</mml:mo>
                              <mml:mo>,</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>d</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>,</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>w</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>t</mml:mi>
                                  <mml:mo linebreak="badbreak">−</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>,</mml:mo>
                              <mml:mo>…</mml:mo>
                              <mml:mo>,</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>w</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>;</mml:mo>
                              <mml:mi>θ</mml:mi>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                            <mml:mspace width="1em" id="mmlalignd1e4954"/>
                            <mml:mo linebreak="goodbreak">=</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>p</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>d</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>t</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mo>,</mml:mo>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>w</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>t</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mrow>
                              <mml:mo class="bigl" fence="true">(</mml:mo>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>d</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>t</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mo>,</mml:mo>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>w</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>t</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mo>|</mml:mo>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>x</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>t</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mo>;</mml:mo>
                                <mml:mi>θ</mml:mi>
                              </mml:mrow>
                              <mml:mo class="bigr" fence="true">)</mml:mo>
                            </mml:mrow>
                            <mml:mo>,</mml:mo>
                            <mml:mspace width="2em"/>
                            <mml:mo linebreak="goodbreak">∀</mml:mo>
                            <mml:mi>t</mml:mi>
                            <mml:mo linebreak="goodbreak">∈</mml:mo>
                            <mml:mrow>
                              <mml:mo>{</mml:mo>
                              <mml:mn>1</mml:mn>
                              <mml:mo>,</mml:mo>
                              <mml:mn>2</mml:mn>
                              <mml:mo>,</mml:mo>
                              <mml:mo>…</mml:mo>
                              <mml:mo>}</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:math>
                      </disp-formula>
                      <italic>where</italic>
                      <inline-formula>
                        <mml:math id="d1e5122" display="inline" altimg="si142.svg">
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>p</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>d</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>t</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mo>,</mml:mo>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>w</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>t</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mi>⋅</mml:mi>
                              <mml:mo>|</mml:mo>
                              <mml:mi>⋅</mml:mi>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:math>
                      </inline-formula>
                      <italic>denotes the joint conditional probability density function (pdf) of</italic>
                      <inline-formula>
                        <mml:math id="d1e5161" display="inline" altimg="si125.svg">
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>d</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>t</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:math>
                      </inline-formula>
                      <italic>and</italic>
                      <inline-formula>
                        <mml:math id="d1e5175" display="inline" altimg="si126.svg">
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>w</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>t</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:math>
                      </inline-formula>
                      <italic>. In this case, the logarithm of the joint probability density function of the output and state sequences for the model</italic>
                      <xref rid="fd7a" ref-type="disp-formula">(7)</xref>
                      <italic>is given by</italic>
                      <disp-formula id="fd11">
                        <label>(11)</label>
                        <mml:math id="d1e5201" display="block" altimg="si145.svg">
                          <mml:mrow>
                            <mml:mo class="qopname" id="mmlalignd1e5121">log</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>p</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>x</mml:mi>
                                <mml:mo>,</mml:mo>
                                <mml:mi>y</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>y</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>,</mml:mo>
                              <mml:mo>…</mml:mo>
                              <mml:mo>,</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>y</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>T</mml:mi>
                                  <mml:mo linebreak="badbreak">+</mml:mo>
                                  <mml:mi>P</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>,</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>x</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>,</mml:mo>
                              <mml:mo>…</mml:mo>
                              <mml:mo>,</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>x</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>T</mml:mi>
                                  <mml:mo linebreak="badbreak">+</mml:mo>
                                  <mml:mi>P</mml:mi>
                                  <mml:mo linebreak="badbreak">+</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>;</mml:mo>
                              <mml:mi>θ</mml:mi>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                            <mml:mspace width="1em" id="mmlalignd1e5201"/>
                            <mml:mo linebreak="goodbreak">=</mml:mo>
                            <mml:munderover>
                              <mml:mrow>
                                <mml:mo linebreak="badbreak">∑</mml:mo>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>t</mml:mi>
                                <mml:mo linebreak="badbreak">=</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>T</mml:mi>
                                <mml:mo linebreak="badbreak">+</mml:mo>
                                <mml:mi>P</mml:mi>
                              </mml:mrow>
                            </mml:munderover>
                            <mml:mo class="qopname">log</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>p</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>d</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>t</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mo>,</mml:mo>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>w</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>t</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mrow>
                              <mml:mo class="bigl" fence="true">(</mml:mo>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>x</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>t</mml:mi>
                                    <mml:mo linebreak="badbreak">+</mml:mo>
                                    <mml:mn>1</mml:mn>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mo>−</mml:mo>
                                <mml:mi>f</mml:mi>
                                <mml:mrow>
                                  <mml:mo>(</mml:mo>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>x</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>t</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mo>;</mml:mo>
                                  <mml:mi>θ</mml:mi>
                                  <mml:mo>)</mml:mo>
                                </mml:mrow>
                                <mml:mo>,</mml:mo>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>y</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>t</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mo>−</mml:mo>
                                <mml:mi>g</mml:mi>
                                <mml:mrow>
                                  <mml:mo>(</mml:mo>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>x</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>t</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mo>;</mml:mo>
                                  <mml:mi>θ</mml:mi>
                                  <mml:mo>)</mml:mo>
                                </mml:mrow>
                                <mml:mo>∣</mml:mo>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>x</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>t</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mo>;</mml:mo>
                                <mml:mi>θ</mml:mi>
                              </mml:mrow>
                              <mml:mo class="bigr" fence="true">)</mml:mo>
                            </mml:mrow>
                            <mml:mo>.</mml:mo>
                            <mml:mspace width="1.2em"/>
                            <mml:mo>□</mml:mo>
                          </mml:mrow>
                        </mml:math>
                      </disp-formula>
                    </p>
                  </statement>
                </p>
                <p id="d1e5417">The <italic>marginal distribution</italic> of the measurements needed for maximum likelihood estimation in <xref rid="fd8" ref-type="disp-formula">(8)</xref> can be obtained from the state and output <italic>joint distribution</italic> in <xref rid="fd11" ref-type="disp-formula">(11)</xref>, using <disp-formula id="fd12"><label>(12)</label><mml:math id="d1e5441" display="block" altimg="si146.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo id="mmlalignd1e5401" linebreak="goodbreak">=</mml:mo><mml:mo id="mmlalignd1e5404" linebreak="goodbreak">∫</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:mi>P</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi id="mmlalignd1e5485">d</mml:mi><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">⋯</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">⋯</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> which requires an integration of the joint distribution with respect to all the state variables and future outputs; an operation that generally cannot be done in closed form for nonlinear systems. However, the following result (proved in Section <xref rid="sec3.3" ref-type="sec">3.3</xref>) provides a procedure to avoid this integration based on Laplace’s method to approximate integrals (<xref rid="b29" ref-type="bibr">MacKay, 2003</xref>): Consider a measurement vector <inline-formula><mml:math id="d1e5631" display="inline" altimg="si147.svg"><mml:mi>Y</mml:mi></mml:math></inline-formula> with a probability density function of the form <disp-formula id="d1e5638"><mml:math id="d1e5641" display="block" altimg="si148.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">=</mml:mo><mml:mo linebreak="goodbreak">∫</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>Z</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="d1e5699" display="inline" altimg="si127.svg"><mml:mi>θ</mml:mi></mml:math></inline-formula> is a vector of unknown parameters taking values in some set <inline-formula><mml:math id="d1e5704" display="inline" altimg="si150.svg"><mml:mi>Θ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="d1e5710" display="inline" altimg="si151.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the joint distribution of <inline-formula><mml:math id="d1e5740" display="inline" altimg="si147.svg"><mml:mi>Y</mml:mi></mml:math></inline-formula> and a latent random variable <inline-formula><mml:math id="d1e5745" display="inline" altimg="si153.svg"><mml:mrow><mml:mi>Z</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> that needs to be integrated out.</p>
                <p id="d1e5764">
                  <statement id="lem2">
                    <label>Lemma 2</label>
                    <p id="d1e5769">
                      <italic>Assume that, for every</italic>
                      <inline-formula>
                        <mml:math id="d1e5775" display="inline" altimg="si127.svg">
                          <mml:mi>θ</mml:mi>
                        </mml:math>
                      </inline-formula>
                      <italic>and</italic>
                      <inline-formula>
                        <mml:math id="d1e5783" display="inline" altimg="si147.svg">
                          <mml:mi>Y</mml:mi>
                        </mml:math>
                      </inline-formula>
                      <italic>, the conditional distribution of</italic>
                      <inline-formula>
                        <mml:math id="d1e5791" display="inline" altimg="si156.svg">
                          <mml:mi>Z</mml:mi>
                        </mml:math>
                      </inline-formula>
                      <italic>given</italic>
                      <inline-formula>
                        <mml:math id="d1e5799" display="inline" altimg="si147.svg">
                          <mml:mi>Y</mml:mi>
                        </mml:math>
                      </inline-formula>
                      <italic>is a multivariable Gaussian. Then the Hessian matrix</italic>
                      <disp-formula id="fd13">
                        <label>(13)</label>
                        <mml:math id="d1e5814" display="block" altimg="si158.svg">
                          <mml:mrow>
                            <mml:mi>H</mml:mi>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mi>Y</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>Z</mml:mi>
                              <mml:mo>;</mml:mo>
                              <mml:mi>θ</mml:mi>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                            <mml:mo linebreak="goodbreak">≔</mml:mo>
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mi>∂</mml:mi>
                                <mml:msup>
                                  <mml:mrow/>
                                  <mml:mrow>
                                    <mml:mn>2</mml:mn>
                                  </mml:mrow>
                                </mml:msup>
                                <mml:mo class="qopname">log</mml:mo>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>p</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>Y</mml:mi>
                                    <mml:mo>,</mml:mo>
                                    <mml:mi>Z</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mrow>
                                  <mml:mo>(</mml:mo>
                                  <mml:mi>Y</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>Z</mml:mi>
                                  <mml:mo>;</mml:mo>
                                  <mml:mi>θ</mml:mi>
                                  <mml:mo>)</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>∂</mml:mi>
                                <mml:msup>
                                  <mml:mrow>
                                    <mml:mi>Z</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mn>2</mml:mn>
                                  </mml:mrow>
                                </mml:msup>
                              </mml:mrow>
                            </mml:mfrac>
                          </mml:mrow>
                        </mml:math>
                      </disp-formula>
                      <italic>does not depend on</italic>
                      <inline-formula>
                        <mml:math id="d1e5886" display="inline" altimg="si156.svg">
                          <mml:mi>Z</mml:mi>
                        </mml:math>
                      </inline-formula>
                      <italic>,</italic>
                      <disp-formula id="fd14">
                        <label>(14)</label>
                        <mml:math id="d1e5899" display="block" altimg="si160.svg">
                          <mml:mrow>
                            <mml:mo class="qopname">E</mml:mo>
                            <mml:mrow>
                              <mml:mo>[</mml:mo>
                              <mml:mi>Z</mml:mi>
                              <mml:mo>|</mml:mo>
                              <mml:mi>Y</mml:mi>
                              <mml:mo>]</mml:mo>
                            </mml:mrow>
                            <mml:mo linebreak="goodbreak">=</mml:mo>
                            <mml:munder>
                              <mml:mrow>
                                <mml:mo class="qopname">arg max</mml:mo>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>Z</mml:mi>
                                <mml:mo linebreak="badbreak">∈</mml:mo>
                                <mml:msup>
                                  <mml:mrow>
                                    <mml:mi mathvariant="double-struck">R</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mrow>
                                        <mml:mi>n</mml:mi>
                                      </mml:mrow>
                                      <mml:mrow>
                                        <mml:mi>Z</mml:mi>
                                      </mml:mrow>
                                    </mml:msub>
                                  </mml:mrow>
                                </mml:msup>
                              </mml:mrow>
                            </mml:munder>
                            <mml:mo class="qopname">log</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>p</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>Y</mml:mi>
                                <mml:mo>,</mml:mo>
                                <mml:mi>Z</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mi>Y</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>Z</mml:mi>
                              <mml:mo>;</mml:mo>
                              <mml:mi>θ</mml:mi>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                            <mml:mo>,</mml:mo>
                            <mml:mspace width="2em"/>
                            <mml:mo class="qopname">CoV</mml:mo>
                            <mml:mrow>
                              <mml:mo>[</mml:mo>
                              <mml:mi>Z</mml:mi>
                              <mml:mo>|</mml:mo>
                              <mml:mi>Y</mml:mi>
                              <mml:mo>]</mml:mo>
                            </mml:mrow>
                            <mml:mo linebreak="goodbreak">=</mml:mo>
                            <mml:mo linebreak="goodbreak">−</mml:mo>
                            <mml:mi>H</mml:mi>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:mo>(</mml:mo>
                                  <mml:mi>Y</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>Z</mml:mi>
                                  <mml:mo>;</mml:mo>
                                  <mml:mi>θ</mml:mi>
                                  <mml:mo>)</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo linebreak="badbreak">−</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msup>
                            <mml:mo>,</mml:mo>
                          </mml:mrow>
                        </mml:math>
                      </disp-formula>
                      <italic>and</italic>
                      <disp-formula id="fd15">
                        <label>(15)</label>
                        <mml:math id="d1e6023" display="block" altimg="si161.svg">
                          <mml:mrow>
                            <mml:mo class="qopname">log</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>p</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>Y</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mi>Y</mml:mi>
                              <mml:mo>;</mml:mo>
                              <mml:mi>θ</mml:mi>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                            <mml:mo id="mmlalignd1e5973" linebreak="goodbreak">=</mml:mo>
                            <mml:mfrac id="mmlalignd1e5976">
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>n</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>Z</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mo class="qopname">log</mml:mo>
                                <mml:mrow>
                                  <mml:mo>(</mml:mo>
                                  <mml:mn>2</mml:mn>
                                  <mml:mi>π</mml:mi>
                                  <mml:mo>)</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mn>2</mml:mn>
                              </mml:mrow>
                            </mml:mfrac>
                            <mml:mo linebreak="goodbreak">−</mml:mo>
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mo class="qopname">log</mml:mo>
                                <mml:mo class="qopname">det</mml:mo>
                                <mml:mrow>
                                  <mml:mo class="bigl" fence="true">(</mml:mo>
                                  <mml:mrow>
                                    <mml:mo linebreak="badbreak">−</mml:mo>
                                    <mml:mi>H</mml:mi>
                                    <mml:mrow>
                                      <mml:mo>(</mml:mo>
                                      <mml:mi>Y</mml:mi>
                                      <mml:mo>,</mml:mo>
                                      <mml:mi>Z</mml:mi>
                                      <mml:mo>;</mml:mo>
                                      <mml:mi>θ</mml:mi>
                                      <mml:mo>)</mml:mo>
                                    </mml:mrow>
                                  </mml:mrow>
                                  <mml:mo class="bigr" fence="true">)</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mn>2</mml:mn>
                              </mml:mrow>
                            </mml:mfrac>
                            <mml:mo id="mmlalignd1e6042" linebreak="newline" indentalign="id" indenttarget="mmlalignd1e5976">+</mml:mo>
                            <mml:munder>
                              <mml:mrow>
                                <mml:mo class="qopname">max</mml:mo>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>Z</mml:mi>
                                <mml:mo linebreak="badbreak">∈</mml:mo>
                                <mml:msup>
                                  <mml:mrow>
                                    <mml:mi mathvariant="double-struck">R</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mrow>
                                        <mml:mi>n</mml:mi>
                                      </mml:mrow>
                                      <mml:mrow>
                                        <mml:mi>Z</mml:mi>
                                      </mml:mrow>
                                    </mml:msub>
                                  </mml:mrow>
                                </mml:msup>
                              </mml:mrow>
                            </mml:munder>
                            <mml:mo class="qopname">log</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>p</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>Y</mml:mi>
                                <mml:mo>,</mml:mo>
                                <mml:mi>Z</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mi>Y</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>Z</mml:mi>
                              <mml:mo>;</mml:mo>
                              <mml:mi>θ</mml:mi>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                            <mml:mo>.</mml:mo>
                          </mml:mrow>
                        </mml:math>
                      </disp-formula>
                      <italic>Consequently, the maximum likelihood estimator for</italic>
                      <inline-formula>
                        <mml:math id="d1e6172" display="inline" altimg="si127.svg">
                          <mml:mi>θ</mml:mi>
                        </mml:math>
                      </inline-formula>
                      <italic>can be obtained by solving</italic>
                      <disp-formula id="fd16">
                        <label>(16)</label>
                        <mml:math id="d1e6187" display="block" altimg="si163.svg">
                          <mml:mrow>
                            <mml:munder>
                              <mml:mrow>
                                <mml:mo class="qopname">arg max</mml:mo>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>θ</mml:mi>
                                <mml:mo linebreak="badbreak">∈</mml:mo>
                                <mml:mi>Θ</mml:mi>
                              </mml:mrow>
                            </mml:munder>
                            <mml:mrow>
                              <mml:mo class="Bigl" fence="true">(</mml:mo>
                              <mml:mrow>
                                <mml:mo>−</mml:mo>
                                <mml:mfrac>
                                  <mml:mrow>
                                    <mml:mn>1</mml:mn>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mn>2</mml:mn>
                                  </mml:mrow>
                                </mml:mfrac>
                                <mml:mo class="qopname">log</mml:mo>
                                <mml:mo class="qopname">det</mml:mo>
                                <mml:mrow>
                                  <mml:mo class="bigl" fence="true">(</mml:mo>
                                  <mml:mrow>
                                    <mml:mo>−</mml:mo>
                                    <mml:mi>H</mml:mi>
                                    <mml:mrow>
                                      <mml:mo>(</mml:mo>
                                      <mml:mi>Y</mml:mi>
                                      <mml:mo>,</mml:mo>
                                      <mml:mi>Z</mml:mi>
                                      <mml:mo>;</mml:mo>
                                      <mml:mi>θ</mml:mi>
                                      <mml:mo>)</mml:mo>
                                    </mml:mrow>
                                  </mml:mrow>
                                  <mml:mo class="bigr" fence="true">)</mml:mo>
                                </mml:mrow>
                                <mml:mo>+</mml:mo>
                                <mml:munder>
                                  <mml:mrow>
                                    <mml:mo class="qopname">max</mml:mo>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>Z</mml:mi>
                                    <mml:mo linebreak="badbreak">∈</mml:mo>
                                    <mml:msup>
                                      <mml:mrow>
                                        <mml:mi mathvariant="double-struck">R</mml:mi>
                                      </mml:mrow>
                                      <mml:mrow>
                                        <mml:msub>
                                          <mml:mrow>
                                            <mml:mi>n</mml:mi>
                                          </mml:mrow>
                                          <mml:mrow>
                                            <mml:mi>Z</mml:mi>
                                          </mml:mrow>
                                        </mml:msub>
                                      </mml:mrow>
                                    </mml:msup>
                                  </mml:mrow>
                                </mml:munder>
                                <mml:mo class="qopname">log</mml:mo>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>p</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>Y</mml:mi>
                                    <mml:mo>,</mml:mo>
                                    <mml:mi>Z</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mrow>
                                  <mml:mo>(</mml:mo>
                                  <mml:mi>Y</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>Z</mml:mi>
                                  <mml:mo>;</mml:mo>
                                  <mml:mi>θ</mml:mi>
                                  <mml:mo>)</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                              <mml:mo class="Bigr" fence="true">)</mml:mo>
                            </mml:mrow>
                            <mml:mo>,</mml:mo>
                          </mml:mrow>
                        </mml:math>
                      </disp-formula>
                      <italic>and, in view of</italic>
                      <xref rid="fd14" ref-type="disp-formula">(14)</xref>
                      <italic>, the associated minimum variance estimator of</italic>
                      <inline-formula>
                        <mml:math id="d1e6311" display="inline" altimg="si156.svg">
                          <mml:mi>Z</mml:mi>
                        </mml:math>
                      </inline-formula>
                      <italic>is</italic>
                      <disp-formula id="d1e6322">
                        <mml:math id="d1e6325" display="block" altimg="si165.svg">
                          <mml:mrow>
                            <mml:mover accent="true">
                              <mml:mrow>
                                <mml:mi>Z</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo>ˆ</mml:mo>
                              </mml:mrow>
                            </mml:mover>
                            <mml:mo linebreak="goodbreak">≔</mml:mo>
                            <mml:munder>
                              <mml:mrow>
                                <mml:mo class="qopname">arg max</mml:mo>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>Z</mml:mi>
                                <mml:mo linebreak="badbreak">∈</mml:mo>
                                <mml:msup>
                                  <mml:mrow>
                                    <mml:mi mathvariant="double-struck">R</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mrow>
                                        <mml:mi>n</mml:mi>
                                      </mml:mrow>
                                      <mml:mrow>
                                        <mml:mi>Z</mml:mi>
                                      </mml:mrow>
                                    </mml:msub>
                                  </mml:mrow>
                                </mml:msup>
                              </mml:mrow>
                            </mml:munder>
                            <mml:mo class="qopname">log</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>p</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>Y</mml:mi>
                                <mml:mo>,</mml:mo>
                                <mml:mi>Z</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mi>Y</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>Z</mml:mi>
                              <mml:mo>;</mml:mo>
                              <mml:mi>θ</mml:mi>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:math>
                      </disp-formula>
                      <italic>with associated error covariance equal to</italic>
                      <disp-formula id="fd17">
                        <label>(17)</label>
                        <mml:math id="d1e6395" display="block" altimg="si166.svg">
                          <mml:mrow>
                            <mml:mo class="qopname">E</mml:mo>
                            <mml:mrow>
                              <mml:mo>[</mml:mo>
                              <mml:mrow>
                                <mml:mo>(</mml:mo>
                                <mml:mi>Z</mml:mi>
                                <mml:mo>−</mml:mo>
                                <mml:mover accent="true">
                                  <mml:mrow>
                                    <mml:mi>Z</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mo>ˆ</mml:mo>
                                  </mml:mrow>
                                </mml:mover>
                                <mml:mo>)</mml:mo>
                              </mml:mrow>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mrow>
                                    <mml:mo>(</mml:mo>
                                    <mml:mi>Z</mml:mi>
                                    <mml:mo linebreak="badbreak">−</mml:mo>
                                    <mml:mover accent="true">
                                      <mml:mrow>
                                        <mml:mi>Z</mml:mi>
                                      </mml:mrow>
                                      <mml:mrow>
                                        <mml:mo>ˆ</mml:mo>
                                      </mml:mrow>
                                    </mml:mover>
                                    <mml:mo>)</mml:mo>
                                  </mml:mrow>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo>′</mml:mo>
                                </mml:mrow>
                              </mml:msup>
                              <mml:mo>|</mml:mo>
                              <mml:mi>Y</mml:mi>
                              <mml:mo>]</mml:mo>
                            </mml:mrow>
                            <mml:mo linebreak="goodbreak">=</mml:mo>
                            <mml:mo linebreak="goodbreak">−</mml:mo>
                            <mml:mi>H</mml:mi>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:mo>(</mml:mo>
                                  <mml:mi>Y</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>Z</mml:mi>
                                  <mml:mo>;</mml:mo>
                                  <mml:mi>θ</mml:mi>
                                  <mml:mo>)</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo linebreak="badbreak">−</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msup>
                            <mml:mo>.</mml:mo>
                            <mml:mspace width="1.2em"/>
                            <mml:mo>□</mml:mo>
                          </mml:mrow>
                        </mml:math>
                      </disp-formula>
                    </p>
                  </statement>
                </p>
                <p id="d1e6478">Making the following associations <disp-formula-group id="d1e6484"><disp-formula id="d1e6485"><mml:math id="d1e6486" display="block" altimg="si167.svg"><mml:mrow><mml:mi>Y</mml:mi><mml:mo id="mmlalignd1e6420" linebreak="goodbreak">≔</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="d1e6536"><mml:math id="d1e6537" display="block" altimg="si168.svg"><mml:mrow><mml:mi>Z</mml:mi><mml:mo id="mmlalignd1e6470" linebreak="goodbreak" indentalign="id" indenttarget="mmlalignd1e6420">≔</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:mi>P</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">≔</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mi>P</mml:mi><mml:mo linebreak="goodbreak">+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></disp-formula-group> with the joint probability density function of these variables given by <xref rid="fd11" ref-type="disp-formula">(11)</xref> in <xref rid="lem1" ref-type="statement">Lemma 1</xref>, the formula <xref rid="fd16" ref-type="disp-formula">(16)</xref> in <xref rid="lem2" ref-type="statement">Lemma 2</xref> provides a method to compute the maximum likelihood estimate for <inline-formula><mml:math id="d1e6685" display="inline" altimg="si127.svg"><mml:mi>θ</mml:mi></mml:math></inline-formula>. As a side product, we also obtain the mean and covariance matrix of the a posteriori distribution in <xref rid="fd9" ref-type="disp-formula">(9)</xref>. This enable us to simultaneously obtain the maximum likelihood estimate of <inline-formula><mml:math id="d1e6695" display="inline" altimg="si127.svg"><mml:mi>θ</mml:mi></mml:math></inline-formula> and the corresponding a posteriori distribution of the state and future output.</p>
                <p id="d1e6699">When the functions <inline-formula><mml:math id="d1e6702" display="inline" altimg="si171.svg"><mml:mi>f</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="d1e6707" display="inline" altimg="si172.svg"><mml:mi>g</mml:mi></mml:math></inline-formula> in <xref rid="fd7a" ref-type="disp-formula">(7)</xref> are nonlinear and/or the disturbance and noise distributions in <xref rid="fd10" ref-type="disp-formula">(10)</xref> are not multivariable Gaussian, the conditional distribution of the state given the output measurements will likely also not be Gaussian and therefore <xref rid="fd15" ref-type="disp-formula">(15)</xref> should be taken as an approximation of the true marginal distribution. We shall see in the proof of <xref rid="lem2" ref-type="statement">Lemma 2</xref> that the Gaussian assumption is used to justify truncating the Taylor series of <inline-formula><mml:math id="d1e6729" display="inline" altimg="si173.svg"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>↦</mml:mo><mml:mo class="qopname">log</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mo>|</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> at its second term since this function is quadratic for Gaussian distributions. For non-Gaussian distributions, this truncation will introduce an error, but it is possible to establish a bound on this error. This is due to the fact that the Taylor series of the joint distribution <inline-formula><mml:math id="d1e6766" display="inline" altimg="si174.svg"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>↦</mml:mo><mml:mo class="qopname">log</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and the conditional distribution <inline-formula><mml:math id="d1e6798" display="inline" altimg="si175.svg"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>↦</mml:mo><mml:mo class="qopname">log</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mo>|</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> have exactly the same terms and we have an explicit formula <xref rid="fd11" ref-type="disp-formula">(11)</xref> for the joint distribution (see <xref rid="rmk4" ref-type="statement">Remark 4</xref> in Section <xref rid="sec3.3" ref-type="sec">3.3</xref>.).</p>
                <p id="d1e6843">
                  <statement id="rmk3">
                    <label>Remark 3</label>
                    <title>Numerical Issues Due to the Lack of Identifiability</title>
                    <p id="d1e6850">When trying to apply <xref rid="lem2" ref-type="statement">Lemma 2</xref> to models that are <italic>not identifiable</italic>, in the sense that multiple realizations for <inline-formula><mml:math id="d1e6860" display="inline" altimg="si156.svg"><mml:mi>Z</mml:mi></mml:math></inline-formula> lead to the same value of the joint distribution <inline-formula><mml:math id="d1e6865" display="inline" altimg="si151.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, the Hessian matrix <inline-formula><mml:math id="d1e6896" display="inline" altimg="si178.svg"><mml:mrow><mml:mi>H</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> may be singular, leading to “infinite” error covariance in <xref rid="fd17" ref-type="disp-formula">(17)</xref>.</p>
                    <p id="d1e6920">For poorly identifiable models, the matrix <inline-formula><mml:math id="d1e6923" display="inline" altimg="si178.svg"><mml:mrow><mml:mi>H</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> may be nonsingular, but with very small singular values, making the log- determinant in <xref rid="fd16" ref-type="disp-formula">(16)</xref> strongly negative and often causing numerical issues. To avoid this, one can replace the optimization in <xref rid="fd16" ref-type="disp-formula">(16)</xref> by <disp-formula id="fd18"><label>(18)</label><mml:math id="d1e6961" display="block" altimg="si180.svg"><mml:mrow><mml:munder><mml:mrow><mml:mo class="qopname">arg max</mml:mo></mml:mrow><mml:mrow><mml:mi>θ</mml:mi><mml:mo linebreak="badbreak">∈</mml:mo><mml:mi>Θ</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo class="Bigl" fence="true">(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo class="qopname">log</mml:mo><mml:mo class="qopname">det</mml:mo><mml:mrow><mml:mo class="bigl" fence="true">(</mml:mo><mml:mrow><mml:mi>ϵ</mml:mi><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>H</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo class="bigr" fence="true">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:mo class="qopname">max</mml:mo></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo linebreak="badbreak">∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:mo class="qopname">log</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo class="Bigr" fence="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>for a small constant <inline-formula><mml:math id="d1e7081" display="inline" altimg="si181.svg"><mml:mrow><mml:mi>ϵ</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. The addition of the constant term <inline-formula><mml:math id="d1e7091" display="inline" altimg="si182.svg"><mml:mrow><mml:mi>ϵ</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula> will have little affect on the estimate of <inline-formula><mml:math id="d1e7099" display="inline" altimg="si127.svg"><mml:mi>θ</mml:mi></mml:math></inline-formula>, as long as this variable does not affect significantly the kernel of <inline-formula><mml:math id="d1e7105" display="inline" altimg="si178.svg"><mml:mrow><mml:mi>H</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, which can be numerically verified.  □</p>
                  </statement>
                </p>
              </sec>
              <sec id="sec3.2">
                <label>3.2</label>
                <title>A scalable iterative algorithm</title>
                <p id="d1e7132">For the problem at hand, <xref rid="fd16" ref-type="disp-formula">(16)</xref> involves a joint optimization with respect to <inline-formula><mml:math id="d1e7139" display="inline" altimg="si185.svg"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> parameters and <inline-formula><mml:math id="d1e7149" display="inline" altimg="si186.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">≔</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mi>P</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> state variables. For large time horizons <inline-formula><mml:math id="d1e7192" display="inline" altimg="si187.svg"><mml:mrow><mml:mi>T</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">+</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:math></inline-formula>, the computation complexity of such optimization can be greatly reduced by using an iterative block coordinate ascent algorithm:</p>
                <p id="d1e7201">
                  <statement id="alg1">
                    <label>Algorithm 1</label>
                    <p id="d1e7206">Given a measurement vector <inline-formula><mml:math id="d1e7209" display="inline" altimg="si147.svg"><mml:mi>Y</mml:mi></mml:math></inline-formula> and a tolerance <inline-formula><mml:math id="d1e7214" display="inline" altimg="si189.svg"><mml:msub><mml:mrow><mml:mi>ϵ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">tol</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, the following algorithm returns estimates <inline-formula><mml:math id="d1e7224" display="inline" altimg="si190.svg"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="d1e7240" display="inline" altimg="si191.svg"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>:</p>
                    <p id="d1e7254">
                      <list list-type="simple" id="d1e7256">
                        <list-item id="lst6">
                          <label>1.</label>
                          <p id="d1e7260">Pick initial values for <inline-formula><mml:math id="d1e7263" display="inline" altimg="si192.svg"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="d1e7278" display="inline" altimg="si193.svg"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and set <inline-formula><mml:math id="d1e7293" display="inline" altimg="si194.svg"><mml:mrow><mml:mi>k</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>.</p>
                        </list-item>
                        <list-item id="lst7">
                          <label>2.</label>
                          <p id="d1e7305">Update estimates using: <disp-formula-group id="d1e7311"><disp-formula id="fd19"><label>(19)</label><mml:math id="d1e7315" display="block" altimg="si195.svg"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo id="mmlalignd1e7259" linebreak="goodbreak">≔</mml:mo><mml:munder><mml:mrow><mml:mo class="qopname">arg max</mml:mo></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo linebreak="badbreak">∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:mo class="qopname">log</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo linebreak="badbreak">−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="fd20"><label>(20)</label><mml:math id="d1e7398" display="block" altimg="si196.svg"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo id="mmlalignd1e7344" linebreak="goodbreak" indentalign="id" indenttarget="mmlalignd1e7259">≔</mml:mo><mml:munder><mml:mrow><mml:mo class="qopname">arg max</mml:mo></mml:mrow><mml:mrow><mml:mi>θ</mml:mi><mml:mo linebreak="badbreak">∈</mml:mo><mml:mi>Θ</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo class="Bigl" fence="true">(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo class="qopname">log</mml:mo><mml:mo class="qopname">det</mml:mo><mml:mrow><mml:mo class="Bigl" fence="true">(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>H</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo class="Bigr" fence="true">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mo class="qopname">log</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo class="Bigr" fence="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></disp-formula-group>
</p>
                        </list-item>
                        <list-item id="lst8">
                          <label>3.</label>
                          <p id="d1e7527">Increment <inline-formula><mml:math id="d1e7530" display="inline" altimg="si197.svg"><mml:mi>k</mml:mi></mml:math></inline-formula> and go back to step <xref rid="lst7" ref-type="list-item">2.</xref> until <inline-formula><mml:math id="d1e7539" display="inline" altimg="si198.svg"><mml:mrow><mml:mo>‖</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>‖</mml:mo><mml:mo linebreak="goodbreak" linebreakstyle="after">⩽</mml:mo><mml:msub><mml:mrow><mml:mi>ϵ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">tol</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>.</p>
                        </list-item>
                      </list>
                    </p>
                  </statement>
                </p>
                <p id="d1e7585">In general, block coordinate ascent/descent algorithms are not guaranteed to terminate (<xref rid="b7" ref-type="bibr">Bertsekas, 1999</xref>). However, upon a successful termination, the pair <inline-formula><mml:math id="d1e7593" display="inline" altimg="si199.svg"><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> satisfies the first order optimality conditions of the optimization in <xref rid="fd19" ref-type="disp-formula">(19)</xref> and the pair <inline-formula><mml:math id="d1e7636" display="inline" altimg="si200.svg"><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> satisfies the first order optimality conditions of the optimization in <xref rid="fd20" ref-type="disp-formula">(20)</xref>. Since the first order optimality conditions of <xref rid="fd16" ref-type="disp-formula">(16)</xref> are precisely the union of the first order optimality condition of <xref rid="fd19" ref-type="disp-formula">(19)</xref>, <xref rid="fd20" ref-type="disp-formula">(20)</xref>, we conclude that the pair <inline-formula><mml:math id="d1e7683" display="inline" altimg="si200.svg"><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> satisfies the first order optimality conditions of <xref rid="fd16" ref-type="disp-formula">(16)</xref> up to the <inline-formula><mml:math id="d1e7721" display="inline" altimg="si189.svg"><mml:msub><mml:mrow><mml:mi>ϵ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">tol</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> discrepancy between <inline-formula><mml:math id="d1e7731" display="inline" altimg="si203.svg"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="d1e7751" display="inline" altimg="si190.svg"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. In general, this does not guarantee that <xref rid="alg1" ref-type="statement">Algorithm 1</xref> will find a global maximum of the likelihood function, but it does guarantees that termination can only take place at a local maximum (up to the <inline-formula><mml:math id="d1e7770" display="inline" altimg="si189.svg"><mml:msub><mml:mrow><mml:mi>ϵ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">tol</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> error). In practice, we have observed that constraining the parameter values <inline-formula><mml:math id="d1e7780" display="inline" altimg="si127.svg"><mml:mi>θ</mml:mi></mml:math></inline-formula> and states/outputs <inline-formula><mml:math id="d1e7786" display="inline" altimg="si156.svg"><mml:mi>Z</mml:mi></mml:math></inline-formula> to physically meaningful sets consistently leads to the same optimum regardless of how we initialize the numerical solvers.</p>
                <p id="d1e7790">The key advantage of the iterative approach in <xref rid="alg1" ref-type="statement">Algorithm 1</xref> with respect to solving the single-shot full optimization in <xref rid="fd16" ref-type="disp-formula">(16)</xref> is that (i) the number <inline-formula><mml:math id="d1e7801" display="inline" altimg="si208.svg"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of optimization variables in <xref rid="fd19" ref-type="disp-formula">(19)</xref> scales linearly with the number of time instants of interest and (ii) the number of optimization variables in <xref rid="fd20" ref-type="disp-formula">(20)</xref> is equal to the number <inline-formula><mml:math id="d1e7820" display="inline" altimg="si185.svg"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of parameters, <italic>regardless of the horizon length</italic>. Furthermore, while the total number of entries of the Hessian matrix <xref rid="fd13" ref-type="disp-formula">(13)</xref> scales quadratically with <inline-formula><mml:math id="d1e7838" display="inline" altimg="si208.svg"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, the number of <italic>non-zero</italic> entries of this matrix only scales linearly with <inline-formula><mml:math id="d1e7851" display="inline" altimg="si208.svg"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. This is because, the structure of <xref rid="fd11" ref-type="disp-formula">(11)</xref> leads to <disp-formula id="d1e7868"><mml:math id="d1e7871" display="block" altimg="si212.svg"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow/><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo class="qopname">log</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo linebreak="badbreak">−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mi>∂</mml:mi><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>for every <inline-formula><mml:math id="d1e7955" display="inline" altimg="si213.svg"><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁄</mml:mo><mml:mo linebreak="goodbreak" linebreakstyle="after">∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. In practice, this means that we can use second order Newton methods to solve <xref rid="fd19" ref-type="disp-formula">(19)</xref> with computation times that only grow linearly with <inline-formula><mml:math id="d1e7987" display="inline" altimg="si208.svg"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, provided that we compute the Newton direction using sparse solvers for linear equations (<xref rid="b15" ref-type="bibr">Davis et al., 2004</xref>, <xref rid="b21" ref-type="bibr">Hespanha, 2017</xref>). Regarding the optimization in <xref rid="fd20" ref-type="disp-formula">(20)</xref>, while the number of optimization variables is typically small and independent of the time horizon length, one still needs to compute the log-determinant of a large matrix. Also here, we can explore the sparsity of <xref rid="fd13" ref-type="disp-formula">(13)</xref> by performing a sparse LDL factorization and obtain the determinant by simply multiplying the entries of the diagonal matrix, or adding their logarithms to directly obtain the log-determinant of the matrix, which is numerically much more stable.</p>
              </sec>
              <sec id="sec3.3">
                <label>3.3</label>
                <title>Proof of <xref rid="lem1" ref-type="statement">Lemma 1</xref>, <xref rid="lem2" ref-type="statement">Lemma 2</xref></title>
                <p id="d1e8017">
                  <statement id="d1e8018">
                    <label>Proof of Lemma 1</label>
                    <p id="d1e8023">For each <inline-formula><mml:math id="d1e8026" display="inline" altimg="si215.svg"><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">⩾</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, we can expand the joint probability density function of the state up to time <inline-formula><mml:math id="d1e8036" display="inline" altimg="si76.svg"><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and measurements up to time <inline-formula><mml:math id="d1e8046" display="inline" altimg="si3.svg"><mml:mi>t</mml:mi></mml:math></inline-formula> as <disp-formula id="d1e8055"><mml:math id="d1e8056" display="block" altimg="si218.svg"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo id="mmlalignd1e8051" linebreak="goodbreak">=</mml:mo><mml:mi id="mmlalignd1e8054">p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="badbreak">−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mi id="mmlalignd1e8133">p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="badbreak">−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mo linebreak="goodbreak">∀</mml:mo><mml:mi>t</mml:mi><mml:mo linebreak="goodbreak">⩾</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> where, for simplicity of notation, we omitted all dependencies on the parameter vector <inline-formula><mml:math id="d1e8265" display="inline" altimg="si127.svg"><mml:mi>θ</mml:mi></mml:math></inline-formula>. In view of <xref rid="fd7a" ref-type="disp-formula">(7)</xref> and the independence assumption <xref rid="fd10" ref-type="disp-formula">(10)</xref>, we have that <disp-formula id="fd21"><label>(21)</label><mml:math id="d1e8285" display="block" altimg="si220.svg"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo id="mmlalignd1e8252">∣</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="badbreak">−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo id="mmlalignd1e8305" linebreak="newline">=</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo class="bigl" fence="true">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="badbreak">−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo class="bigr" fence="true">)</mml:mo></mml:mrow><mml:mo id="mmlalignd1e8447" linebreak="newline" indentalign="id" indenttarget="mmlalignd1e8305">=</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo class="bigl" fence="true">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo class="bigr" fence="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> and therefore <disp-formula id="d1e8616"><mml:math id="d1e8617" display="block" altimg="si221.svg"><mml:mrow><mml:mi id="mmlalignd1e8560">p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="1em" id="mmlalignd1e8617"/><mml:mo linebreak="goodbreak">=</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo class="bigl" fence="true">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo class="bigr" fence="true">)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="badbreak">−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula> Iterating this from <inline-formula><mml:math id="d1e8838" display="inline" altimg="si222.svg"><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="d1e8848" display="inline" altimg="si223.svg"><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mi>T</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">+</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:math></inline-formula> leads to <disp-formula id="d1e8865"><mml:math id="d1e8868" display="block" altimg="si224.svg"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:mi>P</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">=</mml:mo><mml:munderover><mml:mrow><mml:mo linebreak="badbreak">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo class="bigl" fence="true">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo class="bigr" fence="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>from which <xref rid="fd11" ref-type="disp-formula">(11)</xref> follows by taking logarithms. ■</p>
                  </statement>
                </p>
                <p id="d1e9059">
                  <statement id="d1e9060">
                    <label>Proof of Lemma 2</label>
                    <p id="d1e9065">Denoting the conditional distribution of <inline-formula><mml:math id="d1e9068" display="inline" altimg="si156.svg"><mml:mi>Z</mml:mi></mml:math></inline-formula> given <inline-formula><mml:math id="d1e9073" display="inline" altimg="si147.svg"><mml:mi>Y</mml:mi></mml:math></inline-formula> by <disp-formula id="fd22"><label>(22)</label><mml:math id="d1e9084" display="block" altimg="si227.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">≔</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>we have that <disp-formula id="fd23"><label>(23)</label><mml:math id="d1e9172" display="block" altimg="si228.svg"><mml:mrow><mml:mo class="qopname">log</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">+</mml:mo><mml:mo class="qopname">log</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">=</mml:mo><mml:mo class="qopname">log</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>and therefore <disp-formula-group id="fd24"><disp-formula id="fd24a"><label>(24a)</label><mml:math id="d1e9264" display="block" altimg="si229.svg"><mml:mrow><mml:mfrac id="mmlalignd1e9214"><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow/><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo class="qopname">log</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo linebreak="goodbreak">=</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow/><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo class="qopname">log</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mo linebreak="goodbreak">∀</mml:mo><mml:mi>Z</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="fd24b"><label>(24b)</label><mml:math id="d1e9375" display="block" altimg="si230.svg"><mml:mrow><mml:mo class="qopname" id="mmlalignd1e9331">log</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">+</mml:mo><mml:munder><mml:mrow><mml:mo class="qopname">max</mml:mo></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:munder><mml:mo class="qopname">log</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">=</mml:mo><mml:munder><mml:mrow><mml:mo class="qopname">max</mml:mo></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:munder><mml:mo class="qopname">log</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></disp-formula-group>
Moreover, since <inline-formula><mml:math id="d1e9479" display="inline" altimg="si231.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is a multivariable Gaussian, we must have <disp-formula id="fd25"><label>(25)</label><mml:math id="d1e9516" display="block" altimg="si232.svg"><mml:mrow><mml:mo class="qopname">log</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo id="mmlalignd1e9510" linebreak="goodbreak">=</mml:mo><mml:mo id="mmlalignd1e9513" linebreak="goodbreak">−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo class="qopname">log</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo id="mmlalignd1e9542" linebreak="newline" indentalign="id" indenttarget="mmlalignd1e9513">+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo class="qopname">log</mml:mo><mml:mo class="qopname">det</mml:mo><mml:munderover><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo linebreak="badbreak">−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mo linebreak="goodbreak">−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>Z</mml:mi><mml:mo linebreak="badbreak">−</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo linebreak="badbreak">−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>Z</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> where <inline-formula><mml:math id="d1e9682" display="inline" altimg="si233.svg"><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="d1e9696" display="inline" altimg="si234.svg"><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> denote its mean and covariance matrix. This allows us to conclude that <disp-formula-group id="fd26"><disp-formula id="fd26a"><label>(26a)</label><mml:math id="d1e9719" display="block" altimg="si235.svg"><mml:mrow><mml:munder><mml:mrow><mml:mo class="qopname">arg max</mml:mo></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:munder><mml:mo class="qopname">log</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo id="mmlalignd1e9729" linebreak="goodbreak">=</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="fd26b"><label>(26b)</label><mml:math id="d1e9775" display="block" altimg="si236.svg"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow/><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo class="qopname">log</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo id="mmlalignd1e9801" linebreak="goodbreak" indentalign="id" indenttarget="mmlalignd1e9729">=</mml:mo><mml:mo linebreak="goodbreak">−</mml:mo><mml:msubsup><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo linebreak="badbreak">−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="fd26c"><label>(26c)</label><mml:math id="d1e9850" display="block" altimg="si237.svg"><mml:mrow><mml:munder><mml:mrow><mml:mo class="qopname">max</mml:mo></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:munder><mml:mo class="qopname">log</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo id="mmlalignd1e9867" linebreak="goodbreak" indentalign="id" indenttarget="mmlalignd1e9729">=</mml:mo><mml:mo linebreak="goodbreak">−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo class="qopname">log</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo class="qopname">log</mml:mo><mml:mo class="qopname">det</mml:mo><mml:munderover><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo linebreak="badbreak">−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mo id="mmlalignd1e9927" linebreak="newline" indentalign="id" indenttarget="mmlalignd1e9729">=</mml:mo><mml:mo linebreak="goodbreak">−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo class="qopname">log</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="1em" id="mmlalignd1e9957"/><mml:mo linebreak="goodbreak">+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo class="qopname">log</mml:mo><mml:mo class="qopname">det</mml:mo><mml:mrow><mml:mo class="Bigl" fence="true">(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow/><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo class="qopname">log</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo class="Bigr" fence="true">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></disp-formula-group>
We conclude from <xref rid="fd24a" ref-type="disp-formula">(24a)</xref>, <xref rid="fd26b" ref-type="disp-formula">(26b)</xref> that <disp-formula id="d1e10060"><mml:math id="d1e10063" display="block" altimg="si238.svg"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow/><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo class="qopname">log</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo linebreak="goodbreak">=</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow/><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo class="qopname">log</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo linebreak="goodbreak">=</mml:mo><mml:mo linebreak="goodbreak">−</mml:mo><mml:msubsup><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo linebreak="badbreak">−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mo linebreak="goodbreak">∀</mml:mo><mml:mi>Z</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>does not depend on <inline-formula><mml:math id="d1e10193" display="inline" altimg="si156.svg"><mml:mi>Z</mml:mi></mml:math></inline-formula>, and then from <xref rid="fd24b" ref-type="disp-formula">(24b)</xref>, <xref rid="fd26c" ref-type="disp-formula">(26c)</xref> that <disp-formula id="d1e10205"><mml:math id="d1e10206" display="block" altimg="si240.svg"><mml:mrow><mml:mo class="qopname">log</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo id="mmlalignd1e10220" linebreak="goodbreak">=</mml:mo><mml:mo linebreak="goodbreak">−</mml:mo><mml:munder><mml:mrow><mml:mo class="qopname">max</mml:mo></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:munder><mml:mo class="qopname">log</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">+</mml:mo><mml:munder><mml:mrow><mml:mo class="qopname">max</mml:mo></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:munder><mml:mo class="qopname">log</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo id="mmlalignd1e10303" linebreak="newline" indentalign="id" indenttarget="mmlalignd1e10220">=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo class="qopname">log</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo class="qopname">log</mml:mo><mml:mo class="qopname">det</mml:mo><mml:mrow><mml:mo class="Bigl" fence="true">(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow/><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo class="qopname">log</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo class="Bigr" fence="true">)</mml:mo></mml:mrow><mml:mspace width="100.00015pt" id="mmlalignd1e10404"/><mml:mo linebreak="goodbreak">+</mml:mo><mml:munder><mml:mrow><mml:mo class="qopname">max</mml:mo></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:munder><mml:mo class="qopname">log</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> from which the result follows. ■</p>
                  </statement>
                </p>
                <p id="d1e10450">
                  <statement id="rmk4">
                    <label>Remark 4</label>
                    <title>Non-Gaussian a Posteriori</title>
                    <p id="d1e10457">When the a posteriori distribution is not a multivariable Gaussian, one can view <xref rid="fd25" ref-type="disp-formula">(25)</xref> as a second order truncation of the Taylor series of <inline-formula><mml:math id="d1e10464" display="inline" altimg="si241.svg"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>↦</mml:mo><mml:mo class="qopname">log</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, which means that this formula will have an error due to higher order terms in the series. In fact, such a truncation of this Taylor series is at the basis for the Laplace method to approximate integrals (<xref rid="b29" ref-type="bibr">MacKay, 2003</xref>). In view of <xref rid="fd23" ref-type="disp-formula">(23)</xref>, when <inline-formula><mml:math id="d1e10510" display="inline" altimg="si241.svg"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>↦</mml:mo><mml:mo class="qopname">log</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="d1e10546" display="inline" altimg="si243.svg"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>↦</mml:mo><mml:mo class="qopname">log</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are analytic, both functions have the same Taylor series terms of order higher than 0 and therefore one can estimate the error in the truncation <xref rid="fd25" ref-type="disp-formula">(25)</xref> by computing the terms in the Taylor series of <inline-formula><mml:math id="d1e10587" display="inline" altimg="si243.svg"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>↦</mml:mo><mml:mo class="qopname">log</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of order higher than 2. □</p>
                  </statement>
                </p>
              </sec>
            </sec>
            <sec id="sec4">
              <label>4</label>
              <title>Numerical results</title>
              <p id="d1e10629">We now summarize the results obtained by applying the identification/forecasting procedure outlined in Section <xref rid="sec3" ref-type="sec">3</xref> to the SIR stochastic model in Section <xref rid="sec2" ref-type="sec">2</xref>. The measurements used include time series of COVID-19 daily cases and daily deaths obtained from the following sources:</p>
              <p id="d1e10641">
                <list list-type="simple" id="d1e10643">
                  <list-item id="lst9">
                    <label>1.</label>
                    <p id="d1e10647">the European Center for Disease Prevention and Control (ECDPC) (<xref rid="b18" ref-type="bibr">European Center for Disease Prevention and Control, 0000</xref>) for worldwide data outside the United States of America, Brazil, and Portugal;</p>
                  </list-item>
                  <list-item id="lst10">
                    <label>2.</label>
                    <p id="d1e10659">the COVID-19 Data Repository by the Center for Systems Science and Engineering (CSSE) at Johns Hopkins University (<xref rid="b11" ref-type="bibr">Center for Systems Science and Engineering (CSSE) at Johns Hopkins University, 2020</xref>) for State and City data within the United States of America;</p>
                  </list-item>
                  <list-item id="lst11">
                    <label>3.</label>
                    <p id="d1e10669">the Portuguese Direção-Geral de Saúde for data in Portugal (<xref rid="b36" ref-type="bibr">Portuguese Direção-Geral de Saúde, 2020</xref>).</p>
                  </list-item>
                  <list-item id="lst12">
                    <label>4.</label>
                    <p id="d1e10679">Brasil.IO based on data collected from the Secretarias Estaduais de Saúde for State and City data within Brazil (<xref rid="b13" ref-type="bibr">CoronaCidades.org, 0000</xref>).</p>
                  </list-item>
                </list>
              </p>
              <p id="d1e10686">We produced forecasts for every country represented in the ECDPC dataset that, at some point in time, reported more than 10 new COVID-19 cases in one day. For a few countries, including the United States of America and Brazil, we had available data at the state/province/city level and produced forecasts at finer regional levels. The ECDPC and CSSE time series go as far back as February 2020 and contain daily results up to the present. Our full set of results is available at (<xref rid="b14" ref-type="bibr">COVID-19, 2020</xref>) and includes 144 countries and regions around the world, but here we only show a subset of results for Italy, United Kingdom, Germany Portugal, Japan, India, and the US states of New York, California, Texas, Illinois, and Montana. This selection covers a representative set of countries/regions in terms of population size and density, timing and scope of nonpharmaceutical measures, population behavior, etc.</p>
              <p id="d1e10693">For a very large number of countries/regions, the time series with the daily number of cases exhibit large weekly variations, typically with a smaller number of cases reported during the weekends. In fact, for a few countries/time-periods no new cases/deaths are reported in the weekend and a very large number of cases are reported every Monday,<xref rid="fn2" ref-type="fn">2</xref>
leading to a larger delay between the time a patient becomes infective and the case is reported. To remove this day-of-the-week effect, all our forecasts were computed weekly with data up to the latest Wednesday. In addition, all time series were pre-filtered with a 7-day moving average filter that tries to equalize the delay between infectiveness/death and reporting. For consistency, we have done this for every country/region, regardless of whether or not the data showed day-of-the-week effects. For countries/regions where the weekend effect is negligible or where this effect only appeared during a fairly brief period of time, the introduction of 7-day averaging makes little difference in terms of the forecasts. But for countries where this effect has been persistent, removing the averaging inflates the estimates of the noise/disturbances since this effect has to be explained through the stochastic elements of the model.</p>
              <p id="d1e10704">
                <fig id="fig1">
                  <label>Fig. 1</label>
                  <caption>
                    <p>State estimates and forecasts for the daily numbers of new cases and deaths for the model <xref rid="fd3" ref-type="disp-formula">(3)</xref>–<xref rid="fd4" ref-type="disp-formula">(4)</xref>, based on data available up to mid-to-late December (depending on the source of data). The forecasts extend for 3 weeks past the available data. In all plots, the dots correspond to the daily measurements of new cases and deaths, the solid lines to a posteriori state estimates, and the dashed lines to 95% confidence intervals.</p>
                  </caption>
                  <graphic xlink:href="gr1_lrg"/>
                </fig>
                <fig id="fig2">
                  <label>Fig. 2</label>
                  <caption>
                    <p>Continuation from  <xref rid="fig1" ref-type="fig">Fig. 1</xref>.</p>
                  </caption>
                  <graphic xlink:href="gr2_lrg"/>
                </fig>
              </p>
              <sec id="sec4.1">
                <label>4.1</label>
                <title>Methodology</title>
                <p id="d1e10714">All estimates and forecasts reported in this section were obtained using the <xref rid="alg1" ref-type="statement">Algorithm 1</xref> with the vector <inline-formula><mml:math id="d1e10721" display="inline" altimg="si147.svg"><mml:mi>Y</mml:mi></mml:math></inline-formula> containing daily measurements of new cases <inline-formula><mml:math id="d1e10726" display="inline" altimg="si58.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and deaths <inline-formula><mml:math id="d1e10745" display="inline" altimg="si59.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> over a given time range <inline-formula><mml:math id="d1e10763" display="inline" altimg="si60.svg"><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The latent random variable <inline-formula><mml:math id="d1e10790" display="inline" altimg="si156.svg"><mml:mi>Z</mml:mi></mml:math></inline-formula> contains the full state <inline-formula><mml:math id="d1e10795" display="inline" altimg="si250.svg"><mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>ω</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of the model <xref rid="fd3" ref-type="disp-formula">(3)</xref>–<xref rid="fd4" ref-type="disp-formula">(4)</xref> over an extended time range <inline-formula><mml:math id="d1e10862" display="inline" altimg="si251.svg"><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> that includes forecasts up to <inline-formula><mml:math id="d1e10893" display="inline" altimg="si252.svg"><mml:mrow><mml:mi>P</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mn>21</mml:mn></mml:mrow></mml:math></inline-formula> days into the future; the removal rate <inline-formula><mml:math id="d1e10904" display="inline" altimg="si14.svg"><mml:mi>γ</mml:mi></mml:math></inline-formula>; and measurements forecasts for new cases <inline-formula><mml:math id="d1e10909" display="inline" altimg="si58.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and deaths <inline-formula><mml:math id="d1e10927" display="inline" altimg="si59.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> over <inline-formula><mml:math id="d1e10945" display="inline" altimg="si131.svg"><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The parameter vector <inline-formula><mml:math id="d1e10977" display="inline" altimg="si127.svg"><mml:mi>θ</mml:mi></mml:math></inline-formula> includes the variances of the state disturbances <inline-formula><mml:math id="d1e10982" display="inline" altimg="si25.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="d1e11000" display="inline" altimg="si24.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>; the variances of the parameter increments <inline-formula><mml:math id="d1e11018" display="inline" altimg="si70.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="d1e11037" display="inline" altimg="si71.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ω</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="d1e11055" display="inline" altimg="si72.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>; and the variances of the noises <inline-formula><mml:math id="d1e11073" display="inline" altimg="si31.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="d1e11091" display="inline" altimg="si40.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. All 95% confidence intervals reported are based on the a posteriori covariance matrix computed using <xref rid="fd17" ref-type="disp-formula">(17)</xref>, which we marginalize for the different variables to obtain a posteriori standard deviations.</p>
                <p id="d1e11113">For essentially all datasets, we observed that <xref rid="alg1" ref-type="statement">Algorithm 1</xref> converged to estimates corresponding to zero variances for the disturbances <inline-formula><mml:math id="d1e11120" display="inline" altimg="si25.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="d1e11138" display="inline" altimg="si24.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (or to negligible values) so we eventually removed those parameters from <inline-formula><mml:math id="d1e11157" display="inline" altimg="si127.svg"><mml:mi>θ</mml:mi></mml:math></inline-formula> and set them to fixed values that were sufficiently low not to affect any of the other estimates. This improved numerical conditioning, because very small disturbance variances result in poorly conditioned Hessian matrices <inline-formula><mml:math id="d1e11162" display="inline" altimg="si268.svg"><mml:mrow><mml:mi>H</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> in <xref rid="fd20" ref-type="disp-formula">(20)</xref>.</p>
                <p id="d1e11196">The optimizations in <xref rid="fd19" ref-type="disp-formula">(19)</xref>–<xref rid="fd20" ref-type="disp-formula">(20)</xref> were carried out by primal–dual interior-point solvers built using the TensCalc toolbox (<xref rid="b21" ref-type="bibr">Hespanha, 2017</xref>). The solvers generated by TensCalc explore sparsity of the Hessian matrix, resulting in computation times that scale linearly with the horizon length (see Section <xref rid="sec3.2" ref-type="sec">3.2</xref>). <xref rid="alg1" ref-type="statement">Algorithm 1</xref> was initialized with a rough state estimated obtained as follows:</p>
                <p id="d1e11227">
                  <list list-type="simple" id="d1e11229">
                    <list-item id="lst13">
                      <label>1.</label>
                      <p id="d1e11233">The new-cases reporting rate was initialized at <inline-formula><mml:math id="d1e11236" display="inline" altimg="si269.svg"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="d1e11253" display="inline" altimg="si270.svg"><mml:mrow><mml:mo>∀</mml:mo><mml:mi>t</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">⩾</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. Since <inline-formula><mml:math id="d1e11265" display="inline" altimg="si107.svg"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is not identifiable (see Section <xref rid="sec3" ref-type="sec">3</xref>), the initial rate <inline-formula><mml:math id="d1e11284" display="inline" altimg="si107.svg"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> was fixed at 1 and only subsequent <inline-formula><mml:math id="d1e11297" display="inline" altimg="si35.svg"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="d1e11310" display="inline" altimg="si274.svg"><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> were optimized.</p>
                    </list-item>
                    <list-item id="lst14">
                      <label>2.</label>
                      <p id="d1e11322">The removal rate was initialized at the (somewhat arbitrary) value <inline-formula><mml:math id="d1e11325" display="inline" altimg="si275.svg"><mml:mrow><mml:mi>γ</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mn>1</mml:mn><mml:mo>∕</mml:mo><mml:mn>21</mml:mn></mml:mrow></mml:math></inline-formula> (21 days time constant).</p>
                    </list-item>
                    <list-item id="lst15">
                      <label>3.</label>
                      <p id="d1e11341">The initialization for the state <inline-formula><mml:math id="d1e11344" display="inline" altimg="si104.svg"><mml:mrow><mml:mi>U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> was obtained by neglecting noise and disturbances from <xref rid="fd3b" ref-type="disp-formula">(3b)</xref>–<xref rid="fd3c" ref-type="disp-formula">(3c)</xref>, which leads <disp-formula id="d1e11368"><mml:math id="d1e11371" display="block" altimg="si277.svg"><mml:mrow><mml:mi>U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">=</mml:mo><mml:mi>U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">+</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="1em"/><mml:mo>⇒</mml:mo><mml:mspace width="1em"/><mml:mi>U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">=</mml:mo><mml:munder><mml:mrow><mml:mo linebreak="badbreak">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>τ</mml:mi><mml:mo linebreak="badbreak">&lt;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p>
                    </list-item>
                    <list-item id="lst16">
                      <label>4.</label>
                      <p id="d1e11459">The number of infections at day <inline-formula><mml:math id="d1e11462" display="inline" altimg="si222.svg"><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> was initialized to be equal to the total number of infections reported before that date: <disp-formula id="d1e11474"><mml:math id="d1e11477" display="block" altimg="si279.svg"><mml:mrow><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">=</mml:mo><mml:munder><mml:mrow><mml:mo linebreak="badbreak">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>τ</mml:mi><mml:mo linebreak="badbreak">&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>τ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>Subsequent values for the initialization of <inline-formula><mml:math id="d1e11519" display="inline" altimg="si10.svg"><mml:mrow><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> can be obtained by neglecting noise and disturbances from <xref rid="fd3a" ref-type="disp-formula">(3a)</xref>–<xref rid="fd3c" ref-type="disp-formula">(3c)</xref>, which leads to <disp-formula id="d1e11543"><mml:math id="d1e11546" display="block" altimg="si281.svg"><mml:mrow><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">=</mml:mo><mml:mo linebreak="goodbreak">−</mml:mo><mml:mi>γ</mml:mi><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">+</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>The initialization for <inline-formula><mml:math id="d1e11596" display="inline" altimg="si11.svg"><mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> can then be obtained from <inline-formula><mml:math id="d1e11610" display="inline" altimg="si283.svg"><mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mi>U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">−</mml:mo><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="d1e11645" display="inline" altimg="si270.svg"><mml:mrow><mml:mo>∀</mml:mo><mml:mi>t</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">⩾</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>.</p>
                    </list-item>
                    <list-item id="lst17">
                      <label>5.</label>
                      <p id="d1e11659">Assuming a constant value for the infection rate <inline-formula><mml:math id="d1e11662" display="inline" altimg="si19.svg"><mml:mi>β</mml:mi></mml:math></inline-formula> and ignoring disturbances, <xref rid="fd3b" ref-type="disp-formula">(3b)</xref> can be written as <disp-formula id="d1e11673"><mml:math id="d1e11676" display="block" altimg="si286.svg"><mml:mrow><mml:mi>U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">=</mml:mo><mml:mi>U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">+</mml:mo><mml:mi>β</mml:mi><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">−</mml:mo><mml:mfrac><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="2em"/><mml:mo linebreak="goodbreak">∀</mml:mo><mml:mi>t</mml:mi><mml:mo linebreak="goodbreak">⩾</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>from which initializations for <inline-formula><mml:math id="d1e11764" display="inline" altimg="si19.svg"><mml:mi>β</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="d1e11769" display="inline" altimg="si288.svg"><mml:mrow><mml:mi>β</mml:mi><mml:mo>∕</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> can be obtained through a least-squares linear fit. Since the precise value for <inline-formula><mml:math id="d1e11784" display="inline" altimg="si15.svg"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is not identifiable (see Section <xref rid="sec3" ref-type="sec">3</xref>), we took this value to be “correct”.</p>
                    </list-item>
                    <list-item id="lst18">
                      <label>6.</label>
                      <p id="d1e11801">The deaths reporting rate was initialized with a constant value <inline-formula><mml:math id="d1e11804" display="inline" altimg="si295.svg"><mml:mi>ω</mml:mi></mml:math></inline-formula> determined from <xref rid="fd3d" ref-type="disp-formula">(3d)</xref> through a least-squares linear fit.</p>
                    </list-item>
                  </list>
                </p>
                <p id="d1e11812">The same initialization process described above was applied to all countries/regions and time intervals in our dataset, including the alternative models discussed in Section <xref rid="sec4.4" ref-type="sec">4.4</xref>. This initialization resulted in very few failures of the nonlinear solver across the whole dataset.</p>
                <p id="d1e11819">
As noted in <xref rid="rmk3" ref-type="statement">Remark 3</xref>, to avoid numerical issues we replaced <xref rid="fd16" ref-type="disp-formula">(16)</xref> in <xref rid="alg1" ref-type="statement">Algorithm 1</xref> by <xref rid="fd18" ref-type="disp-formula">(18)</xref> with <inline-formula><mml:math id="d1e11845" display="inline" altimg="si291.svg"><mml:mrow><mml:mi>ϵ</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. In the interest of time, we have also limited the number of iterations to 30.<fig id="fig3"><label>Fig. 3</label><caption><p>Estimates of the time-varying parameters for the model <xref rid="fd3" ref-type="disp-formula">(3)</xref>–<xref rid="fd4" ref-type="disp-formula">(4)</xref>, based on data available up to mid December. The forecasts extend for 3 weeks past the available data.</p></caption><graphic xlink:href="gr3_lrg"/></fig><fig id="fig4"><label>Fig. 4</label><caption><p>Running forecasts for the daily numbers of new cases and deaths for the model <xref rid="fd3" ref-type="disp-formula">(3)</xref>–<xref rid="fd4" ref-type="disp-formula">(4)</xref>, based on data available up to 7, 14, and 21 days prior to the forecast. The solid lines depict the forecasts, whereas the dashed lines of the same color depict the corresponding 95% confidence intervals. To keep the plots less cluttered, only the upper bound of the confidence interval is plotted. (For interpretation of the references to color in this figure legend, the reader is referred to the web version of this article.)</p></caption><graphic xlink:href="gr4_lrg"/></fig><fig id="fig5"><label>Fig. 5</label><caption><p>Continuation from <xref rid="fig4" ref-type="fig">Fig. 4</xref>.</p></caption><graphic xlink:href="gr5_lrg"/></fig></p>
              </sec>
              <sec id="sec4.2">
                <label>4.2</label>
                <title>Forecasts based on the entire datasets</title>
                <p id="d1e11868"><xref rid="fig1" ref-type="fig">Fig. 1</xref>, <xref rid="fig2" ref-type="fig">Fig. 2</xref> show state estimates and forecasts based on the largest window of daily data available at the writing of this paper for Italy, Portugal, Japan and the US states of New York, California, and Montana. At this time, most of these regions are experiencing a strong resurgence in the number of cases but with fairly distinct progressions since early March: In Italy, the United Kingdom, Germany, Portugal, the state of São Paulo, and the US states of New York, California, Texas, and Illinois we see two clearly defined waves; Japan seems to be in the middle of a third wave; Montana’s number of cases seems to evolve in a step-like fashion; and India is not (yet?) showing a clearly defined second wave.</p>
                <p id="d1e11873">
In several countries we see that the second wave exceeds the magnitude of the first wave in terms of the number of new cases, but not in terms of daily deaths. The discrepancy between the number of new cases and deaths, which is particularly extreme in Italy, the United Kingdom, Germany, Portugal, Japan, New York, and Illinois is “explained” by the model through changes in the new-cases and deaths reporting rates. This can be confirmed by the plots in <xref rid="fig3" ref-type="fig">Fig. 3</xref>, which shows the estimates of the different time-varying parameters. However, as noted in Section <xref rid="sec2.3" ref-type="sec">2.3</xref>, these parameters are fundamentally not identifiable and can, at most be estimated up to the state/input transformation in <xref rid="fd5" ref-type="disp-formula">(5)</xref>. The plots presented here were obtained by resolving the model ambiguity as discussed in Section <xref rid="sec4.1" ref-type="sec">4.1</xref>. As noted in <xref rid="rmk2" ref-type="statement">Remark 2</xref>, by setting the initial new-cases reporting rate <inline-formula><mml:math id="d1e11903" display="inline" altimg="si115.svg"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> to 100%, an increase in the rate results in values for <inline-formula><mml:math id="d1e11909" display="inline" altimg="si115.svg"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> larger than 100%, which obviously means that the original rate really started at some value below 100%, but the data available does not permit estimating the precise value of the rate in absolute terms.<fig id="fig6"><label>Fig. 6</label><caption><p>Italy running forecasts for the daily numbers of new cases and deaths based on data available up to 7, 14, and 21 days prior to the forecast. The different plots corresponds to distinct assumptions regarding which parameters of the model <xref rid="fd3" ref-type="disp-formula">(3)</xref>–<xref rid="fd4" ref-type="disp-formula">(4)</xref> are allowed to vary with time.</p></caption><graphic xlink:href="gr6_lrg"/></fig><fig id="fig7"><label>Fig. 7</label><caption><p>California, USA running forecasts for the daily numbers of new cases and deaths based on data available up to 7, 14, and 21 days prior to the forecast. The different plots corresponds to distinct assumptions regarding which parameters of the model <xref rid="fd3" ref-type="disp-formula">(3)</xref>–<xref rid="fd4" ref-type="disp-formula">(4)</xref> are allowed to vary with time.</p></caption><graphic xlink:href="gr7_lrg"/></fig></p>
                <p id="d1e11913">Because the time series exhibit large variation, the number of cases in the <inline-formula><mml:math id="d1e11916" display="inline" altimg="si294.svg"><mml:mi>y</mml:mi></mml:math></inline-formula>-axis are plotted in a logarithmic scale. While this permits a better visualization of the data at multiple scales, it somewhat distorts the confidence intervals, which visually appear much larger when the number of cases is smaller. For example in Italy, the confidence interval for the daily number of deaths in August is roughly [1,40] and in early December it is roughly [695–770], while the latter is twice as wide as the former, it appears far smaller with the logarithmic scale used in <xref rid="fig1" ref-type="fig">Fig. 1</xref>.</p>
              </sec>
              <sec id="sec4.3">
                <label>4.3</label>
                <title>Running forecasts</title>
                <p id="d1e11929">A large effort was devoted to validate the methodology used to create forecasts for the daily numbers of new cases and deaths: Starting from the first Wednesday for which we had 21 days of past data, we performed system identification for the stochastic SIR model and computed forecasts for 7, 14, and 21 days ahead; which can eventually be compared with the actual values. We repeated this procedure for every subsequent Wednesday, resulting in updated forecasts. To obtain true validation, the model identified with data up to a particular Wednesday, does not use any subsequent data, either as measurements or to help initialize the numerical solver. This procedure was carried out for every country/region in our datasets and for every week for which we had, at least, 21 days of data, resulting in over 4500 identification/forecasting experiments.</p>
                <p id="d1e11931"><xref rid="fig4" ref-type="fig">Fig. 4</xref>, <xref rid="fig5" ref-type="fig">Fig. 5</xref> shows the results obtained for the same countries/states shown in <xref rid="fig1" ref-type="fig">Fig. 1</xref>, <xref rid="fig2" ref-type="fig">Fig. 2</xref>. It is important to emphasize that in <xref rid="fig1" ref-type="fig">Fig. 1</xref>, <xref rid="fig2" ref-type="fig">Fig. 2</xref>, forecasts only appear in the 3-weeks at the right-hand side of the plots. Prior to that, the solid and dash lines correspond to estimates and confidence intervals for (past) state/measurements that were computed using the entire datasets. In contrast, every point in the solid lines in <xref rid="fig4" ref-type="fig">Fig. 4</xref>, <xref rid="fig5" ref-type="fig">Fig. 5</xref> corresponds to a forecast that was compute 1, 2, or 3 weeks before. The corresponding dashed lines show the upper bounds of the associated 95% confidence intervals. Several important conclusions can be drawn from these plots:<fig id="fig8"><label>Fig. 8</label><caption><p>Running forecasts for the daily numbers of new cases and deaths for the model <xref rid="fd3" ref-type="disp-formula">(3)</xref>–<xref rid="fd4" ref-type="disp-formula">(4)</xref>, based on data available up to 7, 14, and 21 days prior to the forecast. The solid lines depict the forecasts, whereas the dashed lines of the same color depict the corresponding 95% confidence intervals. To keep the plots less cluttered, only the upper bound of the confidence interval is plotted. These plots differ from those in <xref rid="fig4" ref-type="fig">Fig. 4</xref> in that here the death rate <inline-formula><mml:math id="d1e143" display="inline" altimg="si295.svg"><mml:mi>ω</mml:mi></mml:math></inline-formula> was assume constant. (For interpretation of the references to color in this figure legend, the reader is referred to the web version of this article.)</p></caption><graphic xlink:href="gr8_lrg"/></fig><fig id="fig9"><label>Fig. 9</label><caption><p>Continuation from <xref rid="fig8" ref-type="fig">Fig. 8</xref>.</p></caption><graphic xlink:href="gr9_lrg"/></fig></p>
                <p id="d1e11954">
                  <list list-type="simple" id="d1e11956">
                    <list-item id="lst19">
                      <label>1.</label>
                      <p id="d1e11960">The initial forecasts (computed just with 21 days of measurements) vary greatly in accuracy and often come associated with very wide confidence intervals, reflecting the fact that 21 days of measurements do not provide enough information to obtain reliable estimates. However, by the time 4–5 weeks of data are available, the confidence intervals start to become much tighter.</p>
                    </list-item>
                    <list-item id="lst20">
                      <label>2.</label>
                      <p id="d1e11965">The actual numbers of daily deaths, generally fall inside the 95% confidence intervals computed 7, 14, and 21 days before, showing that the model is especially reliable in predicting disease-related casualties. For the countries/states shown, the main exception can bee seen in California in late May, India in mid-June, Texas in mid-July, and São Paulo in late November.</p>
                    </list-item>
                    <list-item id="lst21">
                      <label>3.</label>
                      <p id="d1e11970">Most of the actual numbers of new cases also fall inside the 95% confidence intervals computed 7, 14, and 21 days before, but we can see more exceptions to this “rule”. For example, this can be seen in Italy and the United Kingdom in late April and mid-October; as well as in California and Texas in late May and through most of June. The larger difficulty in predicting the daily number of new cases rather than predicting the number of daily deaths is not surprising in view of the fact that the former is highly dependent on the infection and new-cases reporting rates, which can exhibit abrupt changes due to the so-called super-spreader events (<xref rid="b30" ref-type="bibr">medicalxpress.com, 2020</xref>) or changes in testing policies and/or test availability.</p>
                    </list-item>
                    <list-item id="lst22">
                      <label>4.</label>
                      <p id="d1e11980">The estimates produced are fairly robust to outliers that appear in essentially all datasets. Due to the use of a 7-day moving average filter, each single-day outlier results in 7 consecutive measurements that stand out from the adjacent data points. Notable examples of such outliers appear in the number of deaths in Italy in August 15–21 and in New York in June 29–July 5 (among others). Typically, such outliers are caused by an agency adding to their daily report a number of past deaths/cases that had occurred over some past period of time, but had been neglected in previous daily reports (see Nov. 4th report, <xref rid="b36" ref-type="bibr">Portuguese Direção-Geral de Saúde, 2020</xref>). Even though some outlier are clearly noticeable, we opted not to discard any of these data points because they could potentially be caused by super-spreader events. In practice, the existence of these outliers causes some bias in the estimates, but they generally do not leads to data points outside the 95% confidence intervals.</p>
                    </list-item>
                    <list-item id="lst23">
                      <label>5.</label>
                      <p id="d1e11990">For a few regions/periods we see large fluctuations in the forecasts from one week to the next. This is especially noticeable in the United Kingdom in September and October, in Germany since early July until December, in Portugal in early December, in India in August, in New York from mid-July until mid-December, and in Illinois from mid-September until December. We shall return to these fluctuation in Section <xref rid="sec4.4" ref-type="sec">4.4</xref>.</p>
                    </list-item>
                  </list>
                </p>
              </sec>
              <sec id="sec4.4">
                <label>4.4</label>
                <title>Alternative models</title>
                <p id="d1e12002">The general model in <xref rid="fd3" ref-type="disp-formula">(3)</xref>–<xref rid="fd4" ref-type="disp-formula">(4)</xref> allows the infection rate <inline-formula><mml:math id="d1e12013" display="inline" altimg="si22.svg"><mml:mrow><mml:mi>β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, the new-cases reporting rate <inline-formula><mml:math id="d1e12027" display="inline" altimg="si35.svg"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and the deaths reporting rate <inline-formula><mml:math id="d1e12040" display="inline" altimg="si38.svg"><mml:mrow><mml:mi>ω</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> to be time varying with increments determined by the zero-mean random processes <inline-formula><mml:math id="d1e12053" display="inline" altimg="si299.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ω</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> in <xref rid="fd4" ref-type="disp-formula">(4)</xref>. A special instance of this model includes the case in which the zero-mean increment processes have zero variance and it is instructive to see how the forecasts would change if we were to consider constant rather than time-varying values for these parameters. In addition, we could also question the assumption of keeping the removal rate <inline-formula><mml:math id="d1e12108" display="inline" altimg="si14.svg"><mml:mi>γ</mml:mi></mml:math></inline-formula> constant, rather than a time varying parameter, also with increments determined by a zero-mean random process.</p>
                <p id="d1e12112">Different combinations are possible for which parameters are allowed to vary and which should remain constant. <xref rid="fig6" ref-type="fig">Fig. 6</xref>, <xref rid="fig7" ref-type="fig">Fig. 7</xref> show a comparison of forecasts for Italy and the US state of California for the following 6 possibilities:</p>
                <p id="d1e12118">
                  <list list-type="simple" id="d1e12120">
                    <list-item id="lst24">
                      <label>(a)</label>
                      <p id="d1e12124">all parameters constant;</p>
                    </list-item>
                    <list-item id="lst25">
                      <label>(b)</label>
                      <p id="d1e12129">a variable infection rate <inline-formula><mml:math id="d1e12132" display="inline" altimg="si22.svg"><mml:mrow><mml:mi>β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, but constant removal <inline-formula><mml:math id="d1e12145" display="inline" altimg="si14.svg"><mml:mi>γ</mml:mi></mml:math></inline-formula>, new-cases reporting rate <inline-formula><mml:math id="d1e12150" display="inline" altimg="si115.svg"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> and deaths reporting rates <inline-formula><mml:math id="d1e12156" display="inline" altimg="si295.svg"><mml:mi>ω</mml:mi></mml:math></inline-formula>;</p>
                    </list-item>
                    <list-item id="lst26">
                      <label>(c)</label>
                      <p id="d1e12163">variable infection rate <inline-formula><mml:math id="d1e12166" display="inline" altimg="si22.svg"><mml:mrow><mml:mi>β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, new-cases reporting rate <inline-formula><mml:math id="d1e12179" display="inline" altimg="si35.svg"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, deaths reporting rate <inline-formula><mml:math id="d1e12192" display="inline" altimg="si38.svg"><mml:mrow><mml:mi>ω</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, but constant removal rate <inline-formula><mml:math id="d1e12206" display="inline" altimg="si14.svg"><mml:mi>γ</mml:mi></mml:math></inline-formula>;</p>
                    </list-item>
                    <list-item id="lst27">
                      <label>(d)</label>
                      <p id="d1e12213">variable infection rate <inline-formula><mml:math id="d1e12216" display="inline" altimg="si22.svg"><mml:mrow><mml:mi>β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and new-cases reporting rate <inline-formula><mml:math id="d1e12229" display="inline" altimg="si35.svg"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, but constant removal rate <inline-formula><mml:math id="d1e12242" display="inline" altimg="si14.svg"><mml:mi>γ</mml:mi></mml:math></inline-formula> and deaths reporting rate <inline-formula><mml:math id="d1e12248" display="inline" altimg="si295.svg"><mml:mi>ω</mml:mi></mml:math></inline-formula>;</p>
                    </list-item>
                    <list-item id="lst28">
                      <label>(e)</label>
                      <p id="d1e12255">variable infection rate <inline-formula><mml:math id="d1e12258" display="inline" altimg="si22.svg"><mml:mrow><mml:mi>β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, removal rate <inline-formula><mml:math id="d1e12271" display="inline" altimg="si29.svg"><mml:mrow><mml:mi>γ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, new-cases reporting rate <inline-formula><mml:math id="d1e12284" display="inline" altimg="si35.svg"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, but constant deaths reporting rate <inline-formula><mml:math id="d1e12298" display="inline" altimg="si295.svg"><mml:mi>ω</mml:mi></mml:math></inline-formula>; and</p>
                    </list-item>
                    <list-item id="lst29">
                      <label>(f)</label>
                      <p id="d1e12305">all parameters time varying.</p>
                    </list-item>
                  </list>
                </p>
                <p id="d1e12307">The selection of the combinations above is motivated by the widely accepted observation that the infection rate has varied greatly over time, and therefore we take it as time-varying in all but the first option. In addition, it is also well known that the testing rate for asymptomatic patients has varied greatly, so we only take the new-cases reporting rate as constant in the first 2 options. Variability on the remaining parameters is likely, but almost certainly of a smaller magnitude.</p>
                <p id="d1e12309">A comparison of plots like the ones in <xref rid="fig6" ref-type="fig">Fig. 6</xref>, <xref rid="fig7" ref-type="fig">Fig. 7</xref> for a large number of countries/regions yields the following observations:</p>
                <p id="d1e12315">
                  <list list-type="simple" id="d1e12317">
                    <list-item id="lst30">
                      <label>1.</label>
                      <p id="d1e12321">In general, assuming that all parameters are constant or that all but the infection rate <inline-formula><mml:math id="d1e12324" display="inline" altimg="si22.svg"><mml:mrow><mml:mi>β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are constant severally compromises the models’ ability to produce useful forecasts. For the constant parameters model, in every dataset that exhibits a second wave, the numbers of new cases during the second wave fall grossly outside the confidence intervals associated with the forecasts. This is not surprising in view of the fact that a constant-parameter SIR model cannot exhibit multiple waves. When only the infection rate is allowed to be time-varying, it is possible to “explain” the measurements, but this typically requires large levels of noise and/or a highly variable infection rate, which typically result in confidence intervals that are larger than those obtained with richer models.</p>
                    </list-item>
                    <list-item id="lst31">
                      <label>2.</label>
                      <p id="d1e12339">For a large number of countries/regions, the results obtained assuming that all parameters are time varying differ little from those assuming that the infection rate <inline-formula><mml:math id="d1e12342" display="inline" altimg="si22.svg"><mml:mrow><mml:mi>β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and the new-cases reporting rate <inline-formula><mml:math id="d1e12355" display="inline" altimg="si35.svg"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are the only time-varying parameters. This is generally true both for the point forecasts and the confidence intervals. For a more detailed comparison of the original model <xref rid="fd3" ref-type="disp-formula">(3)</xref>–<xref rid="fd4" ref-type="disp-formula">(4)</xref>, with the simplified model that considers a constant removal rate <inline-formula><mml:math id="d1e12377" display="inline" altimg="si14.svg"><mml:mi>γ</mml:mi></mml:math></inline-formula> and deaths reporting rate <inline-formula><mml:math id="d1e12382" display="inline" altimg="si295.svg"><mml:mi>ω</mml:mi></mml:math></inline-formula>, but time varying infection <inline-formula><mml:math id="d1e12387" display="inline" altimg="si22.svg"><mml:mrow><mml:mi>β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and new-cases reporting <inline-formula><mml:math id="d1e12401" display="inline" altimg="si35.svg"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> rates, we present in <xref rid="fig8" ref-type="fig">Fig. 8</xref>, <xref rid="fig9" ref-type="fig">Fig. 9</xref> the same running forecasts we have seen in <xref rid="fig4" ref-type="fig">Fig. 4</xref>, <xref rid="fig5" ref-type="fig">Fig. 5</xref>. While for many countries/regions the results are indeed similar, by and large, assuming a constant death rate results in more accurate estimates and tighter confidence intervals, without significantly increase the number of forecasts outside the confidence intervals. In fact, the large fluctuations in the forecasts from one week to the next that we had noticed in Section <xref rid="sec4.3" ref-type="sec">4.3</xref>, are mostly absent in <xref rid="fig8" ref-type="fig">Fig. 8</xref>, <xref rid="fig9" ref-type="fig">Fig. 9</xref>. This indicates that a stochastic SIR model with just two time-varying parameters <inline-formula><mml:math id="d1e12432" display="inline" altimg="si22.svg"><mml:mrow><mml:mi>β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="d1e12445" display="inline" altimg="si35.svg"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is still sufficiently rich to represent the data available and that a time-varying death rate introduces unnecessary model uncertainty.</p>
                    </list-item>
                  </list>
                </p>
              </sec>
            </sec>
            <sec id="sec5">
              <label>5</label>
              <title>Conclusions and future work</title>
              <p id="d1e12462">We have shown that it is possible to construct reliable forecasts for the evolution of an epidemic purely from time series of new cases and deaths. This is particularly important in scenarios where social behavior and nonpharmaceutical interventions cause a continuous change in epidemic parameters such as the infection and reporting rates.</p>
              <p id="d1e12464">Because of inherent model ambiguities, the a posteriori forecasts are not always accurate; see for example the estimates in <xref rid="fig8" ref-type="fig">Fig. 8</xref> for the number of deaths in Germany in June or for the United Kingdom in August. However, those inaccurate estimates are typically associated with large 95% confidence intervals that still contain the actual future measurements. From the perspective of epidemic management, the magnitude of the forecast confidence intervals, and in particular the “pessimistic” upper bounds of these intervals, is probably more important than the estimates themselves, as it should inform decision makers of the expected worst-case stress on the healthcare system.</p>
              <p id="d1e12470">We have used a Gaussian random walk stochastic model for parameter drift that is completely agnostic to external factors. It should be possible to improve forecasting when we have available a set of “covariates” that can be used to estimate parameter variations, as in <xref rid="b23" ref-type="bibr">IHME COVID-19 (2020)</xref>. Introducing such covariates is the subject of future research.</p>
              <p id="d1e12476">We have seen that there are fundamental limitations in identifying the internal state and parameters of an SIR model based on daily counts of new cases and deaths. However, this lack of identifiability can be lifted through the use of additional measurements, such as how many new cases are asymptomatic and/or how many individuals were tested and received a negative result. Incorporating such measurements is also the subject of future research, as well as a more systematic study of the identifiability of SIR models (<xref rid="b32" ref-type="bibr">Miao et al., 2011</xref>).</p>
              <p id="d1e12483">Our SIR model is focused on a specific region and the transfer of infected individuals from other regions was only accounted for through stochastic additive terms. This could be improved by considering more sophisticated models that explicitly take into account external effects. However, we foreseen significant challenges in identifying the associated parameters.</p>
            </sec>
            <sec sec-type="COI-statement">
              <title>Declaration of Competing Interest</title>
              <p id="d1e12488">The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper.</p>
            </sec>
          </body>
          <back>
            <ref-list id="bib1">
              <title>References</title>
              <ref id="b1">
                <element-citation publication-type="journal" id="sb1">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Al-Salti</surname>
                      <given-names>N.</given-names>
                    </name>
                    <name>
                      <surname>Al-Musalhi</surname>
                      <given-names>F.</given-names>
                    </name>
                    <name>
                      <surname>Elmojtaba</surname>
                      <given-names>I.</given-names>
                    </name>
                    <name>
                      <surname>Gandhi</surname>
                      <given-names>V.</given-names>
                    </name>
                  </person-group>
                  <article-title>SIR model with time-varying contact rate</article-title>
                  <source>International Journal of Biomathematics</source>
                  <year>2020</year>
                  <pub-id pub-id-type="doi">10.1142/S1793524521500170</pub-id>
                </element-citation>
              </ref>
              <ref id="b2">
                <element-citation publication-type="book" id="sb2">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Andersson</surname>
                      <given-names>H.</given-names>
                    </name>
                    <name>
                      <surname>Britton</surname>
                      <given-names>T.</given-names>
                    </name>
                  </person-group>
                  <chapter-title>Stochastic Epidemic Models and Their Statistical Analysis</chapter-title>
                  <year>2000</year>
                  <publisher-name>Springer</publisher-name>
                </element-citation>
              </ref>
              <ref id="b3">
                <element-citation publication-type="journal" id="sb3">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Ball</surname>
                      <given-names>F.</given-names>
                    </name>
                    <name>
                      <surname>Neal</surname>
                      <given-names>P.</given-names>
                    </name>
                  </person-group>
                  <article-title>A general model for stochastic SIR epidemics with two levels of mixing</article-title>
                  <source>Mathematical Biosciences</source>
                  <volume>180</volume>
                  <issue>1–2</issue>
                  <year>2002</year>
                  <fpage>73</fpage>
                  <lpage>102</lpage>
                  <pub-id pub-id-type="pmid">12387917</pub-id>
                </element-citation>
              </ref>
              <ref id="b4">
                <element-citation publication-type="journal" id="sb4">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Beretta</surname>
                      <given-names>E.</given-names>
                    </name>
                    <name>
                      <surname>Capasso</surname>
                      <given-names>V.</given-names>
                    </name>
                    <name>
                      <surname>Rinaldi</surname>
                      <given-names>F.</given-names>
                    </name>
                  </person-group>
                  <article-title>Global stability results for a generalized Lotka-Volterra system with distributed delays</article-title>
                  <source>Journal of Mathematical Biology</source>
                  <volume>26</volume>
                  <issue>6</issue>
                  <year>1988</year>
                  <fpage>661</fpage>
                  <lpage>688</lpage>
                  <pub-id pub-id-type="pmid">3230365</pub-id>
                </element-citation>
              </ref>
              <ref id="b5">
                <element-citation publication-type="journal" id="sb5">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Beretta</surname>
                      <given-names>E.</given-names>
                    </name>
                    <name>
                      <surname>Kolmanovskii</surname>
                      <given-names>V.</given-names>
                    </name>
                    <name>
                      <surname>Shaikhet</surname>
                      <given-names>L.</given-names>
                    </name>
                  </person-group>
                  <article-title>Stability of epidemic model with time delays influenced by stochastic perturbations</article-title>
                  <source>Mathematics and Computers in Simulation</source>
                  <volume>45</volume>
                  <issue>3–4</issue>
                  <year>1998</year>
                  <fpage>269</fpage>
                  <lpage>277</lpage>
                </element-citation>
              </ref>
              <ref id="b6">
                <element-citation publication-type="journal" id="sb6">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Beretta</surname>
                      <given-names>E.</given-names>
                    </name>
                    <name>
                      <surname>Takeuchi</surname>
                      <given-names>Y.</given-names>
                    </name>
                  </person-group>
                  <article-title>Global stability of an SIR epidemic model with time delays</article-title>
                  <source>Journal of Mathematical Biology</source>
                  <volume>33</volume>
                  <issue>3</issue>
                  <year>1995</year>
                  <fpage>250</fpage>
                  <lpage>260</lpage>
                  <pub-id pub-id-type="pmid">7897328</pub-id>
                </element-citation>
              </ref>
              <ref id="b7">
                <element-citation publication-type="book" id="sb7">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Bertsekas</surname>
                      <given-names>D.P.</given-names>
                    </name>
                  </person-group>
                  <chapter-title>Nonlinear Programming</chapter-title>
                  <edition>second ed.</edition>
                  <year>1999</year>
                  <publisher-name>Athena Scientific</publisher-name>
                  <publisher-loc>Belmont, MA</publisher-loc>
                </element-citation>
              </ref>
              <ref id="b8">
                <element-citation publication-type="book" id="sb8">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Brauer</surname>
                      <given-names>F.</given-names>
                    </name>
                    <name>
                      <surname>Castillo-Chavez</surname>
                      <given-names>C.</given-names>
                    </name>
                    <name>
                      <surname>Feng</surname>
                      <given-names>Z.</given-names>
                    </name>
                  </person-group>
                  <chapter-title>Mathematical Models in Epidemiology</chapter-title>
                  <year>2019</year>
                  <publisher-name>Springer</publisher-name>
                </element-citation>
              </ref>
              <ref id="b9">
                <element-citation publication-type="journal" id="sb9">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Calafiore</surname>
                      <given-names>G.C.</given-names>
                    </name>
                    <name>
                      <surname>Novara</surname>
                      <given-names>C.</given-names>
                    </name>
                    <name>
                      <surname>Possieri</surname>
                      <given-names>C.</given-names>
                    </name>
                  </person-group>
                  <article-title>A time-varying SIRD model for the COVID-19 contagion in Italy</article-title>
                  <source>Annual Reviews in Control</source>
                  <year>2020</year>
                </element-citation>
              </ref>
              <ref id="b10">
                <element-citation publication-type="book" id="sb10">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Capasso</surname>
                      <given-names>V.</given-names>
                    </name>
                  </person-group>
                  <chapter-title>Mathematical Structures of Epidemic Systems</chapter-title>
                  <year>2008</year>
                  <publisher-name>Springer</publisher-name>
                </element-citation>
              </ref>
              <ref id="b11">
                <element-citation publication-type="book" id="sb11">
                  <person-group person-group-type="author">
                    <collab>Center for Systems Science and Engineering (CSSE) at Johns Hopkins University</collab>
                  </person-group>
                  <chapter-title>COVID-19 data repository</chapter-title>
                  <year>2020</year>
                  <comment>
                    <ext-link ext-link-type="uri" xlink:href="https://github.com/CSSEGISandData/COVID-19" id="interref1">https://github.com/CSSEGISandData/COVID-19</ext-link>
                  </comment>
                </element-citation>
              </ref>
              <ref id="b12">
                <element-citation publication-type="journal" id="sb12">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Comunian</surname>
                      <given-names>A.</given-names>
                    </name>
                    <name>
                      <surname>Gaburro</surname>
                      <given-names>R.</given-names>
                    </name>
                    <name>
                      <surname>Giudici</surname>
                      <given-names>M.</given-names>
                    </name>
                  </person-group>
                  <article-title>Inversion of a SIR-based model: a critical analysis about the application to COVID-19 epidemic</article-title>
                  <source>Physica D: Nonlinear Phenomena</source>
                  <volume>413</volume>
                  <year>2020</year>
                  <object-id pub-id-type="publisher-id">132674</object-id>
                </element-citation>
              </ref>
              <ref id="b13">
                <mixed-citation publication-type="other" id="sb13">CoronaCidades.org. (0000). Farol Covid, <ext-link ext-link-type="uri" xlink:href="https://data.brasil.io/dataset/covid19" id="interref2">https://data.brasil.io/dataset/covid19</ext-link>.</mixed-citation>
              </ref>
              <ref id="b14">
                <element-citation publication-type="book" id="sb14">
                  <person-group person-group-type="author">
                    <collab>COVID-19</collab>
                  </person-group>
                  <chapter-title>COVID-19 forecasts based on a stochastic SIR model</chapter-title>
                  <year>2020</year>
                  <comment>URL <ext-link ext-link-type="uri" xlink:href="http://www.ece.ucsb.edu/%7Ehespanha/covid19" id="interref3">http://www.ece.ucsb.edu/ hespanha/covid19</ext-link></comment>
                </element-citation>
              </ref>
              <ref id="b15">
                <element-citation publication-type="journal" id="sb15">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Davis</surname>
                      <given-names>T.A.</given-names>
                    </name>
                    <name>
                      <surname>Gilbert</surname>
                      <given-names>J.R.</given-names>
                    </name>
                    <name>
                      <surname>Larimore</surname>
                      <given-names>S.I.</given-names>
                    </name>
                    <name>
                      <surname>Ng</surname>
                      <given-names>E.G.</given-names>
                    </name>
                  </person-group>
                  <article-title>A column approximate minimum degree ordering algorithm</article-title>
                  <source>Association for Computing Machinery. Transactions on Mathematical Software</source>
                  <volume>30</volume>
                  <issue>3</issue>
                  <year>2004</year>
                  <fpage>353</fpage>
                  <lpage>376</lpage>
                </element-citation>
              </ref>
              <ref id="b16">
                <element-citation publication-type="journal" id="sb16">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Della Rossa</surname>
                      <given-names>F.</given-names>
                    </name>
                    <name>
                      <surname>Salzano</surname>
                      <given-names>D.</given-names>
                    </name>
                    <name>
                      <surname>Di Meglio</surname>
                      <given-names>A.</given-names>
                    </name>
                    <name>
                      <surname>De Lellis</surname>
                      <given-names>F.</given-names>
                    </name>
                    <name>
                      <surname>Coraggio</surname>
                      <given-names>M.</given-names>
                    </name>
                    <name>
                      <surname>Calabrese</surname>
                      <given-names>C.</given-names>
                    </name>
                  </person-group>
                  <article-title>A network model of Italy shows that intermittent regional strategies can alleviate the COVID-19 epidemic</article-title>
                  <source>Nature Commun.</source>
                  <volume>11</volume>
                  <issue>1</issue>
                  <year>2020</year>
                  <fpage>1</fpage>
                  <lpage>9</lpage>
                  <pub-id pub-id-type="pmid">31911652</pub-id>
                </element-citation>
              </ref>
              <ref id="b17">
                <mixed-citation publication-type="other" id="sb17">Efimov, D., &amp; Ushirobira, R. (2020). On interval prediction of COVID-19 development based on a SEIR epidemic model. In <italic>Proc. of the 59th Conf. on Decision and Contr.</italic>.</mixed-citation>
              </ref>
              <ref id="b18">
                <mixed-citation publication-type="other" id="sb18">European Center for Disease Prevention and Control. (0000) Download COVID-19 datasets, <ext-link ext-link-type="uri" xlink:href="https://www.ecdc.europa.eu/en/publications-data/download-todays-data-geographic-distribution-covid-19-cases-worldwide" id="interref4">https://www.ecdc.europa.eu/en/publications-data/download-todays-data-geographic-distribution-covid-19-cases-worldwide</ext-link>.</mixed-citation>
              </ref>
              <ref id="b19">
                <element-citation publication-type="journal" id="sb19">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Giordano</surname>
                      <given-names>G.</given-names>
                    </name>
                    <name>
                      <surname>Blanchini</surname>
                      <given-names>F.</given-names>
                    </name>
                    <name>
                      <surname>Bruno</surname>
                      <given-names>R.</given-names>
                    </name>
                    <name>
                      <surname>Colaneri</surname>
                      <given-names>P.</given-names>
                    </name>
                    <name>
                      <surname>Di Filippo</surname>
                      <given-names>A.</given-names>
                    </name>
                    <name>
                      <surname>Di Matteo</surname>
                      <given-names>A.</given-names>
                    </name>
                  </person-group>
                  <article-title>Modeling the COVID-19 epidemic and implementation of population-wide interventions in Italy</article-title>
                  <source>Nature Medicine</source>
                  <year>2020</year>
                </element-citation>
              </ref>
              <ref id="b20">
                <element-citation publication-type="book" id="sb20">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Hamer</surname>
                      <given-names>W.H.</given-names>
                    </name>
                  </person-group>
                  <chapter-title>Epidemic disease in England: the evidence of variability and of persistency of type</chapter-title>
                  <year>1906</year>
                  <publisher-name>Bedford Press</publisher-name>
                </element-citation>
              </ref>
              <ref id="b21">
                <element-citation publication-type="book" id="sb21">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Hespanha</surname>
                      <given-names>J.P.</given-names>
                    </name>
                  </person-group>
                  <chapter-title>TensCalc — A toolbox to generate fast code to solve nonlinear constrained minimizations and compute Nash equilibria: Technical report</chapter-title>
                  <year>2017</year>
                  <publisher-name>University of California, Santa Barbara</publisher-name>
                  <publisher-loc>Santa Barbara</publisher-loc>
                  <comment>Available at <ext-link ext-link-type="uri" xlink:href="http://www.ece.ucsb.edu/%7Ehespanha/techrep.html" id="interref5">http://www.ece.ucsb.edu/ hespanha/techrep.html</ext-link></comment>
                </element-citation>
              </ref>
              <ref id="b22">
                <element-citation publication-type="journal" id="sb22">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Hethcote</surname>
                      <given-names>H.W.</given-names>
                    </name>
                  </person-group>
                  <article-title>The mathematics of infectious diseases</article-title>
                  <source>SIAM Review</source>
                  <volume>42</volume>
                  <issue>4</issue>
                  <year>2000</year>
                  <fpage>599</fpage>
                  <lpage>653</lpage>
                </element-citation>
              </ref>
              <ref id="b23">
                <element-citation publication-type="journal" id="sb23">
                  <person-group person-group-type="author">
                    <collab>IHME COVID-19 Forecasting Team, R. C. Reiner, et al.</collab>
                  </person-group>
                  <article-title>Modeling COVID-19 scenarios for the United States</article-title>
                  <source>Nature Medicine</source>
                  <year>2020</year>
                </element-citation>
              </ref>
              <ref id="b24">
                <element-citation publication-type="journal" id="sb24">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Ji</surname>
                      <given-names>C.</given-names>
                    </name>
                    <name>
                      <surname>Jiang</surname>
                      <given-names>D.</given-names>
                    </name>
                  </person-group>
                  <article-title>Threshold behaviour of a stochastic SIR model</article-title>
                  <source>Applied Mathematical Modelling</source>
                  <volume>38</volume>
                  <issue>21–22</issue>
                  <year>2014</year>
                  <fpage>5067</fpage>
                  <lpage>5079</lpage>
                </element-citation>
              </ref>
              <ref id="b25">
                <element-citation publication-type="book" id="sb25">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Keeling</surname>
                      <given-names>M.J.</given-names>
                    </name>
                    <name>
                      <surname>Rohani</surname>
                      <given-names>P.</given-names>
                    </name>
                  </person-group>
                  <chapter-title>Modeling Infectious Diseases in Humans and Animals</chapter-title>
                  <year>2008</year>
                  <publisher-name>Princeton University Press</publisher-name>
                </element-citation>
              </ref>
              <ref id="b26">
                <mixed-citation publication-type="other" id="sb26">King, A. A., Domenech de Cellès, M., Magpantay, F. M. G., &amp; Rohani, P. (2015). Avoidable errors in the modelling of outbreaks of emerging pathogens, with special reference to Ebola. In <italic>Proc. of the Royal Society B: Biological Sciences Vol. 282</italic> 1806.</mixed-citation>
              </ref>
              <ref id="b27">
                <element-citation publication-type="book" id="sb27">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Köhler</surname>
                      <given-names>J.</given-names>
                    </name>
                    <name>
                      <surname>Schwenkel</surname>
                      <given-names>L.</given-names>
                    </name>
                    <name>
                      <surname>Koch</surname>
                      <given-names>A.</given-names>
                    </name>
                    <name>
                      <surname>Berberich</surname>
                      <given-names>J.</given-names>
                    </name>
                    <name>
                      <surname>Pauli</surname>
                      <given-names>P.</given-names>
                    </name>
                    <name>
                      <surname>Allgöwer</surname>
                      <given-names>F.</given-names>
                    </name>
                  </person-group>
                  <chapter-title>Robust and optimal predictive control of the COVID-19 outbreak</chapter-title>
                  <year>2020</year>
                  <comment>arXiv preprint <ext-link ext-link-type="uri" xlink:href="arxiv:2005.03580" id="interref6">arXiv:2005.03580</ext-link></comment>
                </element-citation>
              </ref>
              <ref id="b28">
                <element-citation publication-type="book" id="sb28">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Li</surname>
                      <given-names>M.L.</given-names>
                    </name>
                    <name>
                      <surname>Bouardi</surname>
                      <given-names>H.T.</given-names>
                    </name>
                    <name>
                      <surname>Lami</surname>
                      <given-names>O.S.</given-names>
                    </name>
                    <name>
                      <surname>Trikalinos</surname>
                      <given-names>T.A.</given-names>
                    </name>
                    <name>
                      <surname>Trichakis</surname>
                      <given-names>N.K.</given-names>
                    </name>
                    <name>
                      <surname>Bertsimas</surname>
                      <given-names>D.</given-names>
                    </name>
                  </person-group>
                  <chapter-title>Forecasting Covid-19 and analyzing the effect of government interventions</chapter-title>
                  <year>2020</year>
                  <comment>medRxiv</comment>
                </element-citation>
              </ref>
              <ref id="b29">
                <element-citation publication-type="book" id="sb29">
                  <person-group person-group-type="author">
                    <name>
                      <surname>MacKay</surname>
                      <given-names>D.J.</given-names>
                    </name>
                  </person-group>
                  <chapter-title>Information theory, inference and learning algorithms</chapter-title>
                  <year>2003</year>
                  <publisher-name>Cambridge university press</publisher-name>
                </element-citation>
              </ref>
              <ref id="b30">
                <element-citation publication-type="book" id="sb30">
                  <person-group person-group-type="author">
                    <collab>medicalxpress.com</collab>
                  </person-group>
                  <chapter-title>Superspreader events key driver in COVID-19 pandemic</chapter-title>
                  <year>2020</year>
                  <comment>
                    <ext-link ext-link-type="uri" xlink:href="https://medicalxpress.com/news/2020-11-superspreader-events-key-driver-covid-.html" id="interref7">https://medicalxpress.com/news/2020-11-superspreader-events-key-driver-covid-.html</ext-link>
                  </comment>
                </element-citation>
              </ref>
              <ref id="b31">
                <element-citation publication-type="journal" id="sb31">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Mei</surname>
                      <given-names>W.</given-names>
                    </name>
                    <name>
                      <surname>Mohagheghi</surname>
                      <given-names>S.</given-names>
                    </name>
                    <name>
                      <surname>Zampieri</surname>
                      <given-names>S.</given-names>
                    </name>
                    <name>
                      <surname>Bullo</surname>
                      <given-names>F.</given-names>
                    </name>
                  </person-group>
                  <article-title>On the dynamics of deterministic epidemic propagation over networks</article-title>
                  <source>Annual Reviews in Control</source>
                  <volume>44</volume>
                  <year>2017</year>
                  <fpage>116</fpage>
                  <lpage>128</lpage>
                </element-citation>
              </ref>
              <ref id="b32">
                <element-citation publication-type="journal" id="sb32">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Miao</surname>
                      <given-names>H.</given-names>
                    </name>
                    <name>
                      <surname>Xia</surname>
                      <given-names>X.</given-names>
                    </name>
                    <name>
                      <surname>Perelson</surname>
                      <given-names>A.S.</given-names>
                    </name>
                    <name>
                      <surname>Wu</surname>
                      <given-names>H.</given-names>
                    </name>
                  </person-group>
                  <article-title>On identifiability of nonlinear ODE models and applications in viral dynamics</article-title>
                  <source>SIAM Review Society for Industrial and Applied Mathematics</source>
                  <volume>53</volume>
                  <issue>1</issue>
                  <year>2011</year>
                  <fpage>3</fpage>
                  <lpage>39</lpage>
                  <pub-id pub-id-type="pmid">21785515</pub-id>
                </element-citation>
              </ref>
              <ref id="b33">
                <element-citation publication-type="journal" id="sb33">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Morgan</surname>
                      <given-names>O.</given-names>
                    </name>
                  </person-group>
                  <article-title>How decision makers can use quantitative approaches to guide outbreak responses</article-title>
                  <source>Philosophical Transactions of the Royal Society B</source>
                  <volume>374</volume>
                  <issue>1776</issue>
                  <year>2019</year>
                  <object-id pub-id-type="publisher-id">20180365</object-id>
                </element-citation>
              </ref>
              <ref id="b34">
                <element-citation publication-type="book" id="sb34">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Peng</surname>
                      <given-names>L.</given-names>
                    </name>
                    <name>
                      <surname>Yang</surname>
                      <given-names>W.</given-names>
                    </name>
                    <name>
                      <surname>Zhang</surname>
                      <given-names>D.</given-names>
                    </name>
                    <name>
                      <surname>Zhuge</surname>
                      <given-names>C.</given-names>
                    </name>
                    <name>
                      <surname>Hong</surname>
                      <given-names>L.</given-names>
                    </name>
                  </person-group>
                  <chapter-title>Epidemic analysis of COVID-19 in China by dynamical modeling</chapter-title>
                  <year>2020</year>
                  <comment>arXiv preprint <ext-link ext-link-type="uri" xlink:href="arxiv:2002.06563" id="interref8">arXiv:2002.06563</ext-link></comment>
                </element-citation>
              </ref>
              <ref id="b35">
                <element-citation publication-type="book" id="sb35">
                  <person-group person-group-type="author">
                    <name>
                      <surname>y Piontti</surname>
                      <given-names>A.P.</given-names>
                    </name>
                    <name>
                      <surname>Perra</surname>
                      <given-names>N.</given-names>
                    </name>
                    <name>
                      <surname>Rossi</surname>
                      <given-names>L.</given-names>
                    </name>
                    <name>
                      <surname>Samay</surname>
                      <given-names>N.</given-names>
                    </name>
                    <name>
                      <surname>Vespignani</surname>
                      <given-names>A.</given-names>
                    </name>
                  </person-group>
                  <chapter-title>Charting the Next Pandemic: Modeling Infectious Disease Spreading in the Data Science Age</chapter-title>
                  <year>2019</year>
                  <publisher-name>Springer</publisher-name>
                </element-citation>
              </ref>
              <ref id="b36">
                <element-citation publication-type="book" id="sb36">
                  <person-group person-group-type="author">
                    <collab>Portuguese Direção-Geral de Saúde</collab>
                  </person-group>
                  <chapter-title>COVID-19 Relatório de Situação</chapter-title>
                  <year>2020</year>
                  <comment>
                    <ext-link ext-link-type="uri" xlink:href="https://covid19.min-saude.pt/relatorio-de-situacao/" id="interref9">https://covid19.min-saude.pt/relatorio-de-situacao/</ext-link>
                  </comment>
                </element-citation>
              </ref>
              <ref id="b37">
                <element-citation publication-type="journal" id="sb37">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Roda</surname>
                      <given-names>W.C.</given-names>
                    </name>
                    <name>
                      <surname>Varughese</surname>
                      <given-names>M.B.</given-names>
                    </name>
                    <name>
                      <surname>Han</surname>
                      <given-names>D.</given-names>
                    </name>
                    <name>
                      <surname>Li</surname>
                      <given-names>M.Y.</given-names>
                    </name>
                  </person-group>
                  <article-title>Why is it difficult to accurately predict the COVID-19 epidemic?</article-title>
                  <source>Infectious Disease Modelling</source>
                  <year>2020</year>
                </element-citation>
              </ref>
              <ref id="b38">
                <element-citation publication-type="journal" id="sb38">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Shearer</surname>
                      <given-names>F.M.</given-names>
                    </name>
                    <name>
                      <surname>Moss</surname>
                      <given-names>R.</given-names>
                    </name>
                    <name>
                      <surname>McVernon</surname>
                      <given-names>J.</given-names>
                    </name>
                    <name>
                      <surname>Ross</surname>
                      <given-names>J.V.</given-names>
                    </name>
                    <name>
                      <surname>McCaw</surname>
                      <given-names>J.M.</given-names>
                    </name>
                  </person-group>
                  <article-title>Infectious disease pandemic planning and response: Incorporating decision analysis</article-title>
                  <source>PLoS Medicine</source>
                  <volume>17</volume>
                  <issue>1</issue>
                  <year>2020</year>
                  <object-id pub-id-type="publisher-id">e1003018</object-id>
                </element-citation>
              </ref>
              <ref id="b39">
                <element-citation publication-type="book" id="sb39">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Srivastava</surname>
                      <given-names>A.</given-names>
                    </name>
                    <name>
                      <surname>Xu</surname>
                      <given-names>T.</given-names>
                    </name>
                    <name>
                      <surname>Prasanna</surname>
                      <given-names>V.K.</given-names>
                    </name>
                  </person-group>
                  <chapter-title>Fast and accurate forecasting of COVID-19 deaths using the sikj<inline-formula><mml:math id="d1e13917" display="inline" altimg="si326.svg"><mml:mi>α</mml:mi></mml:math></inline-formula> model</chapter-title>
                  <year>2020</year>
                  <comment>arXiv preprint <ext-link ext-link-type="uri" xlink:href="arxiv:2007.05180" id="interref10">arXiv:2007.05180</ext-link></comment>
                </element-citation>
              </ref>
              <ref id="b40">
                <element-citation publication-type="journal" id="sb40">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Stolerman</surname>
                      <given-names>L.M.</given-names>
                    </name>
                    <name>
                      <surname>Coombs</surname>
                      <given-names>D.</given-names>
                    </name>
                    <name>
                      <surname>Boatto</surname>
                      <given-names>S.</given-names>
                    </name>
                  </person-group>
                  <article-title>SIR-network model and its application to dengue fever</article-title>
                  <source>SIAM Journal of Applied Mathematics</source>
                  <volume>75</volume>
                  <issue>6</issue>
                  <year>2015</year>
                  <fpage>2581</fpage>
                  <lpage>2609</lpage>
                </element-citation>
              </ref>
              <ref id="b41">
                <element-citation publication-type="journal" id="sb41">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Tornatore</surname>
                      <given-names>E.</given-names>
                    </name>
                    <name>
                      <surname>Buccellato</surname>
                      <given-names>S.M.</given-names>
                    </name>
                    <name>
                      <surname>Vetro</surname>
                      <given-names>P.</given-names>
                    </name>
                  </person-group>
                  <article-title>Stability of a stochastic SIR system</article-title>
                  <source>Physica A: Statistical Mechanics and its Applications</source>
                  <volume>354</volume>
                  <year>2005</year>
                  <fpage>111</fpage>
                  <lpage>126</lpage>
                </element-citation>
              </ref>
              <ref id="b42">
                <element-citation publication-type="journal" id="sb42">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Xia</surname>
                      <given-names>Z.-Q.</given-names>
                    </name>
                    <name>
                      <surname>Zhang</surname>
                      <given-names>J.</given-names>
                    </name>
                    <name>
                      <surname>Xue</surname>
                      <given-names>Y.-K.</given-names>
                    </name>
                    <name>
                      <surname>Sun</surname>
                      <given-names>G.-Q.</given-names>
                    </name>
                    <name>
                      <surname>Jin</surname>
                      <given-names>Z.</given-names>
                    </name>
                  </person-group>
                  <article-title>Modeling the transmission of middle east respirator syndrome corona virus in the Republic of Korea</article-title>
                  <source>PLoS One</source>
                  <volume>10</volume>
                  <issue>12</issue>
                  <year>2015</year>
                </element-citation>
              </ref>
              <ref id="b43">
                <element-citation publication-type="journal" id="sb43">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Youssef</surname>
                      <given-names>M.</given-names>
                    </name>
                    <name>
                      <surname>Scoglio</surname>
                      <given-names>C.</given-names>
                    </name>
                  </person-group>
                  <article-title>An individual-based approach to SIR epidemics in contact networks</article-title>
                  <source>Journal of Theoretical Biology</source>
                  <volume>283</volume>
                  <issue>1</issue>
                  <year>2011</year>
                  <fpage>136</fpage>
                  <lpage>144</lpage>
                  <pub-id pub-id-type="pmid">21663750</pub-id>
                </element-citation>
              </ref>
              <ref id="b44">
                <element-citation publication-type="book" id="sb44">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Zou</surname>
                      <given-names>D.</given-names>
                    </name>
                    <name>
                      <surname>Wang</surname>
                      <given-names>L.</given-names>
                    </name>
                    <name>
                      <surname>Xu</surname>
                      <given-names>P.</given-names>
                    </name>
                    <name>
                      <surname>Chen</surname>
                      <given-names>J.</given-names>
                    </name>
                    <name>
                      <surname>Zhang</surname>
                      <given-names>W.</given-names>
                    </name>
                    <name>
                      <surname>Gu</surname>
                      <given-names>Q.</given-names>
                    </name>
                  </person-group>
                  <chapter-title>Epidemic model guided machine learning for COVID-19 forecasts in the United States</chapter-title>
                  <year>2020</year>
                  <comment>medRxiv</comment>
                </element-citation>
              </ref>
            </ref-list>
            <ack id="d1e12490">
              <title>Acknowledgments</title>
              <p id="d1e12493">This research was supported by the <funding-source id="GS1"><institution-wrap><institution-id institution-id-type="doi">10.13039/100000001</institution-id><institution>National Science Foundation, USA</institution></institution-wrap></funding-source>
under Grant No. ECCS-2029985. The authors thank Prof. Francesco Bullo for providing important references and information related to this work and to Dr. Radhakisan Baheti for encouragement and guidance.</p>
            </ack>
            <fn-group>
              <fn id="fn1">
                <label>1</label>
                <p id="d1e4200">To shorten the formulas, in this section we denote time dependence through a subscript, as in <inline-formula><mml:math id="d1e4203" display="inline" altimg="si117.svg"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> rather than <inline-formula><mml:math id="d1e4213" display="inline" altimg="si118.svg"><mml:mrow><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
              </fn>
              <fn id="fn2">
                <label>2</label>
                <p id="d1e10701">See, e.g., ECDPC dataset for France during the month of July 2020.</p>
              </fn>
            </fn-group>
          </back>
        </article>
      </metadata>
    </record>
  </GetRecord>
</OAI-PMH>
