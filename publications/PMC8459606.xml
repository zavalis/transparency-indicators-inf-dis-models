<?xml version="1.0" encoding="UTF-8"?>
<OAI-PMH xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.openarchives.org/OAI/2.0/ http://www.openarchives.org/OAI/2.0/OAI-PMH.xsd">
  <responseDate>2022-03-11T00:54:08Z</responseDate>
  <request verb="GetRecord" identifier="oai:pubmedcentral.nih.gov:8459606" metadataPrefix="pmc">https:/www.ncbi.nlm.nih.gov/pmc/oai/oai.cgi</request>
  <GetRecord>
    <record>
      <header>
        <identifier>oai:pubmedcentral.nih.gov:8459606</identifier>
        <datestamp>2021-09-23</datestamp>
        <setSpec>nihpa</setSpec>
        <setSpec>pmc-open</setSpec>
        <setSpec>manuscript</setSpec>
      </header>
      <metadata>
        <article xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" xsi:schemaLocation="https://jats.nlm.nih.gov/ns/archiving/1.3/ https://jats.nlm.nih.gov/archiving/1.3/xsd/JATS-archivearticle1-3.xsd" dtd-version="1.3" article-type="research-article">
          <processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
            <restricted-by>pmc</restricted-by>
          </processing-meta>
          <front>
            <journal-meta>
              <journal-id journal-id-type="nlm-journal-id">9815649</journal-id>
              <journal-id journal-id-type="pubmed-jr-id">21667</journal-id>
              <journal-id journal-id-type="nlm-ta">Health Care Manag Sci</journal-id>
              <journal-id journal-id-type="iso-abbrev">Health Care Manag Sci</journal-id>
              <journal-title-group>
                <journal-title>Health care management science</journal-title>
              </journal-title-group>
              <issn pub-type="ppub">1386-9620</issn>
            </journal-meta>
            <article-meta>
              <article-id pub-id-type="accession">PMC8459606</article-id>
              <article-id pub-id-type="pmcid">PMC8459606</article-id>
              <article-id pub-id-type="pmc-uid">8459606</article-id>
              <article-id pub-id-type="pmid">33991293</article-id>
              <article-id pub-id-type="pmid">33991293</article-id>
              <article-id pub-id-type="doi">10.1007/s10729-021-09558-0</article-id>
              <article-id pub-id-type="manuscript">nihpa1737713</article-id>
              <article-categories>
                <subj-group subj-group-type="heading">
                  <subject>Article</subject>
                </subj-group>
              </article-categories>
              <title-group>
                <article-title>Agent-based evolving network modeling: a new simulation method for modeling low prevalence infectious diseases</article-title>
              </title-group>
              <contrib-group>
                <contrib contrib-type="author">
                  <name>
                    <surname>Eden</surname>
                    <given-names>Matthew</given-names>
                  </name>
                  <xref ref-type="aff" rid="A1">1</xref>
                </contrib>
                <contrib contrib-type="author">
                  <name>
                    <surname>Castonguay</surname>
                    <given-names>Rebecca</given-names>
                  </name>
                  <xref ref-type="aff" rid="A1">1</xref>
                </contrib>
                <contrib contrib-type="author">
                  <name>
                    <surname>Munkhbat</surname>
                    <given-names>Buyannemekh</given-names>
                  </name>
                  <xref ref-type="aff" rid="A1">1</xref>
                </contrib>
                <contrib contrib-type="author">
                  <name>
                    <surname>Balasubramanian</surname>
                    <given-names>Hari</given-names>
                  </name>
                  <xref ref-type="aff" rid="A1">1</xref>
                </contrib>
                <contrib contrib-type="author">
                  <name>
                    <surname>Gopalappa</surname>
                    <given-names>Chaitra</given-names>
                  </name>
                  <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8384-6041</contrib-id>
                  <xref ref-type="aff" rid="A1">1</xref>
                </contrib>
              </contrib-group>
              <aff id="A1"><label>1</label>Mechanical and Industrial Engineering, University of Massachusetts Amherst, Amherst, MA 01003, USA</aff>
              <author-notes>
                <fn fn-type="equal" id="FN1">
                  <p id="P1">Matthew Eden and Rebecca Castonguay contributed equally to this work.</p>
                </fn>
                <corresp id="CR1"><label>✉</label>Chaitra Gopalappa <email>chaitrag@umass.edu</email></corresp>
              </author-notes>
              <pub-date pub-type="nihms-submitted">
                <day>18</day>
                <month>9</month>
                <year>2021</year>
              </pub-date>
              <pub-date pub-type="epub">
                <day>15</day>
                <month>5</month>
                <year>2021</year>
              </pub-date>
              <pub-date pub-type="ppub">
                <month>9</month>
                <year>2021</year>
              </pub-date>
              <pub-date pub-type="pmc-release">
                <day>23</day>
                <month>9</month>
                <year>2021</year>
              </pub-date>
              <volume>24</volume>
              <issue>3</issue>
              <fpage>623</fpage>
              <lpage>639</lpage>
              <!--elocation-id from pubmed: 10.1007/s10729-021-09558-0-->
              <permissions>
                <license>
                  <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
                  <license-p>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
                </license>
              </permissions>
              <abstract id="ABS1">
                <p id="P2">Agent-based network modeling (ABNM) simulates each person at the individual-level as agents of the simulation, and uses network generation algorithms to generate the network of contacts between individuals. ABNM are suitable for simulating individual-level dynamics of infectious diseases, especially for diseases such as HIV that spread through close contacts within intricate contact networks. However, as ABNM simulates a scaled-version of the full population, consisting of all infected and susceptible persons, they are computationally infeasible for studying certain questions in low prevalence diseases such as HIV. We present a new simulation technique, agent-based <italic>evolving</italic> network modeling (ABENM), which includes a new network generation algorithm, Evolving Contact Network Algorithm (ECNA), for generating scale-free networks. ABENM simulates only infected persons and their immediate contacts at the individual-level as agents of the simulation, and uses the ECNA for generating the contact structures between these individuals. All other susceptible persons are modeled using a compartmental modeling structure. Thus, ABENM has a hybrid agent-based and compartmental modeling structure. The ECNA uses concepts from graph theory for generating scale-free networks. Multiple social networks, including sexual partnership networks and needle sharing networks among injecting drug-users, are known to follow a scale-free network structure. Numerical results comparing ABENM with ABNM estimations for disease trajectories of hypothetical diseases transmitted on scale-free contact networks are promising for application to low prevalence diseases.</p>
              </abstract>
              <kwd-group>
                <kwd>Agent-based simulation</kwd>
                <kwd>Network modeling</kwd>
                <kwd>Disease modeling</kwd>
                <kwd>Scale-free networks</kwd>
              </kwd-group>
            </article-meta>
          </front>
          <body>
            <sec id="S1">
              <label>1</label>
              <title>Introduction</title>
              <p id="P3">Mathematical simulation modeling can play a key role in predicting epidemic projections and informing response strategies for disease prevention through analyses of alternative intervention strategies. However, there is a lack of a suitable technique for simulating diseases that spread through defined contact structures but have low prevalence, including endemic diseases such as the human immunodeficiency virus (HIV) or tuberculosis (TB), or reemerging disease outbreaks such as Ebola disease or Middle East Respiratory Syndrome (MERS) where rapid response when prevalence is low is key. We present a new simulation technique, which we refer to as an agent-based evolving network modeling (ABENM) technique, and a new evolving contact network algorithm (ECNA) for generating scale-free networks in ABENM. This technique was specifically developed for analyses of diseases with low prevalence.</p>
              <p id="P4">Current simulation techniques are insufficient for low prevalence diseases where the network structure of contacts significantly influences virus spread. Two commonly used types of simulation techniques in the disease modeling literature are compartmental modeling and agent-based network modeling (ABNM). [<xref rid="R1" ref-type="bibr">1</xref>] Compartmental modeling splits the population into groups (or compartments) that represent the different states of a disease, e.g., susceptible, infected, and removed, and uses a system of differential equations to simulate the rates of change for transitioning between these compartments. These models assume random mixing between people, which is suitable for diseases that spread easily through air droplets such as the seasonal flu but not suitable for diseases that spread through close contact networks such as HIV, Ebola disease, MERS, and TB. [<xref rid="R2" ref-type="bibr">2</xref>] ABNM simulates each entity as an individual agent or node in a network and the connections between nodes as links of a network. ABNM is thus suitable for simulating infected and susceptible persons at the individual-level and the interactions leading to disease transmissions through a network of contacts, [<xref rid="R3" ref-type="bibr">3</xref>] representative of say sexual and needle-sharing partnerships that are the most common modes of HIV transmission, or close family members for TB, Ebola disease, and MERS. However, ABNM is computationally expensive. Therefore, while ABNM provides the necessary mathematical structure, it is computationally infeasible for diseases with low prevalence. Taking HIV as an example, about 421 per 100,000 persons are infected with HIV nationally in the United States (U.S.), [<xref rid="R4" ref-type="bibr">4</xref>] and the size of the underlying contact networks are expected to be 2 to 49 persons per cluster as per molecular analyses of nucleotide sequence data from persons with recent diagnoses (i.e., those diagnosed over the past 3 year period, who constitute about 10% of all PWH). [<xref rid="R5" ref-type="bibr">5</xref>] As ABNM are scaled versions of the population, simulating a population of 100,000 persons representative of the U.S. population will have 421 HIV-infected persons, and 42 persons with recent diagnosis, which are insufficient to generate the expected cluster sizes or model heterogeneity by key features, such as risk-group, age, and race. Computation times in ABNM are in the order of <italic>O</italic>(<italic>N</italic><sup>2</sup>), where <italic>N</italic> is the population size in the simulation, as such, increasing the value of <italic>N</italic> is also not a suitable solution. These issues make ABNM insufficient for modeling low prevalence diseases such as HIV.</p>
              <p id="P5">The key aspect of the newly developed ABENM is to only simulate infected individuals and their network of infected and susceptible contacts at the individual-level, and all other susceptible persons at the population-level as a compartmental model. As susceptible persons become infected, their contacts will be introduced to the network, thus the size of the network grows as new persons become infected. The ECNA is a network generation algorithm that determines the degree (the number of contacts) of each newly added person such that the resulting network would match overall network statistics. This method enables modeling low prevalence diseases on network structures and gives a good trade-off between the current two extreme simulation techniques.</p>
              <p id="P6">Among the computational modeling literature using scale-free networks, several focused on non-network features such as various types of interventions. [<xref rid="R6" ref-type="bibr">6</xref>–<xref rid="R12" ref-type="bibr">12</xref>] Two studies further focused on different features related to sexual behavior, highlighting the significance of modeling network structures. [<xref rid="R7" ref-type="bibr">7</xref>, <xref rid="R8" ref-type="bibr">8</xref>] One study, on computer viruses, focused on understanding the influence of structural properties of scale-free networks on epidemic spread. [<xref rid="R13" ref-type="bibr">13</xref>] Two studies developed open source generalized modeling frameworks, FAVITES for studying physical contact networks and molecular phylogenetic trees and sequences, and SimpactCyan an open-source agent-based simulation tool for HIV with R and Python interfaces. [<xref rid="R14" ref-type="bibr">14</xref>, <xref rid="R15" ref-type="bibr">15</xref>] Two studies also focused on development of methods for calibration of the models rather than network features. [<xref rid="R6" ref-type="bibr">6</xref>, <xref rid="R15" ref-type="bibr">15</xref>]</p>
              <p id="P7">All the above models simulate the full population, i.e., infected and susceptible persons, except for one study, that keeps track of only infected persons as agents, [<xref rid="R11" ref-type="bibr">11</xref>] but they did not explicitly simulate contacts as agents only as features of the infected persons. The motivation of their methodology is similar to our work, modeling low prevalence diseases, however, they do not track or model the contact network and thus it limits its use for studying the transmission dynamics on contact network structures. Our work addresses this gap.</p>
              <p id="P8">Two of the other studies discussed above highlight the limitations caused by constraints in memory and computational times generated by the use of network modeling. One study noted that the computational times are generally in the order of <italic>O</italic>(<italic>N</italic><sup>2</sup>) per time-step and in the worst case go up to <italic>O</italic>(<italic>N</italic><sup>3</sup>). [<xref rid="R6" ref-type="bibr">6</xref>] They simulate a population generally starting at 100,000 agents and reaching utmost 750,000 agents after 12 years, with each run taking about 3 to 6 h on a single processor. However, this model was applied to South Africa where the HIV prevalence is much higher, about 15 to 35% in the last year of the simulation. The SimpactCyan model was demonstrated on population sizes of 5000 to 20,000 and the study reported a runtime of 25–45 min on a single core. [<xref rid="R15" ref-type="bibr">15</xref>]</p>
              <p id="P9">All other models did not discuss computational complexity but used small population sizes or assumed static networks, and are applied to or demonstrated on high prevalence populations. Moshiri et.al. (2019), used preferential attachment to generate a scale-free contact network for simulating HIV through a static sexual contact network [<xref rid="R14" ref-type="bibr">14</xref>]. They apply the model for simulating HIV in San Diego and Uganda, using network sizes of 10,000 or 100,000, and starting with an initial HIV prevalence of 15%. Pastor-Satorras and Vespignani (2000) used large network sizes of upto 8,500,000 to study the spread of computer viruses on static-networks, which do not face similar computational complexities as dynamic networks [<xref rid="R13" ref-type="bibr">13</xref>]. Kretzschmar and Morris (1997) use population size of 2000 [<xref rid="R8" ref-type="bibr">8</xref>]. Vieira et al. (2010) use small world networks for simulating HIV in a small Brazilian population of about 3400 [<xref rid="R10" ref-type="bibr">10</xref>]. Johnson et.al. (2018), start with an initial population size of 20,000 with a prevalence of 1–3% and simulate to a final prevalence of 30% [<xref rid="R9" ref-type="bibr">9</xref>]. Luo et al. (2018), initialize the model with 10,000 persons and simulate MSM in Atlanta, a population with high HIV prevalence [<xref rid="R12" ref-type="bibr">12</xref>]. Reniers et.al. (2015), simulated a small population of 1250 persons starting with an initial prevalence of 5% to model sexual behavior and partnership networks, in the context of HIV in Africa [<xref rid="R7" ref-type="bibr">7</xref>].</p>
              <p id="P10">Methods in the social network literature for network generation, including network evolution models [<xref rid="R16" ref-type="bibr">16</xref>–<xref rid="R19" ref-type="bibr">19</xref>], nodal attribute models [<xref rid="R20" ref-type="bibr">20</xref>], preferential attachment [<xref rid="R19" ref-type="bibr">19</xref>], and exponential random graph models [<xref rid="R21" ref-type="bibr">21</xref>, <xref rid="R22" ref-type="bibr">22</xref>], mostly focus on addition of heterogeneous features and network statistics into network generation. These algorithms generate the full population network and thus are suitable for generating networks for ABNM simulations only.</p>
              <p id="P11">Therefore, the significance of the newly proposed ABENM and ECNA is the focus on modeling network structures for diseases with low prevalence that are spread on non-random networks. This is a category that is not explicitly studied in prior computational epidemiology or social network modeling literature but representative of a significant portion of high burden diseases and is challenging to model with current techniques. This is a concept paper for presenting the ABENM simulation technique with ECNA network generation algorithm specifically for scale-free contact networks where node degree distribution follows a power-law [<xref rid="R13" ref-type="bibr">13</xref>, <xref rid="R23" ref-type="bibr">23</xref>]. Networks of this type include needle sharing contact networks among people who inject drugs and sexual contact networks [<xref rid="R24" ref-type="bibr">24</xref>–<xref rid="R27" ref-type="bibr">27</xref>].</p>
            </sec>
            <sec id="S2">
              <label>2</label>
              <title>Methods</title>
              <p id="P12">Problem description In ABNM, the network of contacts is first generated using a network generation algorithm such as preferential attachment for scale-free networks, and transmission of infections are generated through simulation of individual-level interactions between contacts. In the empirical example in <xref rid="F1" ref-type="fig">Fig. 1</xref> for a hypothetical population of 9 people, all 9 persons (nodes) and their contact structure are initially generated and the spread of infection is simulated over time. The equivalent for the newly proposed ABENM, as shown in <xref rid="F1" ref-type="fig">Fig. 1</xref>, models only infected nodes and their immediate contacts. Therefore, at every time-step, when a new person becomes infected, the problem is to determine the contacts of the newly infected node, specifically, ‘what is the degree (number of contacts) of the neighbors of the newly infected node?’ Errors in this estimation can lead to inaccurate epidemic trajectories, and inaccurate network structures.</p>
              <p id="P13">We hypothesize that 1) current network generation algorithms, such as the preferential attachment which is the most commonly used algorithm for scale-free networks, cannot be used for ABENM; 2) the degree of node neighbors cannot be directly drawn from the overall network degree distributions due to known degree-correlations between nodes, i.e., the degree of a node is not independent of its neighbors’ degree, 3) current estimations for degree correlations are insufficient because of the overlying effects of the stochastic process defining the epidemic trajectory thus requiring new stochastic estimations, and 4) that the estimations are different for static and dynamic contact networks. The technical terms are discussed in more detail in the following sub-sections.</p>
              <p id="P14">The rest of this section is structured as follows. We first discuss the mathematical formulations of the two commonly used simulation modeling techniques for prediction of disease trajectories during epidemics: a) deterministic compartmental modeling in <xref rid="S3" ref-type="sec">Section 2.1</xref>; and b) agent-based network modeling (ABNM), including an overview of agent-based modeling in <xref rid="S4" ref-type="sec">2.2</xref> and network generation algorithms in <xref rid="S5" ref-type="sec">2.3</xref>. We then present the newly developed simulation technique, ABENM, its overall framework in <xref rid="S6" ref-type="sec">2.4</xref> and an algorithm for generating an evolving network, ECNA, in <xref rid="S7" ref-type="sec">2.5</xref>. We discuss our approach to validation of the ABENM with ECNA in <xref rid="S11" ref-type="sec">2.6</xref>.</p>
              <sec id="S3">
                <label>2.1</label>
                <title>Overview of current compartmental simulation modeling technique</title>
                <p id="P15">Compartmental modeling is a simulation modeling technique that is extensively used for epidemic predictions [<xref rid="R1" ref-type="bibr">1</xref>]. Using the simplest epidemic structure, Susceptible-Infected-Removed (SIR), a compartmental model for simulating the epidemic trajectory, specifically, estimating <italic>s</italic><sub><italic>t</italic></sub>, <italic>i</italic><sub><italic>t</italic></sub>, <italic>r</italic><sub><italic>t</italic></sub>, the proportion of people in states S, I, and R, respectively can be written as
<disp-formula id="FD1"><label>(1)</label><mml:math display="block" id="M21"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>μ</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:math></disp-formula>
<disp-formula id="FD2"><label>(2)</label><mml:math display="block" id="M22"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>μ</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:mrow></mml:math></disp-formula>
<disp-formula id="FD3"><label>(3)</label><mml:math display="block" id="M23"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>μ</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>μ</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:mrow></mml:math></disp-formula>
where,
<table-wrap id="T3" position="anchor" orientation="portrait"><table frame="void" rules="none"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><tbody><tr><td align="left" valign="top" rowspan="1" colspan="1"><italic>p</italic></td><td align="left" valign="top" rowspan="1" colspan="1">probability of transmission per susceptible-infected contact</td></tr><tr><td align="left" valign="top" rowspan="1" colspan="1"><italic>c</italic><sub><italic>t</italic></sub></td><td align="left" valign="top" rowspan="1" colspan="1">average number of contacts per person at time <italic>t</italic></td></tr><tr><td align="left" valign="top" rowspan="1" colspan="1"><italic>c</italic><sub><italic>t</italic></sub><italic>i</italic><sub><italic>t</italic></sub></td><td align="left" valign="top" rowspan="1" colspan="1">average number of infected contacts per person at time <italic>t</italic></td></tr><tr><td align="left" valign="top" rowspan="1" colspan="1"><italic>μ</italic><sub><italic>S</italic></sub></td><td align="left" valign="top" rowspan="1" colspan="1">rate of transitioning from state <italic>S</italic> to <italic>R</italic> (in the case of HIV it represents natural mortality rate)</td></tr><tr><td align="left" valign="top" rowspan="1" colspan="1"><italic>μ</italic><sub><italic>I</italic></sub></td><td align="left" valign="top" rowspan="1" colspan="1">rate of transitioning from state <italic>I</italic> to <italic>R</italic> (in the case of HIV it represents mortality rate from the disease)</td></tr></tbody></table></table-wrap>
</p>
                <p id="P16">A more generalized derivation of the compartmental model is presented in <xref rid="SD1" ref-type="supplementary-material">Appendix 1a</xref>, which can be extended to other types of epidemic profiles. Without loss of generality, and as typically done in compartmental model, instead of using <italic>s</italic><sub><italic>t</italic></sub>, <italic>i</italic><sub><italic>t</italic></sub>, <italic>r</italic><sub><italic>t</italic></sub> as the proportion of people in states S, I, and R, respectively, where <inline-formula><mml:math display="inline" id="M24"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, we can also write these equations using <italic>S</italic><sub><italic>t</italic></sub>, <italic>I</italic><sub><italic>t</italic></sub>, <italic>R</italic><sub><italic>t</italic></sub> as the number of people in states S, I, and R, respectively, with <inline-formula><mml:math display="inline" id="M25"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>, where <italic>N</italic> is the size of total population.</p>
                <p id="P17">Some terms from the above equations can then be defined epidemiologically as follows:
<table-wrap id="T4" position="anchor" orientation="portrait"><table frame="void" rules="none"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><tbody><tr><td align="left" valign="top" rowspan="1" colspan="1"><inline-formula><mml:math display="inline" id="M26"><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></td><td align="left" valign="top" rowspan="1" colspan="1">Number of new infections at time <italic>t</italic></td></tr><tr><td align="left" valign="top" rowspan="1" colspan="1"><inline-formula><mml:math display="inline" id="M27"><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>μ</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula></td><td align="left" valign="top" rowspan="1" colspan="1">Number of new deaths among susceptible persons at time <italic>t</italic></td></tr><tr><td align="left" valign="top" rowspan="1" colspan="1"><inline-formula><mml:math display="inline" id="M28"><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>μ</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula></td><td align="left" valign="top" rowspan="1" colspan="1">Number of new deaths among infected persons at time <italic>t</italic></td></tr></tbody></table></table-wrap>
</p>
                <p id="P18">As evident from the above equations and the generalized formulation in <xref rid="SD1" ref-type="supplementary-material">Appendix 1a</xref>, compartmental models do not simulate persons and their contacts individually, resulting in the assumption of random-mixing between individuals.</p>
              </sec>
              <sec id="S4">
                <label>2.2</label>
                <title>Overview of current agent-based network modeling (ABNM) simulation technique</title>
                <p id="P19">In ABNM, every person in the population is simulated at the individual-level, and the contacts between them are represented as links using network modeling. Each person is assigned a disease state, which is updated every time-step using individual-level features that influence disease state. For the simplest SIR epidemic structure, a person would be in one of S (susceptible), I (infected), or R(removed) state. Every time-step, it is determined if a susceptible person <italic>j</italic> would become newly infected (change from S to I) using the inverse of a Bernoulli distribution <inline-formula><mml:math display="inline" id="M29"><mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>c</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where, <italic>p</italic>= probability of transmission per susceptible-infected contact (same as in compartmental model), <inline-formula><mml:math display="inline" id="M30"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>c</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> = number of infected contacts of susceptible person <italic>j</italic> (determined individually for each person using the contact network), and <inline-formula><mml:math display="inline" id="M31"><mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mtext> </mml:mtext><mml:mi>U</mml:mi><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mi>o</mml:mi><mml:mo>/</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Similarly, it is determined if a person would change from S to R or I to R based on probabilities of natural deaths or disease-related deaths, respectively. The overall epidemic is represented as the proportion of people in each state.</p>
              </sec>
              <sec id="S5">
                <label>2.3</label>
                <title>Overview of current network generation algorithms for ABNM</title>
                <p id="P20">In ABNM, the network of contacts is generated prior to the epidemic simulation using network generation algorithms. The key purpose of network generation algorithms is to generate networks whose properties, e.g., degree distribution, match the properties observed in real world networks. In the context of a network, we define a <italic>node</italic> as an individual person, and an <italic>edge</italic> between two nodes as a contact between the two persons, say, representing sexual or needle-sharing partners in the case of HIV. The <italic>degree</italic> (<italic>k</italic>) of a node is the number of edges or links the node has with other nodes. The <italic>degree distribution</italic> of the network is the probability distribution of node degree. The type of distribution is dependent on the network, here we focus on scale-free networks where degree distribution follows a power law, [<xref rid="R23" ref-type="bibr">23</xref>] and thus the probability that a node has degree <italic>k</italic> (represented as <italic>P</italic>(<italic>k</italic>)) can be written as
<disp-formula id="FD4"><mml:math display="block" id="M32"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></disp-formula>
where, the decay-coefficient <inline-formula><mml:math display="inline" id="M33"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>log</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>log</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, <italic>n</italic><sub><italic>k</italic></sub> = number of nodes with degree <italic>k</italic>, Δ is the gradient, and <italic>C</italic> is a normalizing constant; for a given network, λ is a constant, making it a ‘scale-free’ network. The area of network science presents multiple algorithms for generating different types of networks. An algorithm commonly used for generating scale-free networks is the Barabási-Albert preferential attachment algorithm. [<xref rid="R19" ref-type="bibr">19</xref>, <xref rid="R28" ref-type="bibr">28</xref>]</p>
              </sec>
              <sec id="S6">
                <label>2.4</label>
                <title>Proposed agent-based evolving network modeling (ABENM) simulation technique</title>
                <p id="P21">The newly developed agent-based evolving network modeling (ABENM) simulation technique combines the above theories of compartmental modeling and ABNM techniques. Specifically, we model infected persons and their immediate contacts as a network defined by the following parameters.</p>
                <table-wrap id="T5" position="anchor" orientation="portrait">
                  <table frame="void" rules="none">
                    <colgroup span="1">
                      <col align="left" valign="middle" span="1"/>
                      <col align="left" valign="middle" span="1"/>
                    </colgroup>
                    <tbody>
                      <tr>
                        <td align="left" valign="top" rowspan="1" colspan="1">
                          <italic>A<sub>t</sub></italic>
                        </td>
                        <td align="left" valign="top" rowspan="1" colspan="1">a static adjacency matrix with dynamically changing size <italic>Q</italic><sub><italic>t</italic></sub> × <italic>Q</italic><sub><italic>t</italic></sub>, where <italic>Q</italic><sub><italic>t</italic></sub> is the number of people modeled at the individual-level (i.e., only infected persons and their immediate contacts) at time <italic>t</italic>, and represents longterm contacts, e.g., for HIV, <inline-formula><mml:math display="inline" id="M34"><mml:mrow><mml:munder><mml:mo mathsize="small">∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> would represent the number of lifetime partnerships of person <italic>i</italic>,</td>
                      </tr>
                      <tr>
                        <td align="left" valign="top" rowspan="1" colspan="1">
                          <italic>V<sub>t</sub></italic>
                        </td>
                        <td align="left" valign="top" rowspan="1" colspan="1">a dynamic adjacency matrix of dynamically changing size <italic>Q</italic><sub><italic>t</italic></sub> × <italic>Q</italic><sub><italic>t</italic></sub>, i.e., <italic>V</italic><sub><italic>t</italic>, <italic>ij</italic></sub> = 1 if contacts between <italic>i</italic> and <italic>j</italic> are active at time <italic>t</italic>, and 0 otherwise, and <inline-formula><mml:math display="inline" id="M35"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, e.g., <italic>A</italic><sub><italic>t</italic>,<italic>ij</italic></sub> = 1 if <italic>i</italic> and <italic>j</italic> are needle sharing contacts, but <italic>V</italic><sub><italic>t</italic>, <italic>ij</italic></sub> = 0 is there was no needle sharing at time step <italic>t</italic>,</td>
                      </tr>
                      <tr>
                        <td align="left" valign="top" rowspan="1" colspan="1">
                          <italic>h</italic>
                          <sub>t</sub>
                        </td>
                        <td align="left" valign="top" rowspan="1" colspan="1">a row vector of size <italic>Q</italic><sub><italic>t</italic></sub> with each element <italic>j</italic> taking a binary value, 1 if person <italic>j</italic> is infected and 0 otherwise,</td>
                      </tr>
                      <tr>
                        <td align="left" valign="top" rowspan="1" colspan="1">
                          <italic>m<sub>t</sub></italic>
                        </td>
                        <td align="left" valign="top" rowspan="1" colspan="1">a row vector of size <italic>Q</italic><sub><italic>t</italic></sub> with each element <italic>j</italic> taking a binary value, of 1 if person <italic>j</italic> is deceased and 0 otherwise,</td>
                      </tr>
                      <tr>
                        <td align="left" valign="top" rowspan="1" colspan="1">
                          <italic>u</italic>
                          <sub>t</sub>
                        </td>
                        <td align="left" valign="top" rowspan="1" colspan="1">a unit row vector of size <italic>Q</italic><sub><italic>t</italic></sub>, and</td>
                      </tr>
                      <tr>
                        <td align="left" valign="top" rowspan="1" colspan="1">
                          <italic>c<sub>t</sub></italic>
                        </td>
                        <td align="left" valign="top" rowspan="1" colspan="1">a row vector of size <italic>N</italic> with the value of element <italic>j</italic> equal to the number of active infected contacts of person <italic>j</italic> if <italic>j</italic> is susceptible and alive and zero otherwise, calculated as <inline-formula><mml:math display="inline" id="M36"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mtext> </mml:mtext><mml:mo>∘</mml:mo></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mtext> </mml:mtext><mml:mo>∘</mml:mo></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:msubsup><mml:mi>h</mml:mi><mml:mi>t</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, where <italic>T</italic> denotes transpose and ° is elementary-wise multiplication.</td>
                      </tr>
                    </tbody>
                  </table>
                </table-wrap>
                <p id="P22">One, at any time-step <italic>t</italic>, a susceptible node (say <italic>j</italic>) in the network becomes infected if <inline-formula><mml:math display="inline" id="M37"><mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. Upon determining nodes that become newly infected, their contact structure is generated by incrementing <italic>Q</italic><sub><italic>t</italic></sub> by the number of new infections, i.e., <inline-formula><mml:math display="inline" id="M38"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mo mathsize="small">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and updating all elements of the network described above, including <italic>A</italic><sub><italic>t</italic></sub>, <italic>V</italic><sub><italic>t</italic></sub>, and <italic>c</italic><sub><italic>t</italic></sub> by applying the ECNA (described in 2.5) to determine ‘who’ the contacts are of the newly infected nodes. Susceptible persons who are not contacts of infected persons would be tracked as in compartmental model, <xref rid="FD5" ref-type="disp-formula">(4)</xref> below, and the overall epidemic projections can be written as follows, by replacing <italic>s</italic><sub><italic>t</italic> − 1</sub><italic>pc</italic><sub><italic>t</italic> − 1</sub><italic>i</italic><sub><italic>t</italic> − 1</sub> in <xref rid="FD1" ref-type="disp-formula">(1)</xref> and <xref rid="FD2" ref-type="disp-formula">(2)</xref> with <inline-formula><mml:math display="inline" id="M39"><mml:mrow><mml:mfrac><mml:mrow><mml:munder><mml:mo mathsize="small">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mtext>N</mml:mtext></mml:mfrac></mml:mrow></mml:math></inline-formula> in <xref rid="FD5" ref-type="disp-formula">(4)</xref> and <xref rid="FD6" ref-type="disp-formula">(5)</xref> and <italic>i</italic><sub><italic>t</italic> −1</sub> in <xref rid="FD2" ref-type="disp-formula">(2)</xref> and <xref rid="FD3" ref-type="disp-formula">(3)</xref> with <inline-formula><mml:math display="inline" id="M40"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msubsup><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow><mml:mi>N</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula> in <xref rid="FD6" ref-type="disp-formula">(5)</xref> and <xref rid="FD7" ref-type="disp-formula">(6)</xref>. More detailed derivations of ABENM from ABNM are in <xref rid="SD1" ref-type="supplementary-material">Appendix 1</xref>.</p>
                <disp-formula id="FD5">
                  <label>(4)</label>
                  <mml:math display="block" id="M41">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>s</mml:mi>
                        <mml:mi>t</mml:mi>
                      </mml:msub>
                      <mml:mo>=</mml:mo>
                      <mml:msub>
                        <mml:mi>s</mml:mi>
                        <mml:mrow>
                          <mml:mi>t</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>−</mml:mo>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:munder>
                            <mml:mo mathsize="small">∑</mml:mo>
                            <mml:mrow>
                              <mml:mi>j</mml:mi>
                              <mml:mo>=</mml:mo>
                              <mml:mn>1</mml:mn>
                              <mml:mo>:</mml:mo>
                              <mml:msub>
                                <mml:mi>Q</mml:mi>
                                <mml:mrow>
                                  <mml:mi>t</mml:mi>
                                  <mml:mo>−</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                          </mml:munder>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mi>F</mml:mi>
                              <mml:mrow>
                                <mml:mo>−</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msup>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mrow>
                                <mml:mn>1</mml:mn>
                                <mml:mo>−</mml:mo>
                                <mml:msup>
                                  <mml:mrow>
                                    <mml:mrow>
                                      <mml:mo>(</mml:mo>
                                      <mml:mrow>
                                        <mml:mn>1</mml:mn>
                                        <mml:mo>−</mml:mo>
                                        <mml:mi>p</mml:mi>
                                      </mml:mrow>
                                      <mml:mo>)</mml:mo>
                                    </mml:mrow>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mi>c</mml:mi>
                                      <mml:mrow>
                                        <mml:mi>t</mml:mi>
                                        <mml:mo>−</mml:mo>
                                        <mml:mn>1</mml:mn>
                                        <mml:mo>,</mml:mo>
                                        <mml:mi>j</mml:mi>
                                      </mml:mrow>
                                    </mml:msub>
                                  </mml:mrow>
                                </mml:msup>
                              </mml:mrow>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mtext>N</mml:mtext>
                      </mml:mfrac>
                      <mml:mo>−</mml:mo>
                      <mml:msub>
                        <mml:mi>s</mml:mi>
                        <mml:mrow>
                          <mml:mi>t</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:msub>
                      <mml:msub>
                        <mml:mi>μ</mml:mi>
                        <mml:mi>S</mml:mi>
                      </mml:msub>
                    </mml:mrow>
                  </mml:math>
                </disp-formula>
                <disp-formula id="FD6">
                  <label>(5)</label>
                  <mml:math display="block" id="M42">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>i</mml:mi>
                        <mml:mi>t</mml:mi>
                      </mml:msub>
                      <mml:mo>=</mml:mo>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>h</mml:mi>
                            <mml:mrow>
                              <mml:mi>t</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                          <mml:msubsup>
                            <mml:mi>u</mml:mi>
                            <mml:mi>t</mml:mi>
                            <mml:mi>T</mml:mi>
                          </mml:msubsup>
                          <mml:mo>+</mml:mo>
                          <mml:munder>
                            <mml:mo mathsize="small">∑</mml:mo>
                            <mml:mrow>
                              <mml:mi>j</mml:mi>
                              <mml:mo>=</mml:mo>
                              <mml:mn>1</mml:mn>
                              <mml:mo>:</mml:mo>
                              <mml:msub>
                                <mml:mi>Q</mml:mi>
                                <mml:mrow>
                                  <mml:mi>t</mml:mi>
                                  <mml:mo>−</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                          </mml:munder>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mi>F</mml:mi>
                              <mml:mrow>
                                <mml:mo>−</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msup>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mrow>
                                <mml:mn>1</mml:mn>
                                <mml:mo>−</mml:mo>
                                <mml:msup>
                                  <mml:mrow>
                                    <mml:mrow>
                                      <mml:mo>(</mml:mo>
                                      <mml:mrow>
                                        <mml:mn>1</mml:mn>
                                        <mml:mo>−</mml:mo>
                                        <mml:mi>p</mml:mi>
                                      </mml:mrow>
                                      <mml:mo>)</mml:mo>
                                    </mml:mrow>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mi>c</mml:mi>
                                      <mml:mrow>
                                        <mml:mi>t</mml:mi>
                                        <mml:mo>−</mml:mo>
                                        <mml:mn>1</mml:mn>
                                        <mml:mo>,</mml:mo>
                                        <mml:mi>j</mml:mi>
                                      </mml:mrow>
                                    </mml:msub>
                                  </mml:mrow>
                                </mml:msup>
                              </mml:mrow>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:msub>
                              <mml:mi>μ</mml:mi>
                              <mml:mi>I</mml:mi>
                            </mml:msub>
                            <mml:msub>
                              <mml:mi>h</mml:mi>
                              <mml:mrow>
                                <mml:mi>t</mml:mi>
                                <mml:mo>−</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                            <mml:msubsup>
                              <mml:mi>u</mml:mi>
                              <mml:mi>t</mml:mi>
                              <mml:mi>T</mml:mi>
                            </mml:msubsup>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:math>
                </disp-formula>
                <disp-formula id="FD7">
                  <label>(6)</label>
                  <mml:math display="block" id="M43">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>r</mml:mi>
                        <mml:mi>t</mml:mi>
                      </mml:msub>
                      <mml:mo>=</mml:mo>
                      <mml:msub>
                        <mml:mi>r</mml:mi>
                        <mml:mrow>
                          <mml:mi>t</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>+</mml:mo>
                      <mml:msub>
                        <mml:mi>s</mml:mi>
                        <mml:mrow>
                          <mml:mi>t</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:msub>
                      <mml:msub>
                        <mml:mi>μ</mml:mi>
                        <mml:mi>S</mml:mi>
                      </mml:msub>
                      <mml:mo>+</mml:mo>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>μ</mml:mi>
                            <mml:mi>I</mml:mi>
                          </mml:msub>
                          <mml:msub>
                            <mml:mi>h</mml:mi>
                            <mml:mrow>
                              <mml:mi>t</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                          <mml:msubsup>
                            <mml:mi>u</mml:mi>
                            <mml:mi>t</mml:mi>
                            <mml:mi>T</mml:mi>
                          </mml:msubsup>
                        </mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:math>
                </disp-formula>
                <p id="P23">Without loss of generality, we can extend this ABENM structure developed for SIR on a closed population to other epidemic structures, incorporate heterogeneity, and model an open population. As demonstration, we present ABENM for one additional epidemic structure, one SIR structure with heterogeneity, and an SIR model with births and deaths, in <xref rid="SD1" ref-type="supplementary-material">Appendix 2a</xref>, <xref rid="SD1" ref-type="supplementary-material">2b</xref> and <xref rid="SD1" ref-type="supplementary-material">2c</xref>, respectively. A step-by-step algorithm for simulating the epidemic trajectories is outlined in <xref rid="T1" ref-type="table">Table 1</xref>. Step 4 of the ABENM simulation in <xref rid="T1" ref-type="table">Table 1</xref> uses a new network generation method which we describe next.</p>
              </sec>
              <sec id="S7">
                <label>2.5</label>
                <title>Evolving contact network algorithm, a new network generation method for ABENM (step 4 of ABENM in <xref rid="T1" ref-type="table">Table 1</xref>)</title>
                <p id="P24">The main objective of network generation methods, generally in the area of network science, is to determine who should be linked to who based on their degrees, such that the degree distribution of the resulting network matches that of the network it is replicating. The main objective of a network generation method for the ABENM is to determine the degree of the contacts of the newly infected persons, thus it is the main method that ‘evolves’ the network. We will refer to this network generation method as the ‘evolving contact network algorithm (ECNA)’. Before presenting the ECNA, we first discuss current network generation algorithms and its inapplicability to ABENM, and some relevant network properties that inform the development of the ECNA.</p>
                <p id="P25">Current methods, such as the commonly used preferential attachment (PA) algorithm [<xref rid="R28" ref-type="bibr">28</xref>] for generation of scale-free networks cannot be used for the ECNA network generation. The PA algorithm starts with a small, say <italic>m</italic><sub>0</sub>, number of initial connected nodes. Then, new nodes are added to the network one at a time by connecting them to <italic>m</italic> ≤ <italic>m</italic><sub>0</sub> existing nodes, <italic>m</italic> is the minimum degree of the network. This is continued until all nodes of the population are added to the network. The probability, <italic>p</italic>(<italic>k</italic><sub><italic>i</italic></sub>), that a new node will connect to node <italic>i</italic> depends on the degree of the node <italic>k</italic><sub><italic>i</italic></sub>, i.e., <inline-formula><mml:math display="inline" id="M44"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:munder><mml:mo mathsize="small">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, where <italic>N</italic> is the number of nodes in the network at that point. In this method, the degree of each node is evolving as new nodes are added and ‘preference’ of attachment goes to nodes that have higher contacts.</p>
                <p id="P26">On the other hand, for the ABENM simulation, the objective of a network generation algorithm is to determine the expected degree of the immediate node neighbors of a newly infected person. The ABENM starts with an infected node and its immediate node neighbors (both infected and susceptible contacts) in the network. If there is a transmission from an infected node to their susceptible node neighbor, the algorithm should determine the expected degree of the immediate node neighbors’ of the newly infected node.</p>
                <p id="P27">For non-random graphs such as scale-free networks, the expected degree of node neighbors cannot be directly drawn from the probability mass function of the network degree distribution. [<xref rid="R29" ref-type="bibr">29</xref>] This is because of degree correlations between node neighbors, i.e., the degree of two nodes who are connected (node neighbors) are not independent of each other but are correlated. Degree-correlation is usually measured as the probability that a randomly chosen neighbor of a node of degree <italic>k</italic> will have degree <italic>l</italic>, denoted as <italic>Pr</italic>(<italic>L</italic> = <italic>l</italic>| <italic>K</italic> = <italic>k</italic>). The conditional degree distribution <italic>Pr</italic>(<italic>L</italic> = <italic>l</italic>| <italic>k</italic>), is the probability distribution of <italic>L</italic> given specific <italic>k</italic>, i.e., the distribution of the degree of all nodes that are connected to a node of degree <italic>k</italic>. This distribution, in several real-world networks, is found to not follow the network degree distribution but be dependent on <italic>k</italic> [<xref rid="R29" ref-type="bibr">29</xref>] i.e., <italic>Pr</italic>(<italic>L</italic> = <italic>l</italic>| <italic>K</italic> = <italic>k</italic>) ≠ Pr(<italic>L</italic> = <italic>l</italic>). Degree-correlations are a well-studied area in graph theory from the perspective of understanding network properties such as assortative or disassortative mixing, or studying shortest paths or all paths between any two nodes. Fotouhi and Rabbat, 2013, [<xref rid="R29" ref-type="bibr">29</xref>] presented an analytical model for this conditional distribution generally for scale-free networks, and is summarized in <xref rid="SD1" ref-type="supplementary-material">Appendix 1c</xref>.</p>
                <sec id="S15">
                  <title>Conditional probability distributions derived from general scale-free networks (non-contagion) are not suitable for the ECNA</title>
                  <p id="P28">We hypothesize that conditional distributions derived for general scale-free networks cannot be used for determining the degree of the neighbors of the newly infected nodes in the ECNA network generation, which we present as Remarks 2 and 3 in <xref rid="SD1" ref-type="supplementary-material">Appendix 3</xref>, and provide an intuitive discussion here. The analytical expression for the conditional probability distribution derived on a general scale-free network would be representative of the distribution of degree of node neighbors of a randomly chosen set of nodes in the network. Empirically, the data for this can be generated by starting with one node, collecting their degree and the degree of each of their neighbors, and repeating this for all nodes. Therefore, if we consider nodes A and B in an undirected graph, the degree of A given degree of B and the vice-versa, i.e., the degree of B given the degree of A, are both incorporated into the estimation of the probability mass function. However, in the case of epidemics, the chance of A infecting B versus B infecting A would not be equal but vary as a function of the degree of A and B and the prevalence (proportion of population infected) at that time-point, thus creating directionality in flow (epidemic path) and making the chance of infection non-stationary as the prevalence changes over time, and should be thus considered in estimation of conditional distributions for ECNA. The above reasoning also drives the concept that highly connected nodes get infected sooner than nodes with fewer connections, which has been studied through the use of shortest paths and centrality measures. However, though the reasoning is similar, the expression for the conditional distribution of the degree of node neighbors considering the directionality and non-stationarity generated because of the stochasticity of an epidemic has not been evaluated. Therefore, we conducted numerical experiments to present our hypothesis, which we present in the next section. We refer to general scale-free networks as static non-contagion networks, and networks in the context of studying epidemic paths as contagion networks.</p>
                </sec>
                <sec id="S8">
                  <label>2.5.1</label>
                  <title>Numerical testing of degree correlations in networks along epidemic paths</title>
                  <p id="P29">We compared theoretical estimates of <italic>Pr</italic>{<italic>L</italic> = <italic>l</italic>| <italic>k</italic>} with numerical estimations, with theoretical estimates calculated using the expression derived in [<xref rid="R29" ref-type="bibr">29</xref>] (presented in <xref rid="SD1" ref-type="supplementary-material">Appendix 1c</xref>). Numerical estimations were conducted through ABNM simulations, of the type discussed in <xref rid="S4" ref-type="sec">Section 2.2</xref>. and <xref rid="S5" ref-type="sec">2.3</xref>, as follows. We used the <italic>barabasi.game</italic> function in R software to generate scale-free networks. By varying the function input for minimum degree (<italic>m</italic>) between 1 to 5, and varying population sizes (<italic>N</italic>) of 1000 and 10,000 (<italic>N</italic> and <italic>m</italic> are the inputs to the <italic>barabasi.game</italic> function to generate networks of different λ) we generated scale-free networks of λ between 2 to 3, which is the typical range used for scale-free networks [<xref rid="R28" ref-type="bibr">28</xref>]. We generated 100 simulations for each value of <italic>m</italic>. We initiated the simulation with a small number of infected nodes, and at every time step simulated transmission from an infected node to its susceptible neighbors with some probability, thus generating epidemic paths and gathering the degree of every pair of node neighbors on these paths. Specifically, for every newly infected person with degree <italic>K</italic> = <italic>k</italic>, we updated the counter <inline-formula><mml:math display="inline" id="M45"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, which is the number of neighbors with degree <italic>l</italic>. We estimated the distributions <inline-formula><mml:math display="inline" id="M46"><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:munder><mml:mo mathsize="small">∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> for every <italic>k</italic>, <italic>l</italic> combination, where <italic>M</italic> is the maximum network degree, under the following 3 scenarios:
<list list-type="order" id="L1"><list-item><p id="P30">Non-contagion networks: This scenario is formulated to estimate degree correlations in non-contagion networks, by moving through all paths. This is done by setting the probability of transmission as 1, such that the probability of transmission to any node connected to at least one infected neighbor would be 1. This setting counts all neighbors of the newly infected node in updating the counter <inline-formula><mml:math display="inline" id="M47"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mtext> </mml:mtext><mml:mo stretchy="false">|</mml:mo><mml:mtext> </mml:mtext><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>.</p></list-item><list-item><p id="P31">Static contagion networks: This scenario is formulated to estimate degree correlations along epidemic paths when the contact network is static. Epidemic paths are generated by setting 0 &lt; <italic>p</italic> &lt; 1 and calculating the probability of transmission for a node <italic>j</italic> using a Bernoulli model as <inline-formula><mml:math display="inline" id="M48"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:munder><mml:mo mathsize="small">∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, where <italic>d</italic><sub><italic>j</italic></sub>= the number of contacts of node <italic>j</italic> and <italic>h</italic><sub><italic>q</italic></sub> = 1 if the <italic>q</italic><sup><italic>th</italic></sup> contact of node <italic>j</italic> is infected. This setting replicates a static contact network as all contacts of an infected node are active and thus transmission is directly proportional to a node’s degree (corresponds to model in Remark 2 in <xref rid="SD1" ref-type="supplementary-material">Appendix 3</xref>). This setting counts only susceptible neighbors of the newly infected node in updating the counter <inline-formula><mml:math display="inline" id="M49"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mtext> </mml:mtext><mml:mo stretchy="false">|</mml:mo><mml:mtext> </mml:mtext><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>.</p></list-item><list-item><p id="P32">Dynamic contagion networks: This scenario is formulated to estimate degree correlations along epidemic paths when the contact network is dynamic. Epidemic paths are generated by setting 0 &lt; <italic>p</italic> &lt; 1 and calculating the probability of transmission for a node <italic>j</italic> using a Bernoulli model as <inline-formula><mml:math display="inline" id="M50"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:munder><mml:mo mathsize="small">∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, where <italic>d</italic><sub><italic>j</italic></sub>= the number of contacts of node <italic>j</italic>, <italic>h</italic><sub><italic>q</italic></sub> = 1 if the <italic>q</italic><sup><italic>th</italic></sup> contact of node <italic>j</italic> is infected and 0 otherwise, <italic>d</italic><sub><italic>q</italic></sub> is the degree of the <italic>q</italic><sup><italic>th</italic></sup> contact, and <inline-formula><mml:math display="inline" id="M51"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mtext> </mml:mtext><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mtext> </mml:mtext><mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>U</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mtext> </mml:mtext><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, and is 0 other-wise. This assumes that on average only one contact per person is active at any time and the chance of that active contact being node <italic>j</italic> is <inline-formula><mml:math display="inline" id="M52"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. This setting thus replicates a dynamic contact network, where contacts are not active at all times. Note that in this network, the chance of transmission is directly proportional to its degree and inversely proportional to its neighbors’ degrees (see Remark 3 in <xref rid="SD1" ref-type="supplementary-material">Appendix 3</xref>). An example of a dynamic contact network would be needle sharing contacts among injecting drug users, where a person might share needles only on some days and with different people in their contact network. This setting counts only susceptible neighbors of the newly infected node in updating the counter <inline-formula><mml:math display="inline" id="M53"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>.</p></list-item></list></p>
                  <p id="P33"><xref rid="F2" ref-type="fig">Figure 2</xref> plots the conditional distributions for networks of size 1000 with different values of minimum degree and a maximum degree of 64. The characteristic feature of power law distributions is that a small number of nodes will have a large degree and most nodes have a small degree. Observing the degree distributions for the networks generated, for networks of sizes 1000 and 10,000 under different values of minimum degree, fewer than 15% of nodes have degree greater than 8 (see <xref rid="SD1" ref-type="supplementary-material">Appendix 4</xref>). Therefore, as typically done for scale-free networks, we first plot the conditional distributions calculated using binary logarithmic binning of degree (left-side plots of <xref rid="F2" ref-type="fig">Fig. 2</xref>), and to highlight key features at lower degrees, plot conditional distributions using unit binning of degree (right-side plots of <xref rid="F2" ref-type="fig">Fig. 2</xref>). Specifically, the left-side graphs of <xref rid="F2" ref-type="fig">Fig. 2</xref> plots the normalized conditional distributions as <inline-formula><mml:math display="inline" id="M54"><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:msup><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:msup></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:msup><mml:mo stretchy="false">|</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:munder><mml:mo mathsize="small">∑</mml:mo><mml:mi>l</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:msup><mml:mo stretchy="false">|</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math display="inline" id="M55"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:msup><mml:mo stretchy="false">|</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the number of occurrences of neighbors with degree in ‘bin 2<sup><italic>i</italic></sup>’ given degree of newly infected person is in ‘bin 2<sup><italic>j</italic></sup>’, where bin <inline-formula><mml:math display="inline" id="M56"><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:msup><mml:mtext> </mml:mtext><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mtext> </mml:mtext><mml:mi>i</mml:mi><mml:mtext> </mml:mtext><mml:mi>ϵ</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mtext> </mml:mtext><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mtext> </mml:mtext><mml:msup><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:msup><mml:mtext> </mml:mtext><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mtext> </mml:mtext><mml:mi>i</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. The right-hand side plots the same results with unit binning for degrees 1 to 8. There are multiple observations from this figure. First, as seen in the left-hand side subplots of <xref rid="F2" ref-type="fig">Fig. 2</xref>, the theoretical estimates [<xref rid="R29" ref-type="bibr">29</xref>] (<xref rid="SD1" ref-type="supplementary-material">Appendix 1c</xref>) are a better prediction of degree correlations in scenario 1 (non-contagion network), as points lie closer to the 45 degree reference line compared to scenarios 2 (Static contagion network) and 3 (Dynamic contagion network). Second, the margin of error in scenarios 2 and 3 are inversely proportion to the degree, with degree ≤2<sup>3</sup> having the largest errors. Third, degree correlations are different in static contagion networks compared to dynamic contagion networks. Results from networks of size 10,000 have similar observations (see <xref rid="SD1" ref-type="supplementary-material">Appendix 4</xref>).</p>
                </sec>
                <sec id="S9">
                  <label>2.5.2</label>
                  <title>Development of an evolving contact network algorithm (ECNA)</title>
                  <p id="P34">The proposed evolving contact network algorithm is outlined in <xref rid="T2" ref-type="table">Table 2</xref>. It was developed based on the findings from the previous sections that, derivation of conditional distributions of degree of neighboring nodes <inline-formula><mml:math display="inline" id="M57"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> on ‘epidemic’ paths, could help determine the degree of the newly infected agents’ contacts. However, as currently known methods for estimating the conditional distributions are not suitable for stochastic contagion networks a new method is necessary. Considering the complexity of the stochastic process defining epidemic paths, developing an analytic expression for <inline-formula><mml:math display="inline" id="M58"><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is challenging, therefore we fit a non-linear neural network model for estimations of <inline-formula><mml:math display="inline" id="M59"><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> as below.</p>
                  <sec id="S10">
                    <title>Non-linear neural network model for estimating degree correlations in contagion networks</title>
                    <p id="P35">By training on numerical data, we developed a neural network prediction model, which is a model-free non-linear regression for estimation of conditional distributions for degree of neighbors on epidemic paths in dynamic contagion networks. We chose neural network instead of regression because the analytical equation of the conditional probabilities are not known, and difficult to derive without the use of the adjacency matrix of the full network, which are infeasible for the proposed ABENM structure. We trained the neural network using the data generated for the numerical testing of Remarks 2 and 3 under the dynamic contagion networks in the previous section. Specifically, on the numerical data for conditional probabilities <inline-formula><mml:math display="inline" id="M60"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:munder><mml:mo mathsize="small">∑</mml:mo><mml:mi>l</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> generated using ABNM simulations, where, <italic>z</italic><sub><italic>k</italic>, <italic>l</italic></sub> was a counter in the simulation that kept track of the total number of susceptible contacts with degree <italic>l</italic> for newly infected persons with degree <italic>k</italic>, for every <italic>k</italic>, <italic>l</italic> combination. This conditional probability <italic>p</italic>(<italic>l</italic>| <italic>k</italic>) was set as the response variable and the following five inputs as the independent variables: the degree of the newly infected agent <italic>k,</italic> the degree of the susceptible neighbor of the newly infected agent <italic>l</italic>, the minimum degree of the network <italic>m</italic>, the percent of the population that is infected (to account for the changes in epidemic paths over time), and the size of the full network. The neural network was trained, in the R software, on data from 15 different scale-free networks. The data set included data from networks of size (<italic>N</italic>) 1000, 5000, and 10,000, and minimum network degree (<italic>m</italic>) of 1, 2, 3, 4, and 5, which are the inputs for generating the scale-free networks in R using <italic>barabasi.game</italic>, and percent infected at 5%, 13%, 25%, 35%, 50%, 60%, and 90%.</p>
                    <p id="P36">The neural net (NN) had one hidden layer and the number of hidden nodes was a hyperparameter. Tuning of the hyperparameter and validation of the NN was conducted as follows. The scale-free networks were split into test and train networks, all networks except {<italic>N</italic> = 1000, <italic>m</italic> = 1}, {<italic>N</italic> = 5000, <italic>m</italic> = 2}, and {<italic>N</italic> = 10000, <italic>m</italic> = 4}, were set as train networks. Train networks were further split into 60% and 40% train and test data, respectively, through random selection. Only train data of train networks were used in NN prediction. The hyperparameter was iteratively set to values between 5 and 14 and, under each value, the corresponding mean square error (MSE) between predicted and actual were estimated for test and train data of train networks and test networks. While the MSE decreased in the train data of train networks as the number of hidden nodes increased, on the test data and test networks, MSE first decreased and then started to increase after 8 hidden nodes (see graph in <xref rid="SD1" ref-type="supplementary-material">Appendix 5</xref>). Therefore, we set the NN hyperparameter value at 8 hidden nodes, and used the corresponding NN model in the ECNA. Comparison of neural network predictions with actual estimates on the test data sets are presented in <xref rid="SD1" ref-type="supplementary-material">Appendix 5</xref>.</p>
                    <p id="P37">When using the neural network model in ABENM, for any given value of <italic>k</italic>, the conditional probabilities for all values of <italic>l</italic> were predicted and then normalized to add to 1 prior to use in the simulation.</p>
                  </sec>
                </sec>
              </sec>
              <sec id="S11">
                <label>2.6</label>
                <title>Validation approach and metrics</title>
                <p id="P38">Our validation for the newly developed simulation technique, ABENM, is to compare how well it replicates the disease predictions from an ABNM. Therefore, the key validation metric is disease prevalence (% of population infected) as a function of time, a measure of the epidemic trajectory. For ABENM simulations, we evaluated two ECNA methods that varied in their estimation of the conditional degree distributions.</p>
                <disp-quote id="Q1">
                  <p id="P39"><underline>ECNA Method 1</underline>: Used the theoretical estimations for degree correlations between neighbors from [<xref rid="R29" ref-type="bibr">29</xref>] (see equation in <xref rid="SD1" ref-type="supplementary-material">Appendix 1c</xref>).</p>
                  <p id="P40"><underline>ECNA Method 2</underline>: Used neural network predictions for degree correlations between neighbors on dynamic contagion networks</p>
                </disp-quote>
                <p id="P41">While comparing ECNA Method 2 with ABNM helps validate the newly developed algorithms, comparing with ECNA Method 1 helps understand the change in prediction errors compared to using the theoretical degree correlations. Instead of limiting our analyses to a specific disease, to evaluate the robustness of ABENM as a general alternative for studying propagation on scale-free networks, we conducted the numerical analyses for a range of assumptions representative of a wide range of diseases. Specifically, we ran ABENM (with ECNA Methods 1 and 2) and ABNM under multiple combinations of network size (<italic>N</italic>), network minimum degree (<italic>m</italic>), transmission probability per contact (<italic>p</italic>), initial prevalence (<italic>i</italic>), epidemic profiles (susceptible-infected (SI), susceptible-infected-recovered (SIR), and susceptible-infected-susceptible (SIS)), and recovery rates for SIS and SIR (<italic>r</italic>). Network size and minimum degree are input parameters for the preferential attachment algorithm. Minimum degree indirectly sets the scale-free network parameter (λ), and thus the resulting probability distribution for the number of contacts per person. Varying this feature could be representative of modeling different types of contact networks, i.e., epidemiologically different modes of transmission, e.g., sexual contacts, needle sharing contacts, or social contacts for spread of respiratory infections. Or be representative of modeling populations with different behavior, e.g., distribution of the number of sexual contacts among heterosexuals versus men who have sex with men, or distribution of social contacts in a university population versus in a general population. Static transmission probability per contact uses one value for the full simulation and is representative of the epidemiologic measure of infectiousness per contact. Varying this feature would be testing different modes of transmission for the same disease, e.g., needle sharing has a higher chance of HIV transmission than sexual contact, or testing different diseases, e.g., HIV, human papilloma virus, Hepatitis B or C all spread on same contact networks but have different infectiousness. Using a random transmission probability per contact will vary the infectiousness of an individual over time and between individuals at any time-step. Therefore, this feature could represent disease progression or intervention status that could alter infectiousness and change over time for each individual, or represent heterogeneity in individual behavior, e.g., the number of needles shared with a specific contact per unit-time. Initial prevalence could represent initial status of the epidemic at the time of analyses.</p>
                <p id="P42">A SI epidemic profile, where persons once infected remain in that stage for the remaining duration, such as HIV, chronic Hepatitis B and C, and chronic TB, helps evaluate the growth of the full network. The training of the neural network was also conducted using SI to allow for the network to fully grow. However, we also applied the ECNA for simulating SIR and SIS epidemic profiles to evaluate the robustness of the method, specifically, the influence of interruptions in network evolution. In SIR, when an infected node recovers and becomes immune, the network growth of its uninfected contacts is altered as they can no longer be infected by the recovered node (but not necessarily terminated as they may have other contacts who could be infected). In SIS, when an infected node recovers, the alteration is similar to SIR but temporary as the recovered node can become re-infected. The rate of recovery would be the key parameter influencing the frequency of interruptions in SIR and SIS.</p>
                <p id="P43">We specifically evaluated <italic>N</italic> ∈ {1000, 10000, 50000}, <italic>m</italic> ∈ { 1, 2,.., 5 }, <italic>p</italic> ∈ {0.01 ( <italic>static</italic> ), 0.1( <italic>static</italic> ), <italic>and U</italic>[0,0.1](<italic>uniform random</italic>)}, <italic>i</italic> ∈ {0.005,0.01,0.028} for SI. For SIR and SIS profiles, as the outbreak would die out if the overall recovery rate is higher than the infection rate, we chose a subset of combinations that sustain the epidemic for a sufficient time, specifically, <italic>N</italic> ∈ { 10000 }, <italic>m</italic> ∈ {1, 2,.., 5}, <italic>p</italic> ∈ {0.1 (<italic>static</italic>), 0.2(<italic>static</italic>)}, <italic>i</italic> ∈ {0.01}, (<italic>r</italic> ∈ {0.017,0.033}.</p>
                <p id="P44">We generated 100 simulation runs for each combination. The initially infected nodes were randomly selected, i.e., for the ABNM, once the network was generated the nodes were randomly selected, and for the ABENM, the degree of the nodes generated in time-step 1 was randomly selected from the network degree-distribution. We present the 5th and 95th percentile confidence intervals as Results.</p>
              </sec>
            </sec>
            <sec id="S12">
              <label>3</label>
              <title>Results</title>
              <p id="P45">We first discuss results for SI. Results for disease prevalence (% of population infected), specifically the 5th and 95th percentile ranges of the 100 runs on networks with varying combinations of minimum degree (1 to 5) and probability of transmission per contact (0.1 or 0.01), keeping initial prevalence at 0.028 are presented in <xref rid="F3" ref-type="fig">Figs. 3</xref> and <xref rid="F4" ref-type="fig">4</xref> for networks of sizes 10,000 and 1000, respectively. It is observed that Method 2 outperforms Method 1 in most scenarios as hypothesized, i.e., the 5th and 95th percentile values of the 100 runs overlap more closely in ECNA Method 2 than ECNA Method 1 in most cases. The deviations in the 5th and 95th percentile values in ABENM compared to ABNM, calculated as the absolute difference in values between ABNM and ABENM divided by ABNM, are presented as prediction errors. Prediction errors are below 15% in ECNA Method 2 in all cases except when minimum degree was 1. In the networks with minimum degree of 1, the errors are less than 10% up until 50% prevalence. The prediction errors decrease as the minimum degree increases. The probability of transmission had little effect on the results. While the prediction errors fluctuated considerably in population size 1000, especially at the initial phase of the epidemic, it was more stable when the population size was 10,000. Results under different combinations of minimum degree (1 to 5) and probability of transmission per contact (0.1 and 0.01), for lower values of initial prevalence (0.01 and 0.005) are presented in <xref rid="SD1" ref-type="supplementary-material">Appendix 5</xref> and <xref rid="SD1" ref-type="supplementary-material">6</xref> for networks of sizes 10,000 and 1000, respectively. For these lower values of initial prevalence, and for networks of size 10,000, the prediction errors were similar to above in all cases except when minimum degree was 1 where the errors were unacceptably high. For networks of size 1000, as the value of initial prevalence decreased, the errors in the initial phase of the infection increased. Results using random transmission probability per contact are presented in <xref rid="SD1" ref-type="supplementary-material">Appendix 7</xref> for networks with different values of minimum degree (1 to 5), and keeping initial prevalence at 0.01 and network size at 10,000. Results for random transmission probability per contact on networks with minimum degree 2, initial prevalence at 0.005, and network size 50,000 are also presented in <xref rid="SD1" ref-type="supplementary-material">Appendix 7</xref>. Results on these networks were similar as in static transmission probability per contact, i.e., prediction errors were at most 15% when minimum degree was 2 or higher.</p>
              <p id="P46">The prediction errors in ECNA Method 2 for epidemic profiles SIR and SIS followed similar trends in the combinations evaluated as the SI profile, however, errors were higher than in SI profile. Errors were 20% or below except when the epidemic died out quickly, specifically when minimum degree was 1 and in some instances of minimum degree 2 (<xref rid="SD1" ref-type="supplementary-material">Appendix 9</xref> and <xref rid="SD1" ref-type="supplementary-material">10</xref>). However, errors in ECNA Method 2 were generally lower than in ECNA Method 1 (<xref rid="SD1" ref-type="supplementary-material">Appendix 9</xref> and <xref rid="SD1" ref-type="supplementary-material">10</xref>).</p>
            </sec>
            <sec id="S13">
              <label>4</label>
              <title>Discussion and conclusions</title>
              <p id="P47">This is a concept paper to present a new simulation modeling technique, ABENM, which combines theories from compartmental and agent-based modeling, commonly used simulation techniques in disease epidemic predictions. The motivation for this new simulation technique is to provide a computationally feasible alternative to ABNM, which is necessary for analysis of interventions related to low prevalence diseases. Though the ABENM framework is directly based on theories from two well-known concepts, compartmental modeling and ABNM, we believe this is the first paper to propose a hybrid model and present a structure for such a hybrid simulation technique. Further, a significant contribution is the development of a new evolving contact network algorithm (ECNA), for generating scale-free networks without generating the full network, which is key to enabling such a hybrid simulation method.</p>
              <p id="P48">The key contributions of this work can be summarized as follows. It presents a new agent-based network simulation modeling technique that simulates only infected persons and their network of immediate contacts at the individual-level. While the concept is simple, generating partial networks and evolving them over time as new persons become infected is challenging, and our work identifies key concepts to help further research in this area. Our work extends beyond what is already known about degree correlations as a significant structural property of scale-free networks for studying diffusion in networks. Specifically, our work suggests that the degree correlations while traversing through epidemic paths of the network are different than when generally evaluating the degree correlation of the full network, as shown in numerical simulations (also see Remarks 2 and 3 in <xref rid="SD1" ref-type="supplementary-material">Appendix 3</xref>), due to the influence of the stochastic process defining the epidemic. Further, considerably lower epidemic prediction errors in Method 2 over Method 1 suggests that the ECNA, that combines simple concepts from graph theory with neural network function approximations, is a good approach for generating an evolving contact network in ABENM.</p>
              <p id="P49">The empirical results also identify the cases under which the proposed ABENM would be suitable, and help inform development of simulation models for diseases. First, the prediction errors for SI epidemic profiles were below 15% for networks of size 10,000 in all cases except when minimum network degree was 1. This implies that, in modeling say an HIV epidemic, persons with 1 lifetime partners should not be included. As persons with degree of 1 are at the end of a path, their contribution to disease transmission is insignificant, and thus exclusion of those with degree 1 or 0 will likely have minimal impact on epidemic predictions.</p>
              <p id="P50">Second, while the networks of size 10,000 and 50,000 had prediction errors below 15%, the smaller network size of 1000 had larger prediction errors and were less stable in the initial phase of the simulation, highlighting the significance of sample size. This implies that ABENM is not suitable for small networks, and moreover, not necessary as small networks can be analyzed using ABNM.</p>
              <p id="P51">Third, for networks of size 10,000, while predictions errors for SI were at most 15% in all cases (excluding minimum degree 1 discussed above), they were below 10% when minimum degree was greater than 2. When minimum degree was 2, prediction errors were below 10% up until prevalence of 10%. In networks of size 50,000, when minimum degree was 2, prediction errors were below 10% until the end of simulations which were terminated at 50% prevalence. This implies that larger network sizes should be chosen, which is suitable as the motivation for ABENM is to enable simulation of large population sizes to maintain a good sample size for modeling heterogeneity.</p>
              <p id="P52">Fourth, prediction errors were generally higher in SIR and SIS compared to SI, which is as expected as the neural network was trained only with SI profiles. More specific neural network training could help improve the prediction including the use of additional independent variables such as proportion recovered. Prediction errors were however lower in ECNA Method 2 compared to Method 1, providing more stability across the different epidemic profiles. The interpretation of these prediction errors is that, 95% of the time the prediction errors will be lower than that noted above. Therefore, for determining whether to use ABENM for any specific application, the acceptability of the above margin of errors should be considered and subsequent results interpreted accordingly.</p>
              <p id="P53">We believe the significance of the contributions from this work is in the study of diseases where contact structures are critical that compartmental models are not a suitable option and have low prevalence that agent-based network models are infeasible to use. Though our analysis here were restricted to populations of size below 50,000, the lower prediction errors with higher population size is encouraging because the expected use for ABENM is for simulating diseases with small prevalence but with larger population sizes. Instead of scaling-down the full population as in ABNM, ABENM will only scale the infected population. For example, for simulating a prevalence say upto 5% (50,000 infected persons) in a population of 1 million, ABNM would first generate a smaller scaled version of the 1 million (say 10,000) and simulate this network until 5% (i.e., 500 persons) become infected. On the other hand, when using ABENM, we could simulate upto 50,000 infected persons or scale it down while maintaining a sufficiently large sample, say 10,000 infected persons.</p>
              <p id="P54">This work is subject to limitations. The ABENM presented here would be suitable for only those networks that follow scale-free property. We tested the validity of ABENM on a simple version of the model, only indirectly testing impact of disease progression and behavior, and should be followed with a more specific application to diseases. One such study extended this work to model HIV in the United States, by modeling comprehensive dynamics and heterogeneity in population demographics and risk behavior, and showed good validation with national surveillance data on multiple epidemic and network features. [<xref rid="R30" ref-type="bibr">30</xref>, <xref rid="R31" ref-type="bibr">31</xref>] The results from the analysis conducted here on hypothetical networks and data assumptions, representative of a wide range of disease and behavioral features, are promising for application of the ABENM as an alternative simulation technique for study of other diseases with low prevalence.</p>
              <p id="P55">In this manuscript, we used neural networks to predict assortative correlations in degree of neighboring nodes under the influence of a stochastic process (disease transmissions). The scope of work was limited to scale-free networks where only one network feature influences degree correlations between neighbors, the scale-free network exponent (λ). Future work could expand this to networks of other types that also have degree correlations, if an ABENM simulation on that network type is desirable. Other types of degree correlations include second neighbor degree correlations or clustering that are typical in Watts-Strogatz small-world networks used for modeling social friendship networks. [<xref rid="R32" ref-type="bibr">32</xref>] In such networks, two friends of a node have a higher than random chance of also being friends with each other. Thus, the probability of forming triangles between any three nodes, modeled using clustering coefficient, would be a relevant feature and should be incorporated as an additional independent variable in the training of a neural network. Similarly, networks of other types should be trained separately using the features that influence degree correlations, modeling them as independent variables of the neural network model.</p>
              <p id="P56">In the context of diseases, there may be other forms of associative correlations, i.e., the nature of humans to associate with persons who are similar to them, commonly known as homophily, that maybe relevant. These features, however, may not necessarily influence degree correlations, and therefore may need to be considered outside the structure of neural networks. For example, for sexually transmitted diseases, age of partners (age of neighboring nodes) are relevant, as persons of similar age are more likely to form partnerships, but it does not impact degree correlation when modeling lifetime partners as done by one HIV model [<xref rid="R30" ref-type="bibr">30</xref>, <xref rid="R31" ref-type="bibr">31</xref>]. They used the neural network presented here to predict the number of lifetime number of partners (degree) of a neighboring node, but developed new optimization methods to model the current age of the neighbor, the age at which the partnership would initiate, and the duration of the partnership, considering all of its lifetime partnerships.</p>
              <p id="P57">We believe, this paper helps establish that degree correlations is a key feature impacting the scale-free network structure under the influence of an epidemic, all other stochastic features including behavioral and epidemic features, while relevant for the disease dynamics, are not significant for the network structure. This conclusion can be drawn from the fact that the different probabilities of transmission, including static and dynamic values that varied over a range that included zero, had no impact on the results though they were not included as an independent variable in the training of the neural network. Therefore, once trained on scale-free networks using the power-law distribution exponent (λ) and proportion infected as the independent variables, the trained neural network can be used in an ABENM to simulate different populations and epidemics, on a scale-free contact network structure of any value of λ. Stochastic changes in behavior as people age, changes in partnership as persons age, or changes in disease features can be simulated specific to a disease and population.</p>
              <p id="P58">The numerical analyses conducted in this paper indicates that the method is applicable for diseases and analysis of interventions that change the exposure or risk to infection over time, and interventions that activate or deactivate the status of a link. Taking HIV as an example, interventions that change exposure to risk and thus interventions that can be modeled include early diagnosis of HIV infected persons, which is known to increase condom use behavior and thus transmission risk, linkage to care and treatment of HIV infected persons, which is known to reduce transmission risk, interventions that alter condom use behavior, and pre-exposure prophylaxis for susceptible/uninfected persons, which reduce their risk of acquisition. Interventions that activate or deactivate the status of a link include needle exchange programs for injecting drug users, which alters needle sharing behavior. Transmission risk can be modeled as a function of the behavioral parameters of the nodes involved in the partnership, as commonly done. A susceptible person who is a contact of an infected person in the network can be modeled to have prophylaxis or vaccination status, and use it in the transmission risk function. Prophylaxis or vaccination status among susceptible persons in the compartmental model can be modeled as a heterogeneous parameter by splitting compartments into vaccinated and not vaccinated and applying certain rates of transitioning from one to the other. Changes in needle sharing can be modeled by activating or deactivating links using the dynamic adjacency matrix of the ABENM. Similarly, the impact of interventions that may reduce the number of contacts can be measured by activating links in a no intervention scenario and deactivating them in an intervention scenario through the use of the dynamic adjacency matrix in ABENM. On the other hand, if there are systematic changes that permanently alter the degree distribution for future generations, then that transition should be given special focus and additional analysis should be conducted depending on the type of transition. For example, if it still maintains a scale-free network structure but the value of the power-law exponent (λ) is altered permanently, the neural network need not be retrained, the model can be set to draw for this new λ, but the transitionary phase might be relevant to analyze further and be specific to the problem studied. Interventions that permanently change the network structure such that it is no more scale-free, are outside the scope of this model.</p>
              <p id="P59">In summary, we believe the proposed ABENM contributes to the simulation modeling literature by serving as an alternate technique to the current extreme techniques of agent-based and compartmental simulation modeling. The ECNA contributes to the network generation algorithm literature for simulation of epidemic projections over scale-free contact networks. Future work could explore development of network generation algorithms for other types of networks using a neural network method as that developed here.</p>
            </sec>
            <sec sec-type="supplementary-material" id="SM1">
              <title>Supplementary Material</title>
              <supplementary-material content-type="local-data" id="SD1">
                <label>1737713_Sup_Appendix</label>
                <media xlink:href="NIHMS1737713-supplement-1737713_Sup_Appendix.pdf" orientation="portrait" id="d40e2754" position="anchor"/>
              </supplementary-material>
            </sec>
          </body>
          <back>
            <ack id="S14">
              <title>Acknowledgments</title>
              <p id="P60">Research reported in this publication was supported by the National Institute Of Allergy And Infectious Diseases of the National Institutes of Health under Award Number R01AI127236. The content is solely the responsibility of the authors and does not necessarily represent the official views of the National Institutes of Health. Eden, Castonguay, Munkhbat, and Gopalappa were supported on this grant. We also acknowledge our collaborators on this grant Dr. Paul Farnham, and Dr. Stephanie Sansom, from the Centers for Disease Control and Prevention for their inputs on this work. The content is solely the responsibility of the authors and does not necessarily represent the official views of the Centers for Disease Control and Prevention.</p>
            </ack>
            <fn-group>
              <fn id="FN2">
                <p id="P61"><bold>Supplementary Information</bold> The online version contains supplementary material available at <ext-link ext-link-type="doi" xlink:href="10.1007/s10729-021-09558-0">https://doi.org/10.1007/s10729-021-09558-0</ext-link>.</p>
              </fn>
            </fn-group>
            <ref-list>
              <title>References</title>
              <ref id="R1">
                <label>1.</label>
                <mixed-citation publication-type="journal"><name><surname>Siettos</surname><given-names>CI</given-names></name>, <name><surname>Russo</surname><given-names>L</given-names></name> (<year>2013</year>) <article-title>Mathematical modeling of infectious disease dynamics</article-title>. <source>Virulence</source>
<volume>4</volume>:<fpage>295</fpage>–<lpage>306</lpage><pub-id pub-id-type="pmid">23552814</pub-id></mixed-citation>
              </ref>
              <ref id="R2">
                <label>2.</label>
                <mixed-citation publication-type="journal"><name><surname>Smieszek</surname><given-names>T</given-names></name>, <name><surname>Fiebig</surname><given-names>L</given-names></name>, <name><surname>Scholz</surname><given-names>RW</given-names></name> (<year>2009</year>) <article-title>Models of epidemics: when contact repetition and clustering should be included</article-title>. <source>Theor Biol Med Model</source>
<volume>6</volume>:<comment>11–4682 -6-11</comment></mixed-citation>
              </ref>
              <ref id="R3">
                <label>3.</label>
                <mixed-citation publication-type="journal"><name><surname>El-Sayed</surname><given-names>AM</given-names></name>, <name><surname>Scarborough</surname><given-names>P</given-names></name>, <name><surname>Seemann</surname><given-names>L</given-names></name>, <name><surname>Galea</surname><given-names>S</given-names></name> (<year>2012</year>) <article-title>Social network analysis and agent-based modeling in social epidemiology</article-title>. <source>Epidemiol Perspect Innov</source>
<volume>9</volume>:<comment>1–5573 −9–1</comment></mixed-citation>
              </ref>
              <ref id="R4">
                <label>4.</label>
                <mixed-citation publication-type="journal"><collab>Centers for Disease Control and Prevention</collab>. <article-title>Estimated HIV incidence and prevalence in the United States, 2010–2015</article-title>. <source>HIV Surveillance Supplemental Report</source><comment>2018</comment>;<volume>23</volume>(<issue>No. 1</issue>). <comment><ext-link ext-link-type="uri" xlink:href="http://www.cdc.gov/hiv/library/reports/hiv-surveillance.html">http://www.cdc.gov/hiv/library/reports/hiv-surveillance.html</ext-link>.</comment><comment>Published March 2018. Accessed</comment> [<month>11</month>
<year>2018</year>]</mixed-citation>
              </ref>
              <ref id="R5">
                <label>5.</label>
                <mixed-citation publication-type="journal"><name><surname>Oster</surname><given-names>AM</given-names></name>, <name><surname>France</surname><given-names>AM</given-names></name>, <name><surname>Panneer</surname><given-names>N</given-names></name>, <name><surname>Banez Ocfemia</surname><given-names>MC</given-names></name>, <name><surname>Campbell</surname><given-names>E</given-names></name>, <name><surname>Dasgupta</surname><given-names>S</given-names></name><etal/> (<year>2018</year>) <article-title>Identifying clusters of recent and rapid HIV transmission through analysis of molecular surveillance data</article-title>. <source>J Acquir Immune Defic Syndr</source>
<volume>79</volume>:<fpage>543</fpage>–<lpage>550</lpage><pub-id pub-id-type="pmid">30222659</pub-id></mixed-citation>
              </ref>
              <ref id="R6">
                <label>6.</label>
                <mixed-citation publication-type="journal"><name><surname>McCormick</surname><given-names>AW</given-names></name>, <name><surname>Abuelezam</surname><given-names>NN</given-names></name>, <name><surname>Rhode</surname><given-names>ER</given-names></name>, <name><surname>Hou</surname><given-names>T</given-names></name>, <name><surname>Walensky</surname><given-names>RP</given-names></name>, <name><surname>Pei</surname><given-names>PP</given-names></name><etal/> (<year>2014</year>) <article-title>Development, calibration and performance of an HIV transmission model incorporating natural history and behavioral patterns: application in South Africa</article-title>. <source>PLoS One</source>
<volume>9</volume>: <fpage>e98272</fpage><pub-id pub-id-type="pmid">24867402</pub-id></mixed-citation>
              </ref>
              <ref id="R7">
                <label>7.</label>
                <mixed-citation publication-type="journal"><name><surname>Reniers</surname><given-names>G</given-names></name>, <name><surname>Armbruster</surname><given-names>B</given-names></name>, <name><surname>Lucas</surname><given-names>A</given-names></name> (<year>2015</year>) <article-title>Sexual networks, partnership mixing, and the female-to-male ratio of HIV infections in generalized epidemics: An agent-based simulation study</article-title>. <source>Demogr Res</source>
<volume>33</volume>(<issue>15</issue>):<fpage>425</fpage>–<lpage>450</lpage></mixed-citation>
              </ref>
              <ref id="R8">
                <label>8.</label>
                <mixed-citation publication-type="journal"><name><surname>Kretzschmar</surname><given-names>M</given-names></name>, <name><surname>Morris</surname><given-names>M</given-names></name> (<year>1996</year>) <article-title>Measures of concurrency in networks and the spread of infectious disease</article-title>. <source>Math Biosci</source>
<volume>133</volume>:<fpage>165</fpage>–<lpage>195</lpage><pub-id pub-id-type="pmid">8718707</pub-id></mixed-citation>
              </ref>
              <ref id="R9">
                <label>9.</label>
                <mixed-citation publication-type="journal"><name><surname>Johnson</surname><given-names>LF</given-names></name>, <name><surname>Kubjane</surname><given-names>M</given-names></name>, <name><surname>Moolla</surname><given-names>H</given-names></name> (<year>2018</year>) <article-title>MicroCOSM: a model of social and structural drivers of HIV and interventions to reduce HIV incidence in high-risk populations in South Africa</article-title>. <source>bioRxiv 310763</source>. <pub-id pub-id-type="doi">10.1101/310763</pub-id></mixed-citation>
              </ref>
              <ref id="R10">
                <label>10.</label>
                <mixed-citation publication-type="journal"><name><surname>Vieira</surname><given-names>IT</given-names></name>, <name><surname>Cheng</surname><given-names>RCH</given-names></name>, <name><surname>Harper</surname><given-names>PR</given-names></name>, <name><surname>de Senna</surname><given-names>V</given-names></name> (<year>2010</year>) <article-title>Small world network models of the dynamics of HIV infection</article-title>. <source>Ann Oper Res</source>
<volume>178</volume>:<fpage>173</fpage>–<lpage>200</lpage></mixed-citation>
              </ref>
              <ref id="R11">
                <label>11.</label>
                <mixed-citation publication-type="journal"><name><surname>Gopalappa</surname><given-names>C</given-names></name>, <name><surname>Farnham</surname><given-names>PG</given-names></name>, <name><surname>Chen</surname><given-names>YH</given-names></name>, <name><surname>Sansom</surname><given-names>SL</given-names></name> (<year>2017</year>) <article-title>Progression and transmission of HIV/AIDS (PATH 2.0): a new agent-based model to estimate HIV transmissions in the United States</article-title>. <source>Med Decis Mak</source>
<volume>37</volume>:<fpage>224</fpage>–<lpage>233</lpage></mixed-citation>
              </ref>
              <ref id="R12">
                <label>12.</label>
                <mixed-citation publication-type="journal"><name><surname>Luo</surname><given-names>W</given-names></name>, <name><surname>Katz</surname><given-names>DA</given-names></name>, <name><surname>Hamilton</surname><given-names>DT</given-names></name>, <name><surname>McKenney</surname><given-names>J</given-names></name>, <name><surname>Jenness</surname><given-names>SM</given-names></name>, <name><surname>Goodreau</surname><given-names>SM</given-names></name>, <name><surname>Stekler</surname><given-names>JD</given-names></name>, <name><surname>Rosenberg</surname><given-names>ES</given-names></name>, <name><surname>Sullivan</surname><given-names>PS</given-names></name>, <name><surname>Cassels</surname><given-names>S</given-names></name> (<year>2018</year>) <article-title>Development of an agent-based model to investigate the impact of HIV self-testing programs on men who have sex with men in Atlanta and Seattle</article-title>. <source>JMIR Public Health Surveill</source>
<volume>4</volume>:<fpage>e58</fpage><pub-id pub-id-type="pmid">29959112</pub-id></mixed-citation>
              </ref>
              <ref id="R13">
                <label>13.</label>
                <mixed-citation publication-type="journal"><name><surname>Pastor-Satorras</surname><given-names>R</given-names></name>, <name><surname>Vespignani</surname><given-names>A</given-names></name> (<year>2001</year>) <article-title>Epidemic spreading in scale-free networks</article-title>. <source>Phys Rev Lett</source>
<volume>86</volume>:<fpage>3200</fpage>–<lpage>3203</lpage><pub-id pub-id-type="pmid">11290142</pub-id></mixed-citation>
              </ref>
              <ref id="R14">
                <label>14.</label>
                <mixed-citation publication-type="journal"><name><surname>Moshiri</surname><given-names>N</given-names></name>, <name><surname>Ragonnet-Cronin</surname><given-names>M</given-names></name>, <name><surname>Wertheim</surname><given-names>JO</given-names></name>, <name><surname>Mirarab</surname><given-names>S</given-names></name> (<year>2019</year>) <article-title>FAVITES: simultaneous simulation of transmission networks, phylogenetic trees and sequences</article-title>. <source>Bioinformatics</source>
<volume>35</volume>:<fpage>1852</fpage>–<lpage>1861</lpage><pub-id pub-id-type="pmid">30395173</pub-id></mixed-citation>
              </ref>
              <ref id="R15">
                <label>15.</label>
                <mixed-citation publication-type="journal"><name><surname>Liesenborgs</surname><given-names>J</given-names></name>, <name><surname>Hendrickx</surname><given-names>DM</given-names></name>, <name><surname>Kuylen</surname><given-names>E</given-names></name>, <name><surname>Niyukuri</surname><given-names>D</given-names></name>, <name><surname>Hens</surname><given-names>N</given-names></name>, <name><surname>Delva</surname><given-names>W</given-names></name> (<year>2019</year>) <article-title>SimpactCyan 1.0: An Open-source Simulator for Individual-Based Models in HIV Epidemiology with R and Python Interfaces</article-title>. <source>Sci Rep</source>
<volume>9</volume>:<fpage>19289</fpage>–<lpage>19019</lpage>
<comment>55689–4</comment><pub-id pub-id-type="pmid">31848434</pub-id></mixed-citation>
              </ref>
              <ref id="R16">
                <label>16.</label>
                <mixed-citation publication-type="journal"><name><surname>Davidsen</surname><given-names>J</given-names></name>, <name><surname>Ebel</surname><given-names>H</given-names></name>, <name><surname>Bornholdt</surname><given-names>S</given-names></name> (<year>2002</year>) <article-title>Emergence of a small world from local interactions: modeling acquaintance networks</article-title>. <source>Phys Rev Lett</source>
<volume>88</volume>:<fpage>128701</fpage><pub-id pub-id-type="pmid">11909506</pub-id></mixed-citation>
              </ref>
              <ref id="R17">
                <label>17.</label>
                <mixed-citation publication-type="journal"><name><surname>Marsili</surname><given-names>M</given-names></name>, <name><surname>Vega-Redondo</surname><given-names>F</given-names></name>, <name><surname>Slanina</surname><given-names>F</given-names></name> (<year>2004</year>) <article-title>The rise and fall of a networked society: a formal model</article-title>. <source>Proc Natl Acad Sci U S A</source>
<volume>101</volume>: <fpage>1439</fpage>–<lpage>1442</lpage><pub-id pub-id-type="pmid">14745030</pub-id></mixed-citation>
              </ref>
              <ref id="R18">
                <label>18.</label>
                <mixed-citation publication-type="journal"><name><surname>Kumpula</surname><given-names>JM</given-names></name>, <name><surname>Onnela</surname><given-names>JP</given-names></name>, <name><surname>Saramaki</surname><given-names>J</given-names></name>, <name><surname>Kaski</surname><given-names>K</given-names></name>, <name><surname>Kertesz</surname><given-names>J</given-names></name> (<year>2007</year>) <article-title>Emergence of communities in weighted networks</article-title>. <source>Phys Rev Lett</source>
<volume>99</volume>:<fpage>228701</fpage><pub-id pub-id-type="pmid">18233339</pub-id></mixed-citation>
              </ref>
              <ref id="R19">
                <label>19.</label>
                <mixed-citation publication-type="journal"><name><surname>Vazquez</surname><given-names>A</given-names></name> (<year>2003</year>) <article-title>Growing network with local rules: preferential attachment, clustering hierarchy, and degree correlations</article-title>. <source>Phys Rev E Stat Nonlinear Soft Matter Phys</source>
<volume>67</volume>:<fpage>056104</fpage></mixed-citation>
              </ref>
              <ref id="R20">
                <label>20.</label>
                <mixed-citation publication-type="journal"><name><surname>Boguna</surname><given-names>M</given-names></name>, <name><surname>Pastor-Satorras</surname><given-names>R</given-names></name>, <name><surname>Diaz-Guilera</surname><given-names>A</given-names></name>, <name><surname>Arenas</surname><given-names>A</given-names></name> (<year>2004</year>) <article-title>Models of social networks based on social distance attachment</article-title>. <source>Phys Rev E Stat Nonlinear Soft Matter Phys</source>
<volume>70</volume>:<fpage>056122</fpage></mixed-citation>
              </ref>
              <ref id="R21">
                <label>21.</label>
                <mixed-citation publication-type="journal"><name><surname>Robins</surname><given-names>G</given-names></name>, <name><surname>Pattison</surname><given-names>P</given-names></name>, <name><surname>Kalish</surname><given-names>Y</given-names></name>, <name><surname>Lusher</surname><given-names>D</given-names></name> (<year>2007</year>) <article-title>An introduction to exponential random graph (p*) models for social networks</article-title>. <source>Soc Networks</source>
<volume>29</volume>:<fpage>173</fpage>–<lpage>191</lpage></mixed-citation>
              </ref>
              <ref id="R22">
                <label>22.</label>
                <mixed-citation publication-type="book"><name><surname>Schmid</surname><given-names>CS</given-names></name>, <name><surname>Desmarais</surname><given-names>BA</given-names></name> (<year>2017</year>) <part-title>Exponential random graph models with big networks: Maximum pseudolikelihood estimation and the parametric bootstrap</part-title>. In: <name><surname>Nie</surname><given-names>J-Y</given-names></name>, <name><surname>Obradovic</surname><given-names>Z</given-names></name>, <name><surname>Suzumura</surname><given-names>T</given-names></name>, <name><surname>Ghosh</surname><given-names>R</given-names></name>, <name><surname>Nambiar</surname><given-names>R</given-names></name>, <name><surname>Wang</surname><given-names>C</given-names></name>, <name><surname>Zang</surname><given-names>H</given-names></name>, <name><surname>Baeza-Yates</surname><given-names>R</given-names></name>, <name><surname>Baeza-Yates</surname><given-names>R</given-names></name>, <name><surname>Hu</surname><given-names>X</given-names></name>, <name><surname>Kepner</surname><given-names>J</given-names></name>, <name><surname>Cuzzocrea</surname><given-names>A</given-names></name>, <name><surname>Tang</surname><given-names>J</given-names></name>, <name><surname>Toyoda</surname><given-names>M</given-names></name> (eds) <source>Proceedings - 2017 IEEE International Conference on Big Data, Big Data 2017</source>. <publisher-name>Institute of Electrical and Electronics Engineers Inc</publisher-name>, p <fpage>116</fpage>–<lpage>121</lpage>. <pub-id pub-id-type="doi">10.1109/BigData.2017.8257919</pub-id></mixed-citation>
              </ref>
              <ref id="R23">
                <label>23.</label>
                <mixed-citation publication-type="web"><name><surname>Barabasi</surname><given-names>AL</given-names></name> (<comment>2021</comment>) <source>Nework Science- Chapter 4, The Scale-free Property</source>. <comment><ext-link ext-link-type="uri" xlink:href="http://networksciencebook.com">http://networksciencebook.com</ext-link>. Accessed</comment>
<month>3</month>
<year>2021</year></mixed-citation>
              </ref>
              <ref id="R24">
                <label>24.</label>
                <mixed-citation publication-type="journal"><name><surname>Liljeros</surname><given-names>F</given-names></name>, <name><surname>Edling</surname><given-names>CR</given-names></name>, <name><surname>Amaral</surname><given-names>LA</given-names></name>, <name><surname>Stanley</surname><given-names>HE</given-names></name>, <name><surname>Aberg</surname><given-names>Y</given-names></name> (<year>2001</year>) <article-title>The web of human sexual contacts</article-title>. <source>Nature</source>
<volume>411</volume>:<fpage>907</fpage>–<lpage>908</lpage><pub-id pub-id-type="pmid">11418846</pub-id></mixed-citation>
              </ref>
              <ref id="R25">
                <label>25.</label>
                <mixed-citation publication-type="journal"><name><surname>Wertheim</surname><given-names>JO</given-names></name>, <name><surname>Kosakovsky Pond</surname><given-names>SL</given-names></name>, <name><surname>Forgione</surname><given-names>LA</given-names></name>, <name><surname>Mehta</surname><given-names>SR</given-names></name>, <name><surname>Murrell</surname><given-names>B</given-names></name>, <name><surname>Shah</surname><given-names>S</given-names></name>, <name><surname>Smith</surname><given-names>DM</given-names></name>, <name><surname>Scheffler</surname><given-names>K</given-names></name>, <name><surname>Torian</surname><given-names>LV</given-names></name> (<year>2017</year>) <article-title>Social and genetic networks of HIV-1 transmission in New York City</article-title>. <source>PLoS Pathog</source>
<volume>13</volume>:<fpage>e1006000</fpage><pub-id pub-id-type="pmid">28068413</pub-id></mixed-citation>
              </ref>
              <ref id="R26">
                <label>26.</label>
                <mixed-citation publication-type="journal"><name><surname>Wertheim</surname><given-names>JO</given-names></name>, <name><surname>Leigh Brown</surname><given-names>AJ</given-names></name>, <name><surname>Hepler</surname><given-names>NL</given-names></name>, <name><surname>Mehta</surname><given-names>SR</given-names></name>, <name><surname>Richman</surname><given-names>DD</given-names></name>, <name><surname>Smith</surname><given-names>DM</given-names></name>, <name><surname>Kosakovsky Pond</surname><given-names>SL</given-names></name> (<year>2014</year>) <article-title>The global transmission network of HIV-1</article-title>. <source>J Infect Dis</source>
<volume>209</volume>:<fpage>304</fpage>–<lpage>313</lpage><pub-id pub-id-type="pmid">24151309</pub-id></mixed-citation>
              </ref>
              <ref id="R27">
                <label>27.</label>
                <mixed-citation publication-type="journal"><name><surname>Brown</surname><given-names>AJL</given-names></name>, <name><surname>Lycett</surname><given-names>SJ</given-names></name>, <name><surname>Weinert</surname><given-names>L</given-names></name>, <name><surname>Hughes</surname><given-names>GJ</given-names></name>, <name><surname>Fearnhill</surname><given-names>E</given-names></name>, <name><surname>Dunn</surname><given-names>DT</given-names></name> (<year>2011</year>) <article-title>Transmission network parameters estimated from HIV sequences for a Nationwide epidemic</article-title>. <source>J Infect Dis</source>
<volume>204</volume></mixed-citation>
              </ref>
              <ref id="R28">
                <label>28.</label>
                <mixed-citation publication-type="journal"><name><surname>Barabasi</surname><given-names>AL</given-names></name>, <name><surname>Albert</surname><given-names>R</given-names></name> (<year>1999</year>) <article-title>Emergence of scaling in random networks</article-title>. <source>Science</source>
<volume>286</volume>:<fpage>509</fpage>–<lpage>512</lpage><pub-id pub-id-type="pmid">10521342</pub-id></mixed-citation>
              </ref>
              <ref id="R29">
                <label>29.</label>
                <mixed-citation publication-type="journal"><name><surname>Fotouhi</surname><given-names>B</given-names></name>, <name><surname>Rabbat</surname><given-names>MG</given-names></name> (<year>2013</year>) <article-title>Degree correlation in scale-free graphs</article-title>. <source>Eur Phys J B</source>
<volume>86</volume>(<issue>510</issue>)</mixed-citation>
              </ref>
              <ref id="R30">
                <label>30.</label>
                <mixed-citation publication-type="journal"><name><surname>France</surname><given-names>AM</given-names></name>, <name><surname>Gopalappa</surname><given-names>C</given-names></name>, <name><surname>Singh</surname><given-names>S</given-names></name>, <name><surname>Chen</surname><given-names>Y</given-names></name>, <name><surname>Oster</surname><given-names>AM</given-names></name>, <name><surname>Bingham</surname><given-names>A</given-names></name><etal/> (<year>2020</year>) <article-title>Poster # PEC0522 - nationally representative simulation model of HIV transmission clusters in the United States, e-poster track C</article-title>. <source>AIDS</source>
<volume>6–10</volume>:<fpage>2020</fpage></mixed-citation>
              </ref>
              <ref id="R31">
                <label>31.</label>
                <mixed-citation publication-type="journal"><name><surname>Singh</surname><given-names>S</given-names></name>, <name><surname>France</surname><given-names>AM</given-names></name>, <name><surname>Chen</surname><given-names>Y</given-names></name>, <name><surname>Farnham</surname><given-names>P</given-names></name>, <name><surname>Oster</surname><given-names>A</given-names></name>, <name><surname>Goplappa</surname><given-names>C</given-names></name> (<year>2021</year>) <article-title>Progression and transmission of HIV (PATH 4.0)-A new agent-based evolving network simulation for modeling HIV transmission clusters</article-title>. <source>Math Biosci Eng</source>
<volume>18</volume>(<issue>3</issue>):<fpage>2150</fpage>–<lpage>2181</lpage>. <pub-id pub-id-type="doi">10.3934/mbe.2021109</pub-id><pub-id pub-id-type="pmid">33892539</pub-id></mixed-citation>
              </ref>
              <ref id="R32">
                <label>32.</label>
                <mixed-citation publication-type="journal"><name><surname>Watts</surname><given-names>DJ</given-names></name>, <name><surname>Strogatz</surname><given-names>SH</given-names></name> (<year>1998</year>) <article-title>Collective dynamics of ‘small-world’ networks</article-title>. <source>Nature</source>
<volume>393</volume>:<fpage>440</fpage>–<lpage>442</lpage><pub-id pub-id-type="pmid">9623998</pub-id></mixed-citation>
              </ref>
            </ref-list>
          </back>
          <floats-group>
            <fig id="F1" orientation="portrait" position="float">
              <label>Fig. 1</label>
              <caption>
                <p id="P62">Overview of structural differences between the agent-based network modeling (ABNM) and our proposed agent-based evolving network modeling (ABENM) techniques, using a small network of size 9, at two time steps, t = 1 and t = 2, of the simulation. In ABNM, the network is first generated such that the degree of all nodes are known before the start of the simulation. In ABENM, only infected persons and immediate contacts are tracked. At every time-step, for every newly infected node, the desired degree of its newly added susceptible contacts need to be determined, which is the focus of the proposed evolving contact network algorithm (ECNA); current degree = number of current contacts (edges) of the node; desired degree = actual degree o f the node</p>
              </caption>
              <graphic xlink:href="nihms-1737713-f0001"/>
            </fig>
            <fig id="F2" orientation="portrait" position="float">
              <label>Fig. 2</label>
              <caption>
                <p id="P63">Comparing numerically estimated degree correlations on non-contagion and contagion networks with theoretically estimated distributions of degree correlations. <italic>Pr</italic>(<italic>l</italic>| <italic>k</italic>) is the probability that given a node of degree <italic>k</italic>, the degree of its neighbor is <italic>l</italic>. Theoretical estimates are from model in [<xref rid="R29" ref-type="bibr">29</xref>] (see <xref rid="SD1" ref-type="supplementary-material">Appendix 1c</xref>), and numerical estimates are from ABNM simulations. Results are from networks of size 1000</p>
              </caption>
              <graphic xlink:href="nihms-1737713-f0002"/>
            </fig>
            <fig id="F3" orientation="portrait" position="float">
              <label>Fig. 3</label>
              <caption>
                <p id="P64">Disease prevalence (proportion of population infected) predictions and prediction errors in ABENM (ECNA Methods 1 and 2) compared to ABNM for networks with minimum degree m = 1 to 5, transmission probability per exposure <italic>p=</italic> 0.1 and 0.01, initial proportion infected i = 0.028, and network size <italic>N</italic> = 10,000; Plots show the 5th and 95th percentile values of 100 runs. ABNM: Agent-based network model; ABENM: Agent-based evolving network model; ECNA- Evolving contact network algorithm; Method 1: Using theoretical estimations of degree correlations between neighbors from [<xref rid="R29" ref-type="bibr">29</xref>] (see <xref rid="SD1" ref-type="supplementary-material">Appendix 1c</xref>). Method 2: Using neural network predictions for modified degree correlations between neighbors on epidemic paths in dynamic contagion networks.</p>
              </caption>
              <graphic xlink:href="nihms-1737713-f0003"/>
            </fig>
            <fig id="F4" orientation="portrait" position="float">
              <label>Fig. 4</label>
              <caption>
                <p id="P65">Disease prevalence (proportion of population infected) predictions and prediction errors in ECNA Methods 1 and 2 compared to ABNM, for networks with minimum degree m = 1 to 5, transmission probability per exposure <italic>p=</italic> 0.1 and 0.01, initial proportion infected i = 0.028, and network size <italic>N</italic> = 1000; Plots show the 5th and 95th percentile values of 100 runs. ABNM: Agent-based network model; ABENM: Agent-based evolving network model; ECNA- Evolving contact network algorithm; Method 1: Using theoretical estimations of degree correlations between neighbors from [<xref rid="R29" ref-type="bibr">29</xref>] (see <xref rid="SD1" ref-type="supplementary-material">Appendix 1c</xref>). Method 2: Using neural network predictions for modified degree correlations between neighbors on epidemic paths in dynamic contagion networks.</p>
              </caption>
              <graphic xlink:href="nihms-1737713-f0004"/>
            </fig>
            <table-wrap id="T1" position="float" orientation="landscape">
              <label>Table 1</label>
              <caption>
                <p id="P66">Overview of the ABENM for simulating epidemic trajectories for a SIR model: predicting the proportions susceptible, infected, and recovered (<italic>s</italic><sub><italic>t</italic></sub>, <italic>i</italic><sub><italic>t</italic></sub>, <italic>r</italic><sub><italic>t</italic></sub>) as a function of time <italic>t</italic></p>
              </caption>
              <table frame="hsides" rules="groups">
                <colgroup span="1">
                  <col align="left" valign="middle" span="1"/>
                  <col align="left" valign="middle" span="1"/>
                </colgroup>
                <tbody>
                  <tr>
                    <td align="left" valign="middle" rowspan="1" colspan="1">Step 1</td>
                    <td align="left" valign="middle" rowspan="1" colspan="1">Initial setup for <italic>t=0</italic>:</td>
                  </tr>
                  <tr>
                    <td colspan="2" align="left" valign="top" rowspan="1">
                      <hr/>
                    </td>
                  </tr>
                  <tr>
                    <td align="left" valign="top" rowspan="1" colspan="1">1a:</td>
                    <td align="left" valign="top" rowspan="1" colspan="1">Set the initial values for proportions susceptible, infected, and recovered, i.e., values for <italic>s</italic><sub><italic>t</italic>=0</sub><italic>, i</italic><sub><italic>t</italic>=0</sub>, and <italic>r</italic><sub><italic>t</italic>=0</sub>, respectively. For the example for HIV, we could set <italic>i</italic><sub>0</sub> as prevalence in base year of analyses, <italic>r</italic><sub>0</sub> as zero, and <italic>s</italic><sub>0</sub> as 1−<italic>i</italic><sub>0</sub>.</td>
                  </tr>
                  <tr>
                    <td align="left" valign="top" rowspan="1" colspan="1">1b:</td>
                    <td align="left" valign="top" rowspan="1" colspan="1">Based on the computational and sample size requirements, determine the total population size (<italic>N</italic>) and convert the proportions <italic>s</italic><sub><italic>t</italic></sub><italic>, i</italic><sub><italic>t</italic></sub>, and <italic>r</italic><sub><italic>t</italic></sub> to numbers of people.</td>
                  </tr>
                  <tr>
                    <td align="left" valign="top" rowspan="1" colspan="1">1c:</td>
                    <td align="left" valign="top" rowspan="1" colspan="1">Determine <italic>Q</italic><sub><italic>t</italic>=0</sub>, the initial number of people to model at the individual-level, and <italic>A</italic><sub>t=0</sub>, an adjacency matrix representing their contact structure. We do not discuss the initial network generation method as this is a separate problem, which also arises even in ABNM. One method is to start with 1 infected person and do a dry run until the required i<sub>t</sub> proportion of people are infected. For reference, in the Progression and Transmission of HIV (PATH 2.0) agent-based model developed in our previous work, they were estimated by calibration to multiple distributions of individual-level characteristics from surveillance.</td>
                  </tr>
                  <tr>
                    <td align="left" valign="top" rowspan="1" colspan="1">1d:</td>
                    <td align="left" valign="top" rowspan="1" colspan="1">Generate degree distribution vectors, <italic>v</italic> and <inline-formula><mml:math display="inline" id="M1"><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula>, as follows<list list-type="bullet" id="L2"><list-item><p id="P67"><inline-formula><mml:math display="inline" id="M2"><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> = vector that keeps track of the degree distribution of the partial network defined by <italic>A</italic><sub>t</sub>, and <italic>v</italic> = a vector that keeps track of the degrees of the <italic>N</italic>−<italic>Q</italic><sub><italic>t</italic></sub> persons not in <italic>A</italic><sub>t</sub></p></list-item><list-item><p id="P68"><inline-formula><mml:math display="inline" id="M3"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> element k of the vector <inline-formula><mml:math display="inline" id="M4"><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> = number of agents among the <italic>Q</italic><sub><italic>t</italic></sub> agents in the simulation who have a degree k</p></list-item><list-item><p id="P69"><italic>v</italic><sub><italic>k</italic></sub> = element k of the vector <inline-formula><mml:math display="inline" id="M5"><mml:mrow><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, where <italic>P</italic>(<italic>k</italic>) is the probability that a node in the full network has degree k, for scale-free networks it follows a power law distribution</p></list-item><list-item><p id="P70"><inline-formula><mml:math display="inline" id="M6"><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>v</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> = size of the vectors=the maximum degree in the network,</p></list-item></list>Therefore, <italic>v</italic><sub><italic>k</italic></sub> keeps track of the number of nodes of degree k who are not yet an agent in the simulation, i.e., persons who are susceptible and not contacts of infected persons</td>
                  </tr>
                  <tr>
                    <td align="left" valign="top" rowspan="1" colspan="1">Step 2:</td>
                    <td align="left" valign="top" rowspan="1" colspan="1">Determine transmissions from infected persons to immediate contacts at the individual-level using a Bernoulli transmission model</td>
                  </tr>
                  <tr>
                    <td align="left" valign="top" rowspan="1" colspan="1">Step 3:</td>
                    <td align="left" valign="top" rowspan="1" colspan="1">Calculate <italic>s</italic><sub><italic>t</italic></sub>, <italic>i</italic><sub><italic>t</italic></sub>, <italic>r</italic><sub><italic>t</italic></sub>,using the model in <xref rid="FD5" ref-type="disp-formula">(4)</xref>, <xref rid="FD6" ref-type="disp-formula">(5)</xref>, and <xref rid="FD7" ref-type="disp-formula">(6)</xref></td>
                  </tr>
                  <tr>
                    <td align="left" valign="top" rowspan="1" colspan="1">Step 4:</td>
                    <td align="left" valign="top" rowspan="1" colspan="1">Evolve the network, specifically, determine the degree for the contacts of the newly infected persons. We develop a new algorithm that we refer to as the ‘evolving contact network algorithm’(ECNA), discussed in <xref rid="T2" ref-type="table">Table 2</xref> below</td>
                  </tr>
                  <tr>
                    <td align="left" valign="top" rowspan="1" colspan="1">Step 5:</td>
                    <td align="left" valign="top" rowspan="1" colspan="1">Increment t. Stop if reached end of simulation time step, if not, go to Step 2</td>
                  </tr>
                </tbody>
              </table>
            </table-wrap>
            <table-wrap id="T2" position="float" orientation="landscape">
              <label>Table 2</label>
              <caption>
                <p id="P71">Evolving contact network algorithm (ECNA) (Step 4 of algorithm in <xref rid="T1" ref-type="table">Table 1</xref>)</p>
              </caption>
              <table frame="above" rules="groups">
                <colgroup span="1">
                  <col align="left" valign="middle" span="1"/>
                  <col align="left" valign="middle" span="1"/>
                </colgroup>
                <tbody>
                  <tr>
                    <td colspan="2" align="left" valign="top" rowspan="1">Step 4 of <xref rid="T1" ref-type="table">Table 1</xref>: Loop through each newly infected person (<italic>i</italic>)</td>
                  </tr>
                  <tr>
                    <td colspan="2" align="left" valign="top" rowspan="1">
                      <hr/>
                    </td>
                  </tr>
                  <tr>
                    <td align="left" valign="top" rowspan="1" colspan="1">Step 4a</td>
                    <td align="left" valign="top" rowspan="1" colspan="1">Determine the number of new contacts <inline-formula><mml:math display="inline" id="M7"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> to generate for a newly infected person <italic>i</italic> as<break/><inline-formula><mml:math display="inline" id="M8"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:munder><mml:mo mathsize="small">∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi mathvariant="script">A</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula><break/>where, <inline-formula><mml:math display="inline" id="M9"><mml:mrow><mml:msub><mml:mi mathvariant="script">A</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the adjacency matrix of the network at time <italic>t</italic>, and <italic>d</italic><sub><italic>i</italic></sub> is the desired degree for <italic>i</italic>. Note that, in this method, the degree of a newly infected node <italic>d</italic><sub><italic>i</italic></sub> is already known at the time it becomes infected; this degree was determined in step 4b below when the node was added as a susceptible agent when one of its contacts became infected.</td>
                  </tr>
                  <tr>
                    <td colspan="2" align="left" valign="top" rowspan="1">
                      <hr/>
                    </td>
                  </tr>
                  <tr>
                    <td align="left" valign="top" rowspan="1" colspan="1">Step 4b</td>
                    <td align="left" valign="top" rowspan="1" colspan="1">Determine <italic>e</italic><sub><italic>i</italic></sub>, a row vector of eligible nodes from among susceptible agent nodes who are eligible to be contacts of <italic>i</italic>. Among persons in <inline-formula><mml:math display="inline" id="M10"><mml:mrow><mml:msub><mml:mi mathvariant="script">A</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, a person <italic>j</italic> is eligible to be a contact of <italic>i</italic>, if:<break/><underline>Constraint 1</underline>: <italic>j</italic> is not infected, i.e., <italic>h</italic><sub>t−1, j</sub> = 0, where <italic>h</italic><sub>t</sub> is a row vector with <italic>h</italic><sub><italic>t</italic>,<italic>i</italic></sub> = 0 if node <italic>i</italic> is not infected and <italic>h</italic><sub><italic>t</italic>,<italic>i</italic></sub> = 1 if node <italic>i</italic> is infected at time <italic>t</italic>.<break/><underline>Constraint 2</underline>: <italic>j</italic> is not already a direct contact of <italic>i</italic>, i.e., <inline-formula><mml:math display="inline" id="M11"><mml:mrow><mml:msub><mml:mi mathvariant="script">A</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>.<break/><underline>Constraint 3</underline>: degree of node <italic>j</italic> has not saturated, i.e., <inline-formula><mml:math display="inline" id="M12"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:munder><mml:mo mathsize="small">∑</mml:mo><mml:mi>z</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi mathvariant="script">A</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula><break/><underline>Constraint 4</underline>: <inline-formula><mml:math display="inline" id="M13"><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mi>l</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>; <inline-formula><mml:math display="inline" id="M14"><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>U</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mi>l</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math display="inline" id="M15"><mml:mrow><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>U</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the neighbors degree drawn from the conditional degree distribution <inline-formula><mml:math display="inline" id="M16"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>Pr</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and thus all persons who are eligible should belong to the same degree bin <italic>l</italic>.</td>
                  </tr>
                  <tr>
                    <td align="left" valign="top" rowspan="1" colspan="1">Step 4c</td>
                    <td align="left" valign="top" rowspan="1" colspan="1">Determine <italic>v</italic><sub><italic>l</italic></sub>, the number of persons not in <inline-formula><mml:math display="inline" id="M17"><mml:mrow><mml:msub><mml:mi mathvariant="script">A</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> who are eligible to be contacts of <italic>i</italic>. For persons not in <inline-formula><mml:math display="inline" id="M18"><mml:mrow><mml:msub><mml:mi mathvariant="script">A</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, as described in <xref rid="T1" ref-type="table">Table 1</xref>, we only maintain a vector <italic>v</italic> where each element <italic>v</italic><sub><italic>k</italic></sub> contains the number of susceptible persons in degree bin <italic>k</italic>.</td>
                  </tr>
                  <tr>
                    <td align="left" valign="top" rowspan="1" colspan="1">Step 4d</td>
                    <td align="left" valign="top" rowspan="1" colspan="1">Generate contacts with <italic>min</italic>
<inline-formula><mml:math display="inline" id="M19"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> number of susceptible nodes, where |<italic>e</italic><sub><italic>i</italic></sub>| is the size of the vector. Each new contact is randomly chosen from among the current susceptible nodes in vector <italic>e</italic><sub><italic>i</italic></sub> if <inline-formula><mml:math display="inline" id="M20"><mml:mrow><mml:mi>U</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, or is newly generated to add as a susceptible node to the simulation if otherwise.</td>
                  </tr>
                  <tr>
                    <td colspan="2" align="left" valign="top" rowspan="1">
                      <hr/>
                    </td>
                  </tr>
                  <tr>
                    <td colspan="2" align="left" valign="top" rowspan="1">End loop</td>
                  </tr>
                </tbody>
              </table>
            </table-wrap>
            <boxed-text id="BX1" position="float" orientation="portrait">
              <caption>
                <title>Highlights</title>
              </caption>
              <list list-type="bullet" id="L3">
                <list-item>
                  <p id="P72">A new agent-based evolving network modeling (ABENM) simulation technique.</p>
                </list-item>
                <list-item>
                  <p id="P73">A new evolving contact network algorithm (ECNA) for generation of scale-free networks in ABENM.</p>
                </list-item>
                <list-item>
                  <p id="P74">These new methods make it computationally feasible to model contact network structures for simulating epidemic spread of low prevalence infectious diseases; the low prevalence generates computational challenges when using current network simulation techniques.</p>
                </list-item>
                <list-item>
                  <p id="P75">Low prevalence diseases could include current low-risk high disease burden epidemics such as HIV, TB, or Hepatitis B and C, or newly emerging diseases, such as the Ebola disease, or the Middle East Respiratory Syndrome, where rapid response during the early stages of an epidemic, when prevalence is low, is key for effective control.</p>
                </list-item>
                <list-item>
                  <p id="P76">Network modeling allows for studying the dynamics of contact network structures for identifying effective intervention strategies, as a standalone method or when combining with new methods in other areas such as molecular cluster detection for evaluation of early detection and prevention strategies.</p>
                </list-item>
              </list>
            </boxed-text>
          </floats-group>
        </article>
      </metadata>
    </record>
  </GetRecord>
</OAI-PMH>
