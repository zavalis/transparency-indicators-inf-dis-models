<?xml version="1.0" encoding="UTF-8"?>
<OAI-PMH xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.openarchives.org/OAI/2.0/ http://www.openarchives.org/OAI/2.0/OAI-PMH.xsd">
  <responseDate>2022-03-11T00:48:57Z</responseDate>
  <request verb="GetRecord" identifier="oai:pubmedcentral.nih.gov:8483379" metadataPrefix="pmc">https:/www.ncbi.nlm.nih.gov/pmc/oai/oai.cgi</request>
  <GetRecord>
    <record>
      <header>
        <identifier>oai:pubmedcentral.nih.gov:8483379</identifier>
        <datestamp>2021-10-01</datestamp>
        <setSpec>plosone</setSpec>
        <setSpec>pmc-open</setSpec>
      </header>
      <metadata>
        <article xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xsi:schemaLocation="https://jats.nlm.nih.gov/ns/archiving/1.3/ https://jats.nlm.nih.gov/archiving/1.3/xsd/JATS-archivearticle1-3.xsd" dtd-version="1.3" xml:lang="en" article-type="research-article">
          <processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
            <restricted-by>pmc</restricted-by>
          </processing-meta>
          <front>
            <journal-meta>
              <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
              <journal-id journal-id-type="iso-abbrev">PLoS One</journal-id>
              <journal-id journal-id-type="publisher-id">plos</journal-id>
              <journal-title-group>
                <journal-title>PLoS ONE</journal-title>
              </journal-title-group>
              <issn pub-type="epub">1932-6203</issn>
              <publisher>
                <publisher-name>Public Library of Science</publisher-name>
                <publisher-loc>San Francisco, CA USA</publisher-loc>
              </publisher>
            </journal-meta>
            <article-meta>
              <article-id pub-id-type="accession">PMC8483379</article-id>
              <article-id pub-id-type="pmcid">PMC8483379</article-id>
              <article-id pub-id-type="pmc-uid">8483379</article-id>
              <article-id pub-id-type="pmid">34591897</article-id>
              <article-id pub-id-type="publisher-id">PONE-D-21-07099</article-id>
              <article-id pub-id-type="doi">10.1371/journal.pone.0257958</article-id>
              <article-categories>
                <subj-group subj-group-type="heading">
                  <subject>Research Article</subject>
                </subj-group>
                <subj-group subj-group-type="Discipline-v3">
                  <subject>Biology and Life Sciences</subject>
                  <subj-group>
                    <subject>Immunology</subject>
                    <subj-group>
                      <subject>Vaccination and Immunization</subject>
                    </subj-group>
                  </subj-group>
                </subj-group>
                <subj-group subj-group-type="Discipline-v3">
                  <subject>Medicine and Health Sciences</subject>
                  <subj-group>
                    <subject>Immunology</subject>
                    <subj-group>
                      <subject>Vaccination and Immunization</subject>
                    </subj-group>
                  </subj-group>
                </subj-group>
                <subj-group subj-group-type="Discipline-v3">
                  <subject>Medicine and Health Sciences</subject>
                  <subj-group>
                    <subject>Public and Occupational Health</subject>
                    <subj-group>
                      <subject>Preventive Medicine</subject>
                      <subj-group>
                        <subject>Vaccination and Immunization</subject>
                      </subj-group>
                    </subj-group>
                  </subj-group>
                </subj-group>
                <subj-group subj-group-type="Discipline-v3">
                  <subject>Physical Sciences</subject>
                  <subj-group>
                    <subject>Mathematics</subject>
                    <subj-group>
                      <subject>Optimization</subject>
                    </subj-group>
                  </subj-group>
                </subj-group>
                <subj-group subj-group-type="Discipline-v3">
                  <subject>Medicine and Health Sciences</subject>
                  <subj-group>
                    <subject>Medical Conditions</subject>
                    <subj-group>
                      <subject>Infectious Diseases</subject>
                      <subj-group>
                        <subject>Viral Diseases</subject>
                        <subj-group>
                          <subject>Covid 19</subject>
                        </subj-group>
                      </subj-group>
                    </subj-group>
                  </subj-group>
                </subj-group>
                <subj-group subj-group-type="Discipline-v3">
                  <subject>Medicine and Health Sciences</subject>
                  <subj-group>
                    <subject>Medical Conditions</subject>
                    <subj-group>
                      <subject>Infectious Diseases</subject>
                      <subj-group>
                        <subject>Infectious Disease Control</subject>
                      </subj-group>
                    </subj-group>
                  </subj-group>
                </subj-group>
                <subj-group subj-group-type="Discipline-v3">
                  <subject>Physical Sciences</subject>
                  <subj-group>
                    <subject>Mathematics</subject>
                    <subj-group>
                      <subject>Differential Equations</subject>
                    </subj-group>
                  </subj-group>
                </subj-group>
                <subj-group subj-group-type="Discipline-v3">
                  <subject>Medicine and Health Sciences</subject>
                  <subj-group>
                    <subject>Medical Conditions</subject>
                    <subj-group>
                      <subject>Infectious Diseases</subject>
                      <subj-group>
                        <subject>Infectious Disease Control</subject>
                        <subj-group>
                          <subject>Vaccines</subject>
                        </subj-group>
                      </subj-group>
                    </subj-group>
                  </subj-group>
                </subj-group>
                <subj-group subj-group-type="Discipline-v3">
                  <subject>Engineering and Technology</subject>
                  <subj-group>
                    <subject>Industrial Engineering</subject>
                    <subj-group>
                      <subject>Control Engineering</subject>
                      <subj-group>
                        <subject>Control Theory</subject>
                      </subj-group>
                    </subj-group>
                  </subj-group>
                </subj-group>
                <subj-group subj-group-type="Discipline-v3">
                  <subject>Computer and Information Sciences</subject>
                  <subj-group>
                    <subject>Systems Science</subject>
                    <subj-group>
                      <subject>Control Theory</subject>
                    </subj-group>
                  </subj-group>
                </subj-group>
                <subj-group subj-group-type="Discipline-v3">
                  <subject>Physical Sciences</subject>
                  <subj-group>
                    <subject>Mathematics</subject>
                    <subj-group>
                      <subject>Systems Science</subject>
                      <subj-group>
                        <subject>Control Theory</subject>
                      </subj-group>
                    </subj-group>
                  </subj-group>
                </subj-group>
                <subj-group subj-group-type="Discipline-v3">
                  <subject>Medicine and Health Sciences</subject>
                  <subj-group>
                    <subject>Health Care</subject>
                    <subj-group>
                      <subject>Health Care Policy</subject>
                    </subj-group>
                  </subj-group>
                </subj-group>
              </article-categories>
              <title-group>
                <article-title>Disease control as an optimization problem</article-title>
                <alt-title alt-title-type="running-head">Disease control as an optimization problem</alt-title>
              </title-group>
              <contrib-group>
                <contrib contrib-type="author">
                  <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-0717-3927</contrib-id>
                  <name>
                    <surname>Navascués</surname>
                    <given-names>Miguel</given-names>
                  </name>
                  <role content-type="https://casrai.org/credit/">Conceptualization</role>
                  <role content-type="https://casrai.org/credit/">Formal analysis</role>
                  <role content-type="https://casrai.org/credit/">Software</role>
                  <xref rid="aff001" ref-type="aff">
                    <sup>1</sup>
                  </xref>
                  <xref rid="cor001" ref-type="corresp">*</xref>
                </contrib>
                <contrib contrib-type="author">
                  <name>
                    <surname>Budroni</surname>
                    <given-names>Costantino</given-names>
                  </name>
                  <role content-type="https://casrai.org/credit/">Conceptualization</role>
                  <role content-type="https://casrai.org/credit/">Formal analysis</role>
                  <role content-type="https://casrai.org/credit/">Software</role>
                  <xref rid="aff001" ref-type="aff">
                    <sup>1</sup>
                  </xref>
                  <xref rid="aff002" ref-type="aff">
                    <sup>2</sup>
                  </xref>
                </contrib>
                <contrib contrib-type="author">
                  <name>
                    <surname>Guryanova</surname>
                    <given-names>Yelena</given-names>
                  </name>
                  <role content-type="https://casrai.org/credit/">Conceptualization</role>
                  <role content-type="https://casrai.org/credit/">Formal analysis</role>
                  <role content-type="https://casrai.org/credit/">Software</role>
                  <xref rid="aff001" ref-type="aff">
                    <sup>1</sup>
                  </xref>
                </contrib>
              </contrib-group>
              <aff id="aff001">
                <label>1</label>
                <addr-line>Institute for Quantum Optics and Quantum Information (IQOQI), Austrian Academy of Sciences, Vienna, Austria</addr-line>
              </aff>
              <aff id="aff002">
                <label>2</label>
                <addr-line>Faculty of Physics, University of Vienna, Vienna, Austria</addr-line>
              </aff>
              <contrib-group>
                <contrib contrib-type="editor">
                  <name>
                    <surname>Smith</surname>
                    <given-names>Rebecca Lee</given-names>
                  </name>
                  <role>Editor</role>
                  <xref rid="edit1" ref-type="aff"/>
                </contrib>
              </contrib-group>
              <aff id="edit1">
                <addr-line>University of Illinois College of Veterinary Medicine, UNITED STATES</addr-line>
              </aff>
              <author-notes>
                <fn fn-type="COI-statement" id="coi001">
                  <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
                </fn>
                <corresp id="cor001">* E-mail: <email>miguel.navascues@oeaw.ac.at</email></corresp>
              </author-notes>
              <pub-date pub-type="collection">
                <year>2021</year>
              </pub-date>
              <pub-date pub-type="epub">
                <day>30</day>
                <month>9</month>
                <year>2021</year>
              </pub-date>
              <pub-date pub-type="pmc-release">
                <day>30</day>
                <month>9</month>
                <year>2021</year>
              </pub-date>
              <!--PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>.-->
              <volume>16</volume>
              <issue>9</issue>
              <elocation-id>e0257958</elocation-id>
              <history>
                <date date-type="received">
                  <day>3</day>
                  <month>3</month>
                  <year>2021</year>
                </date>
                <date date-type="accepted">
                  <day>14</day>
                  <month>9</month>
                  <year>2021</year>
                </date>
              </history>
              <permissions>
                <copyright-statement>© 2021 Navascués et al</copyright-statement>
                <copyright-year>2021</copyright-year>
                <copyright-holder>Navascués et al</copyright-holder>
                <license>
                  <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
                  <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
                </license>
              </permissions>
              <self-uri content-type="pdf" xlink:href="pone.0257958.pdf"/>
              <abstract>
                <p>In the context of epidemiology, policies for disease control are often devised through a mixture of intuition and brute-force, whereby the set of logically conceivable policies is narrowed down to a small family described by a few parameters, following which linearization or grid search is used to identify the optimal policy within the set. This scheme runs the risk of leaving out more complex (and perhaps counter-intuitive) policies for disease control that could tackle the disease more efficiently. In this article, we use techniques from convex optimization theory and machine learning to conduct optimizations over disease policies described by hundreds of parameters. In contrast to past approaches for policy optimization based on control theory, our framework can deal with arbitrary uncertainties on the initial conditions and model parameters controlling the spread of the disease, and stochastic models. In addition, our methods allow for optimization over policies which remain constant over weekly periods, specified by either continuous or discrete (e.g.: lockdown on/off) government measures. We illustrate our approach by minimizing the total time required to eradicate COVID-19 within the Susceptible-Exposed-Infected-Recovered (SEIR) model proposed by Kissler <italic toggle="yes">et al</italic>. (March, 2020).</p>
              </abstract>
              <funding-group>
                <award-group id="award001">
                  <funding-source>
                    <institution>FWF</institution>
                  </funding-source>
                  <award-id>Zukunftskolleg ZK03</award-id>
                  <principal-award-recipient>
                    <name>
                      <surname>Guryanova</surname>
                      <given-names>Yelena</given-names>
                    </name>
                  </principal-award-recipient>
                </award-group>
                <award-group id="award002">
                  <funding-source>
                    <institution>FWF</institution>
                  </funding-source>
                  <award-id>Zukunftskolleg ZK03</award-id>
                  <principal-award-recipient>
                    <name>
                      <surname>Budroni</surname>
                      <given-names>Costantino</given-names>
                    </name>
                  </principal-award-recipient>
                </award-group>
                <funding-statement>Costantino Budroni and Yelena Guryanova acknowledge funding from the Austrian Science Fund (FWF) through the Zukunftskolleg ZK03. However, this funding was originally conceived to do research in quantum information theory.</funding-statement>
              </funding-group>
              <counts>
                <fig-count count="16"/>
                <table-count count="1"/>
                <page-count count="32"/>
              </counts>
              <custom-meta-group>
                <custom-meta id="data-availability">
                  <meta-name>Data Availability</meta-name>
                  <meta-value>The python code used for the simulations, optimizations, and plots presented can be found in <ext-link xlink:href="https://github.com/costantinobudroni/opt-disease-control/" ext-link-type="uri">https://github.com/costantinobudroni/opt-disease-control/</ext-link>.</meta-value>
                </custom-meta>
                <custom-meta id="outbreaks">
                  <meta-name>Outbreaks</meta-name>
                  <meta-value>COVID-19</meta-value>
                </custom-meta>
              </custom-meta-group>
            </article-meta>
            <notes>
              <title>Data Availability</title>
              <p>The python code used for the simulations, optimizations, and plots presented can be found in <ext-link xlink:href="https://github.com/costantinobudroni/opt-disease-control/" ext-link-type="uri">https://github.com/costantinobudroni/opt-disease-control/</ext-link>.</p>
            </notes>
          </front>
          <body>
            <sec sec-type="intro" id="sec001">
              <title>1 Introduction</title>
              <p>The COVID-19 pandemic has already caused over four million deaths worldwide. The effects of the virus have been widespread and substantial, from the collapse of healthcare systems [<xref rid="pone.0257958.ref001" ref-type="bibr">1</xref>–<xref rid="pone.0257958.ref003" ref-type="bibr">3</xref>] to the enforcement of isolation and quarantine. In the case of Nepal, the national lockdown lasted for 120 days uninterrupted [<xref rid="pone.0257958.ref004" ref-type="bibr">4</xref>].</p>
              <p>In these circumstances, identifying reliable and effective disease control policies is of utmost importance. Here by “policy” we mean a deliberate intervention intended to mitigate the effects of a disease as it runs its course. In much of the mathematical literature on epidemiology, the process of generating a policy is as follows [<xref rid="pone.0257958.ref005" ref-type="bibr">5</xref>]: (1) based on expert intuition, a number of suitable policies to control the disease are proposed; (2) the impact on the population of each of the considered policies is assessed through dynamical models of disease spread; (3) the outcomes of all policies are compared and a decision is taken as to which one is deemed to be the best.</p>
              <p>The main advantage of this three-step process is that the final recommended policy is comprehensible, i.e., it can be interpreted and explained. Moreover, for simple on/off policies, one can sometimes derive analytic results [<xref rid="pone.0257958.ref006" ref-type="bibr">6</xref>]. The process has, nonetheless, two disadvantages. First of all, the class of policies devised by an human could well be suboptimal, since the optimal policy (under some figure of merit) could be extremely complicated and counter-intuitive. Second, the method generally requires one to numerically simulate each policy, and so is inapplicable when the considered class of policies depends on many control parameters: due to the exponentially large number of conceivable policies, by the time one finds the optimal disease control policy, it would be too late to enforce it.</p>
              <p>Other approaches for disease control rely on optimal control theory to identify a suitable policy (see, e.g., [<xref rid="pone.0257958.ref007" ref-type="bibr">7</xref>–<xref rid="pone.0257958.ref010" ref-type="bibr">10</xref>]). The starting point of all these works is that both the initial conditions (namely, the number of individuals infected, exposed, etc.) and the model parameters (such as the disease’s reproduction number) specifying the spread of the disease are known with high precision. This requirement is never met in a real-life epidemic, especially close to the outbreak, when the uncertainty in the disease’s reproduction number can be very high [<xref rid="pone.0257958.ref011" ref-type="bibr">11</xref>, <xref rid="pone.0257958.ref012" ref-type="bibr">12</xref>]. Policies derived through optimal control theory are thus not guaranteed to have the desired effects in practice.</p>
              <p>An additional disadvantage of optimal control theory is that government measures in the model cannot be constrained to be discrete. It is true that some optimal control problems admit a discrete solution, a so-called bang-bang control, but one cannot enforce this property on the solution <italic toggle="yes">a priori</italic>. This makes optimal control theory all the more impractical, for discrete measures, such as a lockdown that is either on or off, have so far dominated global efforts to control the COVID-19 epidemic [<xref rid="pone.0257958.ref013" ref-type="bibr">13</xref>]. Last but not least, optimal control theory can only handle scenarios where the policies vary over time continuously, thus not making it compatible with observed government measures to control COVID-19, which for the most part have been applied on a discrete, weekly basis.</p>
              <p>In this paper we introduce a general framework that maps any disease control scenario to an optimization problem. Contrary to the optimal control approach, our framework can accommodate constraints on the disease dynamics which must hold for whole regions of the initial conditions and the disease’s model parameters. Our framework can enforce policies to be weekly and/or discrete. Invoking tools from optimization theory and machine learning [<xref rid="pone.0257958.ref014" ref-type="bibr">14</xref>], we propose efficient heuristics to solve the optimization problem and hence identify the government policy that best controls the disease.</p>
              <p>To illustrate the power of our approach, we use these optimization techniques to generate long-term plans to fight COVID-19, under the assumption that the disease’s dynamics are accurately captured by a variant of the Susceptible-Exposed-Infected-Recovered (SEIR) compartmental model [<xref rid="pone.0257958.ref005" ref-type="bibr">5</xref>] proposed in [<xref rid="pone.0257958.ref015" ref-type="bibr">15</xref>]. Our results confirm that optimal policies tend to be too complicated to be devised by a human.</p>
              <p>In reality, most epidemiological models only provide short-term approximations to the spread of the disease, with long term projections becoming less and less reliable [<xref rid="pone.0257958.ref016" ref-type="bibr">16</xref>]. In addition, notwithstanding the enormous knowledge gathered since the initial COVID-19 outbreak, many questions remain to be answered regarding the correctness and accuracy of compartmental models such as SEIR: their basic assumptions (e.g., are recovered patients temporarily or permanently immune to the disease?); the actual value of the model’s parameters (e.g., the basic reproduction number <italic toggle="yes">R</italic><sub>0</sub>); and the role of variables not modeled (e.g., age, geographic distribution, contact tracing policies, role of superspreaders).</p>
              <p>In this regard, the goal of this work is not to propose a concrete government policy, but rather to present an efficient method to obtain an optimal one, given all the available information. To estimate the effect of our methods in a realistic scenario, we conduct a numerical simulation where we re-calculate the optimal policy plans every month, based on new, incoming data. The very final policy plan that we present requires less stringent physical distancing measures compared with the one which is not re-calculated every month. All the code used in our simulations is freely available at [<xref rid="pone.0257958.ref017" ref-type="bibr">17</xref>].</p>
            </sec>
            <sec id="sec002">
              <title>2 The framework in a nutshell</title>
              <p>Our starting point is an epidemic that affects a closed population. This assumption is not limiting, since a large ensemble of population centres where individuals are free to commute can also be modeled as a closed system [<xref rid="pone.0257958.ref018" ref-type="bibr">18</xref>]. To gain an understanding of how the disease spreads, it is standard to divide the population into different sectors or compartments [<xref rid="pone.0257958.ref005" ref-type="bibr">5</xref>] (see <xref rid="pone.0257958.g001" ref-type="fig">Fig 1</xref>). One can define, e.g., the compartment of all those individuals who are currently infected. This compartment can, in turn, be sub-divided into different compartments, such as symptomatic/asymptomatic. Once the number of relevant compartments is fixed, one can estimate the occupation of each of them and arrange the resulting numbers in a vector <bold><italic toggle="yes">x</italic></bold>. The disease is subsequently analysed by looking at how <bold><italic toggle="yes">x</italic></bold> changes with time.</p>
              <fig position="float" id="pone.0257958.g001">
                <object-id pub-id-type="doi">10.1371/journal.pone.0257958.g001</object-id>
                <label>Fig 1</label>
                <caption>
                  <title>A possible compartment model for COVID-19 (adapted from [<xref rid="pone.0257958.ref015" ref-type="bibr">15</xref>]).</title>
                  <p>The main compartments are: susceptible; exposed; infected; hospitalized; critical and recovered. This compartmental splitting captures different possible evolutions as well as time delays between transitions. The “infected” compartment, for instance, contains those who will recover without hospitalization (<italic toggle="yes">I</italic><sub><italic toggle="yes">R</italic></sub>); those who will be hospitalized but won’t need critical care (<italic toggle="yes">I</italic><sub><italic toggle="yes">H</italic></sub>); and those who will end up receiving critical care (<italic toggle="yes">I</italic><sub><italic toggle="yes">C</italic></sub>). The “exposed” compartment is introduced here to model the time delay between the exposure to the disease and the development of symptoms (incubation period), in particular, the possibility of infecting others, which is what is relevant for the model. In this model, the compartment “recovered” includes both dead and alive individuals; in principle, it could be sub-divided further.</p>
                </caption>
                <graphic xlink:href="pone.0257958.g001" position="float"/>
              </fig>
              <p>In order to control or even extinguish an epidemic, governments can enforce a number of different measures: mass vaccination, physical (or social [<xref rid="pone.0257958.ref019" ref-type="bibr">19</xref>]) distancing measures, or even a full lockdown, are common examples of interventions aimed to fight the disease. When and to which degree such measures are applied is determined by the <italic toggle="yes">disease control policy</italic>. Consider a disease control policy based on vaccination campaigns, where the intervention consists of vaccinating a number of individuals per day, across all compartments, i.e., without distinguishing between susceptible, exposed, recovered, and so on. Let <italic toggle="yes">v</italic>(<italic toggle="yes">t</italic>) be the fraction of the total population vaccinated on day <italic toggle="yes">t</italic>. This function, between the initial and final times <italic toggle="yes">t</italic><sub>0</sub> and <italic toggle="yes">t</italic><sub><italic toggle="yes">f</italic></sub> (i.e. on the interval [<italic toggle="yes">t</italic><sub>0</sub>, <italic toggle="yes">t</italic><sub><italic toggle="yes">f</italic></sub>]), determines the government’s vaccination policy. Similarly, let <italic toggle="yes">s</italic>(<italic toggle="yes">t</italic>) take the value 1 if the country is in lockdown on day <italic toggle="yes">t</italic> and 0 if it is not. Then the government’s lockdown policy between times <italic toggle="yes">t</italic><sub>0</sub> and <italic toggle="yes">t</italic><sub><italic toggle="yes">f</italic></sub> corresponds to the function <italic toggle="yes">s</italic>(<italic toggle="yes">t</italic>).
<disp-formula id="pone.0257958.e001"><alternatives><graphic xlink:href="pone.0257958.e001.jpg" id="pone.0257958.e001g" position="anchor"/><mml:math id="M1" display="block" overflow="scroll"><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mspace width="4pt"/><mml:mtext>lockdown</mml:mtext><mml:mspace width="4pt"/><mml:mtext>off</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mspace width="4pt"/><mml:mtext>lockdown</mml:mtext><mml:mspace width="4pt"/><mml:mtext>off</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></alternatives><label>(1)</label></disp-formula>
If the government is intervening both through vaccination and lockdown, then its disease control policy will be identified by <italic toggle="yes">both</italic> functions <italic toggle="yes">v</italic>(<italic toggle="yes">t</italic>) and <italic toggle="yes">s</italic>(<italic toggle="yes">t</italic>). Note that, whereas <italic toggle="yes">v</italic>(<italic toggle="yes">t</italic>) can take a continuum of values, <italic toggle="yes">s</italic>(<italic toggle="yes">t</italic>) can only have finitely many. In the following, we will call the first class of interventions <italic toggle="yes">continuous</italic>; and the second, <italic toggle="yes">discrete</italic>. In general, a policy for disease control will combine both kinds of measures, but, as we will see, optimizing over one class or the other requires very different techniques.</p>
              <p>The above are instances of <italic toggle="yes">non-adaptive policies</italic> for disease control, because the functions <italic toggle="yes">s</italic>, <italic toggle="yes">v</italic> only depend on the time <italic toggle="yes">t</italic>, and not, e.g., on the current death rate. A general <italic toggle="yes">adaptive</italic> policy for disease control would take into account the whole past history of data gathered by the government before deciding what to do at each step. Although in the following all our proposed policies are non-adaptive, the formalism we introduce allows one to optimize over adaptive policies as well.</p>
              <p>In conclusion, a disease control policy can always be associated to a time-dependent vector function <bold><italic toggle="yes">α</italic></bold> and perhaps some other observed variables <bold><italic toggle="yes">o</italic></bold>, where each vector entry represents a type of government intervention at time <italic toggle="yes">t</italic>. In turn, we can use a variable vector <inline-formula id="pone.0257958.e002"><alternatives><graphic xlink:href="pone.0257958.e002.jpg" id="pone.0257958.e002g" position="anchor"/><mml:math id="M2" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> to parametrize the class of considered policies, that is, <bold><italic toggle="yes">α</italic></bold>(<italic toggle="yes">t</italic>, <bold><italic toggle="yes">o</italic></bold>) = <bold><italic toggle="yes">α</italic></bold>(<italic toggle="yes">t</italic>, <bold><italic toggle="yes">o</italic></bold>;<bold><italic toggle="yes">μ</italic></bold>). Since <bold><italic toggle="yes">μ</italic></bold> completely determines the policy <bold><italic toggle="yes">α</italic></bold>, we can also regard the parameters <bold><italic toggle="yes">μ</italic></bold> as the disease policy. We will do so from now on.</p>
              <p>The applied policy <bold><italic toggle="yes">μ</italic></bold> is assumed to influence the compartment occupation within the time interval [<italic toggle="yes">t</italic><sub>0</sub>, <italic toggle="yes">t</italic><sub><italic toggle="yes">f</italic></sub>]. That is, <bold><italic toggle="yes">x</italic></bold> is both a function of <italic toggle="yes">t</italic> and <bold><italic toggle="yes">μ</italic></bold>. In this work we are interested in devising policies for disease control which guarantee that the spread of the disease evolves under certain conditions. For example, any country has a fixed number of critical care beds, which we denote by <inline-formula id="pone.0257958.e003"><alternatives><graphic xlink:href="pone.0257958.e003.jpg" id="pone.0257958.e003g" position="anchor"/><mml:math id="M3" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">B</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math></alternatives></inline-formula>. At each time <italic toggle="yes">t</italic> ∈ [<italic toggle="yes">t</italic><sub>0</sub>, <italic toggle="yes">t</italic><sub><italic toggle="yes">f</italic></sub>], it is desirable that the number of individuals admitted to critical care in hospitals, <inline-formula id="pone.0257958.e004"><alternatives><graphic xlink:href="pone.0257958.e004.jpg" id="pone.0257958.e004g" position="anchor"/><mml:math id="M4" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">C</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, does not exceed that capacity. That is, we require that
<disp-formula id="pone.0257958.e005"><alternatives><graphic xlink:href="pone.0257958.e005.jpg" id="pone.0257958.e005g" position="anchor"/><mml:math id="M5" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="script">C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:msub><mml:mi mathvariant="script">B</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mspace width="4pt"/><mml:mtext>for</mml:mtext><mml:mspace width="4pt"/><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula>
We will call any such condition on the policy, or on its effect on the evolution of the disease, a <italic toggle="yes">constraint</italic>. Further examples of relevant constraints are the requirement that the number of planned vaccinations does not exceed the government’s total supply, or that the death rate does not surpass a given threshold.</p>
              <p>Finally, among all policies satisfying the desired constraints, we typically wish to identify the one that minimizes a certain quantity. For example, for many diseases, a simple physical distancing policy that satisfies the constraint <xref rid="pone.0257958.e005" ref-type="disp-formula">(2)</xref> consists of declaring a lockdown throughout the whole time interval [<italic toggle="yes">t</italic><sub>0</sub>, <italic toggle="yes">t</italic><sub><italic toggle="yes">f</italic></sub>], i.e., <italic toggle="yes">s</italic>(<italic toggle="yes">t</italic>) = 1 for <italic toggle="yes">t</italic> ∈ [<italic toggle="yes">t</italic><sub>0</sub>, <italic toggle="yes">t</italic><sub><italic toggle="yes">f</italic></sub>]. This policy is arguably impractical, difficult to enforce and harmful to its citizens’ psychological health, as well as to the national economy. More rationally, one is interested in finding alternative disease policies which, while respecting the critical care occupation constraint, minimize the number of days of lockdown. Alternatively, one may wish to minimize the total number of deaths during the interval [<italic toggle="yes">t</italic><sub>0</sub>, <italic toggle="yes">t</italic><sub><italic toggle="yes">f</italic></sub>], or the number of infected people. In general, the figure of merit or quantity that we wish to minimize will be a complicated functional of the considered policy <bold><italic toggle="yes">α</italic></bold> and <bold><italic toggle="yes">x</italic></bold>. We will call this functional the <italic toggle="yes">objective function</italic>. A sufficiently complex objective function, together with the appropriate optimization constraints, can meet any conceivable set of societal demands.</p>
              <p>The optimization problem sketched above is mathematically ill-defined, unless we specify how <bold><italic toggle="yes">x</italic></bold> varies with the parameters <bold><italic toggle="yes">μ</italic></bold> determining the policy. In order to predict the natural course of a disease or how a given policy might affect its spread, experts make use of mathematical models. In this paper, we will mainly be concerned with <italic toggle="yes">deterministic compartmental models</italic>, but we will show also how our method extends to stochastic models. In these models, the whole population is divided into a number of basic compartments and the interactions between those compartments are modeled, in the deterministic case, through a system of ordinary differential equations. Given the occupation <bold><italic toggle="yes">x</italic></bold><sub><bold>0</bold></sub> of the compartments at time <italic toggle="yes">t</italic><sub>0</sub>, these models allow us to compute the value of <bold><italic toggle="yes">x</italic></bold> at any instant <italic toggle="yes">t</italic> ∈ [<italic toggle="yes">t</italic><sub>0</sub>, <italic toggle="yes">t</italic><sub><italic toggle="yes">f</italic></sub>] as a function of the policy <bold><italic toggle="yes">μ</italic></bold>. That is, each model provides an implicit functional relation of the form
<disp-formula id="pone.0257958.e006"><alternatives><graphic xlink:href="pone.0257958.e006.jpg" id="pone.0257958.e006g" position="anchor"/><mml:math id="M6" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mn mathvariant="bold">0</mml:mn></mml:msub><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula></p>
              <p>Past literature on disease control has made extensive use of compartmental models to recommend specific strategies for policy-makers in an effort to control the spread of a disease. In many cases, suitable policies are devised through a mixture of intuition and grid search, see [<xref rid="pone.0257958.ref015" ref-type="bibr">15</xref>, <xref rid="pone.0257958.ref020" ref-type="bibr">20</xref>–<xref rid="pone.0257958.ref022" ref-type="bibr">22</xref>]. The starting point is a family of disease control policies with one or two unknowns. For instance, in pulse vaccination [<xref rid="pone.0257958.ref021" ref-type="bibr">21</xref>], those unknowns are the time intervals between two mass vaccinations and the vaccination rate. In this paper, we propose a scheme that allows for the optimization over policies specified by thousands of parameters in the space of a few hours. Our scheme, detailed in the following sections, is based on a standard tool in optimization theory and machine learning known as <italic toggle="yes">gradient descent</italic> [<xref rid="pone.0257958.ref023" ref-type="bibr">23</xref>, <xref rid="pone.0257958.ref024" ref-type="bibr">24</xref>]. Starting with a rough guess for the optimal policy <bold><italic toggle="yes">μ</italic></bold><sup>(0)</sup>, gradient descent methods generate a sequence of policies <bold><italic toggle="yes">μ</italic></bold><sup>(1)</sup>, <bold><italic toggle="yes">μ</italic></bold><sup>(2)</sup>, … which typically exhibit increasingly better performance. Although the gradient method is not guaranteed to converge to the optimal policy, after many iterations it generates solutions that are good enough for many practical purposes. In fact, gradient descent is the method most commonly used to train deep neural networks [<xref rid="pone.0257958.ref014" ref-type="bibr">14</xref>] and support vector machines [<xref rid="pone.0257958.ref025" ref-type="bibr">25</xref>].</p>
              <p>Importantly, the computational resources required to carry out the gradient descent method are comparable to the cost of running a full simulation between times <italic toggle="yes">t</italic><sub>0</sub> and <italic toggle="yes">t</italic><sub><italic toggle="yes">f</italic></sub> with the considered disease model. Furthermore, the necessary computations can be <italic toggle="yes">parallelized</italic> for policies depending on many parameters. Although the focus of this paper is on compartmental disease models, our main ideas can also be used to understand ecological systems undergoing more complex dynamics [<xref rid="pone.0257958.ref026" ref-type="bibr">26</xref>], see Appendix D. Even in such complicated scenarios, the former scaling laws hold: provided that we can run the considered disease model, we can apply the gradient method to optimize over policies of disease control.</p>
            </sec>
            <sec id="sec003">
              <title>3 The gradient method</title>
              <p>We next introduce the gradient method and show how one can use it to tackle an abstract optimization problem. Given functions <inline-formula id="pone.0257958.e007"><alternatives><graphic xlink:href="pone.0257958.e007.jpg" id="pone.0257958.e007g" position="anchor"/><mml:math id="M7" display="inline" overflow="scroll"><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>→</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, for <italic toggle="yes">i</italic> = 1, …, <italic toggle="yes">K</italic>, consider the following task:
<disp-formula id="pone.0257958.e008"><alternatives><graphic xlink:href="pone.0257958.e008.jpg" id="pone.0257958.e008g" position="anchor"/><mml:math id="M8" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:munder><mml:mtext>min</mml:mtext><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:munder><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>such</mml:mtext><mml:mspace width="4pt"/><mml:mtext>that</mml:mtext><mml:mspace width="4pt"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="4pt"/><mml:mtext>for</mml:mtext><mml:mspace width="4pt"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(4)</label></disp-formula>
Each of the conditions <italic toggle="yes">g</italic><sub><italic toggle="yes">i</italic></sub>(<bold><italic toggle="yes">μ</italic></bold>) ≤ <italic toggle="yes">h</italic><sub><italic toggle="yes">i</italic></sub> is called a <italic toggle="yes">constraint</italic>.</p>
              <p>Define <italic toggle="yes">M</italic> = {<bold><italic toggle="yes">μ</italic></bold>: <italic toggle="yes">g</italic><sub><italic toggle="yes">i</italic></sub>(<bold><italic toggle="yes">μ</italic></bold>) ≤ <italic toggle="yes">h</italic><sub><italic toggle="yes">i</italic></sub>, <italic toggle="yes">i</italic> = 1, …, <italic toggle="yes">K</italic>}. If <italic toggle="yes">f</italic> is sub-differentiable, a simple heuristic to solve this problem is the projected gradient method [<xref rid="pone.0257958.ref023" ref-type="bibr">23</xref>]. Call <bold><italic toggle="yes">μ</italic></bold><sup>⋆</sup> the solution of the problem. Starting from an initial guess <bold><italic toggle="yes">μ</italic></bold><sup>(0)</sup>, the gradient method generates a sequence of values (<bold><italic toggle="yes">μ</italic></bold><sup>(<italic toggle="yes">k</italic>)</sup>)<sub><italic toggle="yes">k</italic></sub> with the property that lim<sub><italic toggle="yes">k</italic>→∞</sub>
<bold><italic toggle="yes">μ</italic></bold><sup>(<italic toggle="yes">k</italic>)</sup> = <bold><italic toggle="yes">μ</italic></bold><sup>⋆</sup>, provided that <italic toggle="yes">M</italic>, <italic toggle="yes">f</italic> are, respectively, a convex set and a convex function [<xref rid="pone.0257958.ref023" ref-type="bibr">23</xref>]. The sequence (<bold><italic toggle="yes">μ</italic></bold><sup>(<italic toggle="yes">k</italic>)</sup>)<sub><italic toggle="yes">k</italic></sub> is generated recursively via the relation
<disp-formula id="pone.0257958.e009"><alternatives><graphic xlink:href="pone.0257958.e009.jpg" id="pone.0257958.e009g" position="anchor"/><mml:math id="M9" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:mi>ϵ</mml:mi><mml:msub><mml:mo>∇</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(5)</label></disp-formula>
where, for any set <inline-formula id="pone.0257958.e010"><alternatives><graphic xlink:href="pone.0257958.e010.jpg" id="pone.0257958.e010g" position="anchor"/><mml:math id="M10" display="inline" overflow="scroll"><mml:mrow><mml:mi>A</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, <italic toggle="yes">π</italic><sub><italic toggle="yes">A</italic></sub>(<bold><italic toggle="yes">z</italic></bold>) denotes the point <bold><italic toggle="yes">y</italic></bold> ∈ <italic toggle="yes">A</italic> that minimizes the Euclidean distance, i.e., min<sub><bold><italic toggle="yes">y</italic></bold>∈<italic toggle="yes">A</italic></sub> ‖<bold><italic toggle="yes">y</italic></bold> − <bold><italic toggle="yes">x</italic></bold>‖<sub>2</sub>.</p>
              <p>Unfortunately, in the problems we encounter in this paper, <italic toggle="yes">f</italic> is not convex and, sometimes, neither is <italic toggle="yes">M</italic>. This implies that the sequence output by the projected gradient method is not guaranteed to converge to the solution of the problem, but to a local minimum thereof.</p>
              <p>In machine learning, optimization problems with non-convex objective function <italic toggle="yes">f</italic> and <inline-formula id="pone.0257958.e011"><alternatives><graphic xlink:href="pone.0257958.e011.jpg" id="pone.0257958.e011g" position="anchor"/><mml:math id="M11" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> are legion. To solve them, deep learning practitioners typically use variants of the gradient method sketched above. One of these variants, Adam [<xref rid="pone.0257958.ref027" ref-type="bibr">27</xref>], is extensively used to train neural networks.</p>
              <p>Adam works as follows. Starting with the null vectors <inline-formula id="pone.0257958.e012"><alternatives><graphic xlink:href="pone.0257958.e012.jpg" id="pone.0257958.e012g" position="anchor"/><mml:math id="M12" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">m</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, vector sequences are generated according to the following iteration rule:
<disp-formula id="pone.0257958.e013"><alternatives><graphic xlink:href="pone.0257958.e013.jpg" id="pone.0257958.e013g" position="anchor"/><mml:math id="M13" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mo>∇</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">m</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msup><mml:mi mathvariant="bold-italic">m</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>⊙</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold-italic">m</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mi mathvariant="bold-italic">m</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mn>1</mml:mn><mml:mi>k</mml:mi></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mn>2</mml:mn><mml:mi>k</mml:mi></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:mi>ϵ</mml:mi><mml:mfrac><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold-italic">m</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:msqrt><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:msqrt><mml:mo>+</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(6)</label></disp-formula>
where <italic toggle="yes">G</italic><sup>(<italic toggle="yes">k</italic>)</sup> ⊙ <italic toggle="yes">G</italic><sup>(<italic toggle="yes">k</italic>)</sup> denotes the vector of the element-wise product; similarly, the fraction and square root in the definition of <bold><italic toggle="yes">μ</italic></bold><sup>(<italic toggle="yes">k</italic>)</sup> are defined element-wise. Recommended values for the free parameters <italic toggle="yes">ϵ</italic>, <italic toggle="yes">b</italic><sub>1</sub>, <italic toggle="yes">b</italic><sub>2</sub>, <italic toggle="yes">δ</italic> are <italic toggle="yes">ϵ</italic> = 0.001, <italic toggle="yes">b</italic><sub>1</sub> = 0.9, <italic toggle="yes">b</italic><sub>2</sub> = 0.999 and <italic toggle="yes">δ</italic> = 10<sup>−8</sup> [<xref rid="pone.0257958.ref027" ref-type="bibr">27</xref>].</p>
              <p>Like the projected gradient method, Adam is not guaranteed to converge to the optimal solution of the problem. However, provided that the initial conditions and the learning rate <italic toggle="yes">ϵ</italic> are chosen with care, Adam has been observed to typically output a local minimum that is “good enough”.</p>
              <p>Note that, by taking <inline-formula id="pone.0257958.e014"><alternatives><graphic xlink:href="pone.0257958.e014.jpg" id="pone.0257958.e014g" position="anchor"/><mml:math id="M14" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, it is not clear how to enforce that the solution satisfies constraints of the form <italic toggle="yes">g</italic><sub><italic toggle="yes">i</italic></sub>(<bold><italic toggle="yes">μ</italic></bold>) ≤ <italic toggle="yes">h</italic><sub><italic toggle="yes">i</italic></sub>. The answer is to include those constraints as penalties in the objective function. That is, rather than minimizing <italic toggle="yes">f</italic>, we apply Adam to minimize the function
<disp-formula id="pone.0257958.e015"><alternatives><graphic xlink:href="pone.0257958.e015.jpg" id="pone.0257958.e015g" position="anchor"/><mml:math id="M15" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:msub><mml:mi>ν</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(7)</label></disp-formula>
where <italic toggle="yes">ν</italic><sub><italic toggle="yes">i</italic></sub> ≫ 1 and <italic toggle="yes">z</italic><sup>+</sup> denotes the positive part of <italic toggle="yes">z</italic>, i.e., <italic toggle="yes">z</italic><sup>+</sup> = <italic toggle="yes">z</italic> for <italic toggle="yes">z</italic> &gt; 0; otherwise, <italic toggle="yes">z</italic><sup>+</sup> = 0. For high enough values of {<italic toggle="yes">ν</italic><sub><italic toggle="yes">i</italic></sub>}<sub><italic toggle="yes">i</italic></sub>, the solution of the problem will just violate the constraints slightly, i.e., <italic toggle="yes">h</italic><sub><italic toggle="yes">i</italic></sub> − <italic toggle="yes">g</italic>(<bold><italic toggle="yes">μ</italic></bold><sup>⋆</sup>) ∈ [−<italic toggle="yes">δ</italic>, ∞), for <italic toggle="yes">δ</italic> ≪ 1. If no violation whatsoever is desired then one can instead optimize over a function of the form
<disp-formula id="pone.0257958.e016"><alternatives><graphic xlink:href="pone.0257958.e016.jpg" id="pone.0257958.e016g" position="anchor"/><mml:math id="M16" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:msub><mml:mi>ν</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mi>δ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(8)</label></disp-formula>
with <italic toggle="yes">δ</italic>′ &gt; 0.</p>
              <p>In some situations, the objective function <italic toggle="yes">f</italic> will be complicated to the point that computing its exact gradient is an intractable problem. It might be possible, though, to generate a random vector <inline-formula id="pone.0257958.e017"><alternatives><graphic xlink:href="pone.0257958.e017.jpg" id="pone.0257958.e017g" position="anchor"/><mml:math id="M17" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mo>∇</mml:mo><mml:mo>˜</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:msub><mml:mi>f</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> with the property
<disp-formula id="pone.0257958.e018"><alternatives><graphic xlink:href="pone.0257958.e018.jpg" id="pone.0257958.e018g" position="anchor"/><mml:math id="M18" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>⟨</mml:mo><mml:msub><mml:mover accent="true"><mml:mo>∇</mml:mo><mml:mo>˜</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:msub><mml:mi>f</mml:mi><mml:mo>⟩</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mo>∇</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:msub><mml:mi>f</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(9)</label></disp-formula></p>
              <p>In such a predicament, we can solve the original optimization problem <xref rid="pone.0257958.e008" ref-type="disp-formula">(4)</xref> through stochastic gradient descent methods [<xref rid="pone.0257958.ref024" ref-type="bibr">24</xref>]. Stochastic gradient descent consists of applying the considered gradient method, with the difference that, every time that the method requires the gradient of <italic toggle="yes">f</italic>, we input the random variable <inline-formula id="pone.0257958.e019"><alternatives><graphic xlink:href="pone.0257958.e019.jpg" id="pone.0257958.e019g" position="anchor"/><mml:math id="M19" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mo>∇</mml:mo><mml:mo>˜</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:msub><mml:mi>f</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> instead. Namely, it suffices to replace ∇<sub><bold><italic toggle="yes">μ</italic></bold></sub>
<italic toggle="yes">f</italic>(<bold><italic toggle="yes">μ</italic></bold><sup>(<italic toggle="yes">k</italic>−1)</sup>) by <inline-formula id="pone.0257958.e020"><alternatives><graphic xlink:href="pone.0257958.e020.jpg" id="pone.0257958.e020g" position="anchor"/><mml:math id="M20" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mo>∇</mml:mo><mml:mo>˜</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> in the iterative Eqs <xref rid="pone.0257958.e009" ref-type="disp-formula">(5)</xref> and <xref rid="pone.0257958.e013" ref-type="disp-formula">(6)</xref>. As before, if both <italic toggle="yes">M</italic> and <italic toggle="yes">f</italic> are convex, stochastic gradient descent methods are guaranteed to converge to the optimal solution of problem <xref rid="pone.0257958.e008" ref-type="disp-formula">(4)</xref> [<xref rid="pone.0257958.ref024" ref-type="bibr">24</xref>].</p>
            </sec>
            <sec id="sec004">
              <title>4 Overview of techniques</title>
              <p>Our novel contribution is to show how to apply the gradient method to any disease control scenario and optimize over <italic toggle="yes">discrete</italic> or <italic toggle="yes">continuous</italic> response policies. In both cases the task is first to identify a suitable functional <italic toggle="yes">A</italic>, that is to be minimised, and then to show how to compute the gradient of it, which appears in the first line of the Adam algorithm in <xref rid="pone.0257958.e013" ref-type="disp-formula">Eq (6)</xref>, such that the algorithm can step to the next iteration.</p>
              <p>In a discrete policy, the parameters describing the government intervention can only take a finite number of values. <xref rid="pone.0257958.e001" ref-type="disp-formula">Eq (1)</xref> is an example of a discrete policy, because on day <italic toggle="yes">t</italic> the government can either declare a lockdown (<italic toggle="yes">s</italic>(<italic toggle="yes">t</italic>) = 1) or declare no lockdown (<italic toggle="yes">s</italic>(<italic toggle="yes">t</italic>) = 0): we allow for no values of <italic toggle="yes">s</italic>(<italic toggle="yes">t</italic>) inbetween.</p>
              <p>On the other hand, a continuous policy is one in which the parameters that define the policy, which in general we denote by the vector <bold><italic toggle="yes">μ</italic></bold>, are allowed to vary over a continuum. For example, the fraction <italic toggle="yes">v</italic>(<italic toggle="yes">t</italic>) of the population vaccinated on day <italic toggle="yes">t</italic> can take any value between 0 and 1.</p>
              <p>Regardless of whether we chose to optimise over discrete or continuous policies, our starting point is an ordinary differential equation of the form
<disp-formula id="pone.0257958.e021"><alternatives><graphic xlink:href="pone.0257958.e021.jpg" id="pone.0257958.e021g" position="anchor"/><mml:math id="M21" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msup><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>;</mml:mo><mml:mspace width="8pt"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(10)</label></disp-formula>
where the entries of the vector <bold><italic toggle="yes">x</italic></bold> represent the occupations of the different compartments of a disease model and <bold><italic toggle="yes">μ</italic></bold> represents a continuous or discrete parametrization of the effects of a given policy. Let <inline-formula id="pone.0257958.e022"><alternatives><graphic xlink:href="pone.0257958.e022.jpg" id="pone.0257958.e022g" position="anchor"/><mml:math id="M22" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> be the solution of <xref rid="pone.0257958.e021" ref-type="disp-formula">Eq (10)</xref> with initial conditions <bold><italic toggle="yes">x</italic></bold>(0) = <bold><italic toggle="yes">x</italic></bold><sub>0</sub> and <inline-formula id="pone.0257958.e023"><alternatives><graphic xlink:href="pone.0257958.e023.jpg" id="pone.0257958.e023g" position="anchor"/><mml:math id="M23" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>, where the initial policy condition is typically taken to be ‘lockdown off’. We consider the problem of finding the parameters <bold><italic toggle="yes">μ</italic></bold><sup>⋆</sup> such that <bold><italic toggle="yes">x</italic></bold>(<italic toggle="yes">t</italic>;<bold><italic toggle="yes">μ</italic></bold><sup>⋆</sup>, <bold><italic toggle="yes">x</italic></bold><sub>0</sub>) minimizes a given functional <italic toggle="yes">A</italic>. This functional defines how we wish to control the disease and what for: it might represent the number and duration of lockdown periods, etc. If the initial conditions <bold><italic toggle="yes">x</italic></bold><sub>0</sub> are known, then it makes sense to consider functionals of the form
<disp-formula id="pone.0257958.e024"><alternatives><graphic xlink:href="pone.0257958.e024.jpg" id="pone.0257958.e024g" position="anchor"/><mml:math id="M24" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>A</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:msubsup><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mspace width="0.277778em"/><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(11)</label></disp-formula>
where, as discussed in Section 3, constraints which we wish the solution <bold><italic toggle="yes">x</italic></bold>(<italic toggle="yes">t</italic>;<bold><italic toggle="yes">μ</italic></bold><sup>⋆</sup>, <bold><italic toggle="yes">x</italic></bold><sub>0</sub>) to satisfy are incorporated into <inline-formula id="pone.0257958.e025"><alternatives><graphic xlink:href="pone.0257958.e025.jpg" id="pone.0257958.e025g" position="anchor"/><mml:math id="M25" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. For instance, if we want that the number of patients in critical care does not exceed the number of beds, i.e. <xref rid="pone.0257958.e005" ref-type="disp-formula">Eq (2)</xref> to hold, then one of the terms in <inline-formula id="pone.0257958.e026"><alternatives><graphic xlink:href="pone.0257958.e026.jpg" id="pone.0257958.e026g" position="anchor"/><mml:math id="M26" display="inline" overflow="scroll"><mml:mi mathvariant="script">L</mml:mi></mml:math></alternatives></inline-formula> would be
<disp-formula id="pone.0257958.e027"><alternatives><graphic xlink:href="pone.0257958.e027.jpg" id="pone.0257958.e027g" position="anchor"/><mml:math id="M27" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>ρ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(12)</label></disp-formula>
with <italic toggle="yes">ρ</italic>(<italic toggle="yes">t</italic>) ≫ 1. Similarly, to model a constraint on the vaccine supply of the form ∫ <italic toggle="yes">dt v</italic>(<italic toggle="yes">t</italic>;<bold><italic toggle="yes">μ</italic></bold>) ≤ <italic toggle="yes">V</italic>, we would add the term
<disp-formula id="pone.0257958.e028"><alternatives><graphic xlink:href="pone.0257958.e028.jpg" id="pone.0257958.e028g" position="anchor"/><mml:math id="M28" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>λ</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mo>∫</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mspace width="0.277778em"/><mml:mi>v</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>)</mml:mo><mml:mo>-</mml:mo><mml:mi>V</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(13)</label></disp-formula>
with λ ≫ 1.</p>
              <p>As it turns out, minimizing functional <xref rid="pone.0257958.e024" ref-type="disp-formula">(11)</xref> (or more complicated ones, see Appendix B) requires different techniques depending on whether the desired policy is continuous or discrete.</p>
              <sec id="sec005">
                <title>4.1 Continuous policies</title>
                <p>If all the parameters <bold><italic toggle="yes">μ</italic></bold> defining the policy are allowed to take arbitrary values in <inline-formula id="pone.0257958.e029"><alternatives><graphic xlink:href="pone.0257958.e029.jpg" id="pone.0257958.e029g" position="anchor"/><mml:math id="M29" display="inline" overflow="scroll"><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:math></alternatives></inline-formula> and their effect on the disease’s equations of motion <xref rid="pone.0257958.e101" ref-type="disp-formula">(26)</xref> is differentiable, then one can simply apply gradient descent methods to minimize <italic toggle="yes">A</italic>(<bold><italic toggle="yes">μ</italic></bold>, <bold><italic toggle="yes">x</italic></bold><sub>0</sub>). The only difficulty stems in computing ∇<sub><bold><italic toggle="yes">μ</italic></bold></sub>
<italic toggle="yes">A</italic> (i.e., the first line of the Adam algorithm in <xref rid="pone.0257958.e013" ref-type="disp-formula">Eq (6)</xref>). For functionals of the form <xref rid="pone.0257958.e024" ref-type="disp-formula">(11)</xref>, we have
<disp-formula id="pone.0257958.e030"><alternatives><graphic xlink:href="pone.0257958.e030.jpg" id="pone.0257958.e030g" position="anchor"/><mml:math id="M30" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:msubsup><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi mathvariant="script">L</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi mathvariant="script">L</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(14)</label></disp-formula>
In order to evaluate this quantity to step the algorithm, the challenge is to compute the derivatives <inline-formula id="pone.0257958.e031"><alternatives><graphic xlink:href="pone.0257958.e031.jpg" id="pone.0257958.e031g" position="anchor"/><mml:math id="M31" display="inline" overflow="scroll"><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula>. In Appendix B we show that these derivatives arise as the solution of a system of ordinary differential equations, of complexity comparable to that of <xref rid="pone.0257958.e021" ref-type="disp-formula">Eq (10)</xref>. We also explain how to use stochastic gradient descent to deal with scenarios where the model parameters (e.g., the basic reproduction number <italic toggle="yes">R</italic><sub>0</sub>) and/or the initial conditions <bold><italic toggle="yes">x</italic></bold><sub>0</sub> are only known to lie within some bounds, or when the evolution is stochastic. In either case, once a method to compute <xref rid="pone.0257958.e030" ref-type="disp-formula">(14)</xref> is established (or, in the case of uncertainty in the initial conditions, some unbiased statistical estimator thereof (see Appendix B)), one can simply run the vanilla gradient descent <xref rid="pone.0257958.e009" ref-type="disp-formula">(5)</xref> or the Adam algorithm <xref rid="pone.0257958.e013" ref-type="disp-formula">(6)</xref> to arrive at a quasi-optimal policy.</p>
              </sec>
              <sec id="sec006">
                <title>4.2 Discrete policies</title>
                <p>When some or all the entries of <bold><italic toggle="yes">μ</italic></bold> are restricted to take values on a finite, fixed set, it is clear that one cannot apply gradient descent methods straightforwardly in order to minimize the objective function. In fact, optimizations over discrete variables are, in general, a very difficult endeavor: it can be argued that problems which appear simple do not have an efficient solution [<xref rid="pone.0257958.ref028" ref-type="bibr">28</xref>]. Nonetheless, in Appendix C we present two heuristics to tackle such optimizations in the context of policies for disease control.</p>
                <p>The first heuristic consists of mapping the original minimization problem to an optimization over <italic toggle="yes">probabilistic</italic> policies, whereby the government decides how to intervene by sampling a discrete probability distribution, which is continuously dependent on a number of auxiliary (continuous) parameters. By applying stochastic gradient descent methods over such auxiliary parameters, we can find the probabilistic policy that minimizes the average value of the objective function. As shown in Appendix C, independently of the initial conditions, the gradient method is guaranteed to converge to a deterministic policy.</p>
                <p>The second heuristic is tailor-made for optimizations over lockdown (discrete) policies, although it can be easily extended to deal with arbitrary discrete policies. Consider a scenario in which the government is allowed to declare or lift a lockdown at any time. In this case, we can parametrize the policy by the duration of each lockdown phase and the pauses in between, and use gradient descent methods to arrive at the optimal times. In Appendix C we show that estimating the correspondent gradients only requires a minor modification of the methods developed for continuous policies.</p>
              </sec>
            </sec>
            <sec id="sec007">
              <title>5 Application: COVID-19</title>
              <p>To illustrate the use of gradient descent for policy design, we consider a variant of the extended “susceptible-exposed-infected-recovered” (SEIR) disease model proposed in [<xref rid="pone.0257958.ref015" ref-type="bibr">15</xref>] to predict the impact of COVID-19 in the USA, a schematic of which is shown in <xref rid="pone.0257958.g001" ref-type="fig">Fig 1</xref> and the details of which appear in Appendix A. Each state variable <italic toggle="yes">X</italic> in the diagram corresponds to the <italic toggle="yes">fraction</italic> of the whole population <inline-formula id="pone.0257958.e032"><alternatives><graphic xlink:href="pone.0257958.e032.jpg" id="pone.0257958.e032g" position="anchor"/><mml:math id="M32" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> in the corresponding diagram. From now on, we denote intensive quantities like <italic toggle="yes">X</italic> with a normal mathematical font, while extensive quantities <inline-formula id="pone.0257958.e033"><alternatives><graphic xlink:href="pone.0257958.e033.jpg" id="pone.0257958.e033g" position="anchor"/><mml:math id="M33" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">X</mml:mi><mml:mo>=</mml:mo><mml:mi>X</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> are to be represented with calligraphic letters. The clinical parameters of the model in <xref rid="pone.0257958.g001" ref-type="fig">Fig 1</xref>, such as recovery and hospitalization rates, were estimated in [<xref rid="pone.0257958.ref029" ref-type="bibr">29</xref>, <xref rid="pone.0257958.ref030" ref-type="bibr">30</xref>], based on early reports from COVID-19 cases in the UK, China and Italy. Following the model in [<xref rid="pone.0257958.ref015" ref-type="bibr">15</xref>], the disease transmission is assumed to be seasonal by analogy with the known behavior of betacoronaviruses such as HCoV-OC43 [<xref rid="pone.0257958.ref030" ref-type="bibr">30</xref>], with a baseline reproduction number between 2 and 2.5, following fits of the early growth-rate of the epidemic in Wuhan [<xref rid="pone.0257958.ref011" ref-type="bibr">11</xref>, <xref rid="pone.0257958.ref012" ref-type="bibr">12</xref>].</p>
              <p>A relevant compartment in this model is <inline-formula id="pone.0257958.e034"><alternatives><graphic xlink:href="pone.0257958.e034.jpg" id="pone.0257958.e034g" position="anchor"/><mml:math id="M34" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>≡</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, the population occupying a critical care bed at time <italic toggle="yes">t</italic>. The patients sent to critical care cannot breathe unassisted, and thus it is fundamental to ensure that such capacity is not surpassed, namely, that the constraint <xref rid="pone.0257958.e005" ref-type="disp-formula">(2)</xref> holds. For our simulations, we chose a population size of <inline-formula id="pone.0257958.e035"><alternatives><graphic xlink:href="pone.0257958.e035.jpg" id="pone.0257958.e035g" position="anchor"/><mml:math id="M35" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>47</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> million and <inline-formula id="pone.0257958.e036"><alternatives><graphic xlink:href="pone.0257958.e036.jpg" id="pone.0257958.e036g" position="anchor"/><mml:math id="M36" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="script">B</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>9</mml:mn><mml:mo>.</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup><mml:mo>×</mml:mo><mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. That is, we assumed that the healthcare system provides 95 critical care beds per million inhabitants. This is a good approximation to the healthcare capacity of many European countries, as well as the USA.</p>
              <p>According to the chosen model, without intervention, the number of citizens requiring a bed in a critical care unit evolves according to <xref rid="pone.0257958.g002" ref-type="fig">Fig 2</xref> (see Appendix A for the exact initial conditions of our numerical simulations). As the reader can appreciate, between the third and seventh months, the number of people in need of critical care exceeds the capacity of the considered healthcare system by 18 times.</p>
              <fig position="float" id="pone.0257958.g002">
                <object-id pub-id-type="doi">10.1371/journal.pone.0257958.g002</object-id>
                <label>Fig 2</label>
                <caption>
                  <title>Occupation of critical care beds over two years with no policy intervention.</title>
                  <p>The red dashed line indicates the critical care capacity of the healthcare system.</p>
                </caption>
                <graphic xlink:href="pone.0257958.g002" position="float"/>
              </fig>
              <p>Vaccines against COVID-19 were not available during the first year of the pandemic. Hence initially most governments opted to control the disease via distancing measures and/or lockdowns. The effect of implementing a policy <italic toggle="yes">s</italic>(<italic toggle="yes">t</italic>) is to multiply the disease’s basic reproduction number <italic toggle="yes">R</italic><sub>0</sub> by a factor of <italic toggle="yes">r</italic> [<xref rid="pone.0257958.ref015" ref-type="bibr">15</xref>, <xref rid="pone.0257958.ref030" ref-type="bibr">30</xref>], i.e. <italic toggle="yes">R</italic><sub>0</sub> → <italic toggle="yes">rR</italic><sub>0</sub>, where
<disp-formula id="pone.0257958.e037"><alternatives><graphic xlink:href="pone.0257958.e037.jpg" id="pone.0257958.e037g" position="anchor"/><mml:math id="M37" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>r</mml:mi><mml:mo>≔</mml:mo><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(15)</label></disp-formula></p>
              <p>Depending on the discrete or continuous nature of the intervention, we shall consider two kinds of such non-pharmaceutical policies. On one hand, we will speak of <italic toggle="yes">lockdown policies</italic> when <italic toggle="yes">s</italic> is only allowed to take the values {0, 1}; those correspond to situations in which a <italic toggle="yes">lockdown</italic> is either on or off. For discrete <italic toggle="yes">s</italic>(<italic toggle="yes">t</italic>) as in <xref rid="pone.0257958.e001" ref-type="disp-formula">Eq (1)</xref>, the effect of a lockdown (<italic toggle="yes">s</italic> = 1) results in the reduction of the transmission rate <inline-formula id="pone.0257958.e038"><alternatives><graphic xlink:href="pone.0257958.e038.jpg" id="pone.0257958.e038g" position="anchor"/><mml:math id="M38" display="inline" overflow="scroll"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> in <xref rid="pone.0257958.e037" ref-type="disp-formula">Eq (15)</xref>. On the contrary, when the population is free to interact (<italic toggle="yes">s</italic> = 0) then <italic toggle="yes">r</italic> = 1 and there is no change in the disease’s basic reproduction number.</p>
              <p>On the other hand, we will speak of <italic toggle="yes">physical-distancing policies</italic> when <italic toggle="yes">s</italic> is allowed to take any value in the interval [0, 1]. Continuous values of <italic toggle="yes">s</italic>(<italic toggle="yes">t</italic>) correspond to intermediate measures (for example mandatory face masks, suspension of sport events, remote working, school closures), the effect of which can be tentatively estimated from available data [<xref rid="pone.0257958.ref029" ref-type="bibr">29</xref>].</p>
              <p>If distancing measures are the only type of intervention that a government uses, then a non-adaptive continuous policy is fully determined by the function <italic toggle="yes">s</italic>(<italic toggle="yes">t</italic>;<bold><italic toggle="yes">μ</italic></bold>) ∈ [0, 1]. To begin with, we will assume that the government can only declare new measures at the beginning of each week, i.e., that <italic toggle="yes">s</italic>(<italic toggle="yes">t</italic>) does not vary within the weekly intervals <italic toggle="yes">t</italic> ∈ [7<italic toggle="yes">k</italic>, 7(<italic toggle="yes">k</italic> + 1)] ≕ <italic toggle="yes">I</italic><sub><italic toggle="yes">k</italic></sub>, for <inline-formula id="pone.0257958.e039"><alternatives><graphic xlink:href="pone.0257958.e039.jpg" id="pone.0257958.e039g" position="anchor"/><mml:math id="M39" display="inline" overflow="scroll"><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">Z</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. With these conditions, <italic toggle="yes">s</italic>(<italic toggle="yes">t</italic>) can be expressed as
<disp-formula id="pone.0257958.e040"><alternatives><graphic xlink:href="pone.0257958.e040.jpg" id="pone.0257958.e040g" position="anchor"/><mml:math id="M40" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:mi>σ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>χ</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(16)</label></disp-formula>
where <inline-formula id="pone.0257958.e041"><alternatives><graphic xlink:href="pone.0257958.e041.jpg" id="pone.0257958.e041g" position="anchor"/><mml:math id="M41" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>χ</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the characteristic function of week number <italic toggle="yes">k</italic>, i.e., <inline-formula id="pone.0257958.e042"><alternatives><graphic xlink:href="pone.0257958.e042.jpg" id="pone.0257958.e042g" position="anchor"/><mml:math id="M42" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>χ</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> equals 1 if <italic toggle="yes">t</italic> is in the <italic toggle="yes">k</italic>-th week; and 0, otherwise. The characteristic function, thus, ensures that there is only one policy <italic toggle="yes">s</italic>(<italic toggle="yes">t</italic>) per week. <inline-formula id="pone.0257958.e043"><alternatives><graphic xlink:href="pone.0257958.e043.jpg" id="pone.0257958.e043g" position="anchor"/><mml:math id="M43" display="inline" overflow="scroll"><mml:mrow><mml:mi>σ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mtext>exp</mml:mtext><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula> denotes the sigmoid function, which guarantees that <italic toggle="yes">s</italic>(<italic toggle="yes">t</italic>) ∈ [0, 1] by continuously mapping the variables <inline-formula id="pone.0257958.e044"><alternatives><graphic xlink:href="pone.0257958.e044.jpg" id="pone.0257958.e044g" position="anchor"/><mml:math id="M44" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula>, such that, for <italic toggle="yes">t</italic> ∈ [<italic toggle="yes">t</italic><sub>0</sub>, <italic toggle="yes">t</italic><sub><italic toggle="yes">f</italic></sub>], <italic toggle="yes">s</italic>(<italic toggle="yes">t</italic>;{<italic toggle="yes">s</italic><sub><italic toggle="yes">k</italic></sub>}) is everywhere differentiable, making it amenable to the gradient method. The parameters to optimize over are <inline-formula id="pone.0257958.e045"><alternatives><graphic xlink:href="pone.0257958.e045.jpg" id="pone.0257958.e045g" position="anchor"/><mml:math id="M45" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>≡</mml:mo><mml:msub><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, since they fully define the government’s disease policy.</p>
              <p>In 2021, several vaccines against COVID-19 successfully passed clinical trials, and nowadays many governments are fighting the disease through national vaccination campaigns. We model the effect of a COVID-19 vaccination campaign by assuming that: a) the government vaccinates the population across all compartments, i.e., without distinguishing between susceptible, exposed, recovered, etc.; b) just susceptible individuals benefit from the vaccine; c) all such vaccinated individuals become immune to the disease. The reader can find the explicit model in Appendix A. Obviously, this model is a gross simplification of the effect of COVID-19 vaccines currently in the market, which on one hand varies depending on the particular vaccine and the prior exposure to COVID-19, and on the other hand does not seem to always confer full immunity to the disease [<xref rid="pone.0257958.ref031" ref-type="bibr">31</xref>]. More complicated vaccination models can be built to properly assess a government on vaccination policies, but, for the sake of illustration of our techniques, this simplified model will suffice.</p>
              <p>We place a cap of Λ = 0.0011 <italic toggle="yes">days</italic><sup>−1</sup> on the fraction of the population that can be vaccinated per day. We also assume that changes in the vaccination rate can only be made weekly. This brings us to parametrize the vaccination rate via the function
<disp-formula id="pone.0257958.e046"><alternatives><graphic xlink:href="pone.0257958.e046.jpg" id="pone.0257958.e046g" position="anchor"/><mml:math id="M46" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>Λ</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:mi>σ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>χ</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(17)</label></disp-formula>
Finally, we assume that the government holds a supply of vaccines for just a third of the total population. This means that, together with <xref rid="pone.0257958.e005" ref-type="disp-formula">(2)</xref>, we need to enforce the extra constraint
<disp-formula id="pone.0257958.e047"><alternatives><graphic xlink:href="pone.0257958.e047.jpg" id="pone.0257958.e047g" position="anchor"/><mml:math id="M47" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:msubsup><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mi>v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(18)</label></disp-formula>
We achieve this by adding the term <xref rid="pone.0257958.e028" ref-type="disp-formula">(13)</xref> to the objective function, with <inline-formula id="pone.0257958.e048"><alternatives><graphic xlink:href="pone.0257958.e048.jpg" id="pone.0257958.e048g" position="anchor"/><mml:math id="M48" display="inline" overflow="scroll"><mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, λ = 10<sup>4</sup>. Without additional constraints, this model represent the case of a vaccine with 100% efficacy. A reduced efficacy, let us denote it by <italic toggle="yes">e</italic> &lt; 1, can be straightforwardly modeled simply by multiplying the vaccination rate <italic toggle="yes">v</italic>(<italic toggle="yes">t</italic>) and the vaccine supply <italic toggle="yes">V</italic> by <italic toggle="yes">e</italic>.</p>
              <p>In all our examples, we never allow the number of people in the critical care compartment to exceed the maximal occupancy, i.e., we impose the constraint in <xref rid="pone.0257958.e005" ref-type="disp-formula">Eq (2)</xref>. To enforce it, we add the term <xref rid="pone.0257958.e027" ref-type="disp-formula">(12)</xref> to the objective function, with <inline-formula id="pone.0257958.e049"><alternatives><graphic xlink:href="pone.0257958.e049.jpg" id="pone.0257958.e049g" position="anchor"/><mml:math id="M49" display="inline" overflow="scroll"><mml:mrow><mml:mi>ρ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>100</mml:mn><mml:msub><mml:mi>B</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>.</p>
              <p>Finally, in order to solve the differential <xref rid="pone.0257958.e110" ref-type="disp-formula">(29)</xref>, we use the Euler explicit method <xref rid="pone.0257958.e115" ref-type="disp-formula">(30)</xref> with step size <italic toggle="yes">δ</italic> = 1.0 to generate all our plots, apart from in Figs 6 and 7, where we use <italic toggle="yes">δ</italic> = 0.1.</p>
              <p>Next, we use the gradient method to derive the optimal interventions to control COVID-19 in a number of disease scenarios.</p>
              <sec id="sec008">
                <title>5.1 Fighting COVID-19 via physical distancing measures</title>
                <p>We first consider policies exclusively based on non-pharmaceutical interventions; more concretely, continuous weekly policies <italic toggle="yes">s</italic>(<italic toggle="yes">t</italic>) of the form <xref rid="pone.0257958.e040" ref-type="disp-formula">(16)</xref>. For starters, we tackle the problem of quickly steering the population towards herd immunity, all the while respecting the constraint <xref rid="pone.0257958.e005" ref-type="disp-formula">(2)</xref> on the critical care capacity. Our goal can be captured by a functional of the form <xref rid="pone.0257958.e024" ref-type="disp-formula">(11)</xref>, with <inline-formula id="pone.0257958.e050"><alternatives><graphic xlink:href="pone.0257958.e050.jpg" id="pone.0257958.e050g" position="anchor"/><mml:math id="M50" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> and
<disp-formula id="pone.0257958.e051"><alternatives><graphic xlink:href="pone.0257958.e051.jpg" id="pone.0257958.e051g" position="anchor"/><mml:math id="M51" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mi>x</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>x</mml:mi></mml:mstyle><mml:mstyle mathvariant="bold"><mml:mn>0</mml:mn></mml:mstyle></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives><label>(19)</label></disp-formula>
where <italic toggle="yes">S</italic> (as depicted in <xref rid="pone.0257958.g001" ref-type="fig">Fig 1</xref>) is the component of <bold><italic toggle="yes">x</italic></bold> that denotes the proportion of individuals in the population who are susceptible to the disease. <inline-formula id="pone.0257958.e052"><alternatives><graphic xlink:href="pone.0257958.e052.jpg" id="pone.0257958.e052g" position="anchor"/><mml:math id="M52" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>R</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula> is the proportion of susceptible individuals required for herd immunity to be guaranteed; thus, once <italic toggle="yes">S</italic>(<italic toggle="yes">t</italic>)&lt;<italic toggle="yes">S</italic><sub><italic toggle="yes">h</italic></sub>, although people will continue to become infected, the natural evolution of the disease will be such that the rate and number of infected quickly dies out.</p>
                <p><xref rid="pone.0257958.g003" ref-type="fig">Fig 3</xref> illustrates the results of optimizing the objective function in <xref rid="pone.0257958.e051" ref-type="disp-formula">Eq (19)</xref> for continuous physical-distancing measures. The plot shows both the critical care occupancy <inline-formula id="pone.0257958.e053"><alternatives><graphic xlink:href="pone.0257958.e053.jpg" id="pone.0257958.e053g" position="anchor"/><mml:math id="M53" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">C</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and the total number <inline-formula id="pone.0257958.e054"><alternatives><graphic xlink:href="pone.0257958.e054.jpg" id="pone.0257958.e054g" position="anchor"/><mml:math id="M54" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">S</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> of susceptible individuals between times <italic toggle="yes">t</italic><sub>0</sub> and <italic toggle="yes">t</italic><sub><italic toggle="yes">f</italic></sub> = <italic toggle="yes">t</italic><sub>0</sub> + 3 × 365. The number of susceptible individuals reaches <italic toggle="yes">S</italic><sub><italic toggle="yes">h</italic></sub> on day 864, after which the disease can be considered extinct. As the reader can appreciate, the critical care occupancy curve never surpasses the critical value <inline-formula id="pone.0257958.e055"><alternatives><graphic xlink:href="pone.0257958.e055.jpg" id="pone.0257958.e055g" position="anchor"/><mml:math id="M55" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">B</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math></alternatives></inline-formula>.</p>
                <fig position="float" id="pone.0257958.g003">
                  <object-id pub-id-type="doi">10.1371/journal.pone.0257958.g003</object-id>
                  <label>Fig 3</label>
                  <caption>
                    <title>Occupation of critical care beds (red) and population of susceptible individuals (blue) for a period of three years.</title>
                    <p>The blue line corresponds to the level of susceptibles guaranteeing herd immunity over the whole year.</p>
                  </caption>
                  <graphic xlink:href="pone.0257958.g003" position="float"/>
                </fig>
                <p>The results in <xref rid="pone.0257958.g003" ref-type="fig">Fig 3</xref> are achieved at the cost of enforcing constant physical-distancing measures throughout the considered time frame. Naturally, the next problem we consider is that of minimizing the aggregate economic cost <inline-formula id="pone.0257958.e056"><alternatives><graphic xlink:href="pone.0257958.e056.jpg" id="pone.0257958.e056g" position="anchor"/><mml:math id="M56" display="inline" overflow="scroll"><mml:mi mathvariant="script">E</mml:mi></mml:math></alternatives></inline-formula> associated with the physical-distancing measures implemented by the government over the first two years of the disease (while respecting the critical care capacity constraint <xref rid="pone.0257958.e005" ref-type="disp-formula">(2)</xref>). Thus we take an objective function of the form <xref rid="pone.0257958.e024" ref-type="disp-formula">(11)</xref>, with <inline-formula id="pone.0257958.e057"><alternatives><graphic xlink:href="pone.0257958.e057.jpg" id="pone.0257958.e057g" position="anchor"/><mml:math id="M57" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> and
<disp-formula id="pone.0257958.e058"><alternatives><graphic xlink:href="pone.0257958.e058.jpg" id="pone.0257958.e058g" position="anchor"/><mml:math id="M58" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mn mathvariant="bold">0</mml:mn></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="script">E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(20)</label></disp-formula></p>
                <p><xref rid="pone.0257958.g004" ref-type="fig">Fig 4</xref> shows the result of applying the gradient method to minimize this functional for the cost function <inline-formula id="pone.0257958.e059"><alternatives><graphic xlink:href="pone.0257958.e059.jpg" id="pone.0257958.e059g" position="anchor"/><mml:math id="M59" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">E</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>.</p>
                <fig position="float" id="pone.0257958.g004">
                  <object-id pub-id-type="doi">10.1371/journal.pone.0257958.g004</object-id>
                  <label>Fig 4</label>
                  <caption>
                    <title>Occupation of critical care beds (red) and physical-distancing measures (blue) for a period of two years.</title>
                    <p>The optimization has been performed over continuous weekly policies, 104 continuous parameters, i.e., any value of physical-distancing measure <italic toggle="yes">s</italic> between 0 and 1 is accepted. The algorithm, however, tends to prefer 0/1 configurations, i.e., full lockdown or no lockdown in most instances.</p>
                  </caption>
                  <graphic xlink:href="pone.0257958.g004" position="float"/>
                </fig>
                <p>This plot shows the critical care occupancy <inline-formula id="pone.0257958.e060"><alternatives><graphic xlink:href="pone.0257958.e060.jpg" id="pone.0257958.e060g" position="anchor"/><mml:math id="M60" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">C</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, and also the physical-distancing measure <italic toggle="yes">s</italic>(<italic toggle="yes">t</italic>) between times <italic toggle="yes">t</italic><sub>0</sub> and <italic toggle="yes">t</italic><sub><italic toggle="yes">f</italic></sub> = <italic toggle="yes">t</italic><sub>0</sub> + 2 × 365. The aggregate cost of the optimal policy is equal to the economic cost of sustaining a full lockdown for 294 days. As anticipated, the optimal policy found by the computer is very complicated. Notice that the critical care occupancy grows quickly towards the end of the plot. The reason for this is that we asked the computer to minimize the total time in lockdown over a fixed period of two years, which is exactly what it did: it minimized the physical-distancing measures in the first two years, with complete disregard for what could happen next. To overcome such a pathological case, one can introduce additional terms into <xref rid="pone.0257958.e058" ref-type="disp-formula">Eq (20)</xref> to make the final slope of the curve <inline-formula id="pone.0257958.e061"><alternatives><graphic xlink:href="pone.0257958.e061.jpg" id="pone.0257958.e061g" position="anchor"/><mml:math id="M61" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">C</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> less steep, or even decreasing.</p>
              </sec>
              <sec id="sec009">
                <title>5.2 Fighting COVID-19 via lockdowns</title>
                <p>In some circumstances, the only distancing measures considered by governments are discrete: lockdown on or off, as in <xref rid="pone.0257958.e001" ref-type="disp-formula">Eq (1)</xref>. Let the objective function be given by <xref rid="pone.0257958.e058" ref-type="disp-formula">Eq (20)</xref>, with <inline-formula id="pone.0257958.e062"><alternatives><graphic xlink:href="pone.0257958.e062.jpg" id="pone.0257958.e062g" position="anchor"/><mml:math id="M62" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">E</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, i.e., we wish to minimize the total time under lockdown. As stated earlier, optimizations over discrete government interventions cannot be carried out directly with the gradient method. We conduct them instead with the two heuristics proposed in Appendix C.</p>
                <p>The first heuristic allows optimizing over weekly on/off confinements, and its results are shown in <xref rid="pone.0257958.g005" ref-type="fig">Fig 5</xref>. This time the critical care occupancy curve touches the critical care capacity just once, after the end of year 1. The reason for this is that we demanded lockdowns to last exactly one week: had we allowed the government to declare a lockdown on any day of the week, the computer would have found a tighter solution, with every peak of the red curve touching the dashed line. Even under this discrete weekly simplification, the solution found by the computer is non-trivial: it requires the government to declare a lockdown <italic toggle="yes">27 times</italic> (as we will soon see, one can limit the total number of lockdowns in the final policy by adding constraints to the optimization problem). The total length of the lockdown in the course of two years is 371 days.</p>
                <fig position="float" id="pone.0257958.g005">
                  <object-id pub-id-type="doi">10.1371/journal.pone.0257958.g005</object-id>
                  <label>Fig 5</label>
                  <caption>
                    <title>Occupation of critical care beds (red) and lockdown (blue) for a period of two years.</title>
                    <p>The plot shows the result of the optimization over probabilistic policies via gradient descent over a period of two years.</p>
                  </caption>
                  <graphic xlink:href="pone.0257958.g005" position="float"/>
                </fig>
                <p>In the second discretization method, the disease control policy is continuously parametrized through the vector <bold><italic toggle="yes">μ</italic></bold> = (<italic toggle="yes">t</italic><sub>1</sub>, <italic toggle="yes">t</italic><sub>2</sub>, …, <italic toggle="yes">t</italic><sub>2<italic toggle="yes">N</italic></sub>), and lockdown is assumed to take place within the time intervals [<italic toggle="yes">t</italic><sub>1</sub>, <italic toggle="yes">t</italic><sub>2</sub>], [<italic toggle="yes">t</italic><sub>3</sub>, <italic toggle="yes">t</italic><sub>4</sub>], …. In this parametrization, lockdowns can be declared or lifted at arbitrary times within [<italic toggle="yes">t</italic><sub>0</sub>, <italic toggle="yes">t</italic><sub><italic toggle="yes">f</italic></sub>], and not only on Mondays, like in the first heuristic. This second discretization method has the advantage of allowing one to set the maximum number <italic toggle="yes">N</italic> of lockdowns throughout the period [<italic toggle="yes">t</italic><sub>0</sub>, <italic toggle="yes">t</italic><sub><italic toggle="yes">f</italic></sub>]. For <italic toggle="yes">N</italic> = 9, the corresponding critical care occupation and lockdown graphs are shown in <xref rid="pone.0257958.g006" ref-type="fig">Fig 6</xref>. The total length of the lockdown is 338 days.</p>
                <fig position="float" id="pone.0257958.g006">
                  <object-id pub-id-type="doi">10.1371/journal.pone.0257958.g006</object-id>
                  <label>Fig 6</label>
                  <caption>
                    <title>Occupation of critical care beds (red) and lockdown measures (blue) for a period of two years.</title>
                    <p>Optimization over deterministic policies with arbitrary initial and final times for each lockdown period. A total of 9 lockdown periods has been fixed prior to the optimization. Notice that the first lockdown period, around day 60, has been basically removed by the optimization procedure.</p>
                  </caption>
                  <graphic xlink:href="pone.0257958.g006" position="float"/>
                </fig>
                <sec id="sec010">
                  <title>5.2.1 Fighting COVID-19 via limited lockdowns and vaccination</title>
                  <p>We next study the effect of vaccination campaigns in reducing the total time spent in lockdown. To ensure that the final recommended policies are easy to implement, we place the limit <italic toggle="yes">N</italic> = 5 on the maximum number of lockdowns.</p>
                  <p>If we allow the government to declare or lift lockdowns at any point in time, the second heuristic outputs the policy depicted in <xref rid="pone.0257958.g007" ref-type="fig">Fig 7</xref>. Note that the optimal policy does not require 5 lockdowns, but 4. The policy involves vaccinating the population at maximum rate since the very beginning of the government intervention until about day 200, after which the vaccination rate gradually drops to zero. The total span of the required lockdown is 186 days. This must be compared with the 338-days lockdown required when we allow for <italic toggle="yes">N</italic> = 10 lockdowns, but no vaccines are available. Even at such a slow vaccination pace, and under a shortage of supplies, the effects of a vaccination campaign prove to be very impressive.</p>
                  <fig position="float" id="pone.0257958.g007">
                    <object-id pub-id-type="doi">10.1371/journal.pone.0257958.g007</object-id>
                    <label>Fig 7</label>
                    <caption>
                      <title>Lockdown times (blue) and vaccination rates (magenta) for a period of two years.</title>
                    </caption>
                    <graphic xlink:href="pone.0257958.g007" position="float"/>
                  </fig>
                  <p>Let us now see how the picture changes when the government is not allowed to enforce an intervention in the middle of the week. Enforcing a maximum number <italic toggle="yes">N</italic> of lockdowns is not automatic when we deal with the first heuristic; it requires us to add an extra constraint to the optimization over non-deterministic policies. A possibility is to include the term
<disp-formula id="pone.0257958.e063"><alternatives><graphic xlink:href="pone.0257958.e063.jpg" id="pone.0257958.e063g" position="anchor"/><mml:math id="M63" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Ω</mml:mo><mml:mo>⟨</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mi>N</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:msup><mml:mo>⟩</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(21)</label></disp-formula>
in the objective function. Here the random variable <italic toggle="yes">c</italic><sub><italic toggle="yes">k</italic></sub> equals 1 if there was a lockdown on week <italic toggle="yes">k</italic> or 0 otherwise, see Appendix C. The penalty for changing the government response by 2<italic toggle="yes">N</italic> + <italic toggle="yes">x</italic> times within the period [<italic toggle="yes">t</italic><sub>0</sub>, <italic toggle="yes">t</italic><sub><italic toggle="yes">f</italic></sub>] is therefore <italic toggle="yes">x</italic> × Ω. Choosing Ω = 10<sup>2</sup>, we arrive, through stochastic gradient descent, at the deterministic policy depicted in <xref rid="pone.0257958.g008" ref-type="fig">Fig 8</xref>. It demands a total lockdown time of 231 days (compared to the 371 days of lockdown required by the corresponding non-pharmaceutical policy, depicted in <xref rid="pone.0257958.g005" ref-type="fig">Fig 5</xref>). As the reader can appreciate, the time spent in lockdown is considerably higher when we require lockdowns to be enforced or lifted on Mondays than when we allow the government to intervene at arbitrary times.</p>
                  <fig position="float" id="pone.0257958.g008">
                    <object-id pub-id-type="doi">10.1371/journal.pone.0257958.g008</object-id>
                    <label>Fig 8</label>
                    <caption>
                      <title>Weekly lockdown times (blue) and vaccination rates (magenta) for a period of two years.</title>
                    </caption>
                    <graphic xlink:href="pone.0257958.g008" position="float"/>
                  </fig>
                </sec>
              </sec>
              <sec id="sec011">
                <title>5.3 Dealing with uncertainty</title>
                <p>In practice, the predictions of any mathematical model for a physical system will not be perfect for a number of reasons. First, basic parameters of the model, such as the transmission rate or the initial occupation <bold><italic toggle="yes">x</italic></bold><sub><bold>0</bold></sub>, are only known up to approximations. Even if reality were exactly described by a particular mathematical model, small errors in such parameters would accumulate in the long run, making long-term predictions unreliable. Second, reality is never exactly described by mathematical models: on the contrary, any tractable disease model is, at best, a rough approximation to reality. Consequently, even the most successful disease models in the market cease to deliver solid predictions beyond 4 weeks [<xref rid="pone.0257958.ref016" ref-type="bibr">16</xref>].</p>
                <sec id="sec012">
                  <title>5.3.1 Uncertainty in the parameters</title>
                  <p>These considerations make us question how practical a two-year disease control policy really is. Consider the physical-distancing policy depicted in <xref rid="pone.0257958.g004" ref-type="fig">Fig 4</xref>, which was obtained by applying the gradient method to the SEIR model in [<xref rid="pone.0257958.ref015" ref-type="bibr">15</xref>]. Here, the model parameters <bold><italic toggle="yes">ν</italic></bold> correspond to the average values <inline-formula id="pone.0257958.e064"><alternatives><graphic xlink:href="pone.0257958.e064.jpg" id="pone.0257958.e064g" position="anchor"/><mml:math id="M64" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ν</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> of the parameter ranges in Table 1 of Appendix A. In reality of course, the values of the parameters are never all equal to their averages, so we proceed to generate sets of parameters with some fluctuations. Let Δ<bold><italic toggle="yes">ν</italic></bold> be the vector with entries given by the difference between the upper and lower bounds of all the entries of the table, and suppose that the actual parameters of “reality” are unknown and uniformly distributed in the region of values <inline-formula id="pone.0257958.e065"><alternatives><graphic xlink:href="pone.0257958.e065.jpg" id="pone.0257958.e065g" position="anchor"/><mml:math id="M65" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>ν</mml:mi><mml:mo>:</mml:mo><mml:mo>-</mml:mo><mml:mi>a</mml:mi><mml:mfrac><mml:mrow><mml:mo>Δ</mml:mo><mml:mi mathvariant="bold-italic">ν</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>≤</mml:mo><mml:mi mathvariant="bold-italic">ν</mml:mi><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ν</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>≤</mml:mo><mml:mi>a</mml:mi><mml:mfrac><mml:mrow><mml:mo>Δ</mml:mo><mml:mi mathvariant="bold-italic">ν</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where <italic toggle="yes">a</italic> can be interpreted as the amount of noise or uncertainty. How robust is the afore-mentioned policy to uncertainty in the initial parameters?</p>
                  <p><xref rid="pone.0257958.g009" ref-type="fig">Fig 9</xref> shows the result of generating 1000 independent parameter samples from the region <inline-formula id="pone.0257958.e066"><alternatives><graphic xlink:href="pone.0257958.e066.jpg" id="pone.0257958.e066g" position="anchor"/><mml:math id="M66" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>05</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, corresponding to a 5% uncertainty, with respect to the given interval of values, and running the corresponding models for the optimal physical distancing policy in <xref rid="pone.0257958.g004" ref-type="fig">Fig 4</xref>. As one can see, for some sampled values of parameters, the critical care capacity of the healthcare system is exceeded. This is not surprising, since the policy depicted in <xref rid="pone.0257958.g004" ref-type="fig">Fig 4</xref> was devised to perform well under the assumption that <inline-formula id="pone.0257958.e067"><alternatives><graphic xlink:href="pone.0257958.e067.jpg" id="pone.0257958.e067g" position="anchor"/><mml:math id="M67" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">ν</mml:mi><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ν</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> and not <inline-formula id="pone.0257958.e068"><alternatives><graphic xlink:href="pone.0257958.e068.jpg" id="pone.0257958.e068g" position="anchor"/><mml:math id="M68" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">ν</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>05</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.</p>
                  <fig position="float" id="pone.0257958.g009">
                    <object-id pub-id-type="doi">10.1371/journal.pone.0257958.g009</object-id>
                    <label>Fig 9</label>
                    <caption>
                      <title>Occupation of critical care beds (red) and (unoptimized) physical distancing measures (blue) for a period of two years under random parameters in <inline-formula id="pone.0257958.e069"><alternatives><graphic xlink:href="pone.0257958.e069" id="pone.0257958.e069g" position="anchor"/><mml:math id="M69" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>05</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>.</title>
                      <p>The region in red is obtained by sampling 1000 times from the region of model parameters <inline-formula id="pone.0257958.e070"><alternatives><graphic xlink:href="pone.0257958.e070" id="pone.0257958.e070g" position="anchor"/><mml:math id="M70" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>05</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> and evolving the corresponding models with the physical distancing policy optimized over the model with average-value parameters (as in <xref rid="pone.0257958.g004" ref-type="fig">Fig 4</xref>). More precisely, the red region is the one delimited by the minimum and the maximum critical care occupation for all the 1000 models, at each time. The red line represents the average critical care occupation in all those simulations.</p>
                    </caption>
                    <graphic xlink:href="pone.0257958.g009" position="float"/>
                  </fig>
                  <p>In order to tame the behavior in the plot in <xref rid="pone.0257958.g009" ref-type="fig">Fig 9</xref>, we use stochastic gradient descent to minimize the average value of the objective function <italic toggle="yes">A</italic> assuming a uniform distribution of <bold><italic toggle="yes">ν</italic></bold> over <inline-formula id="pone.0257958.e071"><alternatives><graphic xlink:href="pone.0257958.e071.jpg" id="pone.0257958.e071g" position="anchor"/><mml:math id="M71" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></alternatives></inline-formula>, as explained at the end of Appendix B. By adding to <italic toggle="yes">A</italic> sufficiently strong penalties for the violation of each optimization constraint, we make sure that such constraints will approximately hold for most of the points in <inline-formula id="pone.0257958.e072"><alternatives><graphic xlink:href="pone.0257958.e072.jpg" id="pone.0257958.e072g" position="anchor"/><mml:math id="M72" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></alternatives></inline-formula>.</p>
                  <p><xref rid="pone.0257958.g010" ref-type="fig">Fig 10</xref> shows a lockdown policy minimizing the physical distancing measures under the condition that constraint <xref rid="pone.0257958.e005" ref-type="disp-formula">(2)</xref> holds for different values of <inline-formula id="pone.0257958.e073"><alternatives><graphic xlink:href="pone.0257958.e073.jpg" id="pone.0257958.e073g" position="anchor"/><mml:math id="M73" display="inline" overflow="scroll"><mml:mrow><mml:mi>ν</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>05</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, i.e., the critical care capacity is not exceeded. This time, the violation of condition <xref rid="pone.0257958.e005" ref-type="disp-formula">(2)</xref> is neither so extreme nor so frequent. This comes, however, at the cost of enforcing physical distancing measures with a cost equivalent to 331 days of lockdown. Repeating the optimization for <inline-formula id="pone.0257958.e074"><alternatives><graphic xlink:href="pone.0257958.e074.jpg" id="pone.0257958.e074g" position="anchor"/><mml:math id="M74" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, <xref rid="pone.0257958.g011" ref-type="fig">Fig 11</xref>, we see that the critical care capacity is rarely surpassed. However, this time the total cost is equivalent to 414 days of lockdown.</p>
                  <fig position="float" id="pone.0257958.g010">
                    <object-id pub-id-type="doi">10.1371/journal.pone.0257958.g010</object-id>
                    <label>Fig 10</label>
                    <caption>
                      <title>Occupation of critical care beds (red) and (optimized) physical distancing measures (blue) for a period of two years under random parameters in <inline-formula id="pone.0257958.e075"><alternatives><graphic xlink:href="pone.0257958.e075" id="pone.0257958.e075g" position="anchor"/><mml:math id="M75" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>05</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>.</title>
                      <p>The disease control policy was optimized to respect condition <xref rid="pone.0257958.e005" ref-type="disp-formula">(2)</xref> over the whole range of parameters <inline-formula id="pone.0257958.e076"><alternatives><graphic xlink:href="pone.0257958.e076" id="pone.0257958.e076g" position="anchor"/><mml:math id="M76" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>05</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>. As in <xref rid="pone.0257958.g009" ref-type="fig">Fig 9</xref>, the region in red depicts again the range of critical care occupations observed in a sample of 1000 model parameters in <inline-formula id="pone.0257958.e077"><alternatives><graphic xlink:href="pone.0257958.e077" id="pone.0257958.e077g" position="anchor"/><mml:math id="M77" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>05</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, and the red line the average critical care occupation.</p>
                    </caption>
                    <graphic xlink:href="pone.0257958.g010" position="float"/>
                  </fig>
                  <fig position="float" id="pone.0257958.g011">
                    <object-id pub-id-type="doi">10.1371/journal.pone.0257958.g011</object-id>
                    <label>Fig 11</label>
                    <caption>
                      <title>Occupation of critical care beds (red) and (optimized) physical distancing measures (blue) for a period of two years under random parameters in <inline-formula id="pone.0257958.e078"><alternatives><graphic xlink:href="pone.0257958.e078" id="pone.0257958.e078g" position="anchor"/><mml:math id="M78" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>.</title>
                      <p>The disease control policy was optimized to respect condition <xref rid="pone.0257958.e005" ref-type="disp-formula">(2)</xref> over the whole range of parameters <inline-formula id="pone.0257958.e079"><alternatives><graphic xlink:href="pone.0257958.e079" id="pone.0257958.e079g" position="anchor"/><mml:math id="M79" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>. As in <xref rid="pone.0257958.g009" ref-type="fig">Fig 9</xref>, the region in red depicts again the range of critical care occupations observed in a sample of 1000 model parameters in <inline-formula id="pone.0257958.e080"><alternatives><graphic xlink:href="pone.0257958.e080" id="pone.0257958.e080g" position="anchor"/><mml:math id="M80" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, and the red line the average critical care occupation.</p>
                    </caption>
                    <graphic xlink:href="pone.0257958.g011" position="float"/>
                  </fig>
                  <p>This result is what one would have expected. As time goes by, the predictions of the disease model for different values of <bold><italic toggle="yes">ν</italic></bold> diverge: any policy that aims to satisfy constraint <xref rid="pone.0257958.e005" ref-type="disp-formula">(2)</xref> for large ranges of these parameters will necessarily require extensive physical distancing measures.</p>
                  <p>In practical policy-making, graphs such as Figs <xref rid="pone.0257958.g010" ref-type="fig">10</xref> and <xref rid="pone.0257958.g011" ref-type="fig">11</xref> should not be understood to represent the actual physical distancing policy, but rather to provide a provisional <italic toggle="yes">policy plan</italic>. A policy plan gives a recommendation for action for the immediate future, given the current knowledge of the disease. In <xref rid="pone.0257958.g010" ref-type="fig">Fig 10</xref>, the policy plan is advising not to declare physical distancing measures in the first weeks. That is the measure that the government should adopt then. After a first time period, say four weeks, more data will have been gathered: this will allow us to obtain a better estimate of the parameters <bold><italic toggle="yes">ν</italic></bold>, and then re-run the models for another two years ahead. The measure to enforce should then be whatever the new policy plan recommends for the following four-week time period. The process is then repeated.</p>
                  <p>To test how this idea would perform in practice, we consider a scenario where the parameters defining the disease model are unknown, but the region in parameter space in which they live shrinks every month (to be precise, we used a 28-day period, corresponding to four weeks). That is, at month <italic toggle="yes">k</italic>, the government is informed that the parameters <bold><italic toggle="yes">ν</italic></bold> satisfy <inline-formula id="pone.0257958.e081"><alternatives><graphic xlink:href="pone.0257958.e081.jpg" id="pone.0257958.e081g" position="anchor"/><mml:math id="M81" display="inline" overflow="scroll"><mml:mrow><mml:mi>ν</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>25</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi>k</mml:mi></mml:msqrt></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. Every four weeks, the policy is recalculated to minimize the physical distancing measures for the rest of the two years ahead, using the range <inline-formula id="pone.0257958.e082"><alternatives><graphic xlink:href="pone.0257958.e082.jpg" id="pone.0257958.e082g" position="anchor"/><mml:math id="M82" display="inline" overflow="scroll"><mml:mrow><mml:mi>ν</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>25</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi>k</mml:mi></mml:msqrt></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. The final curves for the critical care occupation and the physical distancing measures are shown in <xref rid="pone.0257958.g012" ref-type="fig">Fig 12</xref> for <bold><italic toggle="yes">ν</italic></bold>, in a sequence of shrinking regions <inline-formula id="pone.0257958.e083"><alternatives><graphic xlink:href="pone.0257958.e083.jpg" id="pone.0257958.e083g" position="anchor"/><mml:math id="M83" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>25</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi>k</mml:mi></mml:msqrt></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, for each month <italic toggle="yes">k</italic> (red region) and in the case of a fixed uncertainty region corresponding to the last month, i.e., <inline-formula id="pone.0257958.e084"><alternatives><graphic xlink:href="pone.0257958.e084.jpg" id="pone.0257958.e084g" position="anchor"/><mml:math id="M84" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>049</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> (inner dark blue region). The total cost of the physical distancing measures is equivalent to 358 lockdown days. This has to be compared with the cost of 414 days predicted by the initial policy plan under the assumption <inline-formula id="pone.0257958.e085"><alternatives><graphic xlink:href="pone.0257958.e085.jpg" id="pone.0257958.e085g" position="anchor"/><mml:math id="M85" display="inline" overflow="scroll"><mml:mrow><mml:mi>ν</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.</p>
                  <fig position="float" id="pone.0257958.g012">
                    <object-id pub-id-type="doi">10.1371/journal.pone.0257958.g012</object-id>
                    <label>Fig 12</label>
                    <caption>
                      <title>Occupation of critical care beds (red) and physical distancing measures (blue) for a period of two years under random parameters and monthly noise decrease.</title>
                      <p>The disease control policy was optimized to respect the condition in <xref rid="pone.0257958.e005" ref-type="disp-formula">Eq (2)</xref>, i.e., critical care capacity not exceeded, starting with the parameter region <inline-formula id="pone.0257958.e086"><alternatives><graphic xlink:href="pone.0257958.e086" id="pone.0257958.e086g" position="anchor"/><mml:math id="M86" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> and with a monthly noise decrease of <inline-formula id="pone.0257958.e087"><alternatives><graphic xlink:href="pone.0257958.e087" id="pone.0257958.e087g" position="anchor"/><mml:math id="M87" display="inline" overflow="scroll"><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mi>k</mml:mi></mml:msqrt></mml:mfrac></mml:math></alternatives></inline-formula>, i.e., in the <italic toggle="yes">k</italic>-th month the noise is equal to <inline-formula id="pone.0257958.e088"><alternatives><graphic xlink:href="pone.0257958.e088" id="pone.0257958.e088g" position="anchor"/><mml:math id="M88" display="inline" overflow="scroll"><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>25</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi>k</mml:mi></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula>. The black-dotted region depicts the range of critical care occupations observed in a sample of 1000 model parameters in a sequence of shrinking regions <inline-formula id="pone.0257958.e089"><alternatives><graphic xlink:href="pone.0257958.e089" id="pone.0257958.e089g" position="anchor"/><mml:math id="M89" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>25</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi>k</mml:mi></mml:msqrt></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>; more precisely, for each month <italic toggle="yes">k</italic> the red region is obtained by evolving, from the initial time to month <italic toggle="yes">k</italic> (included), 1000 different models with parameters sampled from the region <inline-formula id="pone.0257958.e090"><alternatives><graphic xlink:href="pone.0257958.e090" id="pone.0257958.e090g" position="anchor"/><mml:math id="M90" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>25</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi>k</mml:mi></mml:msqrt></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>. The final plot is obtained by joining the plots for each month <italic toggle="yes">k</italic>. The inner region in red depicts the range of critical care occupations corresponding to the uncertainty in the final month, i.e., obtained with 1000 models with parameters sampled in <inline-formula id="pone.0257958.e091"><alternatives><graphic xlink:href="pone.0257958.e091" id="pone.0257958.e091g" position="anchor"/><mml:math id="M91" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>049</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>. The red line represents the average critical care occupation, obtained by joining the average of the simulations with decreased uncertainty for each month <italic toggle="yes">k</italic>. Despite the initial uncertainty on the parameters <italic toggle="yes">ν</italic> of the disease model, the final lockdown time is much lower, due to monthly revisions of the original policy plan.</p>
                    </caption>
                    <graphic xlink:href="pone.0257958.g012" position="float"/>
                  </fig>
                  <p>In principle, one could further decrease the total planned cost by devising <italic toggle="yes">adaptive policy plans</italic>, where the measure to be taken at each moment depends not only on the current time <italic toggle="yes">t</italic>, but also on the past history of physical distancing measures and their observed effects. In fact, we tried optimizing over generic adaptive policies described by a continuous version of a neural network architecture known as Long Short-Term Memory (LSTM) [<xref rid="pone.0257958.ref032" ref-type="bibr">32</xref>]. In all our numerical experiments, such simple LSTM architectures could not improve the performance of non-adaptive strategies, but this could be due to ineffective training on our side.</p>
                </sec>
                <sec id="sec013">
                  <title>5.3.2 Nondeterministic models</title>
                  <p>So far, all models considered in the optimization are deterministic, namely, given the model parameters and initial conditions, the compartments evolve along a unique trajectory. As a more general case, we can consider the one in which the disease’s dynamics is governed, rather than by <xref rid="pone.0257958.e094" ref-type="disp-formula">Eq (23)</xref>, by a stochastic differential equation. More concretely, consider the model that results when we replace the first and second lines of <xref rid="pone.0257958.e094" ref-type="disp-formula">Eq (23)</xref> by
<disp-formula id="pone.0257958.e092"><alternatives><graphic xlink:href="pone.0257958.e092.jpg" id="pone.0257958.e092g" position="anchor"/><mml:math id="M92" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>ξ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>ξ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>ν</mml:mi><mml:mi>E</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(22)</label></disp-formula>
where <italic toggle="yes">ξ</italic> represents a Gaussian noise term reflecting stochastic fluctuations on the virus’ transmissivity [<xref rid="pone.0257958.ref005" ref-type="bibr">5</xref>]. Solving this equation by discretization, each occurrence of <italic toggle="yes">ξ</italic> at time <italic toggle="yes">t</italic><sub><italic toggle="yes">k</italic></sub> = <italic toggle="yes">t</italic><sub>0</sub> + <italic toggle="yes">kδ</italic> is replaced by a quantity <italic toggle="yes">ξ</italic><sub><italic toggle="yes">k</italic></sub> sampled from a Gaussian distribution of zero mean and standard deviation <inline-formula id="pone.0257958.e093"><alternatives><graphic xlink:href="pone.0257958.e093.jpg" id="pone.0257958.e093g" position="anchor"/><mml:math id="M93" display="inline" overflow="scroll"><mml:mrow><mml:mi>η</mml:mi><mml:msqrt><mml:mi>δ</mml:mi></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula>, where <italic toggle="yes">η</italic> denotes the magnitude of the noise term.</p>
                  <p>For our simulation, we consider the noise <italic toggle="yes">η</italic> = 0.05. As before, the method of stochastic gradient descent is used for obtaining a noise-robust policy. At each time step, we average the gradient over 1024 × <italic toggle="yes">η</italic> different stochastic evolutions. In contrast to the case of noisy parameters, for a stochastic evolution the sampling has to be repeated at each time step, see Appendix B for more details. The results of our simulations are shown in <xref rid="pone.0257958.g013" ref-type="fig">Fig 13</xref>. Notice that, in contrast to <xref rid="pone.0257958.g009" ref-type="fig">Fig 9</xref>, the noise is not uniformly distributed in a limited interval, but is given by a Gaussian, which allows for (rare) events far away from the mean. This justifies the different representations of uncertainty in these plots. Despite the presence of relatively high noise in the evolution, as shown by the wide fluctuations in <xref rid="pone.0257958.g013" ref-type="fig">Fig 13</xref>, the algorithm is able to devise strong policies that maintain the critical care occupation almost always, i.e., with a high probability, below its capacity.</p>
                  <fig position="float" id="pone.0257958.g013">
                    <object-id pub-id-type="doi">10.1371/journal.pone.0257958.g013</object-id>
                    <label>Fig 13</label>
                    <caption>
                      <title>Occupation of critical care beds (red) and physical distancing measures (blue) for a period of two years for stochastic evolution with noise-level <italic toggle="yes">η</italic> = 0.05.</title>
                      <p>The disease control policy was optimized to respect the condition in <xref rid="pone.0257958.e005" ref-type="disp-formula">Eq (2)</xref>, i.e., critical care capacity not exceeded. The region in light red depicts the range of critical care occupations observed in a sample of 1000 × <italic toggle="yes">η</italic> different evolutions, with a stochastic noise <italic toggle="yes">η</italic> = 0.05; the red line, the average critical care occupation; and the darker red region, the trajectories that lie within two standard deviations from the average value. The policy corresponds to a total of 321 lockdown days.</p>
                    </caption>
                    <graphic xlink:href="pone.0257958.g013" position="float"/>
                  </fig>
                </sec>
              </sec>
            </sec>
            <sec sec-type="conclusions" id="sec014">
              <title>6 Conclusion</title>
              <p>In this paper, we have applied standard tools from optimization theory and machine learning to identify optimal disease control policies, given an epidemiological model. This is in stark contrast to standard practice in mathematical epidemiology, where human intuition is used to narrow down the considered set of policies to a uni-parametric family. We saw that the optimal solutions found by our algorithms are highly counter-intuitive, and thus unlikely to be identified by a human. This supports the idea that policies for disease control should be based on a combination of both human expertise and machine learning.</p>
              <p>Compared to previous approaches that tried to identify suitable disease control policies through optimal control theory, our framework allows one to devise policies that satisfy arbitrary constraints under arbitrary uncertainties in the initial conditions and model parameters that determine the disease’s dynamics, and stochastic evolution. Our methods, in addition, allow one to optimize over discrete policies, as well as policies that can just vary at certain fixed times.</p>
              <p>To illustrate our ideas, we studied a scenario in which a computer is tasked with outputting the minimal amount of non-pharmaceutical interventions for an epidemic in a hypothetical country, in such a way as to never exceed the critical care bed capacity. We looked at situations in which these measures were continuous (recommendations on the interval [0, 1]) as well as discrete (either 0 or 1)—a lockdown that is off or on, respectively for periods of 2 years. We experimented with measures that are just allowed to change weekly, as well as those in which there is a maximum number of lockdowns that is allowed to be declared. We also showed how vaccine supplies, even when meager and poorly distributed, can dramatically shorten the total confinement required to keep the disease under control.</p>
              <p>Admittedly, some of our computer-generated policies are too complicated to be implemented in practice. Our formalism allows, however, to limit the complexity of the found solutions by adding extra constraints to the original optimization problem. To highlight this feature, we generated a near-optimal weekly policy plan of vaccinations and on/off weekly confinement measures with a cap on the total number of lockdowns.</p>
              <p>We examined the problems that one may encounter when applying our techniques to scenarios where the model parameters are not known with high accuracy, or the model evolves stochastically. This led us to propose practical policy plans which must be continually revisited, to account for our ever-changing and ever-growing knowledge in an epidemic. We tested the viability of this approach by simulating a scenario where the uncertainty on the disease model parameters decreases with time. As expected, the final policy implemented was safe for the final range of parameters and required considerably less physical distancing measures than the initial policy plan hinted.</p>
              <p>In this last regard, an interesting problem for future research is devising a gradient-friendly ansatz for adaptive policy plans for disease control, where the actual measure at each time depends on the whole history of disease indicators accessible to the government. In theory, such plans should predict lower values of the average objective function in scenarios where the model parameters are unknown. In our experience, though, gradient descent applied to the standard LSTM architecture seems to be unable to beat the non-adaptive score.</p>
              <p>Finally, we would like to remark once more that, since the optimization problems we dealt with in this paper are non-convex, the gradient method is not guaranteed to converge to the minimum of the (average) objective function. While conducting this research, in order to convince ourselves that the solutions found by our numerical methods were close to optimal, we had to repeat our optimizations several times, with different initial policies <bold><italic toggle="yes">μ</italic></bold><sup>(<bold>0</bold>)</sup> and learning rates <italic toggle="yes">ϵ</italic>. Such a redundant use of computational resources would have been entirely avoidable if we had had some rough approximation to the exact solution of the problem. Hence we conclude this paper with a challenge for the operations research community: develop mathematical tools which allow one to <italic toggle="yes">lower bound</italic> the solution of minimization problems involving ordinary differential equations.</p>
            </sec>
            <sec id="sec015">
              <title>7 Appendix</title>
              <sec id="sec016">
                <title>A Models for the spread of COVID-19</title>
                <p>In all our numerical simulations, we assume that the dynamics of the COVID-19 are well approximated by a compartmental model of the SEIR type. When the government policy reduces to enforcing physical distance measures, we adopt a simplified version of the model used in [<xref rid="pone.0257958.ref015" ref-type="bibr">15</xref>]. This model divides those infected with COVID-19 into three different compartments: <italic toggle="yes">I</italic><sub><italic toggle="yes">R</italic></sub>, or those who recover by themselves from the disease; <italic toggle="yes">I</italic><sub><italic toggle="yes">H</italic></sub>, those who require hospitalization but do not enter a critical care unit; and <italic toggle="yes">I</italic><sub><italic toggle="yes">C</italic></sub>, those who are both hospitalized and visit a critical care unit before recovery. The dynamics of the model are governed by the system of ordinary differential equations below, see the diagram in <xref rid="pone.0257958.g014" ref-type="fig">Fig 14</xref>:
<disp-formula id="pone.0257958.e094"><alternatives><graphic xlink:href="pone.0257958.e094.jpg" id="pone.0257958.e094g" position="anchor"/><mml:math id="M94" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>ν</mml:mi><mml:mi>E</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mi>ν</mml:mi><mml:mi>E</mml:mi><mml:mo>-</mml:mo><mml:mi>γ</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mi>H</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mi>ν</mml:mi><mml:mi>E</mml:mi><mml:mo>-</mml:mo><mml:mi>γ</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mi>C</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:mi>ν</mml:mi><mml:mi>E</mml:mi><mml:mo>-</mml:mo><mml:mi>γ</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>H</mml:mi><mml:mi>H</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>γ</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>H</mml:mi><mml:mi>C</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>γ</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi>ξ</mml:mi><mml:mi>C</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>γ</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>ξ</mml:mi><mml:mi>C</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(23)</label></disp-formula>
Here
<disp-formula id="pone.0257958.e095"><alternatives><graphic xlink:href="pone.0257958.e095.jpg" id="pone.0257958.e095g" position="anchor"/><mml:math id="M95" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>γ</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mo>Δ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mo>Δ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>cos</mml:mo><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>7</mml:mn><mml:mo>×</mml:mo><mml:mn>52</mml:mn></mml:mrow></mml:mfrac><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(24)</label></disp-formula>
denotes the virus’ transmitivity, that is subject to seasonal variability. <inline-formula id="pone.0257958.e096"><alternatives><graphic xlink:href="pone.0257958.e096.jpg" id="pone.0257958.e096g" position="anchor"/><mml:math id="M96" display="inline" overflow="scroll"><mml:mrow><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> models the effect of a government-mandated lockdown <italic toggle="yes">s</italic>(<italic toggle="yes">t</italic>) ∈ {0, 1} on the virus’ transmission rate. The values of the remaining parameters are taken from [<xref rid="pone.0257958.ref015" ref-type="bibr">15</xref>], and appear in <xref rid="pone.0257958.t001" ref-type="table">Table 1</xref>.</p>
                <fig position="float" id="pone.0257958.g014">
                  <object-id pub-id-type="doi">10.1371/journal.pone.0257958.g014</object-id>
                  <label>Fig 14</label>
                  <caption>
                    <title>Two COVID-19 compartmental models for disease policies based on physical distancing measures.</title>
                    <p>The solid lines show the model first presented in [<xref rid="pone.0257958.ref030" ref-type="bibr">30</xref>], where the coefficients connecting the compartments are interpreted couplings, population fractions, time delays and so forth. The addition of the dotted line connecting the ‘susceptible’ and ‘recovered’ compartments creates another model where a vaccination campaign is taken into account.</p>
                  </caption>
                  <graphic xlink:href="pone.0257958.g014" position="float"/>
                </fig>
                <table-wrap position="float" id="pone.0257958.t001">
                  <object-id pub-id-type="doi">10.1371/journal.pone.0257958.t001</object-id>
                  <label>Table 1</label>
                  <caption>
                    <title>Parameter ranges for the compartmental model for COVID-19 proposed in [<xref rid="pone.0257958.ref015" ref-type="bibr">15</xref>].</title>
                  </caption>
                  <alternatives>
                    <graphic xlink:href="pone.0257958.t001" id="pone.0257958.t001g" position="float"/>
                    <table frame="box" rules="all" border="0">
                      <colgroup span="1">
                        <col align="left" valign="middle" span="1"/>
                        <col align="left" valign="middle" span="1"/>
                        <col align="left" valign="middle" span="1"/>
                      </colgroup>
                      <thead>
                        <tr>
                          <th align="center" rowspan="1" colspan="1">parameter</th>
                          <th align="center" rowspan="1" colspan="1">value</th>
                          <th align="center" rowspan="1" colspan="1">units</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td align="center" rowspan="1" colspan="1">
                            <inline-formula id="pone.0257958.e097">
                              <alternatives>
                                <graphic xlink:href="pone.0257958.e097" id="pone.0257958.e097g" position="anchor"/>
                                <mml:math id="M97" display="inline" overflow="scroll">
                                  <mml:mover accent="true">
                                    <mml:mi>r</mml:mi>
                                    <mml:mo>¯</mml:mo>
                                  </mml:mover>
                                </mml:math>
                              </alternatives>
                            </inline-formula>
                          </td>
                          <td align="center" rowspan="1" colspan="1">[0, 0.6]</td>
                          <td align="center" rowspan="1" colspan="1">none</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1">Δ</td>
                          <td align="center" rowspan="1" colspan="1">[0.7, 1.0]</td>
                          <td align="center" rowspan="1" colspan="1">none</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1">
                            <italic toggle="yes">γ</italic>
                          </td>
                          <td align="center" rowspan="1" colspan="1">1/5</td>
                          <td align="center" rowspan="1" colspan="1">days<sup>−1</sup></td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1">
                            <italic toggle="yes">ν</italic>
                          </td>
                          <td align="center" rowspan="1" colspan="1">1/4.6</td>
                          <td align="center" rowspan="1" colspan="1">days<sup>−1</sup></td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1">
                            <italic toggle="yes">p</italic>
                            <sub>
                              <italic toggle="yes">R</italic>
                            </sub>
                          </td>
                          <td align="center" rowspan="1" colspan="1">0.9596</td>
                          <td align="center" rowspan="1" colspan="1">none</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1">
                            <italic toggle="yes">p</italic>
                            <sub>
                              <italic toggle="yes">H</italic>
                            </sub>
                          </td>
                          <td align="center" rowspan="1" colspan="1">0.0308</td>
                          <td align="center" rowspan="1" colspan="1">none</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1">
                            <italic toggle="yes">p</italic>
                            <sub>
                              <italic toggle="yes">C</italic>
                            </sub>
                          </td>
                          <td align="center" rowspan="1" colspan="1">0.0132</td>
                          <td align="center" rowspan="1" colspan="1">none</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1">
                            <italic toggle="yes">δ</italic>
                            <sub>
                              <italic toggle="yes">H</italic>
                            </sub>
                          </td>
                          <td align="center" rowspan="1" colspan="1">1/8</td>
                          <td align="center" rowspan="1" colspan="1">days<sup>−1</sup></td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1">
                            <italic toggle="yes">δ</italic>
                            <sub>
                              <italic toggle="yes">C</italic>
                            </sub>
                          </td>
                          <td align="center" rowspan="1" colspan="1">1/6</td>
                          <td align="center" rowspan="1" colspan="1">days<sup>−1</sup></td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1">
                            <italic toggle="yes">ξ</italic>
                          </td>
                          <td align="center" rowspan="1" colspan="1">1/10</td>
                          <td align="center" rowspan="1" colspan="1">days<sup>−1</sup></td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1">
                            <italic toggle="yes">ϕ</italic>
                          </td>
                          <td align="center" rowspan="1" colspan="1">−7 × 3.8</td>
                          <td align="center" rowspan="1" colspan="1">days</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1">
                            <italic toggle="yes">R</italic>
                            <sub>0</sub>
                          </td>
                          <td align="center" rowspan="1" colspan="1">[2, 2.5]</td>
                          <td align="center" rowspan="1" colspan="1">None</td>
                        </tr>
                      </tbody>
                    </table>
                  </alternatives>
                </table-wrap>
                <p>If the government has a vaccine available, the model changes. In that case, the first and last lines of <xref rid="pone.0257958.e094" ref-type="disp-formula">Eq (23)</xref> shall be replaced by
<disp-formula id="pone.0257958.e098"><alternatives><graphic xlink:href="pone.0257958.e098.jpg" id="pone.0257958.e098g" position="anchor"/><mml:math id="M98" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>γ</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>ξ</mml:mi><mml:mi>C</mml:mi><mml:mo>+</mml:mo><mml:mi>v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(25)</label></disp-formula>
where <italic toggle="yes">v</italic>(<italic toggle="yes">t</italic>) denotes the vaccination rate.</p>
                <p>In all our numerical simulations, we take the total population to be 47 million; the critical care bed capacity per inhabitant <italic toggle="yes">C</italic><sub><italic toggle="yes">c</italic></sub> is also taken to be 9.5 × 10<sup>−5</sup>. We assume that the government starts its intervention on day <italic toggle="yes">t</italic><sub>0</sub> = 60, 30 days after the outbreak of the disease. We model the disease outbreak by assuming that, at time <italic toggle="yes">t</italic><sub><italic toggle="yes">out</italic></sub> = 30, there are 10 individuals in compartment <italic toggle="yes">E</italic>. By default, the values of the disease parameters are taken to be the arithmetic means of the intervals shown in <xref rid="pone.0257958.t001" ref-type="table">Table 1</xref>. We assume that the government can vaccinate at most 50, 000 individuals per day. This means that, at any given time <italic toggle="yes">t</italic>, <inline-formula id="pone.0257958.e099"><alternatives><graphic xlink:href="pone.0257958.e099.jpg" id="pone.0257958.e099g" position="anchor"/><mml:math id="M99" display="inline" overflow="scroll"><mml:mrow><mml:mi>v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:mo>Λ</mml:mo><mml:mo>≔</mml:mo><mml:mfrac><mml:mrow><mml:mn>50</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow><mml:mrow><mml:mn>47</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:mfrac><mml:mo>≈</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>00106</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. In addition, we assume that the total supply of vaccines can just cover a third of the total population. In other words, <inline-formula id="pone.0257958.e100"><alternatives><graphic xlink:href="pone.0257958.e100.jpg" id="pone.0257958.e100g" position="anchor"/><mml:math id="M100" display="inline" overflow="scroll"><mml:mrow><mml:mo>∫</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mi>v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>.</p>
              </sec>
              <sec id="sec017">
                <title>B Optimization over continuous measures for disease control</title>
                <p>In this section, we explain how to apply the gradient method to optimize over continuous classes of government interventions. Our starting point is an ordinary differential equation of the form
<disp-formula id="pone.0257958.e101"><alternatives><graphic xlink:href="pone.0257958.e101.jpg" id="pone.0257958.e101g" position="anchor"/><mml:math id="M101" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msup><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>;</mml:mo><mml:mspace width="4pt"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(26)</label></disp-formula></p>
                <p>The entries of vector <italic toggle="yes">x</italic> represent the occupations of the different compartments of a disease model. In the case of adaptive policies, some of such entries might also represent the components of the <italic toggle="yes">cell state</italic>
<bold><italic toggle="yes">θ</italic></bold> [<xref rid="pone.0257958.ref032" ref-type="bibr">32</xref>], i.e., the internal variables used by the government to keep track of the evolution of the disease and guide future government interventions. <inline-formula id="pone.0257958.e102"><alternatives><graphic xlink:href="pone.0257958.e102.jpg" id="pone.0257958.e102g" position="anchor"/><mml:math id="M102" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> represents a parametrization of the effects of a given policy. Let <inline-formula id="pone.0257958.e103"><alternatives><graphic xlink:href="pone.0257958.e103.jpg" id="pone.0257958.e103g" position="anchor"/><mml:math id="M103" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> be the solution of <xref rid="pone.0257958.e101" ref-type="disp-formula">Eq (26)</xref> with initial conditions <bold><italic toggle="yes">x</italic></bold>(0) = <bold><italic toggle="yes">x</italic></bold><sub>0</sub> and <inline-formula id="pone.0257958.e104"><alternatives><graphic xlink:href="pone.0257958.e104.jpg" id="pone.0257958.e104g" position="anchor"/><mml:math id="M104" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>.</p>
                <p>Given the set <inline-formula id="pone.0257958.e105"><alternatives><graphic xlink:href="pone.0257958.e105.jpg" id="pone.0257958.e105g" position="anchor"/><mml:math id="M105" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>⊂</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, we consider the problem of finding the parameters <bold><italic toggle="yes">μ</italic></bold><sup>⋆</sup> ∈ <italic toggle="yes">M</italic> such that <bold><italic toggle="yes">x</italic></bold>(<italic toggle="yes">t</italic>;<bold><italic toggle="yes">μ</italic></bold><sup>⋆</sup>, <bold><italic toggle="yes">x</italic></bold><sub>0</sub>) minimizes a given functional <italic toggle="yes">A</italic>. This functional defines the means by which we wish to control the disease: it might represent the number and duration of lockdown, etc. For the time being, let us assume this functional to be of the form
<disp-formula id="pone.0257958.e106"><alternatives><graphic xlink:href="pone.0257958.e106.jpg" id="pone.0257958.e106g" position="anchor"/><mml:math id="M106" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>A</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:msubsup><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mspace width="0.277778em"/><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(27)</label></disp-formula>
From the discussion in Section 4, the functional in <xref rid="pone.0257958.e106" ref-type="disp-formula">Eq (27)</xref> might also contain constraints which we wish the solution <bold><italic toggle="yes">x</italic></bold>(<italic toggle="yes">t</italic>;<bold><italic toggle="yes">μ</italic></bold><sup>⋆</sup>, <bold><italic toggle="yes">x</italic></bold><sub>0</sub>) to satisfy, such as <xref rid="pone.0257958.e027" ref-type="disp-formula">(12)</xref> and <xref rid="pone.0257958.e028" ref-type="disp-formula">(13)</xref>. Note that we are assuming to know the initial conditions <bold><italic toggle="yes">x</italic></bold><sub>0</sub> with precision. We will relax this requirement by the end of the section.</p>
                <p>To minimize <italic toggle="yes">A</italic>(<bold><italic toggle="yes">μ</italic></bold>, <bold><italic toggle="yes">x</italic></bold><sub>0</sub>) via gradient descent, we need to compute ∇<sub><bold><italic toggle="yes">μ</italic></bold></sub><italic toggle="yes">A</italic>. For functionals of the form <xref rid="pone.0257958.e106" ref-type="disp-formula">(27)</xref>, we have that
<disp-formula id="pone.0257958.e107"><alternatives><graphic xlink:href="pone.0257958.e107.jpg" id="pone.0257958.e107g" position="anchor"/><mml:math id="M107" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:msubsup><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi mathvariant="script">L</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi mathvariant="script">L</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(28)</label></disp-formula></p>
                <p>The next question is thus how to compute the derivatives <inline-formula id="pone.0257958.e108"><alternatives><graphic xlink:href="pone.0257958.e108.jpg" id="pone.0257958.e108g" position="anchor"/><mml:math id="M108" display="inline" overflow="scroll"><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula>. To this aim, define the variables <inline-formula id="pone.0257958.e109"><alternatives><graphic xlink:href="pone.0257958.e109.jpg" id="pone.0257958.e109g" position="anchor"/><mml:math id="M109" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>≡</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>. Differentiating <xref rid="pone.0257958.e101" ref-type="disp-formula">Eq (26)</xref> by <italic toggle="yes">μ</italic><sub><italic toggle="yes">j</italic></sub>, we have that
<disp-formula id="pone.0257958.e110"><alternatives><graphic xlink:href="pone.0257958.e110.jpg" id="pone.0257958.e110g" position="anchor"/><mml:math id="M110" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>l</mml:mi></mml:munder><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mi>l</mml:mi></mml:msup></mml:mrow></mml:mfrac><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mi>l</mml:mi></mml:msubsup><mml:mo>;</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(29)</label></disp-formula></p>
                <p>In order to obtain <inline-formula id="pone.0257958.e111"><alternatives><graphic xlink:href="pone.0257958.e111.jpg" id="pone.0257958.e111g" position="anchor"/><mml:math id="M111" display="inline" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> for each time <italic toggle="yes">t</italic>, it hence suffices to solve the system of coupled differential equations given by <xref rid="pone.0257958.e101" ref-type="disp-formula">(26)</xref> and <xref rid="pone.0257958.e110" ref-type="disp-formula">(29)</xref> with initial conditions <bold><italic toggle="yes">x</italic></bold>(<italic toggle="yes">t</italic><sub>0</sub>) = <bold><italic toggle="yes">x</italic></bold><sub>0</sub>, <inline-formula id="pone.0257958.e112"><alternatives><graphic xlink:href="pone.0257958.e112.jpg" id="pone.0257958.e112g" position="anchor"/><mml:math id="M112" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. This can be achieved numerically through several different methods, depending on the desired accuracy. The simplest such method is called <italic toggle="yes">Euler explicit</italic> [<xref rid="pone.0257958.ref033" ref-type="bibr">33</xref>]: for some <italic toggle="yes">δ</italic> &gt; 0, it consists of regarding time as a discrete variable of the form <italic toggle="yes">t</italic><sub><italic toggle="yes">k</italic></sub> = <italic toggle="yes">t</italic><sub>0</sub> + <italic toggle="yes">δk</italic>, for <inline-formula id="pone.0257958.e113"><alternatives><graphic xlink:href="pone.0257958.e113.jpg" id="pone.0257958.e113g" position="anchor"/><mml:math id="M113" display="inline" overflow="scroll"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mo>⌈</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mi>δ</mml:mi></mml:mfrac><mml:mo>⌉</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. The quantities <inline-formula id="pone.0257958.e114"><alternatives><graphic xlink:href="pone.0257958.e114.jpg" id="pone.0257958.e114g" position="anchor"/><mml:math id="M114" display="inline" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mi>k</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> are then obtained by recursively applying the relations
<disp-formula id="pone.0257958.e115"><alternatives><graphic xlink:href="pone.0257958.e115.jpg" id="pone.0257958.e115g" position="anchor"/><mml:math id="M115" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:msup><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>l</mml:mi></mml:munder><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mi>l</mml:mi></mml:msup></mml:mrow></mml:mfrac><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mi>l</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(30)</label></disp-formula></p>
                <p>We will also encounter situations where our functional <italic toggle="yes">A</italic> is more complicated than <xref rid="pone.0257958.e106" ref-type="disp-formula">(27)</xref>. Some parameters <bold><italic toggle="yes">ζ</italic></bold> (not policy parameters) regulating the evolution <xref rid="pone.0257958.e101" ref-type="disp-formula">(26)</xref>, such as the basic reproduction number of the disease, might be unknown, or perhaps the initial conditions <bold><italic toggle="yes">x</italic></bold><sub>0</sub> are just known within some bounds. In such cases, the problem’s objective function <italic toggle="yes">A</italic> might adopt the form
<disp-formula id="pone.0257958.e116"><alternatives><graphic xlink:href="pone.0257958.e116.jpg" id="pone.0257958.e116g" position="anchor"/><mml:math id="M116" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>A</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">ζ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi mathvariant="bold-italic">ζ</mml:mi><mml:mi>d</mml:mi><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>∫</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">ζ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>μ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(31)</label></disp-formula>
for some probability measure <italic toggle="yes">p</italic>(<bold><italic toggle="yes">ζ</italic></bold>, <bold><italic toggle="yes">x</italic></bold><sub>0</sub>)<italic toggle="yes">d</italic>
<bold><italic toggle="yes">ζ</italic></bold>
<italic toggle="yes">d</italic>
<bold><italic toggle="yes">x</italic></bold><sub>0</sub>. Again, we wish to minimize <italic toggle="yes">A</italic> over <bold><italic toggle="yes">μ</italic></bold>. As explained in section 3, this can be achieved via stochastic gradient descent methods [<xref rid="pone.0257958.ref023" ref-type="bibr">23</xref>]: all we need is an unbiased estimator <inline-formula id="pone.0257958.e117"><alternatives><graphic xlink:href="pone.0257958.e117.jpg" id="pone.0257958.e117g" position="anchor"/><mml:math id="M117" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mo>∇</mml:mo><mml:mo>˜</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:msub><mml:mi>A</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> of ∇<sub><bold><italic toggle="yes">μ</italic></bold></sub><italic toggle="yes">A</italic>. We obtain this estimator by taking <italic toggle="yes">N</italic> independent samples <inline-formula id="pone.0257958.e118"><alternatives><graphic xlink:href="pone.0257958.e118.jpg" id="pone.0257958.e118g" position="anchor"/><mml:math id="M118" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">ζ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> from the measure <italic toggle="yes">p</italic>(<bold><italic toggle="yes">ζ</italic></bold>, <bold><italic toggle="yes">x</italic></bold><sub>0</sub>)<italic toggle="yes">d</italic><bold><italic toggle="yes">ζ</italic></bold><italic toggle="yes">d</italic><bold><italic toggle="yes">x</italic></bold><sub>0</sub> and using them to compute the quantity
<disp-formula id="pone.0257958.e119"><alternatives><graphic xlink:href="pone.0257958.e119.jpg" id="pone.0257958.e119g" position="anchor"/><mml:math id="M119" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mo>∇</mml:mo><mml:mo>˜</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:msub><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mo>∇</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>μ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msub><mml:mo>∇</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:msub><mml:mo>∫</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">ζ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(32)</label></disp-formula></p>
                <p>The prescription above also allows optimizing over control policies in scenarios where the disease’s equations of motion are not deterministic, but probabilistic. Suppose, for instance, that the disease’s dynamics are governed by a stochastic differential equation
<disp-formula id="pone.0257958.e120"><alternatives><graphic xlink:href="pone.0257958.e120.jpg" id="pone.0257958.e120g" position="anchor"/><mml:math id="M120" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msup><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">ξ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>;</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(33)</label></disp-formula>
where the entries of <inline-formula id="pone.0257958.e121"><alternatives><graphic xlink:href="pone.0257958.e121.jpg" id="pone.0257958.e121g" position="anchor"/><mml:math id="M121" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">ξ</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>s</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> represent Gaussian white noise. When we solve this equation by discretization, each occurrence of <bold><italic toggle="yes">ξ</italic></bold> at time <italic toggle="yes">t</italic><sub><italic toggle="yes">k</italic></sub> = <italic toggle="yes">t</italic><sub>0</sub> + <italic toggle="yes">kδ</italic> is to be replaced by an <italic toggle="yes">s</italic>-dimensional vector <bold><italic toggle="yes">ξ</italic></bold><sup><italic toggle="yes">k</italic></sup> of independent Gaussian variables of 0 mean and standard deviation <inline-formula id="pone.0257958.e122"><alternatives><graphic xlink:href="pone.0257958.e122.jpg" id="pone.0257958.e122g" position="anchor"/><mml:math id="M122" display="inline" overflow="scroll"><mml:msqrt><mml:mi>δ</mml:mi></mml:msqrt></mml:math></alternatives></inline-formula>. Call <inline-formula id="pone.0257958.e123"><alternatives><graphic xlink:href="pone.0257958.e123.jpg" id="pone.0257958.e123g" position="anchor"/><mml:math id="M123" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mo>⌈</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mi>δ</mml:mi></mml:mfrac><mml:mo>⌉</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. If we aim to minimize the expectation value of the objective function, we can estimate the gradient of the average through <xref rid="pone.0257958.e119" ref-type="disp-formula">Eq (32)</xref>, with <bold><italic toggle="yes">ζ</italic></bold> = (<bold><italic toggle="yes">ξ</italic></bold><sup>1</sup>, …, <bold><italic toggle="yes">ξ</italic></bold><sup><italic toggle="yes">M</italic></sup>) and
<disp-formula id="pone.0257958.e124"><alternatives><graphic xlink:href="pone.0257958.e124.jpg" id="pone.0257958.e124g" position="anchor"/><mml:math id="M124" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">ζ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>δ</mml:mi></mml:mrow></mml:msqrt></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mi>s</mml:mi></mml:msup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:msup><mml:mi mathvariant="bold-italic">ξ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:msqrt><mml:mi>δ</mml:mi></mml:msqrt></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(34)</label></disp-formula>
and use stochastic gradient descent to find the minimum. In the specific case we considered in our simulations, the noise simply affected the “susceptible” and “exposed” compartments, where the usual infection rate is multiplied by a factor (1 + <italic toggle="yes">ξ</italic>), thus modelling a stochastic fluctuation of the infection rate. This is arguably the most interesting term to study stochastic fluctuations, since the product <italic toggle="yes">SI</italic> appearing in the differential equation is at the origin of the nonlinearity of the SEIR model.</p>
                <p>In the next section, we will use the same idea to carry out policy optimizations in scenarios where the disease’s evolution is influenced by a finite number of discrete random variables.</p>
              </sec>
              <sec id="sec018">
                <title>C Optimization over discrete policies of disease control</title>
                <p>The section above explains how to conduct optimizations over disease control policies, as long as the parameters <bold><italic toggle="yes">μ</italic></bold> defining the policy are allowed to vary all over <inline-formula id="pone.0257958.e125"><alternatives><graphic xlink:href="pone.0257958.e125.jpg" id="pone.0257958.e125g" position="anchor"/><mml:math id="M125" display="inline" overflow="scroll"><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:math></alternatives></inline-formula>. Some policies, though, are by their very nature, discrete. For instance, on day <italic toggle="yes">t</italic> we can either declare a lockdown (<italic toggle="yes">s</italic>(<italic toggle="yes">t</italic>) = 1) or not declare a lockdown (<italic toggle="yes">s</italic>(<italic toggle="yes">t</italic>) = 0). As we discuss in section 5 in the main text, the effect of a lockdown policy in the evolution of the disease can be modeled by introducing a term in <xref rid="pone.0257958.e101" ref-type="disp-formula">Eq (26)</xref> that is proportional to <italic toggle="yes">s</italic>(<italic toggle="yes">t</italic>). Namely, <inline-formula id="pone.0257958.e126"><alternatives><graphic xlink:href="pone.0257958.e126.jpg" id="pone.0257958.e126g" position="anchor"/><mml:math id="M126" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</p>
                <p>To optimize over such discrete policies via gradient descent methods, one could think of introducing a continuous variable <inline-formula id="pone.0257958.e127"><alternatives><graphic xlink:href="pone.0257958.e127.jpg" id="pone.0257958.e127g" position="anchor"/><mml:math id="M127" display="inline" overflow="scroll"><mml:mrow><mml:mo>λ</mml:mo><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> and writing its effect on the disease’s equations of motion by means of a piece-wise continuous function of λ, e.g.: <italic toggle="yes">s</italic>(<italic toggle="yes">t</italic>) = Θ(λ), for <italic toggle="yes">t</italic> ∈ [<italic toggle="yes">t</italic><sub>1</sub>, <italic toggle="yes">t</italic><sub>2</sub>]. Here Θ(<italic toggle="yes">z</italic>) denotes the Heaviside function (i.e., Θ(<italic toggle="yes">z</italic>) equals 1 for <italic toggle="yes">z</italic> ≥ 0, or 0, otherwise). In this case, however, the gradient method would not work, since the Heaviside function has zero derivative everywhere except at 0. In every iteration of Adam, ∇<sub>λ</sub><italic toggle="yes">A</italic> would be null, and so λ<sup>(<italic toggle="yes">k</italic>)</sup> = λ<sup>(0)</sup> for all <italic toggle="yes">k</italic>.</p>
                <p>Applying the gradient method to optimize over policies for disease control involving discrete government interventions is therefore not straightforward. In the following, we propose two heuristics to tackle this problem.</p>
                <sec id="sec019">
                  <title>C.1 Optimization over deterministic discrete policies through non-deterministic discrete policies</title>
                  <p>Suppose, for the time being, that our lockdown policy were probabilistic, i.e., at each week <italic toggle="yes">k</italic>, we declare a lockdown with probability <inline-formula id="pone.0257958.e128"><alternatives><graphic xlink:href="pone.0257958.e128.jpg" id="pone.0257958.e128g" position="anchor"/><mml:math id="M128" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>σ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>; otherwise, with probability <inline-formula id="pone.0257958.e129"><alternatives><graphic xlink:href="pone.0257958.e129.jpg" id="pone.0257958.e129g" position="anchor"/><mml:math id="M129" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>σ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, we let the population roam freely. We wish to minimize our <italic toggle="yes">average</italic> objective function, that is, the expression
<disp-formula id="pone.0257958.e130"><alternatives><graphic xlink:href="pone.0257958.e130.jpg" id="pone.0257958.e130g" position="anchor"/><mml:math id="M130" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:munderover><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>∫</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mi mathvariant="script">L</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(35)</label></disp-formula>
where <italic toggle="yes">c</italic> is the whole vector of weekly lockdowns, and <bold><italic toggle="yes">μ</italic></bold> corresponds to the continuous parameters of the policy, e.g.: vaccination rates.</p>
                  <p>In principle, we could apply gradient descent to minimize <xref rid="pone.0257958.e130" ref-type="disp-formula">(35)</xref>. Estimating the exact gradient of the above expression is, however, unrealistic, as it involves summing a number of terms exponential in the number of weeks <italic toggle="yes">q</italic>. Instead, we will produce a random unbiased estimate of the gradient and invoke stochastic gradient descent methods, see Section 3.</p>
                  <p>Let us first differentiate <xref rid="pone.0257958.e130" ref-type="disp-formula">Eq (35)</xref> with respect to the continuous variables <bold><italic toggle="yes">μ</italic></bold>. The result is
<disp-formula id="pone.0257958.e131"><alternatives><graphic xlink:href="pone.0257958.e131.jpg" id="pone.0257958.e131g" position="anchor"/><mml:math id="M131" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:munderover><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>|</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>|</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>c</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(36)</label></disp-formula>
where
<disp-formula id="pone.0257958.e132"><alternatives><graphic xlink:href="pone.0257958.e132.jpg" id="pone.0257958.e132g" position="anchor"/><mml:math id="M132" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>|</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi mathvariant="script">L</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(37)</label></disp-formula>
and the components of the random variable <italic toggle="yes">c</italic> ∈ {0, 1}<sup><italic toggle="yes">q</italic></sup> are generated by sequentially sampling from the Bernouilli distributions <inline-formula id="pone.0257958.e133"><alternatives><graphic xlink:href="pone.0257958.e133.jpg" id="pone.0257958.e133g" position="anchor"/><mml:math id="M133" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>σ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula>. Note that the expression in the integrand of <xref rid="pone.0257958.e132" ref-type="disp-formula">(37)</xref> can be computed using the techniques discussed in Section B.</p>
                  <p>Differentiating <xref rid="pone.0257958.e130" ref-type="disp-formula">Eq (35)</xref> with respect to <inline-formula id="pone.0257958.e134"><alternatives><graphic xlink:href="pone.0257958.e134.jpg" id="pone.0257958.e134g" position="anchor"/><mml:math id="M134" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> we find that
<disp-formula id="pone.0257958.e135"><alternatives><graphic xlink:href="pone.0257958.e135.jpg" id="pone.0257958.e135g" position="anchor"/><mml:math id="M135" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>|</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(38)</label></disp-formula>
with
<disp-formula id="pone.0257958.e136"><alternatives><graphic xlink:href="pone.0257958.e136.jpg" id="pone.0257958.e136g" position="anchor"/><mml:math id="M136" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>|</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>∫</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mi mathvariant="script">L</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="4pt"/><mml:mtext>for</mml:mtext><mml:mspace width="4pt"/><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.166667em"/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(39)</label></disp-formula>
and the average <inline-formula id="pone.0257958.e137"><alternatives><graphic xlink:href="pone.0257958.e137.jpg" id="pone.0257958.e137g" position="anchor"/><mml:math id="M137" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mo>〈</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>|</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:msub></mml:math></alternatives></inline-formula> is obtained via sampling over the product of Bernoulli distributions for <inline-formula id="pone.0257958.e138"><alternatives><graphic xlink:href="pone.0257958.e138.jpg" id="pone.0257958.e138g" position="anchor"/><mml:math id="M138" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and fixing <inline-formula id="pone.0257958.e139"><alternatives><graphic xlink:href="pone.0257958.e139.jpg" id="pone.0257958.e139g" position="anchor"/><mml:math id="M139" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>.</p>
                  <p>Putting all this together, we have that the random vectors <italic toggle="yes">v</italic>, <italic toggle="yes">w</italic> satisfy
<disp-formula id="pone.0257958.e140"><alternatives><graphic xlink:href="pone.0257958.e140.jpg" id="pone.0257958.e140g" position="anchor"/><mml:math id="M140" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>⟨</mml:mo><mml:mi>v</mml:mi><mml:mo>⟩</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mo>∇</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>⟨</mml:mo><mml:mi>w</mml:mi><mml:mo>⟩</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mo>∇</mml:mo><mml:mi>s</mml:mi></mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(40)</label></disp-formula>
Since both vectors can be sampled efficiently, we can use them (and their averages) to optimize over <inline-formula id="pone.0257958.e141"><alternatives><graphic xlink:href="pone.0257958.e141.jpg" id="pone.0257958.e141g" position="anchor"/><mml:math id="M141" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> via stochastic gradient descent.</p>
                  <p>At this point, the reader might object that our original goal was to minimize <xref rid="pone.0257958.e106" ref-type="disp-formula">(27)</xref> over policies with <italic toggle="yes">deterministic</italic> lockdown. Very conveniently, independently of the initial values of <italic toggle="yes">s</italic>, <bold><italic toggle="yes">μ</italic></bold>, the stochastic gradient method will converge to a policy <italic toggle="yes">p</italic><sup>⋆</sup>, <bold><italic toggle="yes">μ</italic></bold><sup>⋆</sup> such that the deterministic policy with the same continuous parameters <bold><italic toggle="yes">μ</italic></bold><sup>⋆</sup> and lockdown given by
<disp-formula id="pone.0257958.e142"><alternatives><graphic xlink:href="pone.0257958.e142.jpg" id="pone.0257958.e142g" position="anchor"/><mml:math id="M142" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mi>k</mml:mi><mml:mo>⋆</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>for</mml:mtext><mml:mspace width="4pt"/><mml:msubsup><mml:mi>p</mml:mi><mml:mi>k</mml:mi><mml:mo>⋆</mml:mo></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mtext>otherwise</mml:mtext></mml:mtd></mml:mtr></mml:mtable><mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(41)</label></disp-formula>
has the same objective value. Indeed, for <italic toggle="yes">k</italic> ∈ {1, …, <italic toggle="yes">n</italic>}, fix <inline-formula id="pone.0257958.e143"><alternatives><graphic xlink:href="pone.0257958.e143.jpg" id="pone.0257958.e143g" position="anchor"/><mml:math id="M143" display="inline" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mo>⋆</mml:mo></mml:msubsup><mml:mo>:</mml:mo><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>k</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, then
<disp-formula id="pone.0257958.e144"><alternatives><graphic xlink:href="pone.0257958.e144.jpg" id="pone.0257958.e144g" position="anchor"/><mml:math id="M144" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>⋆</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>⋆</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:msubsup><mml:mi>p</mml:mi><mml:mi>k</mml:mi><mml:mo>⋆</mml:mo></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>A</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>⋆</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>⋆</mml:mo></mml:msup><mml:mo>|</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(42)</label></disp-formula>
with
<disp-formula id="pone.0257958.e145"><alternatives><graphic xlink:href="pone.0257958.e145.jpg" id="pone.0257958.e145g" position="anchor"/><mml:math id="M145" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>A</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>⋆</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>⋆</mml:mo></mml:msup><mml:mo>|</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo><mml:mo>≡</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="right"><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mi>q</mml:mi></mml:munderover><mml:msubsup><mml:mi>p</mml:mi><mml:mi>j</mml:mi><mml:mo>⋆</mml:mo></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>∫</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mi mathvariant="script">L</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>⋆</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>⋆</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(43)</label></disp-formula>
Since <italic toggle="yes">p</italic><sup>⋆</sup>, <bold><italic toggle="yes">μ</italic></bold><sup>⋆</sup> is a local minimum of <inline-formula id="pone.0257958.e146"><alternatives><graphic xlink:href="pone.0257958.e146.jpg" id="pone.0257958.e146g" position="anchor"/><mml:math id="M146" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>⋆</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>⋆</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, it follows that, either
<disp-formula id="pone.0257958.e147"><alternatives><graphic xlink:href="pone.0257958.e147.jpg" id="pone.0257958.e147g" position="anchor"/><mml:math id="M147" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>⋆</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>⋆</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>⋆</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>⋆</mml:mo></mml:msup><mml:mo>|</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>⋆</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>⋆</mml:mo></mml:msup><mml:mo>|</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(44)</label></disp-formula>
or, for some <italic toggle="yes">a</italic> ∈ {0, 1},
<disp-formula id="pone.0257958.e148"><alternatives><graphic xlink:href="pone.0257958.e148.jpg" id="pone.0257958.e148g" position="anchor"/><mml:math id="M148" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>⋆</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>⋆</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>⋆</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>⋆</mml:mo></mml:msup><mml:mo>|</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>A</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>⋆</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>⋆</mml:mo></mml:msup><mml:mo>|</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(45)</label></disp-formula>
with <inline-formula id="pone.0257958.e149"><alternatives><graphic xlink:href="pone.0257958.e149.jpg" id="pone.0257958.e149g" position="anchor"/><mml:math id="M149" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>k</mml:mi><mml:mo>⋆</mml:mo></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>k</mml:mi><mml:mo>⋆</mml:mo></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. In either case, fixing <italic toggle="yes">c</italic><sub><italic toggle="yes">k</italic></sub> through the procedure <xref rid="pone.0257958.e142" ref-type="disp-formula">(41)</xref> cannot increase the average value of the objective function. Iterating over <italic toggle="yes">k</italic> = 1, …, <italic toggle="yes">q</italic>, we prove the claim.</p>
                  <p><italic toggle="yes">C.1.1 Generalization to optimizations over adaptive policies</italic>. The method described above can be easily extended to tackle optimization problems over weekly discrete adaptive policies. Consider an adaptive policy where the government intervention <italic toggle="yes">c</italic><sub><italic toggle="yes">k</italic></sub> ∈ {0, 1} on week <italic toggle="yes">k</italic> is decided on week <italic toggle="yes">k</italic> − <italic toggle="yes">l</italic> by sampling from a Bernoulli distribution dependent on the value <bold><italic toggle="yes">θ</italic></bold><sup><italic toggle="yes">k</italic></sup> of the cell state on week <italic toggle="yes">k</italic> − <italic toggle="yes">l</italic> (remember from Appendix B that the cell state at time <italic toggle="yes">t</italic> represents the government’s internal memory and is given by some of the entries of <bold><italic toggle="yes">x</italic></bold>(<italic toggle="yes">t</italic>)). The functional form of this distribution is determined by a vector of parameters <bold><italic toggle="yes">ν</italic></bold><sup><italic toggle="yes">k</italic></sup>. We thus have that <italic toggle="yes">p</italic><sub><italic toggle="yes">k</italic></sub>(<italic toggle="yes">c</italic><sub><italic toggle="yes">k</italic></sub>) = <italic toggle="yes">p</italic><sub><italic toggle="yes">k</italic></sub>(<italic toggle="yes">c</italic><sub><italic toggle="yes">k</italic></sub>|<bold><italic toggle="yes">θ</italic></bold><sup><italic toggle="yes">k</italic></sup>; <bold><italic toggle="yes">ν</italic></bold><sup><italic toggle="yes">k</italic></sup>).</p>
                  <p>Note that <bold><italic toggle="yes">x</italic></bold><sup><italic toggle="yes">k</italic></sup> = <bold><italic toggle="yes">x</italic></bold><sup><italic toggle="yes">k</italic></sup>(<italic toggle="yes">c</italic><sub>1</sub>, …, <italic toggle="yes">c</italic><sub><italic toggle="yes">k</italic>−<italic toggle="yes">l</italic>−1</sub>). Starting from the initial conditions <bold><italic toggle="yes">x</italic></bold><sub>0</sub>, the average objective function can therefore be estimated by propagating <bold><italic toggle="yes">x</italic></bold> week by week, computing the contribution to <xref rid="pone.0257958.e106" ref-type="disp-formula">(27)</xref> and sampling each <italic toggle="yes">c</italic><sub><italic toggle="yes">k</italic></sub> at time 7(<italic toggle="yes">k</italic> − <italic toggle="yes">l</italic>) as we go along. If we instead compute the contribution to the gradient of <xref rid="pone.0257958.e106" ref-type="disp-formula">(27)</xref> with respect to the continuous variables <bold><italic toggle="yes">μ</italic></bold>, we will have a statistical estimate of the gradient of the average objective function (with respect to <bold><italic toggle="yes">μ</italic></bold>).</p>
                  <p>Estimating the gradient of the average objective function with respect to the variables <bold><italic toggle="yes">ν</italic></bold><sup><italic toggle="yes">k</italic></sup> is done similarly, by averaging over the appropriate Markov chain. More specifically,
<disp-formula id="pone.0257958.e150"><alternatives><graphic xlink:href="pone.0257958.e150.jpg" id="pone.0257958.e150g" position="anchor"/><mml:math id="M150" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mo>∇</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">ν</mml:mi><mml:mi>k</mml:mi></mml:msup></mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ν</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>|</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(46)</label></disp-formula>
with
<disp-formula id="pone.0257958.e151"><alternatives><graphic xlink:href="pone.0257958.e151.jpg" id="pone.0257958.e151g" position="anchor"/><mml:math id="M151" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">ν</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>|</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mo>∇</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">ν</mml:mi><mml:mi>k</mml:mi></mml:msup></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>|</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mi>k</mml:mi></mml:msup><mml:mo>;</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">ν</mml:mi><mml:mi>k</mml:mi></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mo>∫</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mi mathvariant="script">L</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="4pt"/><mml:mtext>for</mml:mtext><mml:mspace width="4pt"/><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(47)</label></disp-formula>
This time, <italic toggle="yes">c</italic><sup>(<italic toggle="yes">k</italic>,<italic toggle="yes">a</italic>)</sup> is sampled sequentially while we solve the differential equation, as described before to estimate the average of the objective function. The only difference is that, at time <italic toggle="yes">t</italic><sub>0</sub> + 7(<italic toggle="yes">k</italic> − <italic toggle="yes">l</italic>), instead of sampling <italic toggle="yes">c</italic><sub><italic toggle="yes">k</italic></sub>, we set it equal to <italic toggle="yes">a</italic>.</p>
                  <p>Now, let us assume that, for <bold><italic toggle="yes">y</italic></bold><sub>1</sub> ≠ <bold><italic toggle="yes">y</italic></bold><sub>2</sub>, the family of functions <italic toggle="yes">p</italic><sub><italic toggle="yes">k</italic></sub>(<italic toggle="yes">a</italic>|<bold><italic toggle="yes">θ</italic></bold><sup><italic toggle="yes">k</italic></sup>;<bold><italic toggle="yes">ν</italic></bold><sup><italic toggle="yes">k</italic></sup>) available is rich enough to regard <italic toggle="yes">p</italic><sub><italic toggle="yes">k</italic></sub>(<italic toggle="yes">a</italic>|<bold><italic toggle="yes">θ</italic></bold><sup><italic toggle="yes">k</italic></sup> = <bold><italic toggle="yes">y</italic></bold><sub>1</sub>;<bold><italic toggle="yes">ν</italic></bold><sup><italic toggle="yes">k</italic></sup>), <italic toggle="yes">p</italic><sub><italic toggle="yes">k</italic></sub>(<italic toggle="yes">a</italic>|<bold><italic toggle="yes">θ</italic></bold><sup><italic toggle="yes">k</italic></sup> = <bold><italic toggle="yes">y</italic></bold><sub>2</sub>;<bold><italic toggle="yes">ν</italic></bold><sup><italic toggle="yes">k</italic></sup>) as independent. Then one can argue as for non-adaptive policies and conclude that the gradient method will converge to a deterministic policy.</p>
                </sec>
                <sec id="sec020">
                  <title>C.2 Optimization over discrete policies with continuous lockdown times</title>
                  <p>Our second heuristic to devise discrete policies for disease control requires considering lock-down policies of the following form:
<disp-formula id="pone.0257958.e152"><alternatives><graphic xlink:href="pone.0257958.e152.jpg" id="pone.0257958.e152g" position="anchor"/><mml:math id="M152" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="4pt"/><mml:mtext>if</mml:mtext><mml:mspace width="4pt"/><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mspace width="4pt"/><mml:mtext>or</mml:mtext><mml:mspace width="4pt"/><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>τ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>τ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="4pt"/><mml:mtext>for</mml:mtext><mml:mspace width="4pt"/><mml:mtext>some</mml:mtext><mml:mspace width="4pt"/><mml:mi>i</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>otherwise</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(48)</label></disp-formula>
Here <italic toggle="yes">t</italic><sub>0</sub> is fixed and the variables <inline-formula id="pone.0257958.e153"><alternatives><graphic xlink:href="pone.0257958.e153.jpg" id="pone.0257958.e153g" position="anchor"/><mml:math id="M153" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> are assumed to be non-negative and to add up to <italic toggle="yes">t</italic><sub><italic toggle="yes">f</italic></sub> − <italic toggle="yes">t</italic><sub>0</sub>; this policy can hence be parametrized by a vector <inline-formula id="pone.0257958.e154"><alternatives><graphic xlink:href="pone.0257958.e154.jpg" id="pone.0257958.e154g" position="anchor"/><mml:math id="M154" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, with <bold><italic toggle="yes">τ</italic></bold> = (<italic toggle="yes">t</italic><sub><italic toggle="yes">f</italic></sub> − <italic toggle="yes">t</italic><sub>0</sub>)softmax(<bold><italic toggle="yes">μ</italic></bold>), where softmax(<bold><italic toggle="yes">μ</italic></bold>) denotes the vector <bold><italic toggle="yes">ν</italic></bold> with components <inline-formula id="pone.0257958.e155"><alternatives><graphic xlink:href="pone.0257958.e155.jpg" id="pone.0257958.e155g" position="anchor"/><mml:math id="M155" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>exp</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>. Intuitively, <inline-formula id="pone.0257958.e156"><alternatives><graphic xlink:href="pone.0257958.e156.jpg" id="pone.0257958.e156g" position="anchor"/><mml:math id="M156" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> divide the interval [<italic toggle="yes">t</italic><sub>0</sub>, <italic toggle="yes">t</italic><sub><italic toggle="yes">f</italic></sub>] into <italic toggle="yes">n</italic> different parts. In each part, lockdown is alternatively declared (<italic toggle="yes">s</italic> = 1) or suspended (<italic toggle="yes">s</italic> = 0), see <xref rid="pone.0257958.g015" ref-type="fig">Fig 15</xref>.</p>
                  <fig position="float" id="pone.0257958.g015">
                    <object-id pub-id-type="doi">10.1371/journal.pone.0257958.g015</object-id>
                    <label>Fig 15</label>
                    <caption>
                      <title>Lockdowns (discrete policies) parametrized with continuous time.</title>
                      <p>In this example there are two lockdowns and two periods of freedom. The algorithm finds the optimal distribution and minimises the total time <italic toggle="yes">τ</italic><sub>2</sub> + <italic toggle="yes">τ</italic><sub>4</sub> in lockdown.</p>
                    </caption>
                    <graphic xlink:href="pone.0257958.g015" position="float"/>
                  </fig>
                  <p>At time <italic toggle="yes">t</italic>, the disease’s basic reproduction number is given by <xref rid="pone.0257958.e037" ref-type="disp-formula">(15)</xref>, with <italic toggle="yes">s</italic>(<italic toggle="yes">t</italic>) defined as above. To find out <inline-formula id="pone.0257958.e157"><alternatives><graphic xlink:href="pone.0257958.e157.jpg" id="pone.0257958.e157g" position="anchor"/><mml:math id="M157" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>≡</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, we invoke <xref rid="pone.0257958.e110" ref-type="disp-formula">Eq (29)</xref>. In computing the term
<disp-formula id="pone.0257958.e158"><alternatives><graphic xlink:href="pone.0257958.e158.jpg" id="pone.0257958.e158g" position="anchor"/><mml:math id="M158" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(49)</label></disp-formula>
we have the problem that, due to <xref rid="pone.0257958.e152" ref-type="disp-formula">(48)</xref>, <italic toggle="yes">G</italic> is not continuous or differentiable. To work our way out, we approximate <italic toggle="yes">s</italic>(<italic toggle="yes">t</italic>) by a piece-wise continuous function with bounded derivative that transitions from 0 to 1 (or viceversa) linearly and in time <italic toggle="yes">δ</italic> ≪ 1, see <xref rid="pone.0257958.g016" ref-type="fig">Fig 16</xref>; later we will take the limit <italic toggle="yes">δ</italic> → 0.</p>
                  <fig position="float" id="pone.0257958.g016">
                    <object-id pub-id-type="doi">10.1371/journal.pone.0257958.g016</object-id>
                    <label>Fig 16</label>
                    <caption>
                      <title>Modified continuous function <inline-formula id="pone.0257958.e159"><alternatives><graphic xlink:href="pone.0257958.e159" id="pone.0257958.e159g" position="anchor"/><mml:math id="M159" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</title>
                    </caption>
                    <graphic xlink:href="pone.0257958.g016" position="float"/>
                  </fig>
                  <p>The new function <inline-formula id="pone.0257958.e160"><alternatives><graphic xlink:href="pone.0257958.e160.jpg" id="pone.0257958.e160g" position="anchor"/><mml:math id="M160" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> has zero derivative with respect to <italic toggle="yes">μ</italic><sub><italic toggle="yes">i</italic></sub>, except for <italic toggle="yes">t</italic> satisfying
<disp-formula id="pone.0257958.e161"><alternatives><graphic xlink:href="pone.0257958.e161.jpg" id="pone.0257958.e161g" position="anchor"/><mml:math id="M161" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>t</mml:mi><mml:mo>-</mml:mo></mml:msup><mml:mo>≔</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>u</mml:mi></mml:munderover><mml:msub><mml:mi>τ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:mi>t</mml:mi><mml:mo>≤</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>u</mml:mi></mml:munderover><mml:msub><mml:mi>τ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>:</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(50)</label></disp-formula>
In that case, the derivative of <inline-formula id="pone.0257958.e162"><alternatives><graphic xlink:href="pone.0257958.e162.jpg" id="pone.0257958.e162g" position="anchor"/><mml:math id="M162" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> with respect to <italic toggle="yes">τ</italic><sub><italic toggle="yes">j</italic></sub>, with <italic toggle="yes">j</italic> ≤ <italic toggle="yes">u</italic>, will (approximately) be
<disp-formula id="pone.0257958.e163"><alternatives><graphic xlink:href="pone.0257958.e163.jpg" id="pone.0257958.e163g" position="anchor"/><mml:math id="M163" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mi>u</mml:mi></mml:msup><mml:mi>δ</mml:mi></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(51)</label></disp-formula>
The derivative with respect to any of the variables {<italic toggle="yes">τ</italic><sub><italic toggle="yes">j</italic></sub>: <italic toggle="yes">j</italic> &gt; <italic toggle="yes">u</italic>} is zero. The dominant term on the right-hand side of <xref rid="pone.0257958.e110" ref-type="disp-formula">(29)</xref> for <italic toggle="yes">t</italic> ∈ [<italic toggle="yes">t</italic><sup>−</sup>, <italic toggle="yes">t</italic><sup>+</sup>] is therefore
<disp-formula id="pone.0257958.e164"><alternatives><graphic xlink:href="pone.0257958.e164.jpg" id="pone.0257958.e164g" position="anchor"/><mml:math id="M164" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>-</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>-</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>u</mml:mi></mml:munderover><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mi>u</mml:mi></mml:msup><mml:mi>δ</mml:mi></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>-</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>-</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>u</mml:mi></mml:munderover><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mtext>softmax</mml:mtext><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>:</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>-</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>-</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>δ</mml:mi></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(52)</label></disp-formula>
Since the evolution takes place for time <italic toggle="yes">δ</italic> = <italic toggle="yes">t</italic><sup>+</sup> − <italic toggle="yes">t</italic><sup>−</sup>, we have that <inline-formula id="pone.0257958.e165"><alternatives><graphic xlink:href="pone.0257958.e165.jpg" id="pone.0257958.e165g" position="anchor"/><mml:math id="M165" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>+</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>-</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mi>K</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>-</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>-</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Taking the limit <italic toggle="yes">δ</italic> → 0, we have that the evolution of <inline-formula id="pone.0257958.e166"><alternatives><graphic xlink:href="pone.0257958.e166.jpg" id="pone.0257958.e166g" position="anchor"/><mml:math id="M166" display="inline" overflow="scroll"><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is determined by the following prescription:</p>
                  <list list-type="order">
                    <list-item>
                      <p><inline-formula id="pone.0257958.e167"><alternatives><graphic xlink:href="pone.0257958.e167.jpg" id="pone.0257958.e167g" position="anchor"/><mml:math id="M167" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.</p>
                    </list-item>
                    <list-item>
                      <p>Let <inline-formula id="pone.0257958.e168"><alternatives><graphic xlink:href="pone.0257958.e168.jpg" id="pone.0257958.e168g" position="anchor"/><mml:math id="M168" display="inline" overflow="scroll"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>u</mml:mi></mml:msubsup><mml:msub><mml:mi>τ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, for some <italic toggle="yes">u</italic>. Then <inline-formula id="pone.0257958.e169"><alternatives><graphic xlink:href="pone.0257958.e169.jpg" id="pone.0257958.e169g" position="anchor"/><mml:math id="M169" display="inline" overflow="scroll"><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is updated by the rule
<disp-formula id="pone.0257958.e170"><alternatives><graphic xlink:href="pone.0257958.e170.jpg" id="pone.0257958.e170g" position="anchor"/><mml:math id="M170" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>→</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mi>K</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(53)</label></disp-formula></p>
                    </list-item>
                    <list-item>
                      <p>For all other values of <italic toggle="yes">t</italic>, <inline-formula id="pone.0257958.e171"><alternatives><graphic xlink:href="pone.0257958.e171.jpg" id="pone.0257958.e171g" position="anchor"/><mml:math id="M171" display="inline" overflow="scroll"><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> continuously evolves via the equation
<disp-formula id="pone.0257958.e172"><alternatives><graphic xlink:href="pone.0257958.e172.jpg" id="pone.0257958.e172g" position="anchor"/><mml:math id="M172" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>l</mml:mi></mml:munder><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mi>l</mml:mi></mml:msup></mml:mrow></mml:mfrac><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mi>l</mml:mi></mml:msubsup><mml:mo>;</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(54)</label></disp-formula></p>
                    </list-item>
                  </list>
                </sec>
              </sec>
              <sec id="sec021">
                <title>D Continuous-space population models</title>
                <p>Even though the focus of this article is that of compartmental models of the form <xref rid="pone.0257958.e101" ref-type="disp-formula">(26)</xref>, one can also apply the principles of gradient descent for policy optimizations on dynamical systems governed by partial differential equations. Consider, e.g., the scenario studied in [<xref rid="pone.0257958.ref026" ref-type="bibr">26</xref>], where the authors model the spread of rabies in raccoons across a realistic landscape <inline-formula id="pone.0257958.e173"><alternatives><graphic xlink:href="pone.0257958.e173.jpg" id="pone.0257958.e173g" position="anchor"/><mml:math id="M173" display="inline" overflow="scroll"><mml:mrow><mml:mo>Ω</mml:mo><mml:mo>⊂</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> through a system of reaction-diffusion equations of the form
<disp-formula id="pone.0257958.e174"><alternatives><graphic xlink:href="pone.0257958.e174.jpg" id="pone.0257958.e174g" position="anchor"/><mml:math id="M174" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>-</mml:mo><mml:mtext>div</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">ν</mml:mi><mml:mo>∇</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(55)</label></disp-formula>
In this equation, the three entries of the vector field <inline-formula id="pone.0257958.e175"><alternatives><graphic xlink:href="pone.0257958.e175.jpg" id="pone.0257958.e175g" position="anchor"/><mml:math id="M175" display="inline" overflow="scroll"><mml:mrow><mml:mi>u</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> respectively denote the number of susceptible, exposed and infected individuals at time <italic toggle="yes">t</italic> in position <italic toggle="yes">X</italic>, <italic toggle="yes">Y</italic>. <italic toggle="yes">ν</italic>, <italic toggle="yes">A</italic> are 3 × 3 matrices that, in principle, might depend on some controllable parameters <bold><italic toggle="yes">μ</italic></bold>. This equation is to be solved under the initial conditions <italic toggle="yes">u</italic>(0, <italic toggle="yes">X</italic>, <italic toggle="yes">Y</italic>) = <italic toggle="yes">u</italic><sub>0</sub>(<italic toggle="yes">X</italic>, <italic toggle="yes">Y</italic>) and the homogeneous von Neumann boundary conditions
<disp-formula id="pone.0257958.e176"><alternatives><graphic xlink:href="pone.0257958.e176.jpg" id="pone.0257958.e176g" position="anchor"/><mml:math id="M176" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>∇</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo>)</mml:mo><mml:mo>·</mml:mo><mml:mi mathvariant="bold-italic">n</mml:mi><mml:mo>(</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="4pt"/><mml:mtext>for</mml:mtext><mml:mspace width="4pt"/><mml:mo>(</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:mi>∂</mml:mi><mml:mo>Ω</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(56)</label></disp-formula>
where <inline-formula id="pone.0257958.e177"><alternatives><graphic xlink:href="pone.0257958.e177.jpg" id="pone.0257958.e177g" position="anchor"/><mml:math id="M177" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> denotes the vector normal to the contour ∂Ω at location (<italic toggle="yes">X</italic>, <italic toggle="yes">Y</italic>). The authors of [<xref rid="pone.0257958.ref026" ref-type="bibr">26</xref>] solve this equation numerically via the Finite Element Method (FEM) [<xref rid="pone.0257958.ref034" ref-type="bibr">34</xref>].</p>
                <p>Suppose that we wished to optimize the policy parameters <inline-formula id="pone.0257958.e178"><alternatives><graphic xlink:href="pone.0257958.e178.jpg" id="pone.0257958.e178g" position="anchor"/><mml:math id="M178" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> over some functional <italic toggle="yes">A</italic> depending on <bold><italic toggle="yes">u</italic></bold>(<italic toggle="yes">t</italic>, <italic toggle="yes">X</italic>, <italic toggle="yes">Y</italic>;<bold><italic toggle="yes">μ</italic></bold>, <italic toggle="yes">u</italic><sub>0</sub>) (instead of <bold><italic toggle="yes">x</italic></bold>(<italic toggle="yes">t</italic>;<bold><italic toggle="yes">μ</italic></bold>, <bold><italic toggle="yes">x</italic></bold><sub>0</sub>)) via the gradient method. Then at some point we would need to compute the quantities <inline-formula id="pone.0257958.e179"><alternatives><graphic xlink:href="pone.0257958.e179.jpg" id="pone.0257958.e179g" position="anchor"/><mml:math id="M179" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>≡</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>. Let <inline-formula id="pone.0257958.e180"><alternatives><graphic xlink:href="pone.0257958.e180.jpg" id="pone.0257958.e180g" position="anchor"/><mml:math id="M180" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mi mathvariant="bold-italic">j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> be the vector with components <inline-formula id="pone.0257958.e181"><alternatives><graphic xlink:href="pone.0257958.e181.jpg" id="pone.0257958.e181g" position="anchor"/><mml:math id="M181" display="inline" overflow="scroll"><mml:msubsup><mml:mi>v</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and differentiate both <xref rid="pone.0257958.e174" ref-type="disp-formula">(55)</xref> and <xref rid="pone.0257958.e176" ref-type="disp-formula">(56)</xref> with respect to <italic toggle="yes">μ</italic><sub><italic toggle="yes">i</italic></sub>. This results in the equation
<disp-formula id="pone.0257958.e182"><alternatives><graphic xlink:href="pone.0257958.e182.jpg" id="pone.0257958.e182g" position="anchor"/><mml:math id="M182" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mi>∂</mml:mi><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:msub><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mi mathvariant="bold-italic">j</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mtext>div</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi mathvariant="bold-italic">ν</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>∇</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>+</mml:mo><mml:mi>ν</mml:mi><mml:mo>∇</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mi mathvariant="bold-italic">j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:msubsup><mml:mi>v</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>+</mml:mo><mml:mi>A</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mi mathvariant="bold-italic">j</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>∇</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mi mathvariant="bold-italic">j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:mi mathvariant="bold-italic">n</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="4pt"/><mml:mtext>for</mml:mtext><mml:mspace width="4pt"/><mml:mrow><mml:mo>(</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:mi>∂</mml:mi><mml:mo>Ω</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(57)</label></disp-formula>
Since <bold><italic toggle="yes">u</italic></bold>(0, <italic toggle="yes">X</italic>, <italic toggle="yes">Y</italic>;<bold><italic toggle="yes">μ</italic></bold>, <bold><italic toggle="yes">u</italic></bold><sub><bold><italic toggle="yes">0</italic></bold></sub>) does not depend on <bold><italic toggle="yes">μ</italic></bold>, this new diffusion equation must be solved for the initial conditions <bold><italic toggle="yes">v</italic></bold><sub><bold><italic toggle="yes">j</italic></bold></sub>(<italic toggle="yes">X</italic>, <italic toggle="yes">Y</italic>, 0) = 0. This can be achieved numerically in the same way that the authors of [<xref rid="pone.0257958.ref026" ref-type="bibr">26</xref>] solved <xref rid="pone.0257958.e174" ref-type="disp-formula">Eq (55)</xref>, that is, via the FEM.</p>
              </sec>
            </sec>
          </body>
          <back>
            <ack>
              <p>We thank Luca Gerardo-Giorda and Mario Budroni for useful discussions.</p>
            </ack>
            <ref-list>
              <title>References</title>
              <ref id="pone.0257958.ref001">
                <label>1</label>
                <mixed-citation publication-type="other">Nations U. A UN framework for the immediate socio-economic response to COVID-19; 2020. Available from: <ext-link xlink:href="https://unsdg.un.org/resources/un-framework-immediate-socio-economic-response-covid-19" ext-link-type="uri">https://unsdg.un.org/resources/un-framework-immediate-socio-economic-response-covid-19</ext-link>.</mixed-citation>
              </ref>
              <ref id="pone.0257958.ref002">
                <label>2</label>
                <mixed-citation publication-type="journal"><article-title>COVID-19 has made the health system’s collapse complete in Yemen</article-title>. <source>Medecins sans Frontieres</source>. <year>2020</year>;.</mixed-citation>
              </ref>
              <ref id="pone.0257958.ref003">
                <label>3</label>
                <mixed-citation publication-type="journal"><article-title>People are dying at home amid collapsing health system in El Salvador</article-title>. <source>Medecins sans Frontieres</source>. <year>2020</year>;.</mixed-citation>
              </ref>
              <ref id="pone.0257958.ref004">
                <label>4</label>
                <mixed-citation publication-type="journal"><name><surname>Pradhan</surname><given-names>TR</given-names></name>. <article-title>Government decides to lift the four-month-long coronavirus lockdown, but with conditions</article-title>. <source>The Kathmandu Post</source>. <year>2020</year>;.</mixed-citation>
              </ref>
              <ref id="pone.0257958.ref005">
                <label>5</label>
                <mixed-citation publication-type="book"><name><surname>Keeling</surname><given-names>MJ</given-names></name>, <name><surname>Rohani</surname><given-names>P</given-names></name>. <source>Modeling Infectious Diseases in Humans and Animals</source>. <publisher-name>Princeton University Press</publisher-name>; <year>2008</year>. Available from: <ext-link xlink:href="http://www.jstor.org/stable/j.ctvcm4gk0" ext-link-type="uri">http://www.jstor.org/stable/j.ctvcm4gk0</ext-link>.</mixed-citation>
              </ref>
              <ref id="pone.0257958.ref006">
                <label>6</label>
                <mixed-citation publication-type="journal"><name><surname>Hindes</surname><given-names>J</given-names></name>, <name><surname>Bianco</surname><given-names>S</given-names></name>, <name><surname>Schwartz</surname><given-names>I</given-names></name>. <article-title>Optimal periodic closure for minimizing risk in emerging disease outbreaks</article-title>. <source>PLoS ONE</source>. <year>2021</year>;<volume>16</volume>(<issue>1 January</issue>). <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0244706</pub-id><?supplied-pmid 33406106?><pub-id pub-id-type="pmid">33406106</pub-id></mixed-citation>
              </ref>
              <ref id="pone.0257958.ref007">
                <label>7</label>
                <mixed-citation publication-type="journal"><name><surname>Gaff</surname><given-names>H</given-names></name>, <name><surname>Schaefer</surname><given-names>E</given-names></name>. <article-title>Optimal control applied to vaccination and treatment strategies for various epidemiological models</article-title>. <source>Mathematical Biosciences and Engineering</source>. <year>2009</year>;<volume>6</volume>:<fpage>469</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3934/mbe.2009.6.469</pub-id><?supplied-pmid 19566121?><pub-id pub-id-type="pmid">19566121</pub-id></mixed-citation>
              </ref>
              <ref id="pone.0257958.ref008">
                <label>8</label>
                <mixed-citation publication-type="other">de Pinho MdR, Kornienko I, Maurer H. Optimal Control of a SEIR Model with Mixed Constraints and L1 Cost. In: Moreira AP, Matos A, Veiga G, editors. CONTROLO’2014—Proceedings of the 11th Portuguese Conference on Automatic Control. Cham: Springer International Publishing; 2015. p. 135–145.</mixed-citation>
              </ref>
              <ref id="pone.0257958.ref009">
                <label>9</label>
                <mixed-citation publication-type="journal"><name><surname>Obsu</surname><given-names>LL</given-names></name>, <name><surname>Balcha</surname><given-names>SF</given-names></name>. <article-title>Optimal control strategies for the transmission risk of COVID-19</article-title>. <source>Journal of Biological Dynamics</source>. <year>2020</year>;<volume>14</volume>(<issue>1</issue>):<fpage>590</fpage>–<lpage>607</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1080/17513758.2020.1788182</pub-id><pub-id pub-id-type="pmid">32696723</pub-id></mixed-citation>
              </ref>
              <ref id="pone.0257958.ref010">
                <label>10</label>
                <mixed-citation publication-type="journal"><name><surname>Zamir</surname><given-names>M</given-names></name>, <name><surname>Shah</surname><given-names>Z</given-names></name>, <name><surname>Nadeem</surname><given-names>F</given-names></name>, <name><surname>Memood</surname><given-names>A</given-names></name>, <name><surname>Alrabaiah</surname><given-names>H</given-names></name>, <name><surname>Kumam</surname><given-names>P</given-names></name>. <article-title>Non Pharmaceutical Interventions for Optimal Control of COVID-19</article-title>. <source>Computer Methods and Programs in Biomedicine</source>. <year>2020</year>;<volume>196</volume>:<fpage>105642</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cmpb.2020.105642</pub-id><?supplied-pmid 32688137?><pub-id pub-id-type="pmid">32688137</pub-id></mixed-citation>
              </ref>
              <ref id="pone.0257958.ref011">
                <label>11</label>
                <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>Q</given-names></name>, <name><surname>Guan</surname><given-names>X</given-names></name>, <name><surname>Wu</surname><given-names>P</given-names></name>, <name><surname>Wang</surname><given-names>X</given-names></name>, <name><surname>Zhou</surname><given-names>L</given-names></name>, <name><surname>Tong</surname><given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>Early Transmission Dynamics in Wuhan, China, of Novel Coronavirus-Infected Pneumonia</article-title>. <source>New England Journal of Medicine</source>. <year>2020</year>;<volume>382</volume>(<issue>13</issue>):<fpage>1199</fpage>–<lpage>1207</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1056/NEJMoa2001316</pub-id>
<?supplied-pmid 31995857?><pub-id pub-id-type="pmid">31995857</pub-id></mixed-citation>
              </ref>
              <ref id="pone.0257958.ref012">
                <label>12</label>
                <mixed-citation publication-type="journal"><name><surname>Riou</surname><given-names>J</given-names></name>, <name><surname>Althaus</surname><given-names>CL</given-names></name>. <article-title>Pattern of early human-to-human transmission of Wuhan 2019 novel coronavirus (2019-nCoV), December 2019 to January 2020</article-title>. <source>Eurosurveillance</source>. <year>2020</year>;<volume>25</volume>:<fpage>2000058</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.2807/1560-7917.ES.2020.25.4.2000058</pub-id></mixed-citation>
              </ref>
              <ref id="pone.0257958.ref013">
                <label>13</label>
                <mixed-citation publication-type="journal"><name><surname>Volpicelli</surname><given-names>G</given-names></name>. <article-title>China has almost eliminated Covid-19. What can the world learn?</article-title><source>Wired</source>. <year>2020</year>;.</mixed-citation>
              </ref>
              <ref id="pone.0257958.ref014">
                <label>14</label>
                <mixed-citation publication-type="book"><name><surname>Goodfellow</surname><given-names>IJ</given-names></name>, <name><surname>Bengio</surname><given-names>Y</given-names></name>, <name><surname>Courville</surname><given-names>A</given-names></name>. <source>Deep Learning</source>. <publisher-loc>Cambridge, MA, USA</publisher-loc>: <publisher-name>MIT Press</publisher-name>; <year>2016</year>. Available from: <ext-link xlink:href="http://www.deeplearningbook.org" ext-link-type="uri">http://www.deeplearningbook.org</ext-link>.</mixed-citation>
              </ref>
              <ref id="pone.0257958.ref015">
                <label>15</label>
                <mixed-citation publication-type="journal"><name><surname>Kissler</surname><given-names>S</given-names></name>, <name><surname>Tedijanto</surname><given-names>C</given-names></name>, <name><surname>Lipsitch</surname><given-names>M</given-names></name>, <name><surname>Grad</surname><given-names>Y</given-names></name>. <source>Social distancing strategies for curbing the COVID-19 epidemic</source>; <year>2020</year>. Available from: <ext-link xlink:href="https://dash.harvard.edu/handle/1/42638988" ext-link-type="uri">https://dash.harvard.edu/handle/1/42638988</ext-link>.</mixed-citation>
              </ref>
              <ref id="pone.0257958.ref016">
                <label>16</label>
                <mixed-citation publication-type="journal"><name><surname>Reich</surname><given-names>NG</given-names></name>, <name><surname>Brooks</surname><given-names>LC</given-names></name>, <name><surname>Fox</surname><given-names>SJ</given-names></name>, <name><surname>Kandula</surname><given-names>S</given-names></name>, <name><surname>McGowan</surname><given-names>CJ</given-names></name>, <name><surname>Moore</surname><given-names>E</given-names></name>, <etal>et al</etal>. <article-title>A collaborative multiyear, multimodel assessment of seasonal influenza forecasting in the United States</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2019</year>;<volume>116</volume>(<issue>8</issue>):<fpage>3146</fpage>–<lpage>3154</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.1812594116</pub-id>
<?supplied-pmid 30647115?><pub-id pub-id-type="pmid">30647115</pub-id></mixed-citation>
              </ref>
              <ref id="pone.0257958.ref017">
                <label>17</label>
                <mixed-citation publication-type="other">Online repository with the code used for the simulations, optimizations, and plots presented;. Available from: <ext-link xlink:href="https://github.com/costantinobudroni/opt-disease-control/" ext-link-type="uri">https://github.com/costantinobudroni/opt-disease-control/</ext-link>.</mixed-citation>
              </ref>
              <ref id="pone.0257958.ref018">
                <label>18</label>
                <mixed-citation publication-type="journal"><name><surname>Keeling</surname><given-names>MJ</given-names></name>, <name><surname>Rohani</surname><given-names>P</given-names></name>. <article-title>Estimating spatial coupling in epidemiological systems: a mechanistic approach</article-title>. <source>Ecology Letters</source>. <year>2002</year>;<volume>5</volume>(<issue>1</issue>):<fpage>20</fpage>–<lpage>29</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1046/j.1461-0248.2002.00268.x</pub-id></mixed-citation>
              </ref>
              <ref id="pone.0257958.ref019">
                <label>19</label>
                <mixed-citation publication-type="other">World Health Organization, Press briefing, March 20th 2020;. Available from: <ext-link xlink:href="https://www.who.int/docs/default-source/coronaviruse/transcripts/who-audio-emergencies-coronavirus-press-conference-full-20mar2020.pdf?sfvrsn=1eafbff_0" ext-link-type="uri">https://www.who.int/docs/default-source/coronaviruse/transcripts/who-audio-emergencies-coronavirus-press-conference-full-20mar2020.pdf?sfvrsn=1eafbff_0</ext-link>.</mixed-citation>
              </ref>
              <ref id="pone.0257958.ref020">
                <label>20</label>
                <mixed-citation publication-type="journal"><name><surname>McLean</surname><given-names>AR</given-names></name>, <name><surname>Blower</surname><given-names>SM</given-names></name>. <article-title>Imperfect vaccines and herd immunity to HIV</article-title>. <source>Proceedings of the Royal Society of London Series B: Biological Sciences</source>. <year>1993</year>;<volume>253</volume>(<issue>1336</issue>):<fpage>9</fpage>–<lpage>13</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1098/rspb.1993.0075</pub-id>
<?supplied-pmid 8396781?><pub-id pub-id-type="pmid">8396781</pub-id></mixed-citation>
              </ref>
              <ref id="pone.0257958.ref021">
                <label>21</label>
                <mixed-citation publication-type="journal"><name><surname>Agur</surname><given-names>Z</given-names></name>, <name><surname>Cojocaru</surname><given-names>L</given-names></name>, <name><surname>Mazor</surname><given-names>G</given-names></name>, <name><surname>Anderson</surname><given-names>RM</given-names></name>, <name><surname>Danon</surname><given-names>YL</given-names></name>. <article-title>Pulse mass measles vaccination across age cohorts</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>1993</year>;<volume>90</volume>(<issue>24</issue>):<fpage>11698</fpage>–<lpage>11702</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.90.24.11698</pub-id>
<?supplied-pmid 8265611?><pub-id pub-id-type="pmid">8265611</pub-id></mixed-citation>
              </ref>
              <ref id="pone.0257958.ref022">
                <label>22</label>
                <mixed-citation publication-type="journal"><name><surname>Keeling</surname><given-names>MJ</given-names></name>, <name><surname>Woolhouse</surname><given-names>MEJ</given-names></name>, <name><surname>Shaw</surname><given-names>DJ</given-names></name>, <name><surname>Matthews</surname><given-names>L</given-names></name>, <name><surname>Chase-Topping</surname><given-names>M</given-names></name>, <name><surname>Haydon</surname><given-names>DT</given-names></name>, <etal>et al</etal>. <article-title>Dynamics of the 2001 UK Foot and Mouth Epidemic: Stochastic Dispersal in a Heterogeneous Landscape</article-title>. <source>Science</source>. <year>2001</year>;<volume>294</volume>(<issue>5543</issue>):<fpage>813</fpage>–<lpage>817</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/science.1065973</pub-id>
<?supplied-pmid 11679661?><pub-id pub-id-type="pmid">11679661</pub-id></mixed-citation>
              </ref>
              <ref id="pone.0257958.ref023">
                <label>23</label>
                <mixed-citation publication-type="other">Boyd S, Xiao L, Mutapcic A. Subgradient methods. lecture notes of EE392o, Stanford University, Autumn Quarter. 2004;.</mixed-citation>
              </ref>
              <ref id="pone.0257958.ref024">
                <label>24</label>
                <mixed-citation publication-type="other">Duchi J. EE364b: Lecture Slides and Notes. <monospace>https://webstanfordedu/class/ee364b/lectureshtml</monospace>. 2018;.</mixed-citation>
              </ref>
              <ref id="pone.0257958.ref025">
                <label>25</label>
                <mixed-citation publication-type="book"><name><surname>Cristianini</surname><given-names>N</given-names></name>, <name><surname>Shawe-Taylor</surname><given-names>J</given-names></name>. <source>An Introduction to Support Vector Machines and Other Kernel-based Learning Methods</source>. <publisher-name>Cambridge University Press</publisher-name>; <year>2000</year>.</mixed-citation>
              </ref>
              <ref id="pone.0257958.ref026">
                <label>26</label>
                <mixed-citation publication-type="journal"><name><surname>Keller</surname><given-names>JP</given-names></name>, <name><surname>Gerardo-Giorda</surname><given-names>L</given-names></name>, <name><surname>Veneziani</surname><given-names>A</given-names></name>. <article-title>Numerical simulation of a susceptible-exposed-infectious space-continuous model for the spread of rabies in raccoons across a realistic landscape</article-title>. <source>Journal of biological dynamics</source>. <year>2013</year>;<volume>7</volume><issue>Suppl 1</issue>:<fpage>31</fpage>–<lpage>46</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1080/17513758.2012.742578</pub-id>
<?supplied-pmid 23157180?><pub-id pub-id-type="pmid">23157180</pub-id></mixed-citation>
              </ref>
              <ref id="pone.0257958.ref027">
                <label>27</label>
                <mixed-citation publication-type="other">Kingma DP, Ba J. Adam: A Method for Stochastic Optimization. In: Bengio Y, LeCun Y, editors. 3rd International Conference on Learning Representations, ICLR 2015, San Diego, CA, USA, May 7-9, 2015, Conference Track Proceedings; 2015.Available from: <ext-link xlink:href="http://arxiv.org/abs/1412.6980" ext-link-type="uri">http://arxiv.org/abs/1412.6980</ext-link>.</mixed-citation>
              </ref>
              <ref id="pone.0257958.ref028">
                <label>28</label>
                <mixed-citation publication-type="other">Cook SA. The Complexity of Theorem-Proving Procedures. In: Proceedings of the Third Annual ACM Symposium on Theory of Computing. STOC’71. New York, NY, USA: Association for Computing Machinery; 1971. p. 151–158. Available from: <pub-id pub-id-type="doi">10.1145/800157.805047</pub-id>.</mixed-citation>
              </ref>
              <ref id="pone.0257958.ref029">
                <label>29</label>
                <mixed-citation publication-type="other">et al F. Report 9: Impact of non-pharmaceutical interventions (NPIs) to reduce COVID-19 mortality and healthcare demand. Imperial College. 2020;.</mixed-citation>
              </ref>
              <ref id="pone.0257958.ref030">
                <label>30</label>
                <mixed-citation publication-type="journal"><name><surname>Kissler</surname><given-names>SM</given-names></name>, <name><surname>Tedijanto</surname><given-names>C</given-names></name>, <name><surname>Goldstein</surname><given-names>E</given-names></name>, <name><surname>Grad</surname><given-names>YH</given-names></name>, <name><surname>Lipsitch</surname><given-names>M</given-names></name>. <article-title>Projecting the transmission dynamics of SARS-CoV-2 through the postpandemic period</article-title>. <source>Science</source>. <year>2020</year>;<volume>368</volume>(<issue>6493</issue>):<fpage>860</fpage>–<lpage>868</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/science.abb5793</pub-id>
<?supplied-pmid 32291278?><pub-id pub-id-type="pmid">32291278</pub-id></mixed-citation>
              </ref>
              <ref id="pone.0257958.ref031">
                <label>31</label>
                <mixed-citation publication-type="other">Katella K. Comparing the COVID-19 Vaccines: How Are They Different?; 2021. Available from: <ext-link xlink:href="https://www.yalemedicine.org/news/covid-19-vaccine-comparison" ext-link-type="uri">https://www.yalemedicine.org/news/covid-19-vaccine-comparison</ext-link>.</mixed-citation>
              </ref>
              <ref id="pone.0257958.ref032">
                <label>32</label>
                <mixed-citation publication-type="journal"><name><surname>Hochreiter</surname><given-names>S</given-names></name>, <name><surname>Schmidhuber</surname><given-names>J</given-names></name>. <article-title>Long Short-term Memory</article-title>. <source>Neural computation</source>. <year>1997</year>;<volume>9</volume>:<fpage>1735</fpage>–<lpage>80</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1162/neco.1997.9.8.1735</pub-id>
<?supplied-pmid 9377276?><pub-id pub-id-type="pmid">9377276</pub-id></mixed-citation>
              </ref>
              <ref id="pone.0257958.ref033">
                <label>33</label>
                <mixed-citation publication-type="other">Numerical Methods for Ordinary Differential Equations. John Wiley &amp; Sons, Ltd; 2016. Available from: <ext-link xlink:href="https://onlinelibrary.wiley.com/doi/abs/10.1002/9781119121534.fmatter" ext-link-type="uri">https://onlinelibrary.wiley.com/doi/abs/10.1002/9781119121534.fmatter</ext-link>.</mixed-citation>
              </ref>
              <ref id="pone.0257958.ref034">
                <label>34</label>
                <mixed-citation publication-type="book"><name><surname>Logan</surname><given-names>DL</given-names></name>. <source>A First Course in the Finite Element Method Using Algor</source>. <edition designator="2">2nd ed</edition>. <publisher-loc>USA</publisher-loc>: <publisher-name>Brooks/Cole Publishing Co</publisher-name>.; <year>2000</year>.</mixed-citation>
              </ref>
            </ref-list>
          </back>
        </article>
      </metadata>
    </record>
  </GetRecord>
</OAI-PMH>
