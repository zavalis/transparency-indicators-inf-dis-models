<?xml version="1.0" encoding="UTF-8"?>
<OAI-PMH xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.openarchives.org/OAI/2.0/ http://www.openarchives.org/OAI/2.0/OAI-PMH.xsd">
  <responseDate>2022-03-11T00:55:04Z</responseDate>
  <request verb="GetRecord" identifier="oai:pubmedcentral.nih.gov:8062106" metadataPrefix="pmc">https:/www.ncbi.nlm.nih.gov/pmc/oai/oai.cgi</request>
  <GetRecord>
    <record>
      <header>
        <identifier>oai:pubmedcentral.nih.gov:8062106</identifier>
        <datestamp>2021-05-04</datestamp>
        <setSpec>plosone</setSpec>
        <setSpec>pmc-open</setSpec>
      </header>
      <metadata>
        <article xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xsi:schemaLocation="https://jats.nlm.nih.gov/ns/archiving/1.3/ https://jats.nlm.nih.gov/archiving/1.3/xsd/JATS-archivearticle1-3.xsd" article-type="research-article">
          <front>
            <journal-meta>
              <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
              <journal-id journal-id-type="iso-abbrev">PLoS One</journal-id>
              <journal-id journal-id-type="publisher-id">plos</journal-id>
              <journal-id journal-id-type="pmc">plosone</journal-id>
              <journal-title-group>
                <journal-title>PLoS ONE</journal-title>
              </journal-title-group>
              <issn pub-type="epub">1932-6203</issn>
              <publisher>
                <publisher-name>Public Library of Science</publisher-name>
                <publisher-loc>San Francisco, CA USA</publisher-loc>
              </publisher>
            </journal-meta>
            <article-meta>
              <article-id pub-id-type="accession">PMC8062106</article-id>
              <article-id pub-id-type="pmcid">PMC8062106</article-id>
              <article-id pub-id-type="pmc-uid">8062106</article-id>
              <article-id pub-id-type="pmid">33886669</article-id>
              <article-id pub-id-type="publisher-id">PONE-D-20-20268</article-id>
              <article-id pub-id-type="doi">10.1371/journal.pone.0250417</article-id>
              <article-categories>
                <subj-group subj-group-type="heading">
                  <subject>Research Article</subject>
                </subj-group>
                <subj-group subj-group-type="Discipline-v3">
                  <subject>Medicine and Health Sciences</subject>
                  <subj-group>
                    <subject>Medical Conditions</subject>
                    <subj-group>
                      <subject>Infectious Diseases</subject>
                      <subj-group>
                        <subject>Viral Diseases</subject>
                        <subj-group>
                          <subject>Influenza</subject>
                        </subj-group>
                      </subj-group>
                    </subj-group>
                  </subj-group>
                </subj-group>
                <subj-group subj-group-type="Discipline-v3">
                  <subject>Earth Sciences</subject>
                  <subj-group>
                    <subject>Geography</subject>
                    <subj-group>
                      <subject>Human Geography</subject>
                      <subj-group>
                        <subject>Human Mobility</subject>
                      </subj-group>
                    </subj-group>
                  </subj-group>
                </subj-group>
                <subj-group subj-group-type="Discipline-v3">
                  <subject>Social Sciences</subject>
                  <subj-group>
                    <subject>Human Geography</subject>
                    <subj-group>
                      <subject>Human Mobility</subject>
                    </subj-group>
                  </subj-group>
                </subj-group>
                <subj-group subj-group-type="Discipline-v3">
                  <subject>Research and Analysis Methods</subject>
                  <subj-group>
                    <subject>Mathematical and Statistical Techniques</subject>
                    <subj-group>
                      <subject>Statistical Methods</subject>
                      <subj-group>
                        <subject>Forecasting</subject>
                      </subj-group>
                    </subj-group>
                  </subj-group>
                </subj-group>
                <subj-group subj-group-type="Discipline-v3">
                  <subject>Physical Sciences</subject>
                  <subj-group>
                    <subject>Mathematics</subject>
                    <subj-group>
                      <subject>Statistics</subject>
                      <subj-group>
                        <subject>Statistical Methods</subject>
                        <subj-group>
                          <subject>Forecasting</subject>
                        </subj-group>
                      </subj-group>
                    </subj-group>
                  </subj-group>
                </subj-group>
                <subj-group subj-group-type="Discipline-v3">
                  <subject>Earth Sciences</subject>
                  <subj-group>
                    <subject>Geography</subject>
                  </subj-group>
                </subj-group>
                <subj-group subj-group-type="Discipline-v3">
                  <subject>Medicine and Health Sciences</subject>
                  <subj-group>
                    <subject>Public and Occupational Health</subject>
                  </subj-group>
                </subj-group>
                <subj-group subj-group-type="Discipline-v3">
                  <subject>Medicine and Health Sciences</subject>
                  <subj-group>
                    <subject>Medical Conditions</subject>
                    <subj-group>
                      <subject>Infectious Diseases</subject>
                    </subj-group>
                  </subj-group>
                </subj-group>
                <subj-group subj-group-type="Discipline-v3">
                  <subject>Computer and Information Sciences</subject>
                  <subj-group>
                    <subject>Neural Networks</subject>
                  </subj-group>
                </subj-group>
                <subj-group subj-group-type="Discipline-v3">
                  <subject>Biology and Life Sciences</subject>
                  <subj-group>
                    <subject>Neuroscience</subject>
                    <subj-group>
                      <subject>Neural Networks</subject>
                    </subj-group>
                  </subj-group>
                </subj-group>
                <subj-group subj-group-type="Discipline-v3">
                  <subject>People and Places</subject>
                  <subj-group>
                    <subject>Geographical Locations</subject>
                    <subj-group>
                      <subject>Asia</subject>
                      <subj-group>
                        <subject>Japan</subject>
                      </subj-group>
                    </subj-group>
                  </subj-group>
                </subj-group>
              </article-categories>
              <title-group>
                <article-title>Predicting regional influenza epidemics with uncertainty estimation using commuting data in Japan</article-title>
                <alt-title alt-title-type="running-head">Predicting regional influenza epidemics with uncertainty estimation using commuting data in Japan</alt-title>
              </title-group>
              <contrib-group>
                <contrib contrib-type="author">
                  <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-1148-711X</contrib-id>
                  <name>
                    <surname>Murayama</surname>
                    <given-names>Taichi</given-names>
                  </name>
                  <role content-type="https://casrai.org/credit/">Conceptualization</role>
                  <role content-type="https://casrai.org/credit/">Writing – original draft</role>
                  <xref ref-type="aff" rid="aff001">
                    <sup>1</sup>
                  </xref>
                  <xref ref-type="corresp" rid="cor001">*</xref>
                </contrib>
                <contrib contrib-type="author">
                  <name>
                    <surname>Shimizu</surname>
                    <given-names>Nobuyuki</given-names>
                  </name>
                  <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
                  <xref ref-type="aff" rid="aff002">
                    <sup>2</sup>
                  </xref>
                </contrib>
                <contrib contrib-type="author">
                  <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1282-386X</contrib-id>
                  <name>
                    <surname>Fujita</surname>
                    <given-names>Sumio</given-names>
                  </name>
                  <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
                  <xref ref-type="aff" rid="aff002">
                    <sup>2</sup>
                  </xref>
                </contrib>
                <contrib contrib-type="author">
                  <name>
                    <surname>Wakamiya</surname>
                    <given-names>Shoko</given-names>
                  </name>
                  <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
                  <xref ref-type="aff" rid="aff001">
                    <sup>1</sup>
                  </xref>
                </contrib>
                <contrib contrib-type="author">
                  <name>
                    <surname>Aramaki</surname>
                    <given-names>Eiji</given-names>
                  </name>
                  <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
                  <xref ref-type="aff" rid="aff001">
                    <sup>1</sup>
                  </xref>
                </contrib>
              </contrib-group>
              <aff id="aff001">
                <label>1</label>
                <addr-line>Nara Institute of Science and Technology (NAIST), Ikoma, Japan</addr-line>
              </aff>
              <aff id="aff002">
                <label>2</label>
                <addr-line>Yahoo Japan Corporation, Tokyo, Japan</addr-line>
              </aff>
              <contrib-group>
                <contrib contrib-type="editor">
                  <name>
                    <surname>Wen</surname>
                    <given-names>Tzai-Hung</given-names>
                  </name>
                  <role>Editor</role>
                  <xref ref-type="aff" rid="edit1"/>
                </contrib>
              </contrib-group>
              <aff id="edit1">
                <addr-line>National Taiwan University, TAIWAN</addr-line>
              </aff>
              <author-notes>
                <fn fn-type="COI-statement" id="coi001">
                  <p><bold>Competing Interests: </bold>The authors have declared that funding from a commercial source, Yahoo Japan Corporation, does not alter our adherence to PLOS ONE policies on sharing data and materials.</p>
                </fn>
                <corresp id="cor001">* E-mail: <email>murayama.taichi.mk1@is.naist.jp</email></corresp>
              </author-notes>
              <pub-date pub-type="collection">
                <year>2021</year>
              </pub-date>
              <pub-date pub-type="epub">
                <day>22</day>
                <month>4</month>
                <year>2021</year>
              </pub-date>
              <volume>16</volume>
              <issue>4</issue>
              <elocation-id>e0250417</elocation-id>
              <history>
                <date date-type="received">
                  <day>1</day>
                  <month>7</month>
                  <year>2020</year>
                </date>
                <date date-type="accepted">
                  <day>6</day>
                  <month>4</month>
                  <year>2021</year>
                </date>
              </history>
              <permissions>
                <copyright-statement>© 2021 Murayama et al</copyright-statement>
                <copyright-year>2021</copyright-year>
                <copyright-holder>Murayama et al</copyright-holder>
                <license>
                  <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
                  <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
                </license>
              </permissions>
              <self-uri content-type="pdf" xlink:href="pone.0250417.pdf"/>
              <abstract>
                <p>Obtaining an accurate prediction of the number of influenza patients in specific areas is a crucial task undertaken by medical institutions. Infections (such as influenza) spread from person to person, and people are rarely confined to a single area. Therefore, creating a regional influenza prediction model should consider the flow of people between different areas. Although various regional flu prediction models have previously been proposed, they do not consider the flow of people among areas. In this study, we propose a method that can predict the geographical distribution of influenza patients using commuting data to represent the flow of people. To elucidate the complex spatial dependence relations, our model uses an extension of the graph convolutional network (GCN). Additionally, a prediction interval for medical institutions is proposed, which is suitable for cyclic time series. Subsequently, we used the weekly data of flu patients from health authorities as the ground-truth to evaluate the prediction interval and performance of influenza patient prediction in each prefecture in Japan. The results indicate that our GCN-based model, which used commuting data, considerably improved the predictive accuracy over baseline values both temporally and spatially to provide an appropriate prediction interval. The proposed model is vital in practical settings, such as in the decision making of public health authorities and addressing growth in vaccine demand and workload. This paper primarily presents a GCN as a useful means for predicting the spread of an epidemic.</p>
              </abstract>
              <funding-group>
                <award-group id="award001">
                  <funding-source>
                    <institution>Yahoo Japan Corporation</institution>
                  </funding-source>
                  <principal-award-recipient>
                    <name>
                      <surname>Aramaki</surname>
                      <given-names>Eiji</given-names>
                    </name>
                  </principal-award-recipient>
                </award-group>
                <funding-statement>This study was supported in part by Yahoo Japan Corporation. The funder provided support in the form of salaries for Dr. Nobuyuki Shimizu and Mr. Sumio Fujita, but did not have any additional role in the study design, data collection and analysis, decision to publish, or preparation of the manuscript. The specific roles of these authors are stated in the ‘author contributions’ section.</funding-statement>
              </funding-group>
              <counts>
                <fig-count count="6"/>
                <table-count count="4"/>
                <page-count count="21"/>
              </counts>
              <custom-meta-group>
                <custom-meta id="data-availability">
                  <meta-name>Data Availability</meta-name>
                  <meta-value>All Japan influenza surveillance reports are available from the NIID (<ext-link ext-link-type="uri" xlink:href="https://www.niid.go.jp/niid/ja/idwr.html">https://www.niid.go.jp/niid/ja/idwr.html</ext-link>) and can be accessed following the protocol outlined in the Methods section.</meta-value>
                </custom-meta>
              </custom-meta-group>
            </article-meta>
            <notes>
              <title>Data Availability</title>
              <p>All Japan influenza surveillance reports are available from the NIID (<ext-link ext-link-type="uri" xlink:href="https://www.niid.go.jp/niid/ja/idwr.html">https://www.niid.go.jp/niid/ja/idwr.html</ext-link>) and can be accessed following the protocol outlined in the Methods section.</p>
            </notes>
          </front>
          <body>
            <sec sec-type="intro" id="sec001">
              <title>Introduction</title>
              <p>Predicting infectious diseases is a critical task for public health authorities and industry stakeholders worldwide. Influenza (or simply flu) epidemics, representing a class of severe infectious diseases, are characterized by the widespread incidence of various symptoms, such as the sudden onset of fever, coughs, and headaches. The World Health Organization (WHO) reports that every year, 3–5 million cases of severe illness occur worldwide due to influenza, leading to 290,000–650,000 deaths annually [<xref rid="pone.0250417.ref001" ref-type="bibr">1</xref>]. Influenza also reduces economic productivity because of employee absenteeism and sudden increase in hospital workload [<xref rid="pone.0250417.ref002" ref-type="bibr">2</xref>]. Such instances have motivated public health authorities to predict the consequences of influenza in different countries.</p>
              <p>Existing influenza prediction systems must be improved to make better decisions regarding public health. First, the influenza volume should be predicted over small regions, rather than over entire countries. Second, the reliability of prediction results should be investigated. Regional influenza predictions must consider the characteristics of infectious diseases, which are mainly spread through direct contact with infected persons (contact infection) or the sneezing and coughing of infected persons, which can lead to the spread of infectious droplets in the air (droplet infection) [<xref rid="pone.0250417.ref003" ref-type="bibr">3</xref>, <xref rid="pone.0250417.ref004" ref-type="bibr">4</xref>]. Thus, influenza tends to spread from one area to the surrounding areas through direct contact with infected persons. According to previous research, such a regional infection spreading pattern can be better modeled by considering the flow of people between regions, rather than considering spatially-adjacent relations [<xref rid="pone.0250417.ref005" ref-type="bibr">5</xref>–<xref rid="pone.0250417.ref007" ref-type="bibr">7</xref>]. Additionally, public health organizations must comprehend the degree of prediction confidence. This will stimulate a flexible response to various problems triggered by influenza epidemics.</p>
              <p>This study aimed to develop a regional flu prediction model that incorporates the geographical flow of people and uncertainty estimation for a cyclic time series. To achieve this, we used commuting data to model the flow of people into a region from other regions. In particular, inter-regional commuting information, as shown in <xref ref-type="fig" rid="pone.0250417.g001">Fig 1(b)</xref>, was used instead of regional adjacency data (AD), as shown in <xref ref-type="fig" rid="pone.0250417.g001">Fig 1(a)</xref>. We incorporated influenza data and commuting data into a traffic simulation model to assess the spread of infection caused by the flow of people based on geographical relations. This study extended the use of graph convolutional neural networks (GCNs) to capture latent geographical relations using graph representation, where each node of the graph is a target region for influenza prediction, and each edge represents the commuting flow of people. GCNs capture spatial dependencies and can be easily combined with other neural models to improve prediction. It is important to show that a GCN can effectively predict the geographical distribution of influenza. We aimed to construct an infectious disease prediction system for each region.</p>
              <fig id="pone.0250417.g001" orientation="portrait" position="float">
                <object-id pub-id-type="doi">10.1371/journal.pone.0250417.g001</object-id>
                <label>Fig 1</label>
                <caption>
                  <p>(a) Adjacency matrix, which is undirected with no weights, has been used so far. (b) Weighted directed matrix, originating from commuting data, includes weights and directions to assess infectious disease characteristics.</p>
                </caption>
                <graphic xlink:href="pone.0250417.g001"/>
              </fig>
              <p>Furthermore, we estimated the suitable uncertainty of our model’s prediction using a prediction interval. This is important for decision making in terms of public health regarding factors such as vaccine demand and medical personnel allocation. Our spatiotemporal model is based on neural networks that are adopted by some epidemic prediction studies [<xref rid="pone.0250417.ref006" ref-type="bibr">6</xref>, <xref rid="pone.0250417.ref008" ref-type="bibr">8</xref>]. However, it is difficult to estimate the prediction interval for the downside or upside of prediction points because neural networks conduct point estimation. Therefore, owing to the unknown reliability of prediction results, it becomes difficult for public health authorities to take certain decisions. To resolve such difficulties, Zhu et al. [<xref rid="pone.0250417.ref009" ref-type="bibr">9</xref>] presented an encoder–decoder method with an inference of prediction intervals by calculating three sources of prediction uncertainties, i.e., model uncertainty, inherent noise, and model misspecification, using Monte Carlo (MC) dropout, which was derived from the property of dropout-approximate Bayesian inference. This method appends an inference module to a trained model, without re-training it, to estimate the prediction uncertainties of the model. However, Zhu et al.’s method tends to favor a prediction interval that is much larger than adequate for non-epidemic periods (mainly in summer). This is due to the lack of consideration of the one-year periodicity in the time series of flu data, which exhibit strong seasonality (i.e., epidemic in winter and non-epidemic in summer). In brief, Zhu et al.’s method is not suitable for a time series with periodicity, such as flu data. Therefore, we extended their method to estimate a suitable prediction interval for one-year cyclic trends in time series and evaluated the effectiveness of the extended method.</p>
              <p>The main contributions of this study can be summarized as follows:</p>
              <list list-type="order">
                <list-item>
                  <p>We demonstrate that modeling the flow of people as spatial information is useful for regional flu prediction. Our spatiotemporal model aims to provide better predictions than baseline models.</p>
                </list-item>
                <list-item>
                  <p>We introduce an uncertainty estimation method for cyclic time series with real-life applications (such as the prediction of infectious diseases).</p>
                </list-item>
              </list>
              <p>The proposed model with uncertainty estimation has important applications, including decision support for regional public health authorities in terms of vaccines and workload.</p>
            </sec>
            <sec id="sec002">
              <title>Related work</title>
              <sec id="sec003">
                <title>Influenza prediction</title>
                <p>Influenza prediction methods can be broadly classified into three categories: compartmental model-based, statistical and time series, and machine learning. Compartmental models include the “susceptible–infected–removed” (SIR) [<xref rid="pone.0250417.ref010" ref-type="bibr">10</xref>] and incidence decay with exponential adjustment [<xref rid="pone.0250417.ref011" ref-type="bibr">11</xref>] models. They differ from statistical and machine-learning methods as they set suitable parameters for each compartment and focus on understanding disease dynamics. Statistical and time series methods include the autoregression-integrated moving average [<xref rid="pone.0250417.ref012" ref-type="bibr">12</xref>] and generalized autoregressive moving average [<xref rid="pone.0250417.ref013" ref-type="bibr">13</xref>] methods. In particular, the autoregression with Google search (ARGO) method [<xref rid="pone.0250417.ref014" ref-type="bibr">14</xref>], which is based on linear regression using the input data of the Google search time series and historical influenza-like illness data, has exhibited superior results for flu forecasting [<xref rid="pone.0250417.ref015" ref-type="bibr">15</xref>–<xref rid="pone.0250417.ref017" ref-type="bibr">17</xref>]. Our GCN-based model is based on machine learning. Other examples of machine-learning methods include linear regression [<xref rid="pone.0250417.ref018" ref-type="bibr">18</xref>, <xref rid="pone.0250417.ref019" ref-type="bibr">19</xref>], random forest [<xref rid="pone.0250417.ref020" ref-type="bibr">20</xref>], Gaussian process [<xref rid="pone.0250417.ref021" ref-type="bibr">21</xref>], and long short-term memory (LSTM) [<xref rid="pone.0250417.ref007" ref-type="bibr">7</xref>, <xref rid="pone.0250417.ref008" ref-type="bibr">8</xref>, <xref rid="pone.0250417.ref022" ref-type="bibr">22</xref>].</p>
                <p>Resource selection for the prediction method is also an important factor in influenza prediction. Many studies have relied on user-generated content (UGC) from internet services, such as search services [<xref rid="pone.0250417.ref012" ref-type="bibr">12</xref>, <xref rid="pone.0250417.ref014" ref-type="bibr">14</xref>, <xref rid="pone.0250417.ref023" ref-type="bibr">23</xref>, <xref rid="pone.0250417.ref024" ref-type="bibr">24</xref>] and social networking services [<xref rid="pone.0250417.ref025" ref-type="bibr">25</xref>–<xref rid="pone.0250417.ref027" ref-type="bibr">27</xref>]. Infectious disease surveillance conducted with online content, such as that described above, is generally described as infoveillance [<xref rid="pone.0250417.ref028" ref-type="bibr">28</xref>]. Currently, Google Flu Trends [<xref rid="pone.0250417.ref024" ref-type="bibr">24</xref>] is one of the most representative systems, which is designed to estimate the current influenza-like illness rate using related Google search terms. Signorini et al. [<xref rid="pone.0250417.ref029" ref-type="bibr">29</xref>] examined Twitter streams for the volume of tweets including keywords related to influenza and demonstrated the usefulness of Twitter data for tracking flu epidemics. In addition to user-generated content, many studies have used diverse resources to improve their models, such as Wikipedia [<xref rid="pone.0250417.ref030" ref-type="bibr">30</xref>], historical flu data [<xref rid="pone.0250417.ref014" ref-type="bibr">14</xref>, <xref rid="pone.0250417.ref031" ref-type="bibr">31</xref>–<xref rid="pone.0250417.ref033" ref-type="bibr">33</xref>], and weather data [<xref rid="pone.0250417.ref034" ref-type="bibr">34</xref>]. Our model used historical flu data as a resource.</p>
                <p>Moreover, our research on influenza prediction for each prefecture is related to the following studies. Senanayake et al. [<xref rid="pone.0250417.ref005" ref-type="bibr">5</xref>] used a kernel function based on the distance between two areas to capture spatial dependence. Wu et al. [<xref rid="pone.0250417.ref006" ref-type="bibr">6</xref>] used a convolutional neural network (CNN) architecture to convolve the information of surrounding areas. Liu et al. [<xref rid="pone.0250417.ref035" ref-type="bibr">35</xref>] used a geographically weighted regression model, which extended the ordinary linear regression model and embedded geographical location data into the regression parameters, with geographical information about hospitals, such as the number of hospitals per 10,000 population, to predict the COVID-19 situation in China. In contrast to the abovementioned studies, our study used regional commuting data to model the flow of people into a specific area. Brockmann et al. [<xref rid="pone.0250417.ref036" ref-type="bibr">36</xref>] attempted to capture the onset of an epidemic using data on international traffic. Wang et al. [<xref rid="pone.0250417.ref037" ref-type="bibr">37</xref>] extended the classic SIR model to consider the visitor transmission between any two areas to predict intra-city epidemic propagation using the traffic volumes in cities. To the best of our knowledge, our study is the first attempt to predict influenza volume in detail for a large area, i.e., the entire territory of Japan, by considering the inter-regional flow of people using machine learning.</p>
              </sec>
              <sec id="sec004">
                <title>Spatiotemporal model</title>
                <p>Spatiotemporal models have a long history [<xref rid="pone.0250417.ref038" ref-type="bibr">38</xref>] as below. Dynamical state-space models, where the current state is conditioned in the past, have also been explored [<xref rid="pone.0250417.ref039" ref-type="bibr">39</xref>]. The use of tensor methods to analyze epidemic data [<xref rid="pone.0250417.ref040" ref-type="bibr">40</xref>] and models that detect the movement of a person in a video using conditional random fields [<xref rid="pone.0250417.ref041" ref-type="bibr">41</xref>] are examples of spatiotemporal models. Recently, GCNs [<xref rid="pone.0250417.ref042" ref-type="bibr">42</xref>], which convolve the graph architecture, were used for text classification [<xref rid="pone.0250417.ref043" ref-type="bibr">43</xref>], image analysis [<xref rid="pone.0250417.ref044" ref-type="bibr">44</xref>], and molecular structure analysis [<xref rid="pone.0250417.ref045" ref-type="bibr">45</xref>]. Additionally, GCN models can present regional relations as graphs and capture time dependence. Previously, GCNs were studied for traffic prediction problems, such as bicycle flow [<xref rid="pone.0250417.ref046" ref-type="bibr">46</xref>] and traffic volume [<xref rid="pone.0250417.ref047" ref-type="bibr">47</xref>].</p>
              </sec>
              <sec id="sec005">
                <title>Bayesian neural networks</title>
                <p>Bayesian neural networks (BNNs) are derived from Bayesian methods and can incorporate uncertainty in deep learning models. The method described by Zhu et al. [<xref rid="pone.0250417.ref009" ref-type="bibr">9</xref>], which is the base model for our prediction interval estimation, is related to BNNs. A BNN aims to determine the posterior distribution of network parameters rather than conduct point estimation. However, it is difficult to calculate the posterior inference of deep learning models because of their complex nonlinearity and non-conjugacy characteristics. Several approximate inference methods have been proposed to address this difficulty, such as probabilistic backpropagation [<xref rid="pone.0250417.ref048" ref-type="bibr">48</xref>] and stochastic search [<xref rid="pone.0250417.ref049" ref-type="bibr">49</xref>]. Zhu’s method is based on the MC dropout proposed in [<xref rid="pone.0250417.ref050" ref-type="bibr">50</xref>]. An important feature of MC dropout is that it can be easily applied to neural networks because it performs stochastic dropouts after passing through each learned hidden layer; further, it generates a posterior predictive distribution.</p>
              </sec>
            </sec>
            <sec sec-type="materials|methods" id="sec006">
              <title>Materials and methods</title>
              <p>This section describes the proposed model. We propose a spatiotemporal model inspired by [<xref rid="pone.0250417.ref009" ref-type="bibr">9</xref>, <xref rid="pone.0250417.ref051" ref-type="bibr">51</xref>] that incorporates the geographical flow of people. Moreover, the model incorporates an estimation method for influenza prediction that is suitable for a year-long cyclic time series. Our model consists of two parts: influenza prediction and uncertainty (prediction interval) estimation. <xref ref-type="fig" rid="pone.0250417.g002">Fig 2</xref> illustrates an overview of the proposed model.</p>
              <fig id="pone.0250417.g002" orientation="portrait" position="float">
                <object-id pub-id-type="doi">10.1371/journal.pone.0250417.g002</object-id>
                <label>Fig 2</label>
                <caption>
                  <title>Overview of our model.</title>
                  <p>The model includes sequence-to-sequence combinations of a diffusion GCN and gated recurrent unit (GRU) with uncertainty estimation. We feed the historical time series of patient numbers into the encoder. Next, we use its final states to initialize the decoder. The decoder generates a prediction from previous ground-truths or the values predicted by the model using scheduled sampling. Additionally, our model applies the predicted values to our uncertainty estimation method and then outputs the prediction interval.</p>
                </caption>
                <graphic xlink:href="pone.0250417.g002"/>
              </fig>
              <sec id="sec007">
                <title>Influenza prediction</title>
                <p>The influenza prediction part of the model is composed of two combined modules: a GCN and a sequence-to-sequence architecture. The GCN extracts the features of various spatial relationships between observation points and captures spatial dependencies. The GCN can be easily combined with other neural networks, such as a recurrent neural network (RNN), which is useful in predicting infectious diseases [<xref rid="pone.0250417.ref022" ref-type="bibr">22</xref>]. The GCN can be used for feature extraction related to graph nodes. Overall, the GCN can achieve high accuracy in predicting infectious diseases. Based on the above reasons, we selected a GCN to capture spatial dependencies. Our model also employs a sequence-to-sequence architecture, which is useful for producing forecasts more than two weeks in advance. <xref rid="pone.0250417.t001" ref-type="table">Table 1</xref> defines the main notations used to represent the influenza prediction part of our model.</p>
                <table-wrap id="pone.0250417.t001" orientation="portrait" position="float">
                  <object-id pub-id-type="doi">10.1371/journal.pone.0250417.t001</object-id>
                  <label>Table 1</label>
                  <caption>
                    <title>Main notations.</title>
                  </caption>
                  <alternatives>
                    <graphic id="pone.0250417.t001g" xlink:href="pone.0250417.t001"/>
                    <table frame="box" rules="all" border="0">
                      <colgroup span="1">
                        <col align="left" valign="middle" span="1"/>
                        <col align="left" valign="middle" span="1"/>
                      </colgroup>
                      <thead>
                        <tr>
                          <th align="center" style="border-bottom-width:thick" rowspan="1" colspan="1">Notation</th>
                          <th align="left" style="border-bottom-width:thick" rowspan="1" colspan="1">Definition or Description</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td align="center" rowspan="1" colspan="1"><bold>X</bold>(<bold>t</bold>)</td>
                          <td align="left" rowspan="1" colspan="1">epidemiology information at time <italic>t</italic></td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1">
                            <bold>W</bold>
                          </td>
                          <td align="left" rowspan="1" colspan="1">weighted matrix</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1">
                            <bold>D</bold>
                            <sub>
                              <italic>O</italic>
                            </sub>
                          </td>
                          <td align="left" rowspan="1" colspan="1">out-degree diagonal matrix</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1">
                            <bold>D</bold>
                            <sub>
                              <italic>I</italic>
                            </sub>
                          </td>
                          <td align="left" rowspan="1" colspan="1">in-degree diagonal matrix</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1">
                            <bold>Θ</bold>
                          </td>
                          <td align="left" rowspan="1" colspan="1">filter parameter tensor</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1">
                            <bold>O</bold>
                          </td>
                          <td align="left" rowspan="1" colspan="1">output of DGCN</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1"><bold>H<sup>1</sup></bold>,<bold>H<sup>2</sup></bold></td>
                          <td align="left" rowspan="1" colspan="1">output of GRU</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1">
                            <inline-formula id="pone.0250417.e001">
                              <alternatives>
                                <graphic id="pone.0250417.e001g" xlink:href="pone.0250417.e001"/>
                                <mml:math id="M1">
                                  <mml:msup>
                                    <mml:mover accent="true">
                                      <mml:mi mathvariant="bold-italic">X</mml:mi>
                                      <mml:mo>^</mml:mo>
                                    </mml:mover>
                                    <mml:mi>t</mml:mi>
                                  </mml:msup>
                                </mml:math>
                              </alternatives>
                            </inline-formula>
                          </td>
                          <td align="left" rowspan="1" colspan="1">predicted influenza volume at time <italic>t</italic></td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1">
                            <inline-formula id="pone.0250417.e002">
                              <alternatives>
                                <graphic id="pone.0250417.e002g" xlink:href="pone.0250417.e002"/>
                                <mml:math id="M2">
                                  <mml:msub>
                                    <mml:mover accent="true">
                                      <mml:mi>η</mml:mi>
                                      <mml:mo>^</mml:mo>
                                    </mml:mover>
                                    <mml:mi>t</mml:mi>
                                  </mml:msub>
                                </mml:math>
                              </alternatives>
                            </inline-formula>
                          </td>
                          <td align="left" rowspan="1" colspan="1">total prediction uncertainty at time <italic>t</italic></td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1">
                            <italic>I</italic>
                          </td>
                          <td align="left" rowspan="1" colspan="1">number of input features</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1">
                            <italic>N</italic>
                          </td>
                          <td align="left" rowspan="1" colspan="1">number of nodes (regions)</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1">
                            <italic>M</italic>
                          </td>
                          <td align="left" rowspan="1" colspan="1">number of input features for DGCN</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1">
                            <italic>Q</italic>
                          </td>
                          <td align="left" rowspan="1" colspan="1">number of output features for DGCN</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1"><italic>T</italic>′</td>
                          <td align="left" rowspan="1" colspan="1">input length</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1">
                            <italic>T</italic>
                          </td>
                          <td align="left" rowspan="1" colspan="1">output length</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1">
                            <italic>K</italic>
                          </td>
                          <td align="left" rowspan="1" colspan="1">number of diffusion steps</td>
                        </tr>
                      </tbody>
                    </table>
                  </alternatives>
                </table-wrap>
                <sec id="sec008">
                  <title>Task definition</title>
                  <p>The objective of influenza prediction is to predict the number of future influenza patients based on previously observed data and commuting data corresponding to <italic>N</italic> regions in the network. One can use <inline-formula id="pone.0250417.e003"><alternatives><graphic xlink:href="pone.0250417.e003.jpg" id="pone.0250417.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> to represent <italic>M</italic> epidemiology information observed from <italic>N</italic> different signals at time <italic>t</italic>; for example, the number of influenza patients in <italic>t</italic> weeks in <italic>N</italic> regions of Japan. Additionally, we represent the regional network as a weighted directed graph <inline-formula id="pone.0250417.e004"><alternatives><graphic xlink:href="pone.0250417.e004.jpg" id="pone.0250417.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:mrow><mml:mi mathvariant="script">G</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mi mathvariant="script">V</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">E</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pone.0250417.e005"><alternatives><graphic xlink:href="pone.0250417.e005.jpg" id="pone.0250417.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:mi mathvariant="script">V</mml:mi></mml:math></alternatives></inline-formula> is a set of nodes <inline-formula id="pone.0250417.e006"><alternatives><graphic xlink:href="pone.0250417.e006.jpg" id="pone.0250417.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:mrow><mml:mo>|</mml:mo><mml:mi mathvariant="script">V</mml:mi><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pone.0250417.e007"><alternatives><graphic xlink:href="pone.0250417.e007.jpg" id="pone.0250417.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:mi mathvariant="script">E</mml:mi></mml:math></alternatives></inline-formula> is a set of edges, and <inline-formula id="pone.0250417.e008"><alternatives><graphic xlink:href="pone.0250417.e008.jpg" id="pone.0250417.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:mrow><mml:mi mathvariant="bold">W</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">N</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="bold-italic">N</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is a weighted matrix representation, such as the constant commuting volume between regions. The influenza prediction problem aims to learn the function <italic>f</italic>(⋅) that maps <italic>T</italic>′ historical signals and a constant weighted matrix representation of <inline-formula id="pone.0250417.e009"><alternatives><graphic xlink:href="pone.0250417.e009.jpg" id="pone.0250417.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:mi mathvariant="script">G</mml:mi></mml:math></alternatives></inline-formula> to <italic>T</italic> future signals:
<disp-formula id="pone.0250417.e010"><alternatives><graphic xlink:href="pone.0250417.e010.jpg" id="pone.0250417.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:mrow><mml:mo>[</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>;</mml:mo><mml:mi mathvariant="script">G</mml:mi><mml:mo>]</mml:mo><mml:mover><mml:mo>→</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mo>·</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mover><mml:mo>[</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
                </sec>
                <sec id="sec009">
                  <title>Diffusion graph convolutional network</title>
                  <p>We used a diffusion GCN (DGCN), which was originally developed for traffic flow prediction by [<xref rid="pone.0250417.ref051" ref-type="bibr">51</xref>], where we modeled the spatial dependence of the virus spreading by applying a diffusion process, i.e., random walk on a commuting graph. Thus, the temporal dynamics of the infection spread through regions were captured by a stochastic process on the input graph <inline-formula id="pone.0250417.e011"><alternatives><graphic xlink:href="pone.0250417.e011.jpg" id="pone.0250417.e011g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M11"><mml:mi mathvariant="script">G</mml:mi></mml:math></alternatives></inline-formula>. Intuitively, this stochastic process represents the step-by-step “flows of viruses” through regions; one day, a commuter transmits a virus to a region, and the following day, other commuters transmit the virus from this region to other regions with some probability, and so on. The transition matrix of the diffusion process is <inline-formula id="pone.0250417.e012"><alternatives><graphic xlink:href="pone.0250417.e012.jpg" id="pone.0250417.e012g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M12"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, where <bold>D</bold><sub><italic>O</italic></sub> = <italic>diag</italic>(<bold><italic>W</italic> 1</bold>) is the diagonal matrix of the total out-commuters from each region, and <bold>1</bold> denotes the all-ones vector. The stationary distribution of the diffusion process is as follows:
<disp-formula id="pone.0250417.e013"><alternatives><graphic xlink:href="pone.0250417.e013.jpg" id="pone.0250417.e013g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M13"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>∞</mml:mi></mml:munderover><mml:mi>α</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula>
where <italic>k</italic> represents the number of diffusion steps and <italic>α</italic> ∈ [0, 1] represents the restart probability, with which the diffusion process restarts from its initial states [<xref rid="pone.0250417.ref052" ref-type="bibr">52</xref>, <xref rid="pone.0250417.ref053" ref-type="bibr">53</xref>]. The DGCN adopts a graph diffusion convolution using the above-mentioned diffusion process in <xref ref-type="disp-formula" rid="pone.0250417.e013">Eq (1)</xref>
over an input epidemiology signal <bold>X</bold> and a filter <italic>f</italic><sub><bold>θ</bold></sub>, leveraging the flows both leaving and entering each region. The signal information <italic>X</italic>, such as the current number of patients, is transferred from one node to its neighboring nodes with the probabilities given in the transition matrix, and the spread signal distribution can reach the above-mentioned stationary distribution after several steps. However, the DGCN uses only a finite <italic>K</italic>-step truncation of the whole diffusion process for computational efficiency. Thus, it captures the <italic>K</italic>-localized graph structures of <italic>G</italic> as follows:
<disp-formula id="pone.0250417.e014"><alternatives><graphic xlink:href="pone.0250417.e014.jpg" id="pone.0250417.e014g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M14"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mo>:</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">m</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msup><mml:mrow/><mml:mo>⋆</mml:mo></mml:msup><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">f</mml:mi><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mo>(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:mo/><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup><mml:mo>)</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mo>:</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mspace width="1em"/><mml:mi>m</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula>
where <inline-formula id="pone.0250417.e015"><alternatives><graphic xlink:href="pone.0250417.e015.jpg" id="pone.0250417.e015g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M15"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> are the filter parameters, and <inline-formula id="pone.0250417.e016"><alternatives><graphic xlink:href="pone.0250417.e016.jpg" id="pone.0250417.e016g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M16"><mml:mrow><mml:msup><mml:mrow/><mml:mo>⋆</mml:mo></mml:msup><mml:mi mathvariant="script">G</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> denotes a graph convolution operation. Furthermore, <inline-formula id="pone.0250417.e017"><alternatives><graphic xlink:href="pone.0250417.e017.jpg" id="pone.0250417.e017g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M17"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0250417.e018"><alternatives><graphic xlink:href="pone.0250417.e018.jpg" id="pone.0250417.e018g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M18"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> represent the transition matrices of the diffusion and reversed processes, respectively, when considering both flows of people. Our machine learning method uses both directions; it learns different parameters for each transition matrix. These two directions might affect the epidemic situation in regions with different strengths of impact; thus, the input graph must be directed.</p>
                  <p>However, computation of the convolution operation defined in <xref ref-type="disp-formula" rid="pone.0250417.e014">Eq (2)</xref> may be expensive. To localize the filter and reduce the number of parameters, the first part of <xref ref-type="disp-formula" rid="pone.0250417.e014">Eq (2)</xref>, including <inline-formula id="pone.0250417.e019"><alternatives><graphic xlink:href="pone.0250417.e019.jpg" id="pone.0250417.e019g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M19"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, can be rewritten as
<disp-formula id="pone.0250417.e020"><alternatives><graphic xlink:href="pone.0250417.e020.jpg" id="pone.0250417.e020g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M20"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mi>θ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>T</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mo>:</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula></p>
                  <p>As <inline-formula id="pone.0250417.e021"><alternatives><graphic xlink:href="pone.0250417.e021.jpg" id="pone.0250417.e021g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M21"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="bold-italic">W</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0250417.e022"><alternatives><graphic xlink:href="pone.0250417.e022.jpg" id="pone.0250417.e022g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M22"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> are sparse, the computational cost can be reduced by recursively computing <italic>K</italic>-localized convolutions [<xref rid="pone.0250417.ref054" ref-type="bibr">54</xref>].</p>
                  <p>Regarding the convolution operation defined in <xref ref-type="disp-formula" rid="pone.0250417.e014">Eq (2)</xref>, a diffusion convolutional layer maps <italic>M</italic>-dimensional features to <italic>Q</italic>-dimensional outputs, where <italic>Q</italic> is the number of output features. The diffusion convolutional layer is described as
<disp-formula id="pone.0250417.e023"><alternatives><graphic xlink:href="pone.0250417.e023.jpg" id="pone.0250417.e023g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M23"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">O</mml:mi><mml:mrow><mml:mo>:</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="bold">q</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="bold">a</mml:mi><mml:mo>(</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="bold">m</mml:mi><mml:mo>=</mml:mo><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:munderover><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mo>:</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">m</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msup><mml:mrow/><mml:mo>⋆</mml:mo></mml:msup><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:msub><mml:mi mathvariant="bold">f</mml:mi><mml:msub><mml:mo>Θ</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">q</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">m</mml:mi><mml:mo>,</mml:mo><mml:mo>:</mml:mo><mml:mo>,</mml:mo><mml:mo>:</mml:mo></mml:mrow></mml:msub></mml:msub><mml:mo>)</mml:mo><mml:mspace width="1em"/><mml:mi mathvariant="bold">q</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mn mathvariant="bold">1</mml:mn><mml:mo>…</mml:mo><mml:mi mathvariant="bold">Q</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(4)</label></disp-formula>
where <inline-formula id="pone.0250417.e024"><alternatives><graphic xlink:href="pone.0250417.e024.jpg" id="pone.0250417.e024g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M24"><mml:mrow><mml:mi mathvariant="bold">O</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mrow><mml:mi mathvariant="bold">N</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> represents the output, <inline-formula id="pone.0250417.e025"><alternatives><graphic xlink:href="pone.0250417.e025.jpg" id="pone.0250417.e025g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M25"><mml:mrow><mml:mo>Θ</mml:mo><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mrow><mml:mi>Q</mml:mi><mml:mo>×</mml:mo><mml:mi>M</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> consists of all <italic>θ</italic> parameters in the parameter tensor, and <bold>a</bold> represents the activation function (e.g., ReLU and sigmoid).</p>
                </sec>
                <sec id="sec010">
                  <title>Sequence-to-sequence architecture of GRU and DGCN</title>
                  <p>Our model employs a sequence-to-sequence architecture to provide forecasts more than two weeks ahead of time; these are composed of RNNs to model the temporal dependence and a GCN to model the spatial dependence. In particular, a GRU [<xref rid="pone.0250417.ref055" ref-type="bibr">55</xref>], which is a simple and powerful variant of an RNN, was first used. The GRU considers <bold>X</bold><sup><italic>t</italic></sup> and <bold>H</bold><sub><italic>t</italic>−1</sub> as inputs and outputs <bold>H</bold><sub><italic>t</italic></sub> in accordance with the following formulae:
<disp-formula id="pone.0250417.e026"><alternatives><graphic xlink:href="pone.0250417.e026.jpg" id="pone.0250417.e026g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M26"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">r</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>σ</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="bold">H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mi mathvariant="bold">f</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold">H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>⊙</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="bold">r</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">z</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>σ</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="bold">H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mi mathvariant="bold">H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="bold">z</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>⊙</mml:mo><mml:msub><mml:mi mathvariant="bold">H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold">z</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⊙</mml:mo><mml:msub><mml:mi mathvariant="bold">f</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(5)</label></disp-formula>
where <bold>z</bold><sub><italic>t</italic></sub> and <bold>r</bold><sub><italic>t</italic></sub> represent the reset gate and update gate at time <italic>t</italic>, respectively. <inline-formula id="pone.0250417.e027"><alternatives><graphic xlink:href="pone.0250417.e027.jpg" id="pone.0250417.e027g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M27"><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>×</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0250417.e028"><alternatives><graphic xlink:href="pone.0250417.e028.jpg" id="pone.0250417.e028g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M28"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>×</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> are parameters for the respective gates, and <italic>M</italic> is the output dimension of the GRU. We can consolidate <xref ref-type="disp-formula" rid="pone.0250417.e026">Eq (5)</xref> as follows:
<disp-formula id="pone.0250417.e029"><alternatives><graphic xlink:href="pone.0250417.e029.jpg" id="pone.0250417.e029g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M29"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">H</mml:mi><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mi>G</mml:mi><mml:mi>R</mml:mi><mml:mi>U</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mi>T</mml:mi><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(6)</label></disp-formula>
where <inline-formula id="pone.0250417.e030"><alternatives><graphic xlink:href="pone.0250417.e030.jpg" id="pone.0250417.e030g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M30"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">H</mml:mi><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, which is the hidden state of the GRU, is applied by the DGCN, as described in Section 4.1. We can then represent Eqs <xref ref-type="disp-formula" rid="pone.0250417.e013">1</xref>–<xref ref-type="disp-formula" rid="pone.0250417.e023">4</xref> as follows:
<disp-formula id="pone.0250417.e031"><alternatives><graphic xlink:href="pone.0250417.e031.jpg" id="pone.0250417.e031g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M31"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">O</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mi>G</mml:mi><mml:mi>C</mml:mi><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mi mathvariant="bold">H</mml:mi><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mi mathvariant="bold">W</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(7)</label></disp-formula></p>
                  <p>The DGCN is used between the two GRU layers to achieve feature squeezing, as described in [<xref rid="pone.0250417.ref056" ref-type="bibr">56</xref>]. Subsequently, we apply the output of the DGCN to the second GRU layer, as follows.
<disp-formula id="pone.0250417.e032"><alternatives><graphic xlink:href="pone.0250417.e032.jpg" id="pone.0250417.e032g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M32"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">H</mml:mi><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mi>G</mml:mi><mml:mi>R</mml:mi><mml:mi>U</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">O</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(8)</label></disp-formula>
where <inline-formula id="pone.0250417.e033"><alternatives><graphic xlink:href="pone.0250417.e033.jpg" id="pone.0250417.e033g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M33"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">H</mml:mi><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. For the inference of the influenza volume in each region, we apply the output of the second GRU layer in the decoder to the multilayer perceptron (MLP), which has two layers. Finally, <inline-formula id="pone.0250417.e034"><alternatives><graphic xlink:href="pone.0250417.e034.jpg" id="pone.0250417.e034g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M34"><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, which is the final output, represents the number of influenza patients in <italic>n</italic> regions at time <italic>t</italic> + 1:
<disp-formula id="pone.0250417.e035"><alternatives><graphic xlink:href="pone.0250417.e035.jpg" id="pone.0250417.e035g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M35"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mi>L</mml:mi><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mi mathvariant="bold">H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(9)</label></disp-formula></p>
                  <p>During training, we feed the historical time series of patient numbers into the encoder. Next, we use its final states to initialize the decoder, which generates the prediction from previous ground-truth values. However, the discrepancy between the input distribution of training and testing data can decrease the performance, as because ground-truth values are replaced by predictions generated by the model. To solve this problem, we use scheduled sampling [<xref rid="pone.0250417.ref057" ref-type="bibr">57</xref>], which is a process that feeds the model either ground-truth values with probability <italic>ϵ</italic> or model predictions with probability 1−<italic>ϵ</italic>.</p>
                </sec>
              </sec>
              <sec id="sec011">
                <title>Uncertainty estimation</title>
                <p>Our model incorporates a method to estimate the uncertainty of the model prediction, i.e., a prediction interval suitable for a cyclic time series. Estimating prediction intervals is important for public health organizations when making decisions.</p>
                <p>However, it is difficult to apply neural networks that conduct point estimation, such as our prediction model. Therefore, we propose a method for estimating prediction intervals that are suitable for cyclic time series after explaining Zhu’s method [<xref rid="pone.0250417.ref009" ref-type="bibr">9</xref>], which is the basis of our method.</p>
                <p><bold>Algorithm 1</bold> Inference (from [<xref rid="pone.0250417.ref009" ref-type="bibr">9</xref>])</p>
                <p specific-use="line"><bold>Input:</bold> data <italic>x</italic>*, encoder <italic>g</italic>(⋅), prediction network <italic>h</italic>(⋅), dropout probability <italic>p</italic>, number of iterations <italic>B</italic></p>
                <p specific-use="line"><bold>Output:</bold> prediction <inline-formula id="pone.0250417.e036"><alternatives><graphic xlink:href="pone.0250417.e036.jpg" id="pone.0250417.e036g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M36"><mml:msubsup><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>m</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula>, uncertainty <italic>η</italic></p>
                <p specific-use="line"> <italic>//Model uncertainty and model misspecification</italic></p>
                <p specific-use="line">1: <inline-formula id="pone.0250417.e037"><alternatives><graphic xlink:href="pone.0250417.e037.jpg" id="pone.0250417.e037g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M37"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, <italic>η</italic><sub>1</sub> ← <italic>MCdropout</italic> (<italic>x</italic>*,<italic>g</italic>,<italic>h</italic>,<italic>p</italic>,<italic>B</italic>)</p>
                <p specific-use="line"> <italic>// Inherent noise</italic></p>
                <p specific-use="line">2: <bold>for</bold>
<inline-formula id="pone.0250417.e038"><alternatives><graphic xlink:href="pone.0250417.e038.jpg" id="pone.0250417.e038g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M38"><mml:msubsup><mml:mi>x</mml:mi><mml:mi>v</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula>
<bold>in</bold> validation set <inline-formula id="pone.0250417.e039"><alternatives><graphic xlink:href="pone.0250417.e039.jpg" id="pone.0250417.e039g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M39"><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mn>1</mml:mn><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>V</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
<bold>do</bold></p>
                <p specific-use="line">3:  <inline-formula id="pone.0250417.e040"><alternatives><graphic xlink:href="pone.0250417.e040.jpg" id="pone.0250417.e040g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M40"><mml:mrow><mml:msub><mml:mover accent="true"><mml:msup><mml:mi>y</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>^</mml:mo></mml:mover><mml:mi>v</mml:mi></mml:msub><mml:mo>←</mml:mo><mml:mi>h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>v</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
                <p specific-use="line">4: <bold>end for</bold></p>
                <p specific-use="line">5: <inline-formula id="pone.0250417.e041"><alternatives><graphic xlink:href="pone.0250417.e041.jpg" id="pone.0250417.e041g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M41"><mml:mrow><mml:msubsup><mml:mi>η</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>←</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>V</mml:mi></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>V</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:msup><mml:mi>y</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>^</mml:mo></mml:mover><mml:mi>v</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>v</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula></p>
                <p specific-use="line"> <italic>// Total prediction uncertainty</italic></p>
                <p specific-use="line">6: <inline-formula id="pone.0250417.e042"><alternatives><graphic xlink:href="pone.0250417.e042.jpg" id="pone.0250417.e042g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M42"><mml:mrow><mml:mi>η</mml:mi><mml:mo>←</mml:mo><mml:msqrt><mml:mrow><mml:msubsup><mml:mi>η</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>η</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula></p>
                <p specific-use="line">7: <bold>return</bold>
<inline-formula id="pone.0250417.e043"><alternatives><graphic xlink:href="pone.0250417.e043.jpg" id="pone.0250417.e043g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M43"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mi>η</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></p>
                <p><bold>Algorithm 2</bold> Inference considering periodicity</p>
                <p specific-use="line"><bold>Input:</bold> data <inline-formula id="pone.0250417.e044"><alternatives><graphic xlink:href="pone.0250417.e044.jpg" id="pone.0250417.e044g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M44"><mml:msubsup><mml:mi>x</mml:mi><mml:mi>m</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula>, time cyclic point <italic>m</italic>, encoder <italic>g</italic>(⋅), prediction network <italic>h</italic>(⋅), dropout probability <italic>p</italic>, number of iterations <italic>B</italic>, window width <italic>W</italic></p>
                <p specific-use="line"><bold>Output:</bold> prediction <inline-formula id="pone.0250417.e045"><alternatives><graphic xlink:href="pone.0250417.e045.jpg" id="pone.0250417.e045g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M45"><mml:msubsup><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>m</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula>, uncertainty <italic>η</italic></p>
                <p specific-use="line"> <italic>//Model uncertainty and model misspecification</italic></p>
                <p specific-use="line">1: <inline-formula id="pone.0250417.e046"><alternatives><graphic xlink:href="pone.0250417.e046.jpg" id="pone.0250417.e046g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M46"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, <italic>η</italic><sub>1</sub> ← <italic>MCdropout</italic>
<inline-formula id="pone.0250417.e047"><alternatives><graphic xlink:href="pone.0250417.e047.jpg" id="pone.0250417.e047g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M47"><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>m</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula></p>
                <p specific-use="line"> <italic>// Inherent noise</italic></p>
                <p specific-use="line">2: <bold>for</bold>
<inline-formula id="pone.0250417.e048"><alternatives><graphic xlink:href="pone.0250417.e048.jpg" id="pone.0250417.e048g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M48"><mml:msubsup><mml:mi>x</mml:mi><mml:mi>w</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula>
<bold>in</bold>
<inline-formula id="pone.0250417.e049"><alternatives><graphic xlink:href="pone.0250417.e049.jpg" id="pone.0250417.e049g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M49"><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>W</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>W</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
<bold>do</bold></p>
                <p specific-use="line">3:  <inline-formula id="pone.0250417.e050"><alternatives><graphic xlink:href="pone.0250417.e050.jpg" id="pone.0250417.e050g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M50"><mml:mrow><mml:msub><mml:mover accent="true"><mml:msup><mml:mi>y</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>^</mml:mo></mml:mover><mml:mi>w</mml:mi></mml:msub><mml:mo>←</mml:mo><mml:mi>h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>w</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
                <p specific-use="line">4: <bold>end for</bold></p>
                <p specific-use="line">5: <inline-formula id="pone.0250417.e051"><alternatives><graphic xlink:href="pone.0250417.e051.jpg" id="pone.0250417.e051g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M51"><mml:mrow><mml:msubsup><mml:mi>η</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>←</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>W</mml:mi></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>W</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:msup><mml:mi>y</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>^</mml:mo></mml:mover><mml:mi>w</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>w</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula></p>
                <p specific-use="line"> <italic>// Total prediction uncertainty</italic></p>
                <p specific-use="line">6: <inline-formula id="pone.0250417.e052"><alternatives><graphic xlink:href="pone.0250417.e052.jpg" id="pone.0250417.e052g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M52"><mml:mrow><mml:mi>η</mml:mi><mml:mo>←</mml:mo><mml:msqrt><mml:mrow><mml:msubsup><mml:mi>η</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>η</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula></p>
                <p specific-use="line">7: <bold>return</bold>
<inline-formula id="pone.0250417.e053"><alternatives><graphic xlink:href="pone.0250417.e053.jpg" id="pone.0250417.e053g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M53"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mi>η</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></p>
                <sec id="sec012">
                  <title>Base method</title>
                  <p>We describe the method proposed by Zhu et al. (referred to as Zhu’s method), which provides time-series prediction and uncertainty estimation. This method quantifies the standard error <italic>η</italic> of the prediction. Therefore, an approximate <italic>α</italic>-level prediction interval can be constructed using [<italic>y</italic>*−<italic>z</italic><sub><italic>α</italic>/2</sub>
<italic>η</italic>, <italic>y</italic>*+<italic>z</italic><sub><italic>α</italic>/2</sub>
<italic>η</italic>]. Here, the model prediction <inline-formula id="pone.0250417.e054"><alternatives><graphic xlink:href="pone.0250417.e054.jpg" id="pone.0250417.e054g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M54"><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mi>f</mml:mi><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:msup><mml:mo>(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, <italic>x</italic>* is a new input, <inline-formula id="pone.0250417.e055"><alternatives><graphic xlink:href="pone.0250417.e055.jpg" id="pone.0250417.e055g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M55"><mml:mrow><mml:msup><mml:mi>f</mml:mi><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:msup><mml:mo>(</mml:mo><mml:mo>.</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is a trained neural network, and <italic>z</italic><sub><italic>α</italic>/2</sub> is the upper <italic>α</italic>/2-quantile of the standard normal distribution. The method accounts for three sources of prediction uncertainties for quantifying the prediction standard error <italic>η</italic>: model uncertainty, inherent noise, and model misspecification.</p>
                  <p>Model uncertainty and misspecification are calculated using MC dropout, which was derived from the property of dropout-approximate Bayesian inference [<xref rid="pone.0250417.ref050" ref-type="bibr">50</xref>]. Specifically, MC dropout proceeds to randomly drop out each hidden unit in a model with a certain probability <italic>p</italic>. This stochastic feed-forward process is repeated <italic>B</italic> times to obtain an output <inline-formula id="pone.0250417.e056"><alternatives><graphic xlink:href="pone.0250417.e056.jpg" id="pone.0250417.e056g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M56"><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>B</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. Using this output, we can approximate the model uncertainty as
<disp-formula id="pone.0250417.e057"><alternatives><graphic xlink:href="pone.0250417.e057.jpg" id="pone.0250417.e057g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M57"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mtext>Var</mml:mtext><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>f</mml:mi><mml:mi>W</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>B</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>B</mml:mi></mml:munderover><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>b</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>-</mml:mo><mml:msup><mml:mover><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>¯</mml:mo></mml:mover><mml:mo>*</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(10)</label></disp-formula>
where <inline-formula id="pone.0250417.e058"><alternatives><graphic xlink:href="pone.0250417.e058.jpg" id="pone.0250417.e058g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M58"><mml:mrow><mml:msup><mml:mover><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>¯</mml:mo></mml:mover><mml:mo>*</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>B</mml:mi></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>B</mml:mi></mml:msubsup><mml:msubsup><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>b</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. To incorporate this uncertainty into the encoder–decoder model, we apply MC dropout to all layers in both the encoder <italic>g</italic> and final prediction network <italic>h</italic>. Estimation of the model uncertainty and misspecification using MC dropout is described in [<xref rid="pone.0250417.ref009" ref-type="bibr">9</xref>].</p>
                  <p>The inherent noise <inline-formula id="pone.0250417.e059"><alternatives><graphic xlink:href="pone.0250417.e059.jpg" id="pone.0250417.e059g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M59"><mml:msup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:math></alternatives></inline-formula> is estimated via the residual sum of squares evaluated on an independent validation set <inline-formula id="pone.0250417.e060"><alternatives><graphic xlink:href="pone.0250417.e060.jpg" id="pone.0250417.e060g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M60"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mn>1</mml:mn><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>V</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mn>1</mml:mn><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>V</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. We estimate the inherent noise via the residual sum of squares for the validation set as we do not know the correct noise level a priori.
<disp-formula id="pone.0250417.e061"><alternatives><graphic xlink:href="pone.0250417.e061.jpg" id="pone.0250417.e061g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M61"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>V</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>V</mml:mi></mml:munderover><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>v</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>-</mml:mo><mml:msup><mml:mi>f</mml:mi><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>v</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mspace width="0.166667em"/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
                  <p>Uncertainty estimation is presented in Algorithm 1.</p>
                </sec>
                <sec id="sec013">
                  <title>Proposed method for cyclic time series</title>
                  <p>We incorporate Zhu et al.’s uncertainty estimation method into our model for flu prediction. Fig 6(a) shows the time series of our model using Zhu’s method for the Okayama prefecture. This figure shows the method applied to our model for the prediction interval. Specifically, it shows a tendency to provide a larger than necessary prediction interval in a non-epidemic period, where there is only a slight variation in the number of flu patients. This tendency, which originates from the method of calculating the inherent noise, can complicate decision making for health authorities.</p>
                  <p>The inherent noise in Algorithm 1 is assumed to be constant in all periods. However, inherent noise strongly depends on the season in a year-long periodic time series (such as the number of influenza patients). Therefore, we replace Algorithm 1 with Algorithm 2, and subsequently incorporate it into our model with this uncertainty estimation for cyclic time series. In Algorithm 2, the one-period validation set is used to calculate the inherent noise, as periodicity must be considered. In particular, we prepare the one-period validation set <inline-formula id="pone.0250417.e062"><alternatives><graphic xlink:href="pone.0250417.e062.jpg" id="pone.0250417.e062g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M62"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mn>1</mml:mn><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mi>M</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mn>1</mml:mn><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>M</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> in the time series (e.g., one-year validation set for flu prediction). Next, we calculate the inherent noise using window width <italic>W</italic> of the validation set <inline-formula id="pone.0250417.e063"><alternatives><graphic xlink:href="pone.0250417.e063.jpg" id="pone.0250417.e063g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M63"><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>W</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>W</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> around January, when a new input is in the January data <inline-formula id="pone.0250417.e064"><alternatives><graphic xlink:href="pone.0250417.e064.jpg" id="pone.0250417.e064g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M64"><mml:msubsup><mml:mi>x</mml:mi><mml:mi>m</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula>. Here, <italic>m</italic> is the time cyclic point, and <italic>M</italic> is the number of one-period data points.</p>
                </sec>
              </sec>
            </sec>
            <sec id="sec014">
              <title>Experiments</title>
              <p>We evaluated the predictive capabilities of our spatiotemporal model and prediction interval estimation on the 47 prefectures of Japan. The proposed model is referred to as “GCN+Seq2seq w/ PF” hereinafter, where PF indicates that the model considers the flow of people.</p>
              <p>We aimed to answer the following research questions:</p>
              <list list-type="bullet">
                <list-item>
                  <p>(RQ1) Does commuting data improve the accuracy of influenza prediction?</p>
                </list-item>
                <list-item>
                  <p>(RQ2) When and in which area does our model produce good results?</p>
                </list-item>
                <list-item>
                  <p>(RQ3) How effective is our uncertainty estimation method in real-world epidemic prediction?</p>
                </list-item>
              </list>
              <sec id="sec015">
                <title>Datasets</title>
                <sec id="sec016">
                  <title>Influenza data</title>
                  <p>We used data based on the weekly number of patients with influenza symptoms for each prefecture in Japan, as reported by the National Institute of Infectious Diseases (NIID). NIID reports aggregated information related to influenza in its weekly reports [<xref rid="pone.0250417.ref058" ref-type="bibr">58</xref>] to provide warnings regarding infection outbreaks. These reports are delayed by approximately seven days from the date of the original clinical reports by physicians (because of the time necessary to aggregate clinical information from different health authorities in each prefecture). We mixed all subtypes of influenza data and accumulated the number of influenza patients from the 37th week of 2012 to the 30th week of 2020. We accessed the data, which was provided fully anonymized, on 21 Oct 2020.</p>
                </sec>
                <sec id="sec017">
                  <title>Commuting data</title>
                  <p>Spatiotemporal models typically use adjacency and distance between observation points to model geographical information. However, human mobility is strongly linked with the transmission of infectious diseases (such as droplets and contact infections). Therefore, this study used commuting data instead of AD as geographical information (<xref ref-type="fig" rid="pone.0250417.g001">Fig 1</xref>). Adding commuting data to our model can better capture the epidemic situation in a region, which is important for public health organizations.</p>
                  <p>To consider inter-regional flows of people, we used commuting data from the 47 prefectures of Japan. The data were provided by the national census report [<xref rid="pone.0250417.ref059" ref-type="bibr">59</xref>] of 2015. The provided data include the single daily average numbers of commuters from one prefecture to another over all days of the weeks. We accessed the data, which was provided fully anonymized, on 21 Oct 2020. In the experiment in each year, we represented the data of each year as a graph <inline-formula id="pone.0250417.e065"><alternatives><graphic xlink:href="pone.0250417.e065.jpg" id="pone.0250417.e065g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M65"><mml:mrow><mml:mi mathvariant="script">G</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mi mathvariant="script">V</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">E</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">W</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> in the proposed model because the national census report only provides only the number of commuters, regardless of the year. We divided the number of commuters by the maximum number of commuters between every prefecture pair, which is known as min-max normalization to graph-edge information, such as <bold>W</bold>. The maximum number of commuters (270,000) travels from Kanagawa prefecture to Tokyo prefecture. Moreover, 135,000 commuters travel from Osaka to Nara. The edge weight, representing commuters traveling from Osaka to Nara, is shown as 0.5 (=135,000/270,000) in the graph, after applying min-max normalization.</p>
                </sec>
              </sec>
              <sec id="sec018">
                <title>Models for comparison</title>
                <sec id="sec019">
                  <title>Vector autoregression</title>
                  <p>Vector autoregression (VAR) [<xref rid="pone.0250417.ref060" ref-type="bibr">60</xref>] is an extension of autoregressive models that allow for more than one evolving variable. We selected observation values in all regions, which are up to <italic>T</italic>′ weeks before, as multiple variables. We set <italic>T</italic>′ as five weeks in the experiment. To make the model more robust, we adopted an L2-regularization term for training.</p>
                </sec>
                <sec id="sec020">
                  <title>LSTM</title>
                  <p>The LSTM model captures temporal dependence in data and preserves backpropagated error through time and layers. LSTM has been successfully used in natural language and sound signal processing [<xref rid="pone.0250417.ref061" ref-type="bibr">61</xref>] as well as influenza prediction [<xref rid="pone.0250417.ref008" ref-type="bibr">8</xref>, <xref rid="pone.0250417.ref022" ref-type="bibr">22</xref>]. Specifically, LSTM has input, output, and forget gates, which are used to compute the new states in the memory cell given old values. Our baseline architecture is the same as that reported in [<xref rid="pone.0250417.ref008" ref-type="bibr">8</xref>].</p>
                </sec>
                <sec id="sec021">
                  <title>CNNRNN-Res</title>
                  <p>The CNNRNN-Res model was developed by [<xref rid="pone.0250417.ref006" ref-type="bibr">6</xref>] for influenza prediction. The model structure comprises three parts: a CNN to capture regional relations; an RNN to capture time dependencies; and residual links for fast training with no overfitting. The CNN uses the adjacent information of the respective regions. The residual links bypass some intermediate layers, which can mitigate overfitting [<xref rid="pone.0250417.ref062" ref-type="bibr">62</xref>].</p>
                </sec>
                <sec id="sec022">
                  <title>GCN+Seq2seq w/ AD</title>
                  <p>To validate the effectiveness of PF as spatial information compared with other geographical relations between prefectures, we used our model with AD instead of commuting data. Note that AD comprise a matrix that represents whether two regions are adjacent (1) or not (0) without a specified direction, as shown in <xref ref-type="fig" rid="pone.0250417.g001">Fig 1(a)</xref>. We term this model with AD between the 47 prefectures “GCN+Seq2seq w/ AD,” for contrast with the proposed“GCN+Seq2seq w/ PF” model.</p>
                </sec>
                <sec id="sec023">
                  <title>GCN+Seq2seq w/ DD</title>
                  <p>To validate the effectiveness of PF as spatial information, compared with other geographical relations between prefectures, we considered the distance between prefecture regions. We assume that the inter-region distance is an important factor in estimating the strength of the interaction between regions along with geographical adjacency. We prepared the data by measuring the straight-line distance between the locations of the government offices of each prefecture. In our model, we substituted the graph weighted by the inverse distance between regions after min-max normalized for commuting data. The closest distance’s edge weight is given as 1, and smaller values indicate longer distances. We term this model with inverse distance data (DD) between the 47 prefectures “GCN+Seq2seq w/ DD.”</p>
                </sec>
              </sec>
              <sec id="sec024">
                <title>Evaluation metrics</title>
                <p>Two evaluation metrics were used to compare each model’s predictive performance: coefficient of determination <italic>R</italic><sup>2</sup> and mean absolute error (MAE). The <italic>R</italic><sup>2</sup> coefficient represents how well the predicted values conform to true values; the higher, the better. The MAE is the average magnitude of differences between the predicted and true values; the lower, the better.</p>
              </sec>
              <sec id="sec025">
                <title>Settings</title>
                <p>We predicted influenza epidemics in the 47 prefectures of Japan with a spatiotemporal model. The model was validated as follows. The influenza patient numbers from week 1 to week 5 (“Nowcasting” and “Forecasting”) were predicted using the proposed model, GCN+Seq2seq w/ PF, and the five models for comparison, i.e., VAR, LSTM, CNNRNN-Res, GCN+Seq2seq w/ AD, and GCN+Seq2seq w/ DD. We assessed the predictive performance using data from four flu seasons in Japan (31st week of 2016—30th week of 2017, 31st week of 2017—30th week of 2018, 31st week of 2018—30th week of 2019, 31st week of 2019—30th week of 2020); these were year-long periods. We set 156 weeks (three years) as the training period using past data, and then set 52 weeks (one year) as the validation period for the prediction interval estimation before each testing period. In other words, we used 7332 training samples (156 weeks × 47 prefectures), 2444 validation samples, and 2444 test samples.</p>
                <p>We used the influenza data for 26 weeks before a specific week as inputs for all models, except the VAR model, for which we set <italic>T</italic>′ as five weeks. The L2-regularization of the VAR model was searched from the set of (0.01, 0.1, 1) in the validation period. Moreover, we used two hidden layers in the LSTM. The size of the hidden layer was selected as (5, 20, 50, 80, 150, 200) for the validation period. For CNNRNN-Res, the hidden dimension for the RNN was (5, 10, 20, 40), and the number of residual links was selected as (4, 8, 16), as described in [<xref rid="pone.0250417.ref006" ref-type="bibr">6</xref>]. For GCN+Seq2seq w/ PF, w/ DD, and w/ AD, we set the number of diffusion steps <italic>K</italic> as 3. We subsequently selected the learning rate and hidden layer sizes of the GRU, <italic>M</italic> and <italic>S</italic>, as (0.001, 0.01, 0.1, 1.0) and (32, 64, 128, 256) for the validation period, respectively. During training, all model parameters were updated using gradient descent with the Adam update rule, with a dropout value of 0.5. The dropout was applied to hidden layers to avoid overfitting and estimate model uncertainty.</p>
              </sec>
            </sec>
            <sec id="sec026">
              <title>Results and discussions</title>
              <sec id="sec027">
                <title>Experimental results</title>
                <p>The results are presented in <xref rid="pone.0250417.t002" ref-type="table">Table 2</xref>. Our GCN+Seq2seq w/ PF model outperformed all other models in terms of <italic>MAE</italic> and <italic>R</italic><sup>2</sup> when predicting the number of influenza patients two to five weeks in advance.</p>
                <table-wrap id="pone.0250417.t002" orientation="portrait" position="float">
                  <object-id pub-id-type="doi">10.1371/journal.pone.0250417.t002</object-id>
                  <label>Table 2</label>
                  <caption>
                    <title>Regional prediction model performances (averaged across all 47 prefectures in Japan).</title>
                  </caption>
                  <alternatives>
                    <graphic id="pone.0250417.t002g" xlink:href="pone.0250417.t002"/>
                    <table frame="box" rules="all" border="0">
                      <colgroup span="1">
                        <col align="left" valign="middle" span="1"/>
                        <col align="left" valign="middle" span="1"/>
                        <col align="left" valign="middle" span="1"/>
                        <col align="left" valign="middle" span="1"/>
                        <col align="left" valign="middle" span="1"/>
                        <col align="left" valign="middle" span="1"/>
                        <col align="left" valign="middle" span="1"/>
                        <col align="left" valign="middle" span="1"/>
                        <col align="left" valign="middle" span="1"/>
                        <col align="left" valign="middle" span="1"/>
                        <col align="left" valign="middle" span="1"/>
                        <col align="left" valign="middle" span="1"/>
                      </colgroup>
                      <thead>
                        <tr>
                          <th align="center" rowspan="2" colspan="1">Season</th>
                          <th align="right" rowspan="2" colspan="1">Model</th>
                          <th align="center" colspan="2" rowspan="1">1-week</th>
                          <th align="center" colspan="2" rowspan="1">2-week</th>
                          <th align="center" colspan="2" rowspan="1">3-week</th>
                          <th align="center" colspan="2" rowspan="1">4-week</th>
                          <th align="center" colspan="2" rowspan="1">5-week</th>
                        </tr>
                        <tr>
                          <th align="right" rowspan="1" colspan="1">
                            <italic>MAE</italic>
                          </th>
                          <th align="right" rowspan="1" colspan="1">
                            <italic>R</italic>
                            <sup>2</sup>
                          </th>
                          <th align="right" rowspan="1" colspan="1">
                            <italic>MAE</italic>
                          </th>
                          <th align="right" rowspan="1" colspan="1">
                            <italic>R</italic>
                            <sup>2</sup>
                          </th>
                          <th align="right" rowspan="1" colspan="1">
                            <italic>MAE</italic>
                          </th>
                          <th align="right" rowspan="1" colspan="1">
                            <italic>R</italic>
                            <sup>2</sup>
                          </th>
                          <th align="right" rowspan="1" colspan="1">
                            <italic>MAE</italic>
                          </th>
                          <th align="right" rowspan="1" colspan="1">
                            <italic>R</italic>
                            <sup>2</sup>
                          </th>
                          <th align="right" rowspan="1" colspan="1">
                            <italic>MAE</italic>
                          </th>
                          <th align="right" rowspan="1" colspan="1">
                            <italic>R</italic>
                            <sup>2</sup>
                          </th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td align="center" rowspan="1" colspan="1"/>
                          <td align="right" rowspan="1" colspan="1">VAR</td>
                          <td align="char" char="." rowspan="1" colspan="1">181.18</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.936</td>
                          <td align="char" char="." rowspan="1" colspan="1">248.07</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.816</td>
                          <td align="char" char="." rowspan="1" colspan="1">314.34</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.690</td>
                          <td align="char" char="." rowspan="1" colspan="1">456.05</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.511</td>
                          <td align="char" char="." rowspan="1" colspan="1">607.31</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.294</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1">2016/31st</td>
                          <td align="right" rowspan="1" colspan="1">LSTM</td>
                          <td align="char" char="." rowspan="1" colspan="1">149.76</td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>0.939</bold>
                          </td>
                          <td align="char" char="." rowspan="1" colspan="1">259.34</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.820</td>
                          <td align="char" char="." rowspan="1" colspan="1">375.67</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.693</td>
                          <td align="char" char="." rowspan="1" colspan="1">513.66</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.537</td>
                          <td align="char" char="." rowspan="1" colspan="1">713.20</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.240</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1">–</td>
                          <td align="right" rowspan="1" colspan="1">CNNRNN-Res</td>
                          <td align="char" char="." rowspan="1" colspan="1">163.24</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.918</td>
                          <td align="char" char="." rowspan="1" colspan="1">332.83</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.750</td>
                          <td align="char" char="." rowspan="1" colspan="1">375.44</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.616</td>
                          <td align="char" char="." rowspan="1" colspan="1">396.16</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.542</td>
                          <td align="char" char="." rowspan="1" colspan="1">458.51</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.460</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1">2017/30th</td>
                          <td align="right" rowspan="1" colspan="1">GCN+S2s w/ AD</td>
                          <td align="char" char="." rowspan="1" colspan="1">142.08</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.931</td>
                          <td align="char" char="." rowspan="1" colspan="1">214.89</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.828</td>
                          <td align="char" char="." rowspan="1" colspan="1">266.42</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.616</td>
                          <td align="char" char="." rowspan="1" colspan="1">320.02</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.530</td>
                          <td align="char" char="." rowspan="1" colspan="1">384.38</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.540</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1"/>
                          <td align="right" rowspan="1" colspan="1">GCN+S2s w/ DD</td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>133.78</bold>
                          </td>
                          <td align="char" char="." rowspan="1" colspan="1">0.931</td>
                          <td align="char" char="." rowspan="1" colspan="1">216.11</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.745</td>
                          <td align="char" char="." rowspan="1" colspan="1">279.27</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.615</td>
                          <td align="char" char="." rowspan="1" colspan="1">312.18</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.599</td>
                          <td align="char" char="." rowspan="1" colspan="1">389.78</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.576</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1"/>
                          <td align="right" rowspan="1" colspan="1">GCN+S2s w/ PF</td>
                          <td align="char" char="." rowspan="1" colspan="1">148.76</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.936</td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>211.30</bold>
                          </td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>0.864</bold>
                          </td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>265.85</bold>
                          </td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>0.760</bold>
                          </td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>305.77</bold>
                          </td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>0.667</bold>
                          </td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>313.29</bold>
                          </td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>0.635</bold>
                          </td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1"/>
                          <td align="right" rowspan="1" colspan="1">VAR</td>
                          <td align="char" char="." rowspan="1" colspan="1">237.94</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.902</td>
                          <td align="char" char="." rowspan="1" colspan="1">420.40</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.781</td>
                          <td align="char" char="." rowspan="1" colspan="1">699.27</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.362</td>
                          <td align="char" char="." rowspan="1" colspan="1">663.41</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.131</td>
                          <td align="char" char="." rowspan="1" colspan="1">987.73</td>
                          <td align="char" char="." rowspan="1" colspan="1">-0.396</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1">2017/31st</td>
                          <td align="right" rowspan="1" colspan="1">LSTM</td>
                          <td align="char" char="." rowspan="1" colspan="1">216.64</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.866</td>
                          <td align="char" char="." rowspan="1" colspan="1">366.58</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.678</td>
                          <td align="char" char="." rowspan="1" colspan="1">451.27</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.580</td>
                          <td align="char" char="." rowspan="1" colspan="1">517.39</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.541</td>
                          <td align="char" char="." rowspan="1" colspan="1">595.47</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.415</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1">–</td>
                          <td align="right" rowspan="1" colspan="1">CNNRNN-Res</td>
                          <td align="char" char="." rowspan="1" colspan="1">210.29</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.891</td>
                          <td align="char" char="." rowspan="1" colspan="1">343.49</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.733</td>
                          <td align="char" char="." rowspan="1" colspan="1">440.64</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.621</td>
                          <td align="char" char="." rowspan="1" colspan="1">498.01</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.532</td>
                          <td align="char" char="." rowspan="1" colspan="1">610.81</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.423</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1">2018/30th</td>
                          <td align="right" rowspan="1" colspan="1">GCN+S2s w/ AD</td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>197.20</bold>
                          </td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>0.918</bold>
                          </td>
                          <td align="char" char="." rowspan="1" colspan="1">341.72</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.791</td>
                          <td align="char" char="." rowspan="1" colspan="1">402.10</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.704</td>
                          <td align="char" char="." rowspan="1" colspan="1">448.38</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.628</td>
                          <td align="char" char="." rowspan="1" colspan="1">553.52</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.619</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1"/>
                          <td align="right" rowspan="1" colspan="1">GCN+S2s w/ DD</td>
                          <td align="char" char="." rowspan="1" colspan="1">201.53</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.915</td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>322.87</bold>
                          </td>
                          <td align="char" char="." rowspan="1" colspan="1">0.779</td>
                          <td align="char" char="." rowspan="1" colspan="1">399.76</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.697</td>
                          <td align="char" char="." rowspan="1" colspan="1">479.11</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.648</td>
                          <td align="char" char="." rowspan="1" colspan="1">480.35</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.619</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1"/>
                          <td align="right" rowspan="1" colspan="1">GCN+S2s w/ PF</td>
                          <td align="char" char="." rowspan="1" colspan="1">215.31</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.918</td>
                          <td align="char" char="." rowspan="1" colspan="1">338.03</td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>0.795</bold>
                          </td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>399.42</bold>
                          </td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>0.723</bold>
                          </td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>442.31</bold>
                          </td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>0.666</bold>
                          </td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>459.12</bold>
                          </td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>0.648</bold>
                          </td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1"/>
                          <td align="right" rowspan="1" colspan="1">VAR</td>
                          <td align="char" char="." rowspan="1" colspan="1">239.21</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.916</td>
                          <td align="char" char="." rowspan="1" colspan="1">341.35</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.834</td>
                          <td align="char" char="." rowspan="1" colspan="1">579.81</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.433</td>
                          <td align="char" char="." rowspan="1" colspan="1">822.02</td>
                          <td align="char" char="." rowspan="1" colspan="1">-0.112</td>
                          <td align="char" char="." rowspan="1" colspan="1">1034.90</td>
                          <td align="char" char="." rowspan="1" colspan="1">-0.695</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1">2018/31st</td>
                          <td align="right" rowspan="1" colspan="1">LSTM</td>
                          <td align="char" char="." rowspan="1" colspan="1">167.08</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.912</td>
                          <td align="char" char="." rowspan="1" colspan="1">263.39</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.815</td>
                          <td align="char" char="." rowspan="1" colspan="1">310.94</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.620</td>
                          <td align="char" char="." rowspan="1" colspan="1">368.73</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.673</td>
                          <td align="char" char="." rowspan="1" colspan="1">417.39</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.562</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1">–</td>
                          <td align="right" rowspan="1" colspan="1">CNNRNN-Res</td>
                          <td align="char" char="." rowspan="1" colspan="1">168.01</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.917</td>
                          <td align="char" char="." rowspan="1" colspan="1">375.27</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.652</td>
                          <td align="char" char="." rowspan="1" colspan="1">422.63</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.528</td>
                          <td align="char" char="." rowspan="1" colspan="1">512.72</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.437</td>
                          <td align="char" char="." rowspan="1" colspan="1">615.29</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.400</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1">2019/30th</td>
                          <td align="right" rowspan="1" colspan="1">GCN+S2s w/ AD</td>
                          <td align="char" char="." rowspan="1" colspan="1">130.31</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.967</td>
                          <td align="char" char="." rowspan="1" colspan="1">237.31</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.907</td>
                          <td align="char" char="." rowspan="1" colspan="1">266.94</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.882</td>
                          <td align="char" char="." rowspan="1" colspan="1">290.93</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.852</td>
                          <td align="char" char="." rowspan="1" colspan="1">362.65</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.737</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1"/>
                          <td align="right" rowspan="1" colspan="1">GCN+S2s w/ DD</td>
                          <td align="char" char="." rowspan="1" colspan="1">146.09</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.961</td>
                          <td align="char" char="." rowspan="1" colspan="1">256.22</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.895</td>
                          <td align="char" char="." rowspan="1" colspan="1">306.38</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.859</td>
                          <td align="char" char="." rowspan="1" colspan="1">335.03</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.830</td>
                          <td align="char" char="." rowspan="1" colspan="1">398.36</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.745</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1"/>
                          <td align="right" rowspan="1" colspan="1">GCN+S2s w/ PF</td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>117.40</bold>
                          </td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>0.974</bold>
                          </td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>196.45</bold>
                          </td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>0.918</bold>
                          </td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>228.85</bold>
                          </td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>0.884</bold>
                          </td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>230.85</bold>
                          </td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>0.887</bold>
                          </td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>224.62</bold>
                          </td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>0.890</bold>
                          </td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1"/>
                          <td align="right" rowspan="1" colspan="1">VAR</td>
                          <td align="char" char="." rowspan="1" colspan="1">126.56</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.942</td>
                          <td align="char" char="." rowspan="1" colspan="1">326.09</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.420</td>
                          <td align="char" char="." rowspan="1" colspan="1">544.50</td>
                          <td align="char" char="." rowspan="1" colspan="1">-0.803</td>
                          <td align="char" char="." rowspan="1" colspan="1">686.64</td>
                          <td align="char" char="." rowspan="1" colspan="1">-1.901</td>
                          <td align="char" char="." rowspan="1" colspan="1">856.59</td>
                          <td align="char" char="." rowspan="1" colspan="1">-3.459</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1">2019/31st</td>
                          <td align="right" rowspan="1" colspan="1">LSTM</td>
                          <td align="char" char="." rowspan="1" colspan="1">124.62</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.842</td>
                          <td align="char" char="." rowspan="1" colspan="1">263.39</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.581</td>
                          <td align="char" char="." rowspan="1" colspan="1">286.15</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.409</td>
                          <td align="char" char="." rowspan="1" colspan="1">369.28</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.188</td>
                          <td align="char" char="." rowspan="1" colspan="1">433.53</td>
                          <td align="char" char="." rowspan="1" colspan="1">-0.316</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1">–</td>
                          <td align="right" rowspan="1" colspan="1">CNNRNN-Res</td>
                          <td align="char" char="." rowspan="1" colspan="1">100.91</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.922</td>
                          <td align="char" char="." rowspan="1" colspan="1">283.58</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.571</td>
                          <td align="char" char="." rowspan="1" colspan="1">333.94</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.357</td>
                          <td align="char" char="." rowspan="1" colspan="1">399.31</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.151</td>
                          <td align="char" char="." rowspan="1" colspan="1">501.02</td>
                          <td align="char" char="." rowspan="1" colspan="1">-0.402</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1">2020/30th</td>
                          <td align="right" rowspan="1" colspan="1">GCN+S2s w/ AD</td>
                          <td align="char" char="." rowspan="1" colspan="1">83.95</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.955</td>
                          <td align="char" char="." rowspan="1" colspan="1">193.15</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.667</td>
                          <td align="char" char="." rowspan="1" colspan="1">274.65</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.395</td>
                          <td align="char" char="." rowspan="1" colspan="1">345.11</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.095</td>
                          <td align="char" char="." rowspan="1" colspan="1">408.42</td>
                          <td align="char" char="." rowspan="1" colspan="1">-0.255</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1"/>
                          <td align="right" rowspan="1" colspan="1">GCN+S2s w/ DD</td>
                          <td align="char" char="." rowspan="1" colspan="1">96.82</td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>0.959</bold>
                          </td>
                          <td align="char" char="." rowspan="1" colspan="1">209.93</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.704</td>
                          <td align="char" char="." rowspan="1" colspan="1">313.72</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.472</td>
                          <td align="char" char="." rowspan="1" colspan="1">395.97</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.164</td>
                          <td align="char" char="." rowspan="1" colspan="1">447.38</td>
                          <td align="char" char="." rowspan="1" colspan="1">-0.074</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="1" colspan="1"/>
                          <td align="right" rowspan="1" colspan="1">GCN+S2s w/ PF</td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>76.26</bold>
                          </td>
                          <td align="char" char="." rowspan="1" colspan="1">0.954</td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>164.05</bold>
                          </td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>0.707</bold>
                          </td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>227.57</bold>
                          </td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>0.473</bold>
                          </td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>288.72</bold>
                          </td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>0.230</bold>
                          </td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>343.89</bold>
                          </td>
                          <td align="char" char="." rowspan="1" colspan="1">
                            <bold>0.006</bold>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </alternatives>
                </table-wrap>
                <p>In immediate-future predictions, such as one or two weeks in advance, the predictive performance of <bold>VAR</bold>, a statistical model, had no significant difference from that of the machine-learning model. However, when predicting more than three weeks in advance, the performance of the statistical model declined sharply. <bold>LSTM</bold>, a neural network, achieved high <italic>R</italic><sup>2</sup> and <italic>MAE</italic> values considering temporal dependency. <bold>CNNRNN-Res</bold>, which combines a CNN and RNN using prefecture information, also achieved high performance similar to that of LSTM. However, the prediction performances of the two comparative models based on machine learning at more than four weeks ahead were insufficient. <bold>GCN+Seq2seq w/ PF</bold>, based on a GCN using commuting data, had a slightly better prediction performance for the number of influenza patients at one and two weeks as compared with the other models; it especially achieved much better performance for predictions more than four weeks in advance. These results indicate that our GCN model based on commuting data was the best model among various epidemic prediction models for regions and countries.</p>
              </sec>
              <sec id="sec028">
                <title>RQ1: Effectiveness of commuting data</title>
                <p>To answer RQ1 (Does commuting data improve the accuracy of the influenza prediction?), we compared GCN+Seq2seq w/ PF with the GCN+Seq2seq w/ AD and GCN+Seq2seq w/ DD models, which used adjacency and distance data instead of commuting data, respectively. GCN+Seq2seq w/ PF outperformed both variants. Specifically, as shown by the comparison between GCN+Seq2seq w/ PF and other baselines, such as the LSTM and CNNRNN-Res models, the effect of the commuting data on advanced predictions (such as the four or five week prediction) was higher than that on immediate future predictions (such as the one week prediction). The results demonstrate the advantages of considering PF between prefectures to improve predictions of the numbers of patients that might be affected by infectious diseases. Such flow and movement of people leads to the spread of influenza from person to person.</p>
                <p><xref ref-type="fig" rid="pone.0250417.g003">Fig 3</xref> shows examples of trained filters by GCN+Seq2seq w/ AD, w/ DD, and w/ PF centered at the Nara prefecture. The weights represent the importance of using inputs from other prefectures. Moreover, the weights by GCN+Seq2seq w/ PF reflect commuting data, as opposed to w/ AD and w/ DD. For example, the visualization by GCN+Seq2seq w/ PF indicates significant weights for Osaka (second-largest metropolitan prefecture in Japan) and relatively significant weights for Tokyo (capital of Japan) and Aichi (third-largest metropolitan prefecture in Japan), although these prefectures are far from Nara.</p>
                <fig id="pone.0250417.g003" orientation="portrait" position="float">
                  <object-id pub-id-type="doi">10.1371/journal.pone.0250417.g003</object-id>
                  <label>Fig 3</label>
                  <caption>
                    <title>Visualization of the weights of learned localized filters of <xref ref-type="disp-formula" rid="pone.0250417.e014">Eq (2)</xref> for (a) GCN+Seq2seq w/ PF, (b) GCN+Seq2seq w/ DD, and (c) GCN+Seq2seq w/ AD against the prediction target node (Nara prefecture, as shown by a star).</title>
                    <p>The colors represent the weights, i.e., strength of influence of each prefecture on the prediction of the target prefecture. The red prefectures are given assigned larger weights, i.e., they contribute significantly for to predicting the epidemics of in the target prefecture, while blue prefectures are given assigned smaller weights. Note that most prefectures are represented in white for visibility, as their weights are less than 5% of the maximum.</p>
                  </caption>
                  <graphic xlink:href="pone.0250417.g003"/>
                </fig>
              </sec>
              <sec id="sec029">
                <title>RQ2: Effectiveness of spatiotemporal model</title>
                <p>To answer RQ2 (when and in which areas does our model produce good results?), we divided it into two questions: “for which areas does our model produce good results” and “when does our model produce good results?”</p>
                <sec id="sec030">
                  <title>For which areas does our model produce good results?</title>
                  <p>For almost all prefectures, our model outperformed LSTM in terms of <italic>MAE</italic>. The model also provided a better performance over a wider space. We demonstrated the improvement of our model’s predictive performance compared with LSTM in terms of <italic>MAE</italic> in the best five and least five improved prefectures, as shown in <xref rid="pone.0250417.t003" ref-type="table">Table 3</xref>. Their locations are presented in <xref ref-type="fig" rid="pone.0250417.g004">Fig 4</xref>. These results demonstrate that GCN+Seq2seq w/ PF had a strong positive effect, such as maximizing the reduction in <italic>MAE</italic> by up to approximately 80%, for prediction of influenza patient numbers in any prefecture. The flow of people between different prefectures was the main factor that improved the accuracy of infection predictions.</p>
                  <table-wrap id="pone.0250417.t003" orientation="portrait" position="float">
                    <object-id pub-id-type="doi">10.1371/journal.pone.0250417.t003</object-id>
                    <label>Table 3</label>
                    <caption>
                      <title>Improvement percentage of our predictive performance compared with LSTM in terms of <italic>MAE</italic> in the five most and least improved prefectures.</title>
                      <p>Lower values indicate greater improvement because a lower <italic>MAE</italic> indicates better performance.</p>
                    </caption>
                    <alternatives>
                      <graphic id="pone.0250417.t003g" xlink:href="pone.0250417.t003"/>
                      <table frame="box" rules="all" border="0">
                        <colgroup span="1">
                          <col align="left" valign="middle" span="1"/>
                          <col align="left" valign="middle" span="1"/>
                          <col align="left" valign="middle" span="1"/>
                          <col align="left" valign="middle" span="1"/>
                          <col align="left" valign="middle" span="1"/>
                          <col align="left" valign="middle" span="1"/>
                          <col align="left" valign="middle" span="1"/>
                          <col align="left" valign="middle" span="1"/>
                          <col align="left" valign="middle" span="1"/>
                        </colgroup>
                        <thead>
                          <tr>
                            <th align="right" rowspan="2" colspan="1">Rank</th>
                            <th align="center" colspan="2" rowspan="1">2016/31st–2017/30th</th>
                            <th align="center" colspan="2" rowspan="1">2017/31st–2018/30th</th>
                            <th align="center" colspan="2" rowspan="1">2018/31st–2019/30th</th>
                            <th align="center" colspan="2" rowspan="1">2019/31st–2020/30th</th>
                          </tr>
                          <tr>
                            <th align="right" rowspan="2" colspan="1">Prefecture</th>
                            <th align="right" rowspan="1" colspan="1">Improve ment (%)</th>
                            <th align="right" rowspan="2" colspan="1">Prefecture</th>
                            <th align="right" rowspan="1" colspan="1">Improve ment (%)</th>
                            <th align="right" rowspan="2" colspan="1">Prefecture</th>
                            <th align="right" rowspan="1" colspan="1">Improve ment (%)</th>
                            <th align="right" rowspan="2" colspan="1">Prefecture</th>
                            <th align="right" rowspan="1" colspan="1">Improve ment (%)</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td align="right" rowspan="1" colspan="1">1</td>
                            <td align="right" rowspan="1" colspan="1">Tokushima</td>
                            <td align="char" char="." rowspan="1" colspan="1">-79.5</td>
                            <td align="right" rowspan="1" colspan="1">Aomori</td>
                            <td align="char" char="." rowspan="1" colspan="1">-46.1</td>
                            <td align="right" rowspan="1" colspan="1">Oita</td>
                            <td align="char" char="." rowspan="1" colspan="1">-50.7</td>
                            <td align="right" rowspan="1" colspan="1">Kochi</td>
                            <td align="char" char="." rowspan="1" colspan="1">-61.1</td>
                          </tr>
                          <tr>
                            <td align="right" rowspan="1" colspan="1">2</td>
                            <td align="right" rowspan="1" colspan="1">Kagawa</td>
                            <td align="char" char="." rowspan="1" colspan="1">-75.0</td>
                            <td align="right" rowspan="1" colspan="1">Nigata</td>
                            <td align="char" char="." rowspan="1" colspan="1">-45.5</td>
                            <td align="right" rowspan="1" colspan="1">Gunma</td>
                            <td align="char" char="." rowspan="1" colspan="1">-48.2</td>
                            <td align="right" rowspan="1" colspan="1">Kagoshima</td>
                            <td align="char" char="." rowspan="1" colspan="1">-60.5</td>
                          </tr>
                          <tr>
                            <td align="right" rowspan="1" colspan="1">3</td>
                            <td align="right" rowspan="1" colspan="1">Hiroshima</td>
                            <td align="char" char="." rowspan="1" colspan="1">-74.0</td>
                            <td align="right" rowspan="1" colspan="1">Fukui</td>
                            <td align="char" char="." rowspan="1" colspan="1">-39.9</td>
                            <td align="right" rowspan="1" colspan="1">Okayama</td>
                            <td align="char" char="." rowspan="1" colspan="1">-47.8</td>
                            <td align="right" rowspan="1" colspan="1">Wakayama</td>
                            <td align="char" char="." rowspan="1" colspan="1">-60.4</td>
                          </tr>
                          <tr>
                            <td align="right" rowspan="1" colspan="1">4</td>
                            <td align="right" rowspan="1" colspan="1">Okayama</td>
                            <td align="char" char="." rowspan="1" colspan="1">-69.8</td>
                            <td align="right" rowspan="1" colspan="1">Ishikawa</td>
                            <td align="char" char="." rowspan="1" colspan="1">-39.6</td>
                            <td align="right" rowspan="1" colspan="1">Ehime</td>
                            <td align="char" char="." rowspan="1" colspan="1">-47.6</td>
                            <td align="right" rowspan="1" colspan="1">Miyazaki</td>
                            <td align="char" char="." rowspan="1" colspan="1">-58.7</td>
                          </tr>
                          <tr>
                            <td align="right" rowspan="1" colspan="1">5</td>
                            <td align="right" rowspan="1" colspan="1">Yamaguchi</td>
                            <td align="char" char="." rowspan="1" colspan="1">-66.9</td>
                            <td align="right" rowspan="1" colspan="1">Toyama</td>
                            <td align="char" char="." rowspan="1" colspan="1">-38.7</td>
                            <td align="right" rowspan="1" colspan="1">Kagawa</td>
                            <td align="char" char="." rowspan="1" colspan="1">-47.2</td>
                            <td align="right" rowspan="1" colspan="1">Saga</td>
                            <td align="char" char="." rowspan="1" colspan="1">-55.7</td>
                          </tr>
                          <tr>
                            <td align="right" rowspan="1" colspan="1">43</td>
                            <td align="right" rowspan="1" colspan="1">Gifu</td>
                            <td align="char" char="." rowspan="1" colspan="1">-34.0</td>
                            <td align="right" rowspan="1" colspan="1">Okinawa</td>
                            <td align="char" char="." rowspan="1" colspan="1">-14.9</td>
                            <td align="right" rowspan="1" colspan="1">Shizuoka</td>
                            <td align="char" char="." rowspan="1" colspan="1">-17.3</td>
                            <td align="right" rowspan="1" colspan="1">Akita</td>
                            <td align="char" char="." rowspan="1" colspan="1">9.1</td>
                          </tr>
                          <tr>
                            <td align="right" rowspan="1" colspan="1">44</td>
                            <td align="right" rowspan="1" colspan="1">Shiga</td>
                            <td align="char" char="." rowspan="1" colspan="1">-32.3</td>
                            <td align="right" rowspan="1" colspan="1">Kyoto</td>
                            <td align="char" char="." rowspan="1" colspan="1">-12.5</td>
                            <td align="right" rowspan="1" colspan="1">Tokyo</td>
                            <td align="char" char="." rowspan="1" colspan="1">-14.5</td>
                            <td align="right" rowspan="1" colspan="1">Hukushima</td>
                            <td align="char" char="." rowspan="1" colspan="1">10.6</td>
                          </tr>
                          <tr>
                            <td align="right" rowspan="1" colspan="1">45</td>
                            <td align="right" rowspan="1" colspan="1">Fukushima</td>
                            <td align="char" char="." rowspan="1" colspan="1">-27.8</td>
                            <td align="right" rowspan="1" colspan="1">Kochi</td>
                            <td align="char" char="." rowspan="1" colspan="1">-11.6</td>
                            <td align="right" rowspan="1" colspan="1">Okinawa</td>
                            <td align="char" char="." rowspan="1" colspan="1">-13.1</td>
                            <td align="right" rowspan="1" colspan="1">Nagano</td>
                            <td align="char" char="." rowspan="1" colspan="1">14.4</td>
                          </tr>
                          <tr>
                            <td align="right" rowspan="1" colspan="1">46</td>
                            <td align="right" rowspan="1" colspan="1">Yamagata</td>
                            <td align="char" char="." rowspan="1" colspan="1">-24.2</td>
                            <td align="right" rowspan="1" colspan="1">Okayama</td>
                            <td align="char" char="." rowspan="1" colspan="1">-11.5</td>
                            <td align="right" rowspan="1" colspan="1">Yamaguchi</td>
                            <td align="char" char="." rowspan="1" colspan="1">-5.0</td>
                            <td align="right" rowspan="1" colspan="1">Aomori</td>
                            <td align="char" char="." rowspan="1" colspan="1">15.9</td>
                          </tr>
                          <tr>
                            <td align="right" rowspan="1" colspan="1">47</td>
                            <td align="right" rowspan="1" colspan="1">Okinawa</td>
                            <td align="char" char="." rowspan="1" colspan="1">-17.5</td>
                            <td align="right" rowspan="1" colspan="1">Shiga</td>
                            <td align="char" char="." rowspan="1" colspan="1">-9.1</td>
                            <td align="right" rowspan="1" colspan="1">Miyazaki</td>
                            <td align="char" char="." rowspan="1" colspan="1">1.6</td>
                            <td align="right" rowspan="1" colspan="1">Hokkaido</td>
                            <td align="char" char="." rowspan="1" colspan="1">20.5</td>
                          </tr>
                        </tbody>
                      </table>
                    </alternatives>
                  </table-wrap>
                  <fig id="pone.0250417.g004" orientation="portrait" position="float">
                    <object-id pub-id-type="doi">10.1371/journal.pone.0250417.g004</object-id>
                    <label>Fig 4</label>
                    <caption>
                      <title>Prefecture maps that illustrate the improvements of prediction accuracy measured by <italic>MAE</italic> in each prefecture, where the improvement ratios of GCN+Seq2seq w/ PF against LSTM are represented by colors.</title>
                      <p>Red denotes improved prefectures and blue denotes degraded prefectures. Prefectures enclosed in red and blue frames denote the five best and worst prefectures in each year, respectively. The small square at the corner of each map shows Okinawa prefecture.</p>
                    </caption>
                    <graphic xlink:href="pone.0250417.g004"/>
                  </fig>
                  <p>The next important question we want to address is “what factors lead to different results of our model, compared with LSTM, in different prefectures?” <xref ref-type="fig" rid="pone.0250417.g004">Fig 4</xref> reveals a strong relationship between locations of top-ranked prefectures (enclosed in red frames). These include four prefectures in 2016–2017, four in 2017–2018, and three in 2018–2019, which are contiguous. Hence, the GCN ensures a synergistic effect between contiguous regions. In contrast, <xref ref-type="fig" rid="pone.0250417.g004">Fig 4</xref> reveals that the locations of prefectures with the lowest ranks (blue frames) are unrelated, except for Okinawa. Okinawa has the lowest rank of improvement (<italic>MAE</italic>) compared with LSTM for almost every year. We assumed that this is due to the location of Okinawa, which is the southernmost prefecture and is surrounded by sea (rightmost island in <xref ref-type="fig" rid="pone.0250417.g004">Fig 4</xref>), implying that few commuters travel there from other prefectures. Therefore, the GCN does not affect the improvement of the predictive performance for Okinawa as much as other prefectures.</p>
                </sec>
                <sec id="sec031">
                  <title>When does our model produce good results?</title>
                  <p><xref ref-type="fig" rid="pone.0250417.g005">Fig 5</xref> shows the time series for Okayama with a relative <italic>MAE</italic> improvement compared with LSTM in four years. According to these results, GCN+Seq2seq w/ PF can identify the beginning of epidemics in specific regions. This is because it uses the GCN to learn the effects of influenza epidemics from other prefectures.</p>
                  <fig id="pone.0250417.g005" orientation="portrait" position="float">
                    <object-id pub-id-type="doi">10.1371/journal.pone.0250417.g005</object-id>
                    <label>Fig 5</label>
                    <caption>
                      <title>Time series for Okayama prefecture: (a) two weeks in advance, (b) three weeks in advance, (c) four weeks in advance, and (d) five weeks in advance prediction time series in Okayama.</title>
                      <p>The blue and green dotted lines indicate the prediction values of compared models. The red line indicates the prediction values of the proposed GCN+Seq2seq w/ PF model. The black Line indicates the actual influenza patients.</p>
                    </caption>
                    <graphic xlink:href="pone.0250417.g005"/>
                  </fig>
                  <p>All model predictions were lower than the true values at the peak of trends in 2018. In contrast, the results for 2020 seem to show the inverse; all model predictions were higher than the true values at the peak of trends. We assume that this tendency is due to the characteristics of machine-learning methods, which are designed to learn the data of most recent years. Evidently, in the seasons when epidemics grew much larger than in the previous years (as in 2018), these prediction models tended to underestimate the peak value. Furthermore, for seasons when the epidemics remained on a smaller scale than in the previous years, the models overestimated the peak value (as in 2020).</p>
                </sec>
              </sec>
              <sec id="sec032">
                <title>RQ3: Effectiveness of the proposed prediction interval estimation method</title>
                <p>We evaluated the quality of our interval estimation method for epidemic prediction and compared it with Zhu’s method to answer RQ3 (How effective is our uncertainty estimation method in real-world epidemic prediction?) We measured the average bandwidth, which indicates the number of patients included between the upper and lower limits of the prediction interval. We set the empirical coverage of the 95% prediction interval of each method as the validation of the prediction interval quality. This method aimed to provide good interval estimation, with a narrow average bandwidth and high empirical coverage. To search for a suitable window width <italic>W</italic>, we attempted to use various values (1, 3, 5, 7) in the experiment.</p>
                <p>The results are presented in <xref rid="pone.0250417.t004" ref-type="table">Table 4</xref>. The proposed method reduced the average bandwidth mark by 25%–32% compared to the conventional method; the empirical coverage was approximately 85%–91%, compared with that of Zhu’s method, which was approximately 89%–91%. These results demonstrate the effectiveness of our proposed method. Regarding the search for a suitable window width <italic>W</italic>, the average bandwidth and empirical coverage tended to increase as the window width increased. The value of the window width should be determined based on the problem characteristics. This is because there is a trade-off between the average bandwidth and empirical coverage. In this scenario, a window width (<italic>W</italic>) of 5 caused a 29%–34% reduction in the average bandwidth and approximately 1% reduction in the empirical coverage compared with those in Zhu’s method. Therefore, we assumed that a window width of 5 was sufficient.</p>
                <table-wrap id="pone.0250417.t004" orientation="portrait" position="float">
                  <object-id pub-id-type="doi">10.1371/journal.pone.0250417.t004</object-id>
                  <label>Table 4</label>
                  <caption>
                    <title>Average bandwidth and empirical coverage of the 95% prediction interval found using the proposed method and Zhu’s method.</title>
                  </caption>
                  <alternatives>
                    <graphic id="pone.0250417.t004g" xlink:href="pone.0250417.t004"/>
                    <table frame="box" rules="all" border="0">
                      <colgroup span="1">
                        <col align="left" valign="middle" span="1"/>
                        <col align="left" valign="middle" span="1"/>
                        <col align="left" valign="middle" span="1"/>
                        <col align="left" valign="middle" span="1"/>
                        <col align="left" valign="middle" span="1"/>
                        <col align="left" valign="middle" span="1"/>
                        <col align="left" valign="middle" span="1"/>
                      </colgroup>
                      <thead>
                        <tr>
                          <th align="center" rowspan="2" colspan="1"/>
                          <th align="right" rowspan="2" colspan="1"/>
                          <th align="right" rowspan="2" colspan="1">Zhu’s</th>
                          <th align="center" colspan="4" rowspan="1">Proposed (numbers correspond to <italic>W</italic>)</th>
                        </tr>
                        <tr>
                          <th align="right" rowspan="1" colspan="1">1</th>
                          <th align="right" rowspan="1" colspan="1">3</th>
                          <th align="right" rowspan="1" colspan="1">5</th>
                          <th align="left" rowspan="1" colspan="1">7</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td align="center" rowspan="5" colspan="1">Average band width</td>
                          <td align="right" rowspan="1" colspan="1">1-week</td>
                          <td align="char" char="." rowspan="1" colspan="1">966.64</td>
                          <td align="char" char="." rowspan="1" colspan="1">619.76</td>
                          <td align="char" char="." rowspan="1" colspan="1">652.87</td>
                          <td align="char" char="." rowspan="1" colspan="1">675.33</td>
                          <td align="char" char="." rowspan="1" colspan="1">696.09</td>
                        </tr>
                        <tr>
                          <td align="right" rowspan="1" colspan="1">2-week</td>
                          <td align="char" char="." rowspan="1" colspan="1">1472.79</td>
                          <td align="char" char="." rowspan="1" colspan="1">918.57</td>
                          <td align="char" char="." rowspan="1" colspan="1">974.97</td>
                          <td align="char" char="." rowspan="1" colspan="1">1016.89</td>
                          <td align="char" char="." rowspan="1" colspan="1">1054.74</td>
                        </tr>
                        <tr>
                          <td align="right" rowspan="1" colspan="1">3-week</td>
                          <td align="char" char="." rowspan="1" colspan="1">1798.09</td>
                          <td align="char" char="." rowspan="1" colspan="1">1069.76</td>
                          <td align="char" char="." rowspan="1" colspan="1">1136.20</td>
                          <td align="char" char="." rowspan="1" colspan="1">1190.87</td>
                          <td align="char" char="." rowspan="1" colspan="1">1240.26</td>
                        </tr>
                        <tr>
                          <td align="right" rowspan="1" colspan="1">4-week</td>
                          <td align="char" char="." rowspan="1" colspan="1">2051.89</td>
                          <td align="char" char="." rowspan="1" colspan="1">1224.23</td>
                          <td align="char" char="." rowspan="1" colspan="1">1302.95</td>
                          <td align="char" char="." rowspan="1" colspan="1">1371.27</td>
                          <td align="char" char="." rowspan="1" colspan="1">1434.28</td>
                        </tr>
                        <tr>
                          <td align="right" rowspan="1" colspan="1">5-week</td>
                          <td align="char" char="." rowspan="1" colspan="1">2151.01</td>
                          <td align="char" char="." rowspan="1" colspan="1">1351.16</td>
                          <td align="char" char="." rowspan="1" colspan="1">1443.91</td>
                          <td align="char" char="." rowspan="1" colspan="1">1529.80</td>
                          <td align="char" char="." rowspan="1" colspan="1">1610.46</td>
                        </tr>
                        <tr>
                          <td align="center" rowspan="5" colspan="1">Empirical coverage (%)</td>
                          <td align="right" rowspan="1" colspan="1">1-week</td>
                          <td align="char" char="." rowspan="1" colspan="1">91.14</td>
                          <td align="char" char="." rowspan="1" colspan="1">88.97</td>
                          <td align="char" char="." rowspan="1" colspan="1">90.37</td>
                          <td align="char" char="." rowspan="1" colspan="1">90.79</td>
                          <td align="char" char="." rowspan="1" colspan="1">91.40</td>
                        </tr>
                        <tr>
                          <td align="right" rowspan="1" colspan="1">2-week</td>
                          <td align="char" char="." rowspan="1" colspan="1">90.07</td>
                          <td align="char" char="." rowspan="1" colspan="1">85.96</td>
                          <td align="char" char="." rowspan="1" colspan="1">88.87</td>
                          <td align="char" char="." rowspan="1" colspan="1">89.11</td>
                          <td align="char" char="." rowspan="1" colspan="1">89.49</td>
                        </tr>
                        <tr>
                          <td align="right" rowspan="1" colspan="1">3-week</td>
                          <td align="char" char="." rowspan="1" colspan="1">90.00</td>
                          <td align="char" char="." rowspan="1" colspan="1">86.34</td>
                          <td align="char" char="." rowspan="1" colspan="1">87.11</td>
                          <td align="char" char="." rowspan="1" colspan="1">88.68</td>
                          <td align="char" char="." rowspan="1" colspan="1">88.85</td>
                        </tr>
                        <tr>
                          <td align="right" rowspan="1" colspan="1">4-week</td>
                          <td align="char" char="." rowspan="1" colspan="1">89.89</td>
                          <td align="char" char="." rowspan="1" colspan="1">86.45</td>
                          <td align="char" char="." rowspan="1" colspan="1">86.70</td>
                          <td align="char" char="." rowspan="1" colspan="1">88.45</td>
                          <td align="char" char="." rowspan="1" colspan="1">89.29</td>
                        </tr>
                        <tr>
                          <td align="right" rowspan="1" colspan="1">5-week</td>
                          <td align="char" char="." rowspan="1" colspan="1">89.87</td>
                          <td align="char" char="." rowspan="1" colspan="1">85.30</td>
                          <td align="char" char="." rowspan="1" colspan="1">86.26</td>
                          <td align="char" char="." rowspan="1" colspan="1">88.23</td>
                          <td align="char" char="." rowspan="1" colspan="1">88.38</td>
                        </tr>
                      </tbody>
                    </table>
                  </alternatives>
                </table-wrap>
                <p>We present a time series with a prediction interval using the proposed method in <xref ref-type="fig" rid="pone.0250417.g006">Fig 6(b)</xref>; the settings are the same as shown in <xref ref-type="fig" rid="pone.0250417.g006">Fig 6(a)</xref> using the conventional method in our model. The prediction interval’s width in <xref ref-type="fig" rid="pone.0250417.g006">Fig 6(b)</xref> decreases in a non-epidemic period when the true values do not escape from the interval; this increases the epidemic period. This study demonstrated applications of the proposed method to infection epidemics. Furthermore, this method can be useful for other periodic time series (such as traffic and sales volume). However, a shortcoming of this method is the requirement for periodicity in terms of validation. For example, for the application of the proposed method to influenza prediction, we require at least one year of validation data because the data have a periodicity of one year. This leads to the possibility of more validation data being required than in Zhu’s method.</p>
                <fig id="pone.0250417.g006" orientation="portrait" position="float">
                  <object-id pub-id-type="doi">10.1371/journal.pone.0250417.g006</object-id>
                  <label>Fig 6</label>
                  <caption>
                    <title>Time series with prediction interval of influenza patients (black line).</title>
                    <p>Predictive values of the two weeks in advance prediction by our proposed model (red line) in the Okayama prefecture. Prediction intervals by (a) Zhu’s method and (b) proposed method. Light blue and dark blue sections show the 95% and 50% prediction intervals, respectively.</p>
                  </caption>
                  <graphic xlink:href="pone.0250417.g006"/>
                </fig>
              </sec>
            </sec>
            <sec sec-type="conclusions" id="sec033">
              <title>Conclusion</title>
              <p>This study proposed a model for regional influenza prediction with uncertainty estimation by incorporating commuting data between regions. We conclude by emphasizing the following points: (1) We validated the use of PF as spatial information in a GCN for epidemic prediction. Our GCN-based model outperformed other baseline models. To the best of our knowledge, this is the first study to apply a GCN model to an epidemic prediction problem. (2) We proposed an uncertainty estimation method for periodic time series data, which reduced the prediction interval bandwidth.</p>
              <p>The proposed model with uncertainty estimation will contribute to the infection control measures of public health organizations. Nevertheless, more research could be conducted; specifically, future work can examine the use of user-generated content in neural networks to elucidate the dynamics of other geographically evolving epidemics.</p>
            </sec>
            <sec sec-type="supplementary-material" id="sec034">
              <title>Supporting information</title>
              <supplementary-material content-type="local-data" id="pone.0250417.s001">
                <label>S1 Fig</label>
                <caption>
                  <title>Boxplots of the distribution of the prediction scores in each prefecture.</title>
                  <p>This figure shows the boxplots of the distribution of the prediction scores (<italic>MAE</italic> and <italic>R</italic><sup>2</sup>) in each prefecture for the compared models. Each colored box indicates a different model; from left to right: VAR (cyan), LSTM (green), CNNRNN-Res (blue), GCN+S2s w/ AD (pink), GCN+S2s w/ DD (brown), and GCN+S2s w/ PF (red). The black center line in each box indicates the median value; the top and bottom of each box indicate the upper and lower quartiles, respectively; the whiskers indicate the maximum and minimum values; and the other points indicate outliers. For visualization, only MAE scores from 0 to 2000 and <italic>R</italic><sup>2</sup> scores from -1.0 to 1.0 are shown.</p>
                  <p>(TIF)</p>
                </caption>
                <media xlink:href="pone.0250417.s001.tif">
                  <caption>
                    <p>Click here for additional data file.</p>
                  </caption>
                </media>
              </supplementary-material>
            </sec>
          </body>
          <back>
            <ref-list>
              <title>References</title>
              <ref id="pone.0250417.ref001">
                <label>1</label>
                <mixed-citation publication-type="other">World Health Organization website, Influenza (seasonal) [cited 2 April 2019]. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.who.int/news-room/fact-sheets/detail/influenza-(seasonal)">http://www.who.int/news-room/fact-sheets/detail/influenza-(seasonal)</ext-link>.</mixed-citation>
              </ref>
              <ref id="pone.0250417.ref002">
                <label>2</label>
                <mixed-citation publication-type="journal"><name><surname>Molinari</surname><given-names>NA</given-names></name>, <name><surname>Ortega-Sanchez</surname><given-names>IR</given-names></name>, <name><surname>Messonnier</surname><given-names>ML</given-names></name>, <name><surname>Thompson</surname><given-names>WW</given-names></name>, <name><surname>Wortley</surname><given-names>PM</given-names></name>, <name><surname>Weintraub</surname><given-names>E</given-names></name>, <etal>et al</etal>. <article-title>The annual impact of seasonal influenza in the US: Measuring disease burden and costs</article-title>. <source>Vaccine</source>. <year>2007</year>;<volume>25</volume>(<issue>27</issue>): <fpage>5086</fpage>–<lpage>5096</lpage>
<pub-id pub-id-type="doi">10.1016/j.vaccine.2007.03.046</pub-id>
<?supplied-pmid 17544181?><pub-id pub-id-type="pmid">17544181</pub-id></mixed-citation>
              </ref>
              <ref id="pone.0250417.ref003">
                <label>3</label>
                <mixed-citation publication-type="journal"><name><surname>Tellier</surname><given-names>R</given-names></name>. <article-title>Transmission of influenza A in human beings</article-title>. <source>Lancet Infect Dis</source>. <year>2007</year>;<volume>7</volume>(<issue>12</issue>): <fpage>759</fpage>. <pub-id pub-id-type="doi">10.1016/S1473-3099(07)70269-4</pub-id><pub-id pub-id-type="pmid">18045555</pub-id></mixed-citation>
              </ref>
              <ref id="pone.0250417.ref004">
                <label>4</label>
                <mixed-citation publication-type="journal"><name><surname>Tellier</surname><given-names>R</given-names></name>. <article-title>Review of aerosol transmission of influenza A virus</article-title>. <source>Emerg Infect Dis</source>. <year>2006</year>;<volume>12</volume>(<issue>11</issue>): <fpage>1657</fpage>. <pub-id pub-id-type="doi">10.3201/eid1211.060426</pub-id><?supplied-pmid 17283614?><pub-id pub-id-type="pmid">17283614</pub-id></mixed-citation>
              </ref>
              <ref id="pone.0250417.ref005">
                <label>5</label>
                <mixed-citation publication-type="other">Senanayake R, Ramos F. Predicting Spatio-Temporal Propagation of Seasonal Influenza Using Variational Gaussian Process Regression. In Proceedings of AAAI, 3901–3907 (2016).</mixed-citation>
              </ref>
              <ref id="pone.0250417.ref006">
                <label>6</label>
                <mixed-citation publication-type="other">Wu Y, Yang Y, Nishiura H, Saitoh M. Deep Learning for Epidemiological Predictions. In Proceedings of SIGIR, 1085–1088 (2018).</mixed-citation>
              </ref>
              <ref id="pone.0250417.ref007">
                <label>7</label>
                <mixed-citation publication-type="journal"><name><surname>Venna</surname><given-names>SR</given-names></name>, <name><surname>Tavanaei</surname><given-names>A</given-names></name>, <name><surname>Gottumukkala</surname><given-names>RN</given-names></name>, <name><surname>Raghavan</surname><given-names>VV</given-names></name>, <name><surname>Maida</surname><given-names>AS</given-names></name>, <name><surname>Nichols</surname><given-names>S</given-names></name>. <article-title>A Novel Data-driven Model for Real-Time Influenza Forecasting</article-title>. <source>IEEE Access</source>. <year>2019</year>;<volume>7</volume>: <fpage>7691</fpage>–<lpage>7701</lpage>. <pub-id pub-id-type="doi">10.1109/ACCESS.2018.2888585</pub-id></mixed-citation>
              </ref>
              <ref id="pone.0250417.ref008">
                <label>8</label>
                <mixed-citation publication-type="other">Liu L, Han M, Zhou Y, Wang Y. LSTM Recurrent Neural Networks for Influenza Trends Prediction. In International Symposium on Bioinformatics Research and Applications, 259–264 (2018).</mixed-citation>
              </ref>
              <ref id="pone.0250417.ref009">
                <label>9</label>
                <mixed-citation publication-type="other">Zhu L, Laptev N. Deep and confident prediction for time series at uber. In Proceedings of ICDMW, 103–110 (2017).</mixed-citation>
              </ref>
              <ref id="pone.0250417.ref010">
                <label>10</label>
                <mixed-citation publication-type="journal"><name><surname>Hethcote</surname><given-names>HW</given-names></name>. <article-title>The mathematics of infectious diseases</article-title>. <source>SIAM Review</source>. <year>2000</year>;<volume>42</volume>(<issue>4</issue>): <fpage>599</fpage>–<lpage>653</lpage>. <pub-id pub-id-type="doi">10.1137/S0036144500371907</pub-id></mixed-citation>
              </ref>
              <ref id="pone.0250417.ref011">
                <label>11</label>
                <mixed-citation publication-type="journal"><name><surname>Nasserie</surname><given-names>T</given-names></name>, <name><surname>Tuite</surname><given-names>AR</given-names></name>, <name><surname>Whitmore</surname><given-names>L</given-names></name>, <name><surname>Hatchette</surname><given-names>T</given-names></name>, <name><surname>Drews</surname><given-names>SJ</given-names></name>, <name><surname>Peci</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Seasonal Influenza Forecasting in Real Time Using the Incidence Decay With Exponential Adjustment Model</article-title>. <source>Open Forum Infect Dis</source>. <year>2017</year>;<volume>4</volume>(<issue>3</issue>). <pub-id pub-id-type="doi">10.1093/ofid/ofx166</pub-id><?supplied-pmid 29497629?><pub-id pub-id-type="pmid">29497629</pub-id></mixed-citation>
              </ref>
              <ref id="pone.0250417.ref012">
                <label>12</label>
                <mixed-citation publication-type="journal"><name><surname>Santillana</surname><given-names>M</given-names></name>, <name><surname>Nguyen</surname><given-names>AT</given-names></name>, <name><surname>Dredze</surname><given-names>M</given-names></name>, <name><surname>Paul</surname><given-names>MJ</given-names></name>, <name><surname>Nsoesie</surname><given-names>EO</given-names></name>, <name><surname>Brownstein</surname><given-names>JS</given-names></name>. <article-title>Combining search, social media, and traditional data sources to improve influenza surveillance</article-title>. <source>PLoS Comput Biol</source>. <year>2015</year>;<volume>11</volume>(<issue>10</issue>): <fpage>e1004513</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pcbi.1004513</pub-id><pub-id pub-id-type="pmid">26513245</pub-id></mixed-citation>
              </ref>
              <ref id="pone.0250417.ref013">
                <label>13</label>
                <mixed-citation publication-type="journal"><name><surname>Dugas</surname><given-names>AF</given-names></name>, <name><surname>Jalalpour</surname><given-names>M</given-names></name>, <name><surname>Gel</surname><given-names>Y</given-names></name>, <name><surname>Levin</surname><given-names>S</given-names></name>, <name><surname>Torcaso</surname><given-names>F</given-names></name>, <name><surname>Igusa</surname><given-names>T</given-names></name>, <etal>et al</etal>. <article-title>Influenza forecasting with Google flu trends</article-title>. <source>PloS One</source>. <year>2013</year>;<volume>8</volume>(<issue>2</issue>): <fpage>e56176</fpage>.<pub-id pub-id-type="pmid">23457520</pub-id></mixed-citation>
              </ref>
              <ref id="pone.0250417.ref014">
                <label>14</label>
                <mixed-citation publication-type="journal"><name><surname>Yang</surname><given-names>S</given-names></name>, <name><surname>Santillana</surname><given-names>M</given-names></name>, <name><surname>Kou</surname><given-names>SC</given-names></name>. <article-title>Accurate estimation of influenza epidemics using Google search data via ARGO</article-title>. In <source>Proceedings of the National Academy of Sciences</source>, <volume>112</volume>(<issue>47</issue>), <fpage>14473</fpage>–<lpage>14478</lpage> (<year>2015</year>). <pub-id pub-id-type="doi">10.1073/pnas.1515373112</pub-id>
<?supplied-pmid 26553980?><pub-id pub-id-type="pmid">26553980</pub-id></mixed-citation>
              </ref>
              <ref id="pone.0250417.ref015">
                <label>15</label>
                <mixed-citation publication-type="journal"><name><surname>Lu</surname><given-names>FS</given-names></name>, <name><surname>Hattab</surname><given-names>MW</given-names></name>, <name><surname>Clemente</surname><given-names>CL</given-names></name>, <name><surname>Biggerstaff</surname><given-names>M</given-names></name>, <name><surname>Santillana</surname><given-names>M</given-names></name>. <article-title>Improved state-level influenza nowcasting in the United States leveraging Internet-based data and network approaches</article-title>. <source>Nat Commun</source>. <year>2019</year>;<volume>10</volume>(<issue>1</issue>): <fpage>1</fpage>–<lpage>10</lpage>.<pub-id pub-id-type="pmid">30602773</pub-id></mixed-citation>
              </ref>
              <ref id="pone.0250417.ref016">
                <label>16</label>
                <mixed-citation publication-type="journal"><name><surname>Ning</surname><given-names>S</given-names></name>, <name><surname>Yang</surname><given-names>S</given-names></name>, <name><surname>Kou</surname><given-names>SC</given-names></name>. <article-title>Accurate regional influenza epidemics tracking using Internet search data</article-title>. <source>Sci Rep</source>. <year>2019</year>;<volume>9</volume>(<issue>1</issue>): <fpage>1</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">30626917</pub-id></mixed-citation>
              </ref>
              <ref id="pone.0250417.ref017">
                <label>17</label>
                <mixed-citation publication-type="journal"><name><surname>Aiken</surname><given-names>EL</given-names></name>, <name><surname>McGough</surname><given-names>SF</given-names></name>, <name><surname>Majumder</surname><given-names>MS</given-names></name>, <name><surname>Wachtel</surname><given-names>G</given-names></name>, <name><surname>Nguyen</surname><given-names>AT</given-names></name>, <name><surname>Viboud</surname><given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Real-time estimation of disease activity in emerging outbreaks using internet search information</article-title>. <source>PLoS Comput Biol</source>. <year>2020</year>;<volume>16</volume>(<issue>8</issue>): <fpage>e1008117</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pcbi.1008117</pub-id><pub-id pub-id-type="pmid">32804932</pub-id></mixed-citation>
              </ref>
              <ref id="pone.0250417.ref018">
                <label>18</label>
                <mixed-citation publication-type="journal"><name><surname>Santos</surname><given-names>JC</given-names></name>, <name><surname>Matos</surname><given-names>S</given-names></name>. <article-title>Analysing Twitter and web queries for flu trend prediction</article-title>. <source>Theor Biol Med Model</source>. <year>2014</year>;<volume>11</volume>(<issue>1</issue>): <fpage>S6</fpage>.<pub-id pub-id-type="pmid">25077431</pub-id></mixed-citation>
              </ref>
              <ref id="pone.0250417.ref019">
                <label>19</label>
                <mixed-citation publication-type="journal"><name><surname>Polgreen</surname><given-names>PM</given-names></name>, <name><surname>Pennock</surname><given-names>DM</given-names></name>, <name><surname>Nelson</surname><given-names>FD</given-names></name>. <article-title>Using internet searches for influenza surveillance</article-title>. <source>Clin Infect Dis</source>. <year>2018</year>;<volume>47</volume>(<issue>11</issue>): <fpage>1443</fpage>–<lpage>1448</lpage>.</mixed-citation>
              </ref>
              <ref id="pone.0250417.ref020">
                <label>20</label>
                <mixed-citation publication-type="journal"><name><surname>Wu</surname><given-names>H</given-names></name>, <name><surname>Cai</surname><given-names>Y</given-names></name>, <name><surname>Wu</surname><given-names>Y</given-names></name>, <name><surname>Zhong</surname><given-names>R</given-names></name>, <name><surname>Li</surname><given-names>Q</given-names></name>, <name><surname>Zheng</surname><given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Time series analysis of weekly influenza-like illness rate using a one-year period of factors in random forest regression</article-title>. <source>Biosci Trends</source>. <year>2017</year>;<volume>11</volume>(<issue>3</issue>): <fpage>292</fpage>–<lpage>296</lpage>. <pub-id pub-id-type="doi">10.5582/bst.2017.01035</pub-id>
<?supplied-pmid 28484187?><pub-id pub-id-type="pmid">28484187</pub-id></mixed-citation>
              </ref>
              <ref id="pone.0250417.ref021">
                <label>21</label>
                <mixed-citation publication-type="other">Zou B, Lampos V, Cox I. Multi-task learning improves disease models from web search. In Proceedings of the International Conference on World Wide Web, 87–96 (2018).</mixed-citation>
              </ref>
              <ref id="pone.0250417.ref022">
                <label>22</label>
                <mixed-citation publication-type="journal"><name><surname>Volkova</surname><given-names>S</given-names></name>, <name><surname>Ayton</surname><given-names>E</given-names></name>, <name><surname>Porterfield</surname><given-names>K</given-names></name>, <name><surname>Corley</surname><given-names>CD</given-names></name>. <article-title>Forecasting influenza-like illness dynamics for military populations using neural networks and social media</article-title>. <source>PLoS One</source>. <year>2017</year>;<volume>12</volume>(<issue>12</issue>) <fpage>e0188941</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0188941</pub-id><pub-id pub-id-type="pmid">29244814</pub-id></mixed-citation>
              </ref>
              <ref id="pone.0250417.ref023">
                <label>23</label>
                <mixed-citation publication-type="other">Zou B, Lampos V, Cox I. Transfer learning for unsupervised influenza-like illness models from online search data. In Proceedings of the World Wide Web Conference, 2505–2516 (2019).</mixed-citation>
              </ref>
              <ref id="pone.0250417.ref024">
                <label>24</label>
                <mixed-citation publication-type="journal">Ginsberg J <etal>et al</etal>. <article-title>Detecting influenza epidemics using search engine query data</article-title>. <source>Nature</source>. <year>2009</year>;<volume>457</volume>(<issue>7232</issue>): <fpage>1012</fpage>–<lpage>1014</lpage>. <pub-id pub-id-type="doi">10.1038/nature07634</pub-id>
<?supplied-pmid 19020500?><pub-id pub-id-type="pmid">19020500</pub-id></mixed-citation>
              </ref>
              <ref id="pone.0250417.ref025">
                <label>25</label>
                <mixed-citation publication-type="other">Aramaki E, Maskawa S, Morita M. Twitter catches the flu: detecting influenza epidemics using Twitter. In Proceedings of EMNLP, 1568–1576 (2011).</mixed-citation>
              </ref>
              <ref id="pone.0250417.ref026">
                <label>26</label>
                <mixed-citation publication-type="journal"><name><surname>Paul</surname><given-names>MJ</given-names></name>, <name><surname>Dredze</surname><given-names>M</given-names></name>, <name><surname>Broniatowski</surname><given-names>D</given-names></name>. <article-title>Twitter improves influenza forecasting</article-title>. <source>PLoS Curr</source>. <year>2014</year>;<volume>6</volume>.</mixed-citation>
              </ref>
              <ref id="pone.0250417.ref027">
                <label>27</label>
                <mixed-citation publication-type="other">Culotta A. Towards detecting influenza epidemics by analysing Twitter messages. In Proceedings of the First Workshop on Social Media Analytics, 115–122 (2010).</mixed-citation>
              </ref>
              <ref id="pone.0250417.ref028">
                <label>28</label>
                <mixed-citation publication-type="journal"><name><surname>Eysenbach</surname><given-names>G</given-names></name>. <article-title>Infodemiology and infoveillance: framework for an emerging set of public health informatics methods to analyze search, communication and publication behavior on the Internet</article-title>. <source>J Med Internet Res</source>. <year>2009</year>;<volume>11</volume>(<issue>1</issue>). <pub-id pub-id-type="doi">10.2196/jmir.1157</pub-id><?supplied-pmid 19329408?><pub-id pub-id-type="pmid">19329408</pub-id></mixed-citation>
              </ref>
              <ref id="pone.0250417.ref029">
                <label>29</label>
                <mixed-citation publication-type="journal"><name><surname>Signorini</surname><given-names>A</given-names></name>, <name><surname>Segre</surname><given-names>AM</given-names></name>, <name><surname>Polgreen</surname><given-names>PM</given-names></name>. <article-title>The use of Twitter to track levels of disease activity and public concern in the US during the influenza A H1N1 pandemic</article-title>. <source>PloS One</source>. <year>2011</year>;<volume>6</volume>(<issue>5</issue>): <fpage>e19467</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0019467</pub-id><pub-id pub-id-type="pmid">21573238</pub-id></mixed-citation>
              </ref>
              <ref id="pone.0250417.ref030">
                <label>30</label>
                <mixed-citation publication-type="journal"><name><surname>Sharpe</surname><given-names>JD</given-names></name>, <name><surname>Hopkins</surname><given-names>RS</given-names></name>, <name><surname>Cook</surname><given-names>RL</given-names></name>, <name><surname>Striley</surname><given-names>CW</given-names></name>. <article-title>Evaluating Google, Twitter, and Wikipedia as tools for influenza surveillance using Bayesian change point analysis: A comparative analysis</article-title>. <source>JMIR Public Health Surveill</source>. <year>2016</year>;<volume>2</volume>(<issue>2</issue>): <fpage>e161</fpage>. <pub-id pub-id-type="doi">10.2196/publichealth.5901</pub-id><pub-id pub-id-type="pmid">27765731</pub-id></mixed-citation>
              </ref>
              <ref id="pone.0250417.ref031">
                <label>31</label>
                <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>J</given-names></name>, <name><surname>Nawata</surname><given-names>K</given-names></name>. <article-title>A comparative study on predicting influenza outbreaks</article-title>. <source>Biosci Trends</source>. <year>2017</year>;<volume>11</volume>(<issue>5</issue>): <fpage>533</fpage>–<lpage>541</lpage>. <pub-id pub-id-type="doi">10.5582/bst.2017.01257</pub-id><pub-id pub-id-type="pmid">29070762</pub-id></mixed-citation>
              </ref>
              <ref id="pone.0250417.ref032">
                <label>32</label>
                <mixed-citation publication-type="other">Wang L, Chen J, Marathe M. DEFSI: Deep learning based epidemic forecasting with synthetic information. In Proceedings of the AAAI Conference on Artificial Intelligence, 9607–9612 (2019).</mixed-citation>
              </ref>
              <ref id="pone.0250417.ref033">
                <label>33</label>
                <mixed-citation publication-type="other">Wu N, Green B, Ben X, O’Banion S. Deep transformer models for time series forecasting: The influenza prevalence case. arXiv:2001.08317 2020 [cited 21 Oct 2020]. Available from: <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/2001.08317">https://arxiv.org/abs/2001.08317</ext-link></mixed-citation>
              </ref>
              <ref id="pone.0250417.ref034">
                <label>34</label>
                <mixed-citation publication-type="journal"><name><surname>Lowen</surname><given-names>AC</given-names></name>, <name><surname>Steel</surname><given-names>J</given-names></name>. <article-title>Roles of humidity and temperature in shaping influenza seasonality</article-title>. <source>J Virol</source>. <year>2014</year>;<volume>88</volume>(<issue>14</issue>): <fpage>7692</fpage>–<lpage>7695</lpage>. <pub-id pub-id-type="doi">10.1128/JVI.03544-13</pub-id><pub-id pub-id-type="pmid">24789791</pub-id></mixed-citation>
              </ref>
              <ref id="pone.0250417.ref035">
                <label>35</label>
                <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>F</given-names></name>, <name><surname>Wang</surname><given-names>J</given-names></name>, <name><surname>Liu</surname><given-names>J</given-names></name>, <name><surname>Li</surname><given-names>Y</given-names></name>, <name><surname>Liu</surname><given-names>D</given-names></name>, <name><surname>Tong</surname><given-names>J</given-names></name>. <article-title>Predicting and analyzing the COVID-19 epidemic in China: Based on SEIRD, LSTM and GWR models</article-title>. <source>PLoS ONE</source>. <year>2020</year>;<volume>15</volume>(<issue>8</issue>): <fpage>e0238280</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0238280</pub-id><pub-id pub-id-type="pmid">32853285</pub-id></mixed-citation>
              </ref>
              <ref id="pone.0250417.ref036">
                <label>36</label>
                <mixed-citation publication-type="journal"><name><surname>Brockmann</surname><given-names>D</given-names></name>, <name><surname>Helbing</surname><given-names>D</given-names></name>. <article-title>The hidden geometry of complex, network-driven contagion phenomena</article-title>. <source>Science</source>. <year>2013</year>;<volume>342</volume>(<issue>6164</issue>): <fpage>1337</fpage>–<lpage>1342</lpage>.<pub-id pub-id-type="pmid">24337289</pub-id></mixed-citation>
              </ref>
              <ref id="pone.0250417.ref037">
                <label>37</label>
                <mixed-citation publication-type="other">Wang J, Wang X, Wu J. Inferring metapopulation propagation network for intra-city epidemic control and prevention. In Proceedings of the ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining, 830–838 (2018).</mixed-citation>
              </ref>
              <ref id="pone.0250417.ref038">
                <label>38</label>
                <mixed-citation publication-type="book"><name><surname>Cressie</surname><given-names>N</given-names></name>, <name><surname>Wikle</surname><given-names>CK</given-names></name>. <source>Statistics for spatio-temporal data</source>. <publisher-name>John Wiley &amp; Sons</publisher-name>; <year>2015</year>.</mixed-citation>
              </ref>
              <ref id="pone.0250417.ref039">
                <label>39</label>
                <mixed-citation publication-type="journal"><name><surname>Wikle</surname><given-names>CK</given-names></name>. <article-title>Modern perspectives on statistics for spatio-temporal data</article-title>. <source>WIREs: Computat Stat</source>. <year>2015</year>;<volume>7</volume>(<issue>1</issue>): <fpage>86</fpage>–<lpage>98</lpage>.</mixed-citation>
              </ref>
              <ref id="pone.0250417.ref040">
                <label>40</label>
                <mixed-citation publication-type="other">Matsubara Y, Sakurai Y, Van Panhuis WG, Faloutsos C. FUNNEL: automatic mining of spatially coevolving epidemics. In Proceedings of SIGKDD, 105–114 (2014).</mixed-citation>
              </ref>
              <ref id="pone.0250417.ref041">
                <label>41</label>
                <mixed-citation publication-type="other">Koppula H, Saxena A. Learning spatio-temporal structure from rgb-d videos for human activity detection and anticipation. In Proceedings of ICML, 792–800 (2013).</mixed-citation>
              </ref>
              <ref id="pone.0250417.ref042">
                <label>42</label>
                <mixed-citation publication-type="other">Bruna J, Zaremba W, Szlam A, LeCun Y. Spectral networks and locally connected networks on graphs. arXiv:1312.6203 2013 [cited 21 Oct 2020]. Available from: <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1312.6203">https://arxiv.org/abs/1312.6203</ext-link></mixed-citation>
              </ref>
              <ref id="pone.0250417.ref043">
                <label>43</label>
                <mixed-citation publication-type="other">Peng H, Li J, He Y, Liu Y, Bao M, Wang L. Large-Scale Hierarchical Text Classification with Recursively Regularized Deep Graph-CNN. In Proceedings of World Wide Web Conference, 1063–1072 (2018).</mixed-citation>
              </ref>
              <ref id="pone.0250417.ref044">
                <label>44</label>
                <mixed-citation publication-type="other">Wang X, Ye Y, Gupta A. Zero-shot Recognition via Semantic Embeddings and Knowledge Graphs. In Proceedings of CVPR, 6857–6866 (2018).</mixed-citation>
              </ref>
              <ref id="pone.0250417.ref045">
                <label>45</label>
                <mixed-citation publication-type="other">Duvenaud DK, Maclaurin D, Aguilera-Iparraguirre J, Gómez-Bombarelli R, Hirzel T, Aspuru-Guzik A, et al. Convolutional networks on graphs for learning molecular fingerprints. In Proceedings of NIPS, 2224–2232, (2015).</mixed-citation>
              </ref>
              <ref id="pone.0250417.ref046">
                <label>46</label>
                <mixed-citation publication-type="other">Chai D, Wang L, Yang Q. Bike flow prediction with multi-graph convolutional networks. In Proceedings of SIGSPATIAL, 397–400 (2018).</mixed-citation>
              </ref>
              <ref id="pone.0250417.ref047">
                <label>47</label>
                <mixed-citation publication-type="other">Yu B, Yin H, Zhu Z. Spatio-temporal graph convolutional networks: A deep learning framework for traffic forecasting. arXiv:1709.04875 [Preprint]. 2017 [cited 21 Oct 2020]. Available from: <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1709.04875">https://arxiv.org/abs/1709.04875</ext-link></mixed-citation>
              </ref>
              <ref id="pone.0250417.ref048">
                <label>48</label>
                <mixed-citation publication-type="other">Hernández-Lobato, JM, Adams R. Probabilistic backpropagation for scalable learning of bayesian neural networks. In Proceedings of ICML, 1861–1869 (2015).</mixed-citation>
              </ref>
              <ref id="pone.0250417.ref049">
                <label>49</label>
                <mixed-citation publication-type="other">Paisley J, Blei D, Jordan M. Variational Bayesian inference with stochastic search. arXiv:1206.6430 [Preprint]. 2012 [cited 21 Oct 2020]. Available from: <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1206.6430">https://arxiv.org/abs/1206.6430</ext-link></mixed-citation>
              </ref>
              <ref id="pone.0250417.ref050">
                <label>50</label>
                <mixed-citation publication-type="other">Gal Y, Ghahrmani Z. Dropout as a Bayesian approximation: Representing model uncertainty in deep learning. In Proceedings of ICML, 1050–1059 (2016).</mixed-citation>
              </ref>
              <ref id="pone.0250417.ref051">
                <label>51</label>
                <mixed-citation publication-type="other">Li Y, Yu R, Shahabi C, Liu Y. Diffusion convolutional recurrent neural network: Data-driven traffic forecasting. In Proceedings of ICLR, (2018).</mixed-citation>
              </ref>
              <ref id="pone.0250417.ref052">
                <label>52</label>
                <mixed-citation publication-type="other">Molitierno, JJ. Applications of combinatorial matrix theory to Laplacian matrices of graphs. CRC Press (2016).</mixed-citation>
              </ref>
              <ref id="pone.0250417.ref053">
                <label>53</label>
                <mixed-citation publication-type="other">Klicpera, J, Weißenberger S, Günnemann S. Diffusion improves graph learning. In Proceedings of NeurIPS (2019).</mixed-citation>
              </ref>
              <ref id="pone.0250417.ref054">
                <label>54</label>
                <mixed-citation publication-type="other">Defferrard M, Bresson X, Vandergheynst P. Convolutional neural networks on graphs with fast localized spectral filtering. In Proceedings of NIPS, 3844–3852 (2016).</mixed-citation>
              </ref>
              <ref id="pone.0250417.ref055">
                <label>55</label>
                <mixed-citation publication-type="other">Chung J, Gulcehre C, Cho K, Bengio Y. Empirical evaluation of gated recurrent neural networks on sequence modeling. arXiv:1412.3555 [Preprint]. 2014 [cited]. Available from: <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1412.3555">https://arxiv.org/abs/1412.3555</ext-link></mixed-citation>
              </ref>
              <ref id="pone.0250417.ref056">
                <label>56</label>
                <mixed-citation publication-type="other">He K, Zhang X, Ren S, Sun J. Deep residual learning for image recognition. In Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition, 770–778 (2016).</mixed-citation>
              </ref>
              <ref id="pone.0250417.ref057">
                <label>57</label>
                <mixed-citation publication-type="other">Bengio S, Vinyals O, Jaitly N, Shazeer N. Scheduled sampling for sequence prediction with recurrent neural networks. In Proceedings of NIPS, 1171–1179 (2015).</mixed-citation>
              </ref>
              <ref id="pone.0250417.ref058">
                <label>58</label>
                <mixed-citation publication-type="other">The National Institute of Infectious Diseases [cited 21 Oct 2020]. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.niid.go.jp/niid/ja/idwr.html">https://www.niid.go.jp/niid/ja/idwr.html</ext-link>.</mixed-citation>
              </ref>
              <ref id="pone.0250417.ref059">
                <label>59</label>
                <mixed-citation publication-type="other">The National Census Report of 27th year of the Heisei period [cited 21 Oct 2020] Available from: <ext-link ext-link-type="uri" xlink:href="https://www.stat.go.jp/data/kokusei/2015/kekka.html">https://www.stat.go.jp/data/kokusei/2015/kekka.html</ext-link>.</mixed-citation>
              </ref>
              <ref id="pone.0250417.ref060">
                <label>60</label>
                <mixed-citation publication-type="book"><name><surname>Das</surname><given-names>S</given-names></name>. <source>Time series analysis</source>. <publisher-name>Princeton University Press</publisher-name>; <year>1994</year>.</mixed-citation>
              </ref>
              <ref id="pone.0250417.ref061">
                <label>61</label>
                <mixed-citation publication-type="other">Sutskever I, Vinyals O, Le QV. Sequence to sequence learning with neural networks. In Advances in Neural Information Processing Systems, 3104–3112 (2014).</mixed-citation>
              </ref>
              <ref id="pone.0250417.ref062">
                <label>62</label>
                <mixed-citation publication-type="other">Huang G, Liu Z, Van Der Maaten L, Weinberger KQ. Densely connected convolutional networks. In Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition, 4700–4708 (2017).</mixed-citation>
              </ref>
            </ref-list>
          </back>
          <sub-article id="pone.0250417.r001" article-type="aggregated-review-documents">
            <front-stub>
              <article-id pub-id-type="doi">10.1371/journal.pone.0250417.r001</article-id>
              <title-group>
                <article-title>Decision Letter 0</article-title>
              </title-group>
              <contrib-group>
                <contrib contrib-type="author">
                  <name>
                    <surname>Wen</surname>
                    <given-names>Tzai-Hung</given-names>
                  </name>
                  <role>Academic Editor</role>
                </contrib>
              </contrib-group>
              <permissions>
                <copyright-statement>© 2021 Tzai-Hung Wen</copyright-statement>
                <copyright-year>2021</copyright-year>
                <copyright-holder>Tzai-Hung Wen</copyright-holder>
                <license>
                  <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
                  <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
                </license>
              </permissions>
              <related-article id="rel-obj001" ext-link-type="doi" xlink:href="10.1371/journal.pone.0250417" related-article-type="reviewed-article"/>
              <custom-meta-group>
                <custom-meta>
                  <meta-name>Submission Version</meta-name>
                  <meta-value>0</meta-value>
                </custom-meta>
              </custom-meta-group>
            </front-stub>
            <body>
              <p>
                <named-content content-type="letter-date">23 Sep 2020</named-content>
              </p>
              <p>PONE-D-20-20268</p>
              <p>Predicting Regional Influenza Epidemics with Uncertainty Estimation using Commuting Data in Japan</p>
              <p>PLOS ONE</p>
              <p>Dear Dr. Murayama,</p>
              <p>Thank you for submitting your manuscript to PLOS ONE. After careful consideration, we feel that it has merit but does not fully meet PLOS ONE’s publication criteria as it currently stands. Therefore, we invite you to submit a revised version of the manuscript that addresses the points raised during the review process.</p>
              <p>Please submit your revised manuscript by Nov 07 2020 11:59PM. If you will need more time than this to complete your revisions, please reply to this message or contact the journal office at <email>plosone@plos.org</email>. When you're ready to submit your revision, log on to <ext-link ext-link-type="uri" xlink:href="https://www.editorialmanager.com/pone/">https://www.editorialmanager.com/pone/</ext-link> and select the 'Submissions Needing Revision' folder to locate your manuscript file.</p>
              <p>Please include the following items when submitting your revised manuscript:</p>
              <p>
                <list list-type="bullet">
                  <list-item>
                    <p>A rebuttal letter that responds to each point raised by the academic editor and reviewer(s). You should upload this letter as a separate file labeled 'Response to Reviewers'.</p>
                  </list-item>
                  <list-item>
                    <p>A marked-up copy of your manuscript that highlights changes made to the original version. You should upload this as a separate file labeled 'Revised Manuscript with Track Changes'.</p>
                  </list-item>
                  <list-item>
                    <p>An unmarked version of your revised paper without tracked changes. You should upload this as a separate file labeled 'Manuscript'.</p>
                  </list-item>
                </list>
              </p>
              <p>If you would like to make changes to your financial disclosure, please include your updated statement in your cover letter. Guidelines for resubmitting your figure files are available below the reviewer comments at the end of this letter.</p>
              <p>If applicable, we recommend that you deposit your laboratory protocols in protocols.io to enhance the reproducibility of your results. Protocols.io assigns your protocol its own identifier (DOI) so that it can be cited independently in the future. For instructions see: <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols">http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols</ext-link></p>
              <p>We look forward to receiving your revised manuscript.</p>
              <p>Kind regards,</p>
              <p>Tzai-Hung Wen, Ph.D.</p>
              <p>Academic Editor</p>
              <p>PLOS ONE</p>
              <p>Journal Requirements:</p>
              <p>When submitting your revision, we need you to address these additional requirements.</p>
              <p>1. Please ensure that your manuscript meets PLOS ONE's style requirements, including those for file naming. The PLOS ONE style templates can be found at</p>
              <p><ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/plosone/s/file?id=wjVg/PLOSOne_formatting_sample_main_body.pdf">https://journals.plos.org/plosone/s/file?id=wjVg/PLOSOne_formatting_sample_main_body.pdf</ext-link> and</p>
              <p>
                <ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/plosone/s/file?id=ba62/PLOSOne_formatting_sample_title_authors_affiliations.pdf">https://journals.plos.org/plosone/s/file?id=ba62/PLOSOne_formatting_sample_title_authors_affiliations.pdf</ext-link>
              </p>
              <p>2. Please provide more information on the data used in your study. Specifically please report the following in your methods section:</p>
              <p>     - Influenza data: date range of influenza cases chosen for this study, the date the data was accessed, the identification numbers of the entries or link to where the data can be found</p>
              <p>     - Commuting data: the date the data was accessed, the identification numbers of the entries or link to where the data can be found</p>
              <p>In addition, in your methods section and ethics statement, please clarify whether all data were fully anonymized before you accessed them.</p>
              <p>3. Thank you for stating the following in the Financial Disclosure section:</p>
              <p>"This study was supported in part by Yahoo Japan Corporation.</p>
              <p>The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript"</p>
              <p>We note that one or more of the authors have an affiliation to the commercial funders of this research study : Yahoo Japan Corporation.</p>
              <p>3.1. Please provide an amended Funding Statement declaring this commercial affiliation, as well as a statement regarding the Role of Funders in your study. If the funding organization did not play a role in the study design, data collection and analysis, decision to publish, or preparation of the manuscript and only provided financial support in the form of authors' salaries and/or research materials, please review your statements relating to the author contributions, and ensure you have specifically and accurately indicated the role(s) that these authors had in your study. You can update author roles in the Author Contributions section of the online submission form.</p>
              <p>Please also include the following statement within your amended Funding Statement.</p>
              <p>“The funder provided support in the form of salaries for authors [insert relevant initials], but did not have any additional role in the study design, data collection and analysis, decision to publish, or preparation of the manuscript. The specific roles of these authors are articulated in the ‘author contributions’ section.”</p>
              <p>If your commercial affiliation did play a role in your study, please state and explain this role within your updated Funding Statement.</p>
              <p>3.2. Please also provide an updated Competing Interests Statement declaring this commercial affiliation along with any other relevant declarations relating to employment, consultancy, patents, products in development, or marketed products, etc.  </p>
              <p>Within your Competing Interests Statement, please confirm that this commercial affiliation does not alter your adherence to all PLOS ONE policies on sharing data and materials by including the following statement: "This does not alter our adherence to  PLOS ONE policies on sharing data and materials.” (as detailed online in our guide for authors <ext-link ext-link-type="uri" xlink:href="about:blank">http://journals.plos.org/plosone/s/competing-interests</ext-link>). If this adherence statement is not accurate and  there are restrictions on sharing of data and/or materials, please state these. Please note that we cannot proceed with consideration of your article until this information has been declared.</p>
              <p>Please include both an updated Funding Statement and Competing Interests Statement in your cover letter. We will change the online submission form on your behalf.</p>
              <p>Please know it is PLOS ONE policy for corresponding authors to declare, on behalf of all authors, all potential competing interests for the purposes of transparency. PLOS defines a competing interest as anything that interferes with, or could reasonably be perceived as interfering with, the full and objective presentation, peer review, editorial decision-making, or publication of research or non-research articles submitted to one of the journals. Competing interests can be financial or non-financial, professional, or personal. Competing interests can arise in relationship to an organization or another person. Please follow this link to our website for more details on competing interests: <ext-link ext-link-type="uri" xlink:href="about:blank">http://journals.plos.org/plosone/s/competing-interests</ext-link></p>
              <p>4. We note that Figure 1, 2, 3, 4 in your submission contain map images which may be copyrighted. All PLOS content is published under the Creative Commons Attribution License (CC BY 4.0), which means that the manuscript, images, and Supporting Information files will be freely available online, and any third party is permitted to access, download, copy, distribute, and use these materials in any way, even commercially, with proper attribution. For these reasons, we cannot publish previously copyrighted maps or satellite images created using proprietary data, such as Google software (Google Maps, Street View, and Earth). For more information, see our copyright guidelines: <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosone/s/licenses-and-copyright">http://journals.plos.org/plosone/s/licenses-and-copyright</ext-link>.</p>
              <p>We require you to either (1) present written permission from the copyright holder to publish these figures specifically under the CC BY 4.0 license, or (2) remove the figures from your submission:</p>
              <p>4.1.    You may seek permission from the original copyright holder of Figure 1, 2, 3, 4 to publish the content specifically under the CC BY 4.0 license. </p>
              <p>We recommend that you contact the original copyright holder with the Content Permission Form (<ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosone/s/file?id=7c09/content-permission-form.pdf">http://journals.plos.org/plosone/s/file?id=7c09/content-permission-form.pdf</ext-link>) and the following text:</p>
              <p>“I request permission for the open-access journal PLOS ONE to publish XXX under the Creative Commons Attribution License (CCAL) CC BY 4.0 (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>). Please be aware that this license allows unrestricted use and distribution, even commercially, by third parties. Please reply and provide explicit written permission to publish XXX under a CC BY license and complete the attached form.”</p>
              <p>Please upload the completed Content Permission Form or other proof of granted permissions as an "Other" file with your submission.</p>
              <p>In the figure caption of the copyrighted figure, please include the following text: “Reprinted from [ref] under a CC BY license, with permission from [name of publisher], original copyright [original copyright year].”</p>
              <p>4.2.    If you are unable to obtain permission from the original copyright holder to publish these figures under the CC BY 4.0 license or if the copyright holder’s requirements are incompatible with the CC BY 4.0 license, please either i) remove the figure or ii) supply a replacement figure that complies with the CC BY 4.0 license. Please check copyright information on all replacement figures and update the figure caption with source information. If applicable, please specify in the figure caption text when a figure is similar but not identical to the original image and is therefore for illustrative purposes only.</p>
              <p>The following resources for replacing copyrighted map figures may be helpful:</p>
              <p>USGS National Map Viewer (public domain): <ext-link ext-link-type="uri" xlink:href="http://viewer.nationalmap.gov/viewer/">http://viewer.nationalmap.gov/viewer/</ext-link></p>
              <p>The Gateway to Astronaut Photography of Earth (public domain): <ext-link ext-link-type="uri" xlink:href="http://eol.jsc.nasa.gov/sseop/clickmap/">http://eol.jsc.nasa.gov/sseop/clickmap/</ext-link></p>
              <p>Maps at the CIA (public domain): <ext-link ext-link-type="uri" xlink:href="https://www.cia.gov/library/publications/the-world-factbook/index.html">https://www.cia.gov/library/publications/the-world-factbook/index.html</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://www.cia.gov/library/publications/cia-maps-publications/index.html">https://www.cia.gov/library/publications/cia-maps-publications/index.html</ext-link></p>
              <p>NASA Earth Observatory (public domain): <ext-link ext-link-type="uri" xlink:href="http://earthobservatory.nasa.gov/">http://earthobservatory.nasa.gov/</ext-link></p>
              <p>Landsat: <ext-link ext-link-type="uri" xlink:href="http://landsat.visibleearth.nasa.gov/">http://landsat.visibleearth.nasa.gov/</ext-link></p>
              <p>USGS EROS (Earth Resources Observatory and Science (EROS) Center) (public domain): <ext-link ext-link-type="uri" xlink:href="http://eros.usgs.gov/#">http://eros.usgs.gov/#</ext-link></p>
              <p>Natural Earth (public domain): <ext-link ext-link-type="uri" xlink:href="http://www.naturalearthdata.com/">http://www.naturalearthdata.com/</ext-link></p>
              <p>[Note: HTML markup is below. Please do not edit.]</p>
              <p>Reviewers' comments:</p>
              <p>Reviewer's Responses to Questions</p>
              <p>
                <bold>Comments to the Author</bold>
              </p>
              <p>1. Is the manuscript technically sound, and do the data support the conclusions?</p>
              <p>The manuscript must describe a technically sound piece of scientific research with data that supports the conclusions. Experiments must have been conducted rigorously, with appropriate controls, replication, and sample sizes. The conclusions must be drawn appropriately based on the data presented. </p>
              <p>Reviewer #1: Partly</p>
              <p>Reviewer #2: Yes</p>
              <p>**********</p>
              <p>2. Has the statistical analysis been performed appropriately and rigorously? </p>
              <p>Reviewer #1: No</p>
              <p>Reviewer #2: Yes</p>
              <p>**********</p>
              <p>3. Have the authors made all data underlying the findings in their manuscript fully available?</p>
              <p>The <ext-link ext-link-type="uri" xlink:href="http://www.plosone.org/static/policies.action#sharing">PLOS Data policy</ext-link> requires authors to make all data underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data—e.g. participant privacy or use of data from a third party—those must be specified.</p>
              <p>Reviewer #1: Yes</p>
              <p>Reviewer #2: Yes</p>
              <p>**********</p>
              <p>4. Is the manuscript presented in an intelligible fashion and written in standard English?</p>
              <p>PLOS ONE does not copyedit accepted manuscripts, so the language in submitted articles must be clear, correct, and unambiguous. Any typographical or grammatical errors should be corrected at revision, so please note any specific errors here.</p>
              <p>Reviewer #1: Yes</p>
              <p>Reviewer #2: No</p>
              <p>**********</p>
              <p>5. Review Comments to the Author</p>
              <p>Please use the space provided to explain your answers to the questions above. You may also include additional comments for the author, including concerns about dual publication, research ethics, or publication ethics. (Please upload your review as an attachment if it exceeds 20,000 characters)</p>
              <p>Reviewer #1: 1. The reference number order in the article is messy, please renumber in numerical order.</p>
              <p>2. In lines 265 to 269, the author made the following explanation for Influenza data: "We use data for the weekly number of patients with influenza symptoms...of clinical information". However, Influenza's disease transmission and virus patterns are very complicated, and there may be asymptomatic infections, which are important parameters that cannot be captured in the data. The following points should be further explained:</p>
              <p>(a) Which subtype of Influenza is the simulation study for?</p>
              <p>(b) How to set the parameters that meet this Influenza subtype, especially the E (Exposed) infected persons in the SEIR model in the compartmental models?</p>
              <p>(c) Generally, people infected with Influenza are very likely to be infected again after recovery. How to correctly evaluate the number of people infected after recovery?</p>
              <p>(d) Since this study is based on Influenza, it does not seem to be based on a certain subtype. However, when all Influenza subtypes have been mixed and discussed, how to verify the experimental results with actual data? (Especially the data of E infected persons cannot be obtained)</p>
              <p>3. The author uses the commuting network (Fig.1) to simulate the spread of disease in this study. However, generally speaking, the commuting network may use different means of transportation such as highways, trains, high-speed rails, planes, and ships. Sometimes the disease may spread on a large scale because an infected person takes a plane or a ship, and the plane and ship play a long-distance transmission role. However, the communicating network of Fig.1 seems to be too simple, and there is no network layer for airplanes and ships, but the simulation result (Fig.5) is very close to the true value. Can the author further explain the information acquisition and use of the commuting network in this study?</p>
              <p>4. The results of this study are shown in Fig.4~6 until October 2019. Can the author provide a simulation to the first half of this year?</p>
              <p>5. The number of references in 2019 and 2020 is very small (only 1 out of 50), please add the reference for the past two years.</p>
              <p>Reviewer #2: The study proposed a graph convolutional network (GCN) based prediction model to predict influenza epidemic, which temporal trend has a 'periodicity' pattern. The model incorporate commuting data (from 2015 census) and spatial adjacency relationship as the interaction between (47) areas in the model, and used 3 flu seasons (from 2016 to 2019) as the study periods, to test and compare their model with other methods. With the three research questions analyses, they concluded that their proposed model outperform the other previous models. While the idea, method and analyses are interesting, the current status of the manuscript is yet to reach publishable quality. Therefore, I would recommend major revision. My concerns were listed as follow.</p>
              <p>Major concerns:</p>
              <p>1. One key contribution of the study should be the consideration of 'periodicity in a time series' (page 2, line 51) in the model, which was neglected in the previous Zhu et al. [18] Encoder-Decoder model. But, the authors did not explain what is it, and why it is important. Since the study did not use time-dependent dynamic commuting data, I would 'guess' the periodicity is in the weekly disease data. The authors should not let readers to guess, thus they should explain and clarify the 'periodicity' term where they first mention it, and emphasize the consequence of neglecting it; and which would help emphasizing the contribution of this study.</p>
              <p>2. According to the dataset description, the commuting data is in 'the daily average number of commuters from one area to another area'. Is this dataset differentiate weekdays/weekends, or from Monday to Sunday? The time unit for the model is by weekly basis, how did the daily data converted to weekly before the 'min-max normalization'?</p>
              <p>3. Also about the description of the commuting data (page 9, line 276-282), the authors describe the number of commuters as 'inflow of commuting data', e.g. the 270,000 and 135,000, as the number of commuters from one area to another. Based on the terminology from graph theory and social network analysis, the term 'inflow' could indicate the total number of people/commuters go to a target area, e.g. the total number of people go into Tokyo from any area; and the counterpart 'out-flow' could mean the total people leaving from the area. The usage of term 'inflow' is misleading.</p>
              <p>4. Following the #3 point, the input data for the model should be a weighted directed matrix (as suggested in figure 1). Commuting data is expected to be the number of people commute from the home area to work area. The people eventually will go back to their home in daily basis, i.e. a reversed direction flow relationships, or transpose matrix of flow matrix. Why the reverse direction of commuting flow is not considered and processed in the model? And, why direction of flow matters in the machine-learning based model?</p>
              <p>5. Both figures 5 and 6 suggested that all models' predictions were lower than the true values at the peak of trends, especially the second peak (near 2018 10th). Why they all failed to capture the peak values? Why LSTM's peaks were almost all earlier than the true value, whereas CNN-Res were always later?</p>
              <p>6. In page 3 line 91, the authors claimed that 'Our study is the first to predict the influenza volume in detail on a large area...'. But in fact, the model considered only 47 areas, which is not a large number and is a low resolution for the whole country. Practically speaking, the 47 areas (assumably prefectures) might be enough for national level management, but they are too large for local disease control or health management, therefore not so useful for 'regional public health organizations' (page 15 line 459). Is this model applicable to smaller areas (higher resolution, e.g. municipal)? If so, what should be prepared and which part should be modified; if not, why?</p>
              <p>7. Following previous point, is it possible to extend/apply the model to be used in early warning system?</p>
              <p>8. From the view of spatial epidemiology, the disease spread from one place to another, through droplets or direct/indirect physical interactions (etc.) and through the flow of the infected people. The infectious process is described as SIR model, which has (at least) three conditions: susceptible, infected, and recovered. The infected person go through the SIR process, and thus a time-lag is expected in the process, i.e. from susceptible to infected, and from infected to recovered. How does this machine-learning based model(s) handle the complicated SIR (or SEIR, SLIR, SIS, etc.) process and the time-lag effect?</p>
              <p>Suggestions and minor concerns:</p>
              <p>1. Table 2 presented the average MAE and R-squared of 47 areas. While the average values shows that their model (GCN+S2s w/ PF) are in overall outperform other models, the average values may be misleading by outliers. Thus, showing the distribution of the 47 values were needed, e.g. with std or boxplots. I believe these results could be presented using a set of boxplots (3 MAE and 3 R-squared), with vertical axis showing the MAE or R-squared, horizontal-axis showing the 1-to-5-weeks, and six boxes (different colors) for each week showing the values for 47 areas for the six models. Line plot with error bars can also be used to show the average and plus-minus standard deviation if boxplot is not clear.</p>
              <p>2. Following previous point, it should be possible to calculate the MAE and R-squared in aggregated (national) level, instead of average of 47, and the national level results shall also be useful for discussion.</p>
              <p>3. The comparative model (GCN+S2s w/ AD) considered only the adjacent relations between areas (polygon shapes of the 47 areas). In transportation and spatial analysis, the strength of interaction between cities (e.g. flows) can be estimated mainly using gravity model or radiation model. In simple words, the interaction strengths were higher between closer cities, and lower between farther cities, i.e. distance decay effect. What if adding another comparative model that calculate the inversed distance as the weight matrix?</p>
              <p>4. Page 12 line 378, what is 'examples of learned'. What do the colors means in Figure 3. Tokyo and Aichi were in the 'min' values, which should means that the interactions from Nara to Tokyo/Aichi are low, thus not important and could be ignored?</p>
              <p>5. Figure 4, consider adding legends on maps. And since the authors presented a map for a year, it would be better to show the 'improvement' percentage in all 47 areas with color ramp, and maybe used colored thick borders to highlight the highest and lowest five areas.</p>
              <p>6. Figures 3 and 4, what is the purpose of the small squares at the corner of each map (not the Hokkaido area)?</p>
              <p>7. Table 1, consider align the second column (Definitions or Descriptions) to left.</p>
              <p>8. Figures 5 and 6 consider changed x-label to Weeks from Date.</p>
              <p>9. Finally, while the content is quite rich, the English writing in the manuscript is not publishable; some of the sentences needs to read twice or more to understand/guess the authors meaning, e.g. the above point 4 (examples of learned?), page 13 line 416 (beginning of epidemics?). It would be difficult for readers to understand the idea/method/uniqueness/contribution of the study, and possibly lead to misunderstanding. Please revise the writing.</p>
              <p>**********</p>
              <p>6. PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/plosone/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
              <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
              <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
              <p>Reviewer #1: No</p>
              <p>Reviewer #2: <bold>Yes: </bold>WEI CHIEN BENNY CHIN</p>
              <p>[NOTE: If reviewer comments were submitted as an attachment file, they will be attached to this email and accessible via the submission site. Please log into your account, locate the manuscript record, and check for the action link "View Attachments". If this link does not appear, there are no attachment files.]</p>
              <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com/">https://pacev2.apexcovantage.com/</ext-link>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Registration is free. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email PLOS at <email>figures@plos.org</email>. Please note that Supporting Information files do not need this step.</p>
              <supplementary-material content-type="local-data" id="pone.0250417.s002">
                <label>Attachment</label>
                <caption>
                  <p>Submitted filename: <named-content content-type="submitted-filename">Review for PONE-D-20-20268.pdf</named-content></p>
                </caption>
                <media xlink:href="pone.0250417.s002.pdf">
                  <caption>
                    <p>Click here for additional data file.</p>
                  </caption>
                </media>
              </supplementary-material>
            </body>
          </sub-article>
          <sub-article id="pone.0250417.r002" article-type="author-comment">
            <front-stub>
              <article-id pub-id-type="doi">10.1371/journal.pone.0250417.r002</article-id>
              <title-group>
                <article-title>Author response to Decision Letter 0</article-title>
              </title-group>
              <related-article id="rel-obj002" ext-link-type="doi" xlink:href="10.1371/journal.pone.0250417" related-article-type="editor-report"/>
              <custom-meta-group>
                <custom-meta>
                  <meta-name>Submission Version</meta-name>
                  <meta-value>1</meta-value>
                </custom-meta>
              </custom-meta-group>
            </front-stub>
            <body>
              <p>
                <named-content content-type="author-response-date">24 Nov 2020</named-content>
              </p>
              <p>We appreciate the time and effort you and each reviewer has dedicated to providing insightful feedback on ways to strengthen our paper. We have incorporated changes that reflect the detailed suggestions you have graciously provided. We also hope that the edits and responses we have provided satisfactorily address all the issues and concerns you and the reviewers have noted.</p>
              <p>We describes our replies to all comments in our rebuttal letter in the attached files. We kindly ask for your confirmation.</p>
              <supplementary-material content-type="local-data" id="pone.0250417.s003">
                <label>Attachment</label>
                <caption>
                  <p>Submitted filename: <named-content content-type="submitted-filename">Plos_one_reply.pdf</named-content></p>
                </caption>
                <media xlink:href="pone.0250417.s003.pdf">
                  <caption>
                    <p>Click here for additional data file.</p>
                  </caption>
                </media>
              </supplementary-material>
            </body>
          </sub-article>
          <sub-article id="pone.0250417.r003" article-type="aggregated-review-documents">
            <front-stub>
              <article-id pub-id-type="doi">10.1371/journal.pone.0250417.r003</article-id>
              <title-group>
                <article-title>Decision Letter 1</article-title>
              </title-group>
              <contrib-group>
                <contrib contrib-type="author">
                  <name>
                    <surname>Wen</surname>
                    <given-names>Tzai-Hung</given-names>
                  </name>
                  <role>Academic Editor</role>
                </contrib>
              </contrib-group>
              <permissions>
                <copyright-statement>© 2021 Tzai-Hung Wen</copyright-statement>
                <copyright-year>2021</copyright-year>
                <copyright-holder>Tzai-Hung Wen</copyright-holder>
                <license>
                  <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
                  <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
                </license>
              </permissions>
              <related-article id="rel-obj003" ext-link-type="doi" xlink:href="10.1371/journal.pone.0250417" related-article-type="reviewed-article"/>
              <custom-meta-group>
                <custom-meta>
                  <meta-name>Submission Version</meta-name>
                  <meta-value>1</meta-value>
                </custom-meta>
              </custom-meta-group>
            </front-stub>
            <body>
              <p>
                <named-content content-type="letter-date">28 Jan 2021</named-content>
              </p>
              <p>PONE-D-20-20268R1</p>
              <p>Predicting Regional Influenza Epidemics with Uncertainty Estimation using Commuting Data in Japan</p>
              <p>PLOS ONE</p>
              <p>Dear Dr. Murayama,</p>
              <p>Thank you for submitting your manuscript to PLOS ONE. After careful consideration, we feel that it has merit but does not fully meet PLOS ONE’s publication criteria as it currently stands. Therefore, we invite you to submit a revised version of the manuscript that addresses the points raised during the review process.</p>
              <p>Please submit your revised manuscript by Mar 14 2021 11:59PM. If you will need more time than this to complete your revisions, please reply to this message or contact the journal office at <email>plosone@plos.org</email>. When you're ready to submit your revision, log on to <ext-link ext-link-type="uri" xlink:href="https://www.editorialmanager.com/pone/">https://www.editorialmanager.com/pone/</ext-link> and select the 'Submissions Needing Revision' folder to locate your manuscript file.</p>
              <p>Please include the following items when submitting your revised manuscript:</p>
              <p>
                <list list-type="bullet">
                  <list-item>
                    <p>A rebuttal letter that responds to each point raised by the academic editor and reviewer(s). You should upload this letter as a separate file labeled 'Response to Reviewers'.</p>
                  </list-item>
                  <list-item>
                    <p>A marked-up copy of your manuscript that highlights changes made to the original version. You should upload this as a separate file labeled 'Revised Manuscript with Track Changes'.</p>
                  </list-item>
                  <list-item>
                    <p>An unmarked version of your revised paper without tracked changes. You should upload this as a separate file labeled 'Manuscript'.</p>
                  </list-item>
                </list>
              </p>
              <p>If you would like to make changes to your financial disclosure, please include your updated statement in your cover letter. Guidelines for resubmitting your figure files are available below the reviewer comments at the end of this letter.</p>
              <p>If applicable, we recommend that you deposit your laboratory protocols in protocols.io to enhance the reproducibility of your results. Protocols.io assigns your protocol its own identifier (DOI) so that it can be cited independently in the future. For instructions see: <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols">http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols</ext-link></p>
              <p>We look forward to receiving your revised manuscript.</p>
              <p>Kind regards,</p>
              <p>Tzai-Hung Wen, Ph.D.</p>
              <p>Academic Editor</p>
              <p>PLOS ONE</p>
              <p>[Note: HTML markup is below. Please do not edit.]</p>
              <p>Reviewers' comments:</p>
              <p>Reviewer's Responses to Questions</p>
              <p>
                <bold>Comments to the Author</bold>
              </p>
              <p>1. If the authors have adequately addressed your comments raised in a previous round of review and you feel that this manuscript is now acceptable for publication, you may indicate that here to bypass the “Comments to the Author” section, enter your conflict of interest statement in the “Confidential to Editor” section, and submit your "Accept" recommendation.</p>
              <p>Reviewer #2: All comments have been addressed</p>
              <p>Reviewer #3: All comments have been addressed</p>
              <p>**********</p>
              <p>2. Is the manuscript technically sound, and do the data support the conclusions?</p>
              <p>The manuscript must describe a technically sound piece of scientific research with data that supports the conclusions. Experiments must have been conducted rigorously, with appropriate controls, replication, and sample sizes. The conclusions must be drawn appropriately based on the data presented. </p>
              <p>Reviewer #2: Yes</p>
              <p>Reviewer #3: Yes</p>
              <p>**********</p>
              <p>3. Has the statistical analysis been performed appropriately and rigorously? </p>
              <p>Reviewer #2: Yes</p>
              <p>Reviewer #3: Yes</p>
              <p>**********</p>
              <p>4. Have the authors made all data underlying the findings in their manuscript fully available?</p>
              <p>The <ext-link ext-link-type="uri" xlink:href="http://www.plosone.org/static/policies.action#sharing">PLOS Data policy</ext-link> requires authors to make all data underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data—e.g. participant privacy or use of data from a third party—those must be specified.</p>
              <p>Reviewer #2: Yes</p>
              <p>Reviewer #3: Yes</p>
              <p>**********</p>
              <p>5. Is the manuscript presented in an intelligible fashion and written in standard English?</p>
              <p>PLOS ONE does not copyedit accepted manuscripts, so the language in submitted articles must be clear, correct, and unambiguous. Any typographical or grammatical errors should be corrected at revision, so please note any specific errors here.</p>
              <p>Reviewer #2: Yes</p>
              <p>Reviewer #3: Yes</p>
              <p>**********</p>
              <p>6. Review Comments to the Author</p>
              <p>Please use the space provided to explain your answers to the questions above. You may also include additional comments for the author, including concerns about dual publication, research ethics, or publication ethics. (Please upload your review as an attachment if it exceeds 20,000 characters)</p>
              <p>Reviewer #2: (No Response)</p>
              <p>Reviewer #3: In this revised manuscript, the authors have answered the reviewer accordingly. Apparently, this version is significantly improved. As an additional reviewer, I would like to provide some extra suggestion.</p>
              <p>1. The graph element is very crucial in this study, and thus relevant information should be given as clear as possible. For example, why is the diffusion graph (Pg5) needed while the graph information has already given (Pg 9, “Commuting Data”). Is the diffusion process is inherence process of GCN or else?</p>
              <p>Furthermore, it seems that there are only single (cross-sectional) commuting data, since the articles states “…provides only the number of commuters, regardless of the year” (pg 9, “Commuting Data” section). Is that mean such information used throughout the GCN model, or as initial information and subsequently evolve through the diffusion process? Such information would be helpful for those readers not familiar in GCN.</p>
              <p>2. Recently, some study (see reference) also applied geographically weighted regression (GWR) into epidemic prediction. The reason that I raise this suggestion is that GWR also considers the spatial flow relation between regions which is similar in this study. This study may indicates GWR-based method may be improved using commuting data. Adding such information may be helpful for those researchers who using “statistical and time series” approach.</p>
              <p>Reference:</p>
              <p>Liu, F., Wang, J., Liu, J., Li, Y., Liu, D., Tong, J., Li, Z., Yu, D., Fan, Y., Bi, X., Zhang, X., &amp; Mo, S. (2020). Predicting and analyzing the COVID-19 epidemic in China: Based on SEIRD, LSTM and GWR models. PloS one, 15(8), e0238280. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0238280">https://doi.org/10.1371/journal.pone.0238280</ext-link></p>
              <p>
                <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7451659/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7451659/</ext-link>
              </p>
              <p>**********</p>
              <p>7. PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/plosone/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
              <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
              <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
              <p>Reviewer #2: No</p>
              <p>Reviewer #3: No</p>
              <p>[NOTE: If reviewer comments were submitted as an attachment file, they will be attached to this email and accessible via the submission site. Please log into your account, locate the manuscript record, and check for the action link "View Attachments". If this link does not appear, there are no attachment files.]</p>
              <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com/">https://pacev2.apexcovantage.com/</ext-link>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Registration is free. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email PLOS at <email>figures@plos.org</email>. Please note that Supporting Information files do not need this step.</p>
            </body>
          </sub-article>
          <sub-article id="pone.0250417.r004" article-type="author-comment">
            <front-stub>
              <article-id pub-id-type="doi">10.1371/journal.pone.0250417.r004</article-id>
              <title-group>
                <article-title>Author response to Decision Letter 1</article-title>
              </title-group>
              <related-article id="rel-obj004" ext-link-type="doi" xlink:href="10.1371/journal.pone.0250417" related-article-type="editor-report"/>
              <custom-meta-group>
                <custom-meta>
                  <meta-name>Submission Version</meta-name>
                  <meta-value>2</meta-value>
                </custom-meta>
              </custom-meta-group>
            </front-stub>
            <body>
              <p>
                <named-content content-type="author-response-date">5 Mar 2021</named-content>
              </p>
              <p>Thank you for inviting us to submit a revised draft of our manuscript (PONE-D-20-20268).</p>
              <p>We appreciate the time and effort you and each reviewer have dedicated to providing insightful feedback to help strengthen our manuscript. Thus, it is with great pleasure that we resubmit our manuscript for further consideration. We have incorporated changes that reflect the detailed suggestions you have graciously provided.</p>
              <p>We have included our response to the reviewer in a separate file (Plos_one_reply.pdf).</p>
              <p>Would you check the file.</p>
              <p>Thank you.</p>
              <supplementary-material content-type="local-data" id="pone.0250417.s004">
                <label>Attachment</label>
                <caption>
                  <p>Submitted filename: <named-content content-type="submitted-filename">Plos_one_reply.pdf</named-content></p>
                </caption>
                <media xlink:href="pone.0250417.s004.pdf">
                  <caption>
                    <p>Click here for additional data file.</p>
                  </caption>
                </media>
              </supplementary-material>
            </body>
          </sub-article>
          <sub-article id="pone.0250417.r005" article-type="aggregated-review-documents">
            <front-stub>
              <article-id pub-id-type="doi">10.1371/journal.pone.0250417.r005</article-id>
              <title-group>
                <article-title>Decision Letter 2</article-title>
              </title-group>
              <contrib-group>
                <contrib contrib-type="author">
                  <name>
                    <surname>Wen</surname>
                    <given-names>Tzai-Hung</given-names>
                  </name>
                  <role>Academic Editor</role>
                </contrib>
              </contrib-group>
              <permissions>
                <copyright-statement>© 2021 Tzai-Hung Wen</copyright-statement>
                <copyright-year>2021</copyright-year>
                <copyright-holder>Tzai-Hung Wen</copyright-holder>
                <license>
                  <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
                  <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
                </license>
              </permissions>
              <related-article id="rel-obj005" ext-link-type="doi" xlink:href="10.1371/journal.pone.0250417" related-article-type="reviewed-article"/>
              <custom-meta-group>
                <custom-meta>
                  <meta-name>Submission Version</meta-name>
                  <meta-value>2</meta-value>
                </custom-meta>
              </custom-meta-group>
            </front-stub>
            <body>
              <p>
                <named-content content-type="letter-date">7 Apr 2021</named-content>
              </p>
              <p>Predicting Regional Influenza Epidemics with Uncertainty Estimation using Commuting Data in Japan</p>
              <p>PONE-D-20-20268R2</p>
              <p>Dear Dr. Murayama,</p>
              <p>We’re pleased to inform you that your manuscript has been judged scientifically suitable for publication and will be formally accepted for publication once it meets all outstanding technical requirements.</p>
              <p>Within one week, you’ll receive an e-mail detailing the required amendments. When these have been addressed, you’ll receive a formal acceptance letter and your manuscript will be scheduled for publication.</p>
              <p>An invoice for payment will follow shortly after the formal acceptance. To ensure an efficient process, please log into Editorial Manager at <ext-link ext-link-type="uri" xlink:href="http://www.editorialmanager.com/pone/">http://www.editorialmanager.com/pone/</ext-link>, click the 'Update My Information' link at the top of the page, and double check that your user information is up-to-date. If you have any billing related questions, please contact our Author Billing department directly at <email>authorbilling@plos.org</email>.</p>
              <p>If your institution or institutions have a press office, please notify them about your upcoming paper to help maximize its impact. If they’ll be preparing press materials, please inform our press team as soon as possible -- no later than 48 hours after receiving the formal acceptance. Your manuscript will remain under strict press embargo until 2 pm Eastern Time on the date of publication. For more information, please contact <email>onepress@plos.org</email>.</p>
              <p>Kind regards,</p>
              <p>Tzai-Hung Wen, Ph.D.</p>
              <p>Academic Editor</p>
              <p>PLOS ONE</p>
              <p>Additional Editor Comments (optional):</p>
              <p>Reviewers' comments:</p>
              <p>Reviewer's Responses to Questions</p>
              <p>
                <bold>Comments to the Author</bold>
              </p>
              <p>1. If the authors have adequately addressed your comments raised in a previous round of review and you feel that this manuscript is now acceptable for publication, you may indicate that here to bypass the “Comments to the Author” section, enter your conflict of interest statement in the “Confidential to Editor” section, and submit your "Accept" recommendation.</p>
              <p>Reviewer #3: All comments have been addressed</p>
              <p>**********</p>
              <p>2. Is the manuscript technically sound, and do the data support the conclusions?</p>
              <p>The manuscript must describe a technically sound piece of scientific research with data that supports the conclusions. Experiments must have been conducted rigorously, with appropriate controls, replication, and sample sizes. The conclusions must be drawn appropriately based on the data presented. </p>
              <p>Reviewer #3: Yes</p>
              <p>**********</p>
              <p>3. Has the statistical analysis been performed appropriately and rigorously? </p>
              <p>Reviewer #3: Yes</p>
              <p>**********</p>
              <p>4. Have the authors made all data underlying the findings in their manuscript fully available?</p>
              <p>The <ext-link ext-link-type="uri" xlink:href="http://www.plosone.org/static/policies.action#sharing">PLOS Data policy</ext-link> requires authors to make all data underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data—e.g. participant privacy or use of data from a third party—those must be specified.</p>
              <p>Reviewer #3: Yes</p>
              <p>**********</p>
              <p>5. Is the manuscript presented in an intelligible fashion and written in standard English?</p>
              <p>PLOS ONE does not copyedit accepted manuscripts, so the language in submitted articles must be clear, correct, and unambiguous. Any typographical or grammatical errors should be corrected at revision, so please note any specific errors here.</p>
              <p>Reviewer #3: Yes</p>
              <p>**********</p>
              <p>6. Review Comments to the Author</p>
              <p>Please use the space provided to explain your answers to the questions above. You may also include additional comments for the author, including concerns about dual publication, research ethics, or publication ethics. (Please upload your review as an attachment if it exceeds 20,000 characters)</p>
              <p>Reviewer #3: The authors have made their points clear and convincing. I have no further question. Note that this paper has illustrated an advanced method for disease modelling and thus related details should be stated correctly. Please ensure no typo mistake, notation mistake during the publication process.</p>
              <p>**********</p>
              <p>7. PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/plosone/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
              <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
              <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
              <p>Reviewer #3: No</p>
            </body>
          </sub-article>
          <sub-article id="pone.0250417.r006" article-type="editor-report">
            <front-stub>
              <article-id pub-id-type="doi">10.1371/journal.pone.0250417.r006</article-id>
              <title-group>
                <article-title>Acceptance letter</article-title>
              </title-group>
              <contrib-group>
                <contrib contrib-type="author">
                  <name>
                    <surname>Wen</surname>
                    <given-names>Tzai-Hung</given-names>
                  </name>
                  <role>Academic Editor</role>
                </contrib>
              </contrib-group>
              <permissions>
                <copyright-statement>© 2021 Tzai-Hung Wen</copyright-statement>
                <copyright-year>2021</copyright-year>
                <copyright-holder>Tzai-Hung Wen</copyright-holder>
                <license>
                  <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
                  <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
                </license>
              </permissions>
              <related-article id="rel-obj006" ext-link-type="doi" xlink:href="10.1371/journal.pone.0250417" related-article-type="reviewed-article"/>
            </front-stub>
            <body>
              <p>
                <named-content content-type="letter-date">13 Apr 2021</named-content>
              </p>
              <p>PONE-D-20-20268R2 </p>
              <p>Predicting Regional Influenza Epidemics with Uncertainty Estimation using Commuting Data in Japan </p>
              <p>Dear Dr. Murayama:</p>
              <p>I'm pleased to inform you that your manuscript has been deemed suitable for publication in PLOS ONE. Congratulations! Your manuscript is now with our production department. </p>
              <p>If your institution or institutions have a press office, please let them know about your upcoming paper now to help maximize its impact. If they'll be preparing press materials, please inform our press team within the next 48 hours. Your manuscript will remain under strict press embargo until 2 pm Eastern Time on the date of publication. For more information please contact <email>onepress@plos.org</email>.</p>
              <p>If we can help with anything else, please email us at <email>plosone@plos.org</email>. </p>
              <p>Thank you for submitting your work to PLOS ONE and supporting open access. </p>
              <p>Kind regards, </p>
              <p>PLOS ONE Editorial Office Staff</p>
              <p>on behalf of</p>
              <p>Dr. Tzai-Hung Wen </p>
              <p>Academic Editor</p>
              <p>PLOS ONE</p>
            </body>
          </sub-article>
        </article>
      </metadata>
    </record>
  </GetRecord>
</OAI-PMH>
