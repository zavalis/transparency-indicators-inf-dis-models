<?xml version="1.0" encoding="UTF-8"?>
<OAI-PMH xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.openarchives.org/OAI/2.0/ http://www.openarchives.org/OAI/2.0/OAI-PMH.xsd">
  <responseDate>2022-03-11T00:50:53Z</responseDate>
  <request verb="GetRecord" identifier="oai:pubmedcentral.nih.gov:8342694" metadataPrefix="pmc">https:/www.ncbi.nlm.nih.gov/pmc/oai/oai.cgi</request>
  <GetRecord>
    <record>
      <header>
        <identifier>oai:pubmedcentral.nih.gov:8342694</identifier>
        <datestamp>2021-08-20</datestamp>
        <setSpec>ncomms</setSpec>
        <setSpec>pmc-open</setSpec>
      </header>
      <metadata>
        <article xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" xsi:schemaLocation="https://jats.nlm.nih.gov/ns/archiving/1.3/ https://jats.nlm.nih.gov/archiving/1.3/xsd/JATS-archivearticle1-3.xsd" article-type="research-article">
          <front>
            <journal-meta>
              <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
              <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
              <journal-title-group>
                <journal-title>Nature Communications</journal-title>
              </journal-title-group>
              <issn pub-type="epub">2041-1723</issn>
              <publisher>
                <publisher-name>Nature Publishing Group UK</publisher-name>
                <publisher-loc>London</publisher-loc>
              </publisher>
            </journal-meta>
            <article-meta>
              <article-id pub-id-type="accession">PMC8342694</article-id>
              <article-id pub-id-type="pmcid">PMC8342694</article-id>
              <article-id pub-id-type="pmc-uid">8342694</article-id>
              <article-id pub-id-type="pmid">34354055</article-id>
              <article-id pub-id-type="publisher-id">24732</article-id>
              <article-id pub-id-type="doi">10.1038/s41467-021-24732-2</article-id>
              <article-categories>
                <subj-group subj-group-type="heading">
                  <subject>Article</subject>
                </subj-group>
              </article-categories>
              <title-group>
                <article-title>Deep learning of contagion dynamics on complex networks</article-title>
              </title-group>
              <contrib-group>
                <contrib contrib-type="author">
                  <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1019-4518</contrib-id>
                  <name>
                    <surname>Murphy</surname>
                    <given-names>Charles</given-names>
                  </name>
                  <xref ref-type="aff" rid="Aff1">1</xref>
                  <xref ref-type="aff" rid="Aff2">2</xref>
                </contrib>
                <contrib contrib-type="author">
                  <name>
                    <surname>Laurence</surname>
                    <given-names>Edward</given-names>
                  </name>
                  <xref ref-type="aff" rid="Aff1">1</xref>
                  <xref ref-type="aff" rid="Aff2">2</xref>
                </contrib>
                <contrib contrib-type="author" corresp="yes">
                  <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-8208-9920</contrib-id>
                  <name>
                    <surname>Allard</surname>
                    <given-names>Antoine</given-names>
                  </name>
                  <address>
                    <email>antoine.allard@phy.ulaval.ca</email>
                  </address>
                  <xref ref-type="aff" rid="Aff1">1</xref>
                  <xref ref-type="aff" rid="Aff2">2</xref>
                </contrib>
                <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.23856.3a</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8390</institution-id><institution>Département de physique, de génie physique et d’optique, </institution><institution>Université Laval, </institution></institution-wrap>Québec, Québec Canada </aff>
                <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.23856.3a</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8390</institution-id><institution>Centre interdisciplinaire en modélisation mathématique, </institution><institution>Université Laval, </institution></institution-wrap>Québec, Québec Canada </aff>
              </contrib-group>
              <pub-date pub-type="epub">
                <day>5</day>
                <month>8</month>
                <year>2021</year>
              </pub-date>
              <pub-date pub-type="pmc-release">
                <day>5</day>
                <month>8</month>
                <year>2021</year>
              </pub-date>
              <pub-date pub-type="collection">
                <year>2021</year>
              </pub-date>
              <volume>12</volume>
              <elocation-id>4720</elocation-id>
              <history>
                <date date-type="received">
                  <day>19</day>
                  <month>6</month>
                  <year>2020</year>
                </date>
                <date date-type="accepted">
                  <day>5</day>
                  <month>7</month>
                  <year>2021</year>
                </date>
              </history>
              <permissions>
                <copyright-statement>© The Author(s) 2021</copyright-statement>
                <license>
                  <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
                  <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
                </license>
              </permissions>
              <abstract id="Abs1">
                <p id="Par1">Forecasting the evolution of contagion dynamics is still an open problem to which mechanistic models only offer a partial answer. To remain mathematically or computationally tractable, these models must rely on simplifying assumptions, thereby limiting the quantitative accuracy of their predictions and the complexity of the dynamics they can model. Here, we propose a complementary approach based on deep learning where effective local mechanisms governing a dynamic on a network are learned from time series data. Our graph neural network architecture makes very few assumptions about the dynamics, and we demonstrate its accuracy using different contagion dynamics of increasing complexity. By allowing simulations on arbitrary network structures, our approach makes it possible to explore the properties of the learned dynamics beyond the training data. Finally, we illustrate the applicability of our approach using real data of the COVID-19 outbreak in Spain. Our results demonstrate how deep learning offers a new and complementary perspective to build effective models of contagion dynamics on networks.</p>
              </abstract>
              <abstract id="Abs2" abstract-type="web-summary">
                <p id="Par2">Prediction of contagion dynamics is of relevance for epidemic and social complex networks. Murphy et al. propose a data-driven approach based on deep learning which allows to learn mechanisms governing network dynamics and make predictions beyond the training data for arbitrary network structures.</p>
              </abstract>
              <kwd-group kwd-group-type="npg-subject">
                <title>Subject terms</title>
                <kwd>Applied mathematics</kwd>
                <kwd>Complex networks</kwd>
              </kwd-group>
              <funding-group>
                <award-group>
                  <funding-source>
                    <institution-wrap>
                      <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100000038</institution-id>
                      <institution>Gouvernement du Canada | Natural Sciences and Engineering Research Council of Canada (Conseil de Recherches en Sciences Naturelles et en Génie du Canada)</institution>
                    </institution-wrap>
                  </funding-source>
                </award-group>
              </funding-group>
              <custom-meta-group>
                <custom-meta>
                  <meta-name>issue-copyright-statement</meta-name>
                  <meta-value>© The Author(s) 2021</meta-value>
                </custom-meta>
              </custom-meta-group>
            </article-meta>
          </front>
          <body>
            <sec id="Sec1" sec-type="introduction">
              <title>Introduction</title>
              <p id="Par3">Our capacity to prevent or contain outbreaks of infectious diseases is directly linked to our ability to accurately model contagion dynamics. Since the seminal work of Kermack and McKendrick almost a century ago<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>, a variety of models incorporating ever more sophisticated contagion mechanisms has been proposed<sup><xref ref-type="bibr" rid="CR2">2</xref>–<xref ref-type="bibr" rid="CR5">5</xref></sup>. These mechanistic models have provided invaluable insights about how infectious diseases spread, and have thereby contributed to the design of better public health policies. However, several challenges remain unresolved, which call for contributions from new modeling approaches<sup><xref ref-type="bibr" rid="CR6">6</xref>–<xref ref-type="bibr" rid="CR8">8</xref></sup>.</p>
              <p id="Par4">For instance, many complex contagion processes involve the nontrivial interaction of several pathogens<sup><xref ref-type="bibr" rid="CR9">9</xref>–<xref ref-type="bibr" rid="CR12">12</xref></sup>, and some social contagion phenomena, like the spread of misinformation, require to go beyond pairwise interactions between individuals<sup><xref ref-type="bibr" rid="CR13">13</xref>–<xref ref-type="bibr" rid="CR15">15</xref></sup>. Also, while qualitatively informative, the forecasts of most mechanistic models lack quantitative accuracy<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. Indeed, most models are constructed from a handful of mechanisms which can hardly reproduce the intricacies of real complex contagion dynamics. One approach to these challenges is to complexify the models by adding more detailed and sophisticated mechanisms. However, mechanistic models become rapidly intractable as new mechanisms are added. Moreover, models with higher complexity require the specification of a large number of parameters whose values can be difficult to infer from limited data.</p>
              <p id="Par5">There has been a recent gain of interest towards using machine learning to address the issue of the often-limiting complexity of mechanistic models<sup><xref ref-type="bibr" rid="CR12">12</xref>,<xref ref-type="bibr" rid="CR17">17</xref>–<xref ref-type="bibr" rid="CR23">23</xref></sup>. This new kind of approach aims at training predictive models directly from observational time series data. These data-driven models are then used for various tasks such as making accurate predictions<sup><xref ref-type="bibr" rid="CR19">19</xref>,<xref ref-type="bibr" rid="CR21">21</xref></sup>, gaining useful intuitions about complex phenomena<sup><xref ref-type="bibr" rid="CR12">12</xref></sup> and discovering new patterns from which better mechanisms can be designed<sup><xref ref-type="bibr" rid="CR17">17</xref>,<xref ref-type="bibr" rid="CR18">18</xref></sup>. Although these approaches were originally designed for regularly structured data, this new paradigm is now being applied to epidemics spreading on networked systems<sup><xref ref-type="bibr" rid="CR24">24</xref>,<xref ref-type="bibr" rid="CR25">25</xref></sup>, and more generally to dynamical systems<sup><xref ref-type="bibr" rid="CR26">26</xref>–<xref ref-type="bibr" rid="CR28">28</xref></sup>. Meanwhile, the machine learning community has dedicated a considerable amount of attention to deep learning on networks, structure learning and graph neural networks (GNN)<sup><xref ref-type="bibr" rid="CR29">29</xref>–<xref ref-type="bibr" rid="CR31">31</xref></sup>. Recent works showed great promise for GNN in the context of community detection<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>, link prediction<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>, network inference<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>, as well as for the discovery of new materials and drugs<sup><xref ref-type="bibr" rid="CR35">35</xref>,<xref ref-type="bibr" rid="CR36">36</xref></sup>. Yet, others have pointed out the inherent limitations of a majority of GNN architectures in distinguishing certain network structures<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>, in turn limiting their learning capabilities. Hence, while recent advances and results<sup><xref ref-type="bibr" rid="CR37">37</xref>–<xref ref-type="bibr" rid="CR40">40</xref></sup> suggest that GNN could be prime candidates for building effective data-driven dynamical models on networks, it remains to be shown if, how and when GNN can be applied to dynamics learning problems.</p>
              <p id="Par6">In this paper, we show how GNN, usually used for structure learning, can also be used to model contagion dynamics on complex networks. Our contribution is threefold. First, we design a training procedure and an appropriate GNN architecture capable of representing a wide range of dynamics with very few assumptions. Second, we demonstrate the validity of our approach using various contagion dynamics of increasing complexity on networks of different natures, as well as real epidemiological data. Finally, we show how our approach can provide predictions for previously unseen network structures, therefore allowing the exploration of the properties of the learned dynamics beyond the training data. Our work generalizes the idea of constructing dynamical models from regularly structured data to arbitrary network structures, and suggests that our approach could be accurately extended to many other classes of dynamical processes.</p>
            </sec>
            <sec id="Sec2" sec-type="results">
              <title>Results</title>
              <p id="Par7">In our approach, we assume that an unknown dynamical process, denoted <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathcal{M}}}}}}$$\end{document}</tex-math><mml:math id="M2"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">M</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq1.gif"/></alternatives></inline-formula>, takes place on a known network structure—or ensemble of networks—, denoted <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G=({{{{{\mathcal{V}}}}}},{{{{{\mathcal{E}}}}}};{{{{{\boldsymbol{\Phi }}}}}},{{{{{\boldsymbol{\Omega }}}}}})$$\end{document}</tex-math><mml:math id="M4"><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">V</mml:mi><mml:mo>,</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">E</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">Φ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq2.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathcal{V}}}}}}=\left\{{v}_{1},\cdots \ ,{v}_{N}\right\}$$\end{document}</tex-math><mml:math id="M6"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">V</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mspace width="0.33em"/><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq3.gif"/></alternatives></inline-formula> is the node set and <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathcal{E}}}}}}=\{{e}_{ij}| {v}_{j}\,{{\mbox{is connected to}}}\;{v}_{i}{{\mbox{}}}\wedge ({v}_{i},{v}_{j})\in {{{{{{\mathcal{V}}}}}}}^{2}\}$$\end{document}</tex-math><mml:math id="M8"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">E</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mstyle><mml:mtext>is connected to</mml:mtext></mml:mstyle><mml:mspace width="0.16em"/><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mstyle><mml:mtext/></mml:mstyle><mml:mo>∧</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">V</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq4.gif"/></alternatives></inline-formula> is the edge set. We also assume that the network(s) contains metadata, taking the form of node and edge attributes denoted Φ<sub><italic>i</italic></sub> = (<italic>ϕ</italic><sub>1</sub>(<italic>v</italic><sub><italic>i</italic></sub>), ⋯ , <italic>ϕ</italic><sub><italic>Q</italic></sub>(<italic>v</italic><sub><italic>i</italic></sub>)) for node <italic>v</italic><sub><italic>i</italic></sub> and Ω<sub><italic>i</italic><italic>j</italic></sub> = (<italic>ω</italic><sub>1</sub>(<italic>e</italic><sub><italic>i</italic><italic>j</italic></sub>), ⋯ , <italic>ω</italic><sub><italic>P</italic></sub>(<italic>e</italic><sub><italic>i</italic><italic>j</italic></sub>)) for edge <italic>e</italic><sub><italic>i</italic><italic>j</italic></sub>, respectively, where <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\phi }_{q}:{{{{{\mathcal{V}}}}}}\to {\mathbb{R}}$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">V</mml:mi><mml:mo>→</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq5.gif"/></alternatives></inline-formula> and <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\omega }_{p}:{{{{{\mathcal{E}}}}}}\to {\mathbb{R}}$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">E</mml:mi><mml:mo>→</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq6.gif"/></alternatives></inline-formula>. These metadata can take various forms like node characteristics or edge weights. We also denote the node and edge attribute matrices <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\boldsymbol{\Phi }}}}}}=({{{\Phi }}}_{i}| {v}_{i}\in {{{{{\mathcal{V}}}}}})$$\end{document}</tex-math><mml:math id="M14"><mml:mi mathvariant="bold-italic">Φ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">V</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq7.gif"/></alternatives></inline-formula> and <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\boldsymbol{\Omega }}}}}}=({{{\Omega }}}_{ij}| {e}_{ij}\in {{{{{\mathcal{E}}}}}})$$\end{document}</tex-math><mml:math id="M16"><mml:mi mathvariant="bold-italic">Ω</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">E</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq8.gif"/></alternatives></inline-formula>, respectively.</p>
              <p id="Par8">Next, we assume that the dynamics <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathcal{M}}}}}}$$\end{document}</tex-math><mml:math id="M18"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">M</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq9.gif"/></alternatives></inline-formula> has generated a time series <italic>D</italic> on the network <italic>G</italic>. This time series takes the form of a pair of consecutive snapshots <italic>D</italic> = (<bold><italic>X</italic></bold>, <bold><italic>Y</italic></bold>) with <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\boldsymbol{X}}}}}}=\left({X}_{1},\cdots \ ,{X}_{T}\right)$$\end{document}</tex-math><mml:math id="M20"><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mspace width="0.33em"/><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq10.gif"/></alternatives></inline-formula> and <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\boldsymbol{Y}}}}}}=\left({Y}_{1},\cdots \ ,{Y}_{T}\right)$$\end{document}</tex-math><mml:math id="M22"><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mspace width="0.33em"/><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq11.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}_{t}\in {{{{{{\mathcal{S}}}}}}}^{| {{{{{\mathcal{V}}}}}}| }$$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">S</mml:mi></mml:mrow><mml:mrow><mml:mo>∣</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">V</mml:mi><mml:mo>∣</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq12.gif"/></alternatives></inline-formula> is the state of the nodes at time <italic>t</italic>, <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Y}_{t}\in {{{{{{\mathcal{R}}}}}}}^{| {{{{{\mathcal{V}}}}}}| }$$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">R</mml:mi></mml:mrow><mml:mrow><mml:mo>∣</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">V</mml:mi><mml:mo>∣</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq13.gif"/></alternatives></inline-formula> is the outcome of <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathcal{M}}}}}}$$\end{document}</tex-math><mml:math id="M28"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">M</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq14.gif"/></alternatives></inline-formula> defined as<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Y}_{t}={{{{{\mathcal{M}}}}}}\left({X}_{t},G\right)\ ,$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">M</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:mfenced><mml:mspace width="0.33em"/><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41467_2021_24732_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula><inline-formula id="IEq15"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathcal{S}}}}}}$$\end{document}</tex-math><mml:math id="M32"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq15.gif"/></alternatives></inline-formula> is the set of possible node states, and <inline-formula id="IEq16"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathcal{R}}}}}}$$\end{document}</tex-math><mml:math id="M34"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">R</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq16.gif"/></alternatives></inline-formula> is the set of possible node outcomes. This way of defining <italic>D</italic> allows us to formally concatenate multiple realizations of the dynamics in a single dataset. Additionally, the elements <inline-formula id="IEq17"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{i}(t) = {({X}_{t})}_{i}$$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq17.gif"/></alternatives></inline-formula> and <inline-formula id="IEq18"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}_{i}(t) = {({Y}_{t})}_{i}$$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq18.gif"/></alternatives></inline-formula> correspond to the state of node <italic>v</italic><sub><italic>i</italic></sub> at time <italic>t</italic> and its outcome, respectively. Typically, we consider that the outcome <italic>y</italic><sub><italic>i</italic></sub>(<italic>t</italic>) is simply the state of node <italic>v</italic><sub><italic>i</italic></sub> after transitioning from state <italic>x</italic><sub><italic>i</italic></sub>(<italic>t</italic>). In this case, we have <inline-formula id="IEq19"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathcal{S}}}}}}={{{{{\mathcal{R}}}}}}$$\end{document}</tex-math><mml:math id="M40"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">S</mml:mi><mml:mo>=</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">R</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq19.gif"/></alternatives></inline-formula> and <italic>x</italic><sub><italic>i</italic></sub>(<italic>t</italic> + Δ<italic>t</italic>) = <italic>y</italic><sub><italic>i</italic></sub>(<italic>t</italic>) where Δ<italic>t</italic> is the length of the time steps. However, if <inline-formula id="IEq20"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathcal{S}}}}}}$$\end{document}</tex-math><mml:math id="M42"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq20.gif"/></alternatives></inline-formula> is a discrete set—i.e. finite and countable—<italic>y</italic><sub><italic>i</italic></sub>(<italic>t</italic>) is a transition probability vector conditioned on <italic>x</italic><sub><italic>i</italic></sub>(<italic>t</italic>) from which the following state, <italic>x</italic><sub><italic>i</italic></sub>(<italic>t</italic> + Δ<italic>t</italic>), will be sampled. The element <inline-formula id="IEq21"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left({y}_{i}(t)\right)}_{m}$$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq21.gif"/></alternatives></inline-formula> corresponds to the probability that node <italic>v</italic><sub><italic>i</italic></sub> evolves to state <inline-formula id="IEq22"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m\in {{{{{\mathcal{S}}}}}}$$\end{document}</tex-math><mml:math id="M46"><mml:mi>m</mml:mi><mml:mo>∈</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq22.gif"/></alternatives></inline-formula> given that it was previously in state <italic>x</italic><sub><italic>i</italic></sub>(<italic>t</italic>)—i.e. <inline-formula id="IEq23"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathcal{R}}}}}}={[0,1]}^{| {{{{{\mathcal{S}}}}}}| }$$\end{document}</tex-math><mml:math id="M48"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">R</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>∣</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">S</mml:mi><mml:mo>∣</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq23.gif"/></alternatives></inline-formula>. When <inline-formula id="IEq24"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathcal{M}}}}}}$$\end{document}</tex-math><mml:math id="M50"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">M</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq24.gif"/></alternatives></inline-formula> is a stochastic dynamics, we do not typically have access to the transition probabilities <italic>y</italic><sub><italic>i</italic></sub>(<italic>t</italic>) directly, but rather to the observed outcome state—e.g. <italic>x</italic><sub><italic>i</italic></sub>(<italic>t</italic> + Δ<italic>t</italic>) in the event where <bold><italic>X</italic></bold> is temporally ordered—, we therefore define the observed outcome <inline-formula id="IEq25"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\tilde{y}}_{i}(t)$$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>~</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq25.gif"/></alternatives></inline-formula> as<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${({\tilde{y}}_{i}(t))}_{m}=\delta \left({x}_{i}(t+{{\Delta }}t),m\right)\ ,\ \ \forall m\in {{{{{\mathcal{S}}}}}}$$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>~</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>δ</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mfenced><mml:mspace width="0.33em"/><mml:mo>,</mml:mo><mml:mspace width="0.33em"/><mml:mspace width="0.33em"/><mml:mo>∀</mml:mo><mml:mi>m</mml:mi><mml:mo>∈</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">S</mml:mi></mml:math><graphic xlink:href="41467_2021_24732_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where <italic>δ</italic>(<italic>x</italic>, <italic>y</italic>) is the Kronecker delta. Finally, we assume that <inline-formula id="IEq26"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathcal{M}}}}}}$$\end{document}</tex-math><mml:math id="M56"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">M</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq26.gif"/></alternatives></inline-formula> acts on <italic>X</italic><sub><italic>t</italic></sub> locally and identically at all times, according to the structure of <italic>G</italic>. In other words, knowing the state <italic>x</italic><sub><italic>i</italic></sub> as well as the states of all the neighbors of <italic>v</italic><sub><italic>i</italic></sub>, the outcome <italic>y</italic><sub><italic>i</italic></sub> is computed using a time independent function <italic>f</italic> identical for all nodes<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}_{i} = f\left({x}_{i},{{{\Phi }}}_{i},{x}_{{{{{{{\mathcal{N}}}}}}}_{i}},{{{\Phi }}}_{{{{{{{\mathcal{N}}}}}}}_{i}},{{{\Omega }}}_{i{{{{{{\mathcal{N}}}}}}}_{i}}\right)\ ,$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mspace width="0.33em"/><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41467_2021_24732_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq27"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{{{{{{{\mathcal{N}}}}}}}_{i}}=({x}_{j}| {v}_{j}\in {{{{{{\mathcal{N}}}}}}}_{i})$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq27.gif"/></alternatives></inline-formula> denotes the states of the neighbors, <inline-formula id="IEq28"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathcal{N}}}}}}}_{i} = \{{v}_{j}| {e}_{ij}\in {{{{{\mathcal{E}}}}}}\}$$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">E</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq28.gif"/></alternatives></inline-formula> is the set of the neighbors, <inline-formula id="IEq29"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{\Phi }}}_{{{{{{{\mathcal{N}}}}}}}_{i}} = \{{{{\Phi }}}_{j}| {v}_{j}\in {{{{{{\mathcal{N}}}}}}}_{i}\}$$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq29.gif"/></alternatives></inline-formula> and <inline-formula id="IEq30"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{\Omega }}}_{i{{{{{{\mathcal{N}}}}}}}_{i}} = \{{{{\Omega }}}_{ij}| {v}_{j}\in {{{{{{\mathcal{N}}}}}}}_{i}\}$$\end{document}</tex-math><mml:math id="M66"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq30.gif"/></alternatives></inline-formula>. As a result, we impose a notion of locality where the underlying dynamics is time invariant and invariant under the permutation of the node labels in <italic>G</italic>, under the assumption that the node and edge attributes are left invariant.</p>
              <p id="Par9">Our objective is to build a model <inline-formula id="IEq31"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{{{{{{\mathcal{M}}}}}}}$$\end{document}</tex-math><mml:math id="M68"><mml:mover accent="true"><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">M</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq31.gif"/></alternatives></inline-formula>, parametrized by a GNN with a set of tunable parameters <bold>Θ</bold> and trained on the observed dataset <italic>D</italic> to mimic <inline-formula id="IEq32"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathcal{M}}}}}}$$\end{document}</tex-math><mml:math id="M70"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">M</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq32.gif"/></alternatives></inline-formula> given <italic>G</italic>, such that<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{{{{{{\mathcal{M}}}}}}}({X}_{t}^{\prime},G^{\prime} ;{{{{{\boldsymbol{\Theta }}}}}})\approx {{{{{\mathcal{M}}}}}}({X}_{t}^{\prime},G^{\prime} )\ ,$$\end{document}</tex-math><mml:math id="M72"><mml:mover accent="true"><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">M</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">Θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">M</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.33em"/><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41467_2021_24732_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>for all states <inline-formula id="IEq33"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}_{t}^{\prime}$$\end{document}</tex-math><mml:math id="M74"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq33.gif"/></alternatives></inline-formula> and all networks <inline-formula id="IEq34"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G^{\prime}$$\end{document}</tex-math><mml:math id="M76"><mml:msup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq34.gif"/></alternatives></inline-formula>. The architecture of <inline-formula id="IEq35"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{{{{{{\mathcal{M}}}}}}}$$\end{document}</tex-math><mml:math id="M78"><mml:mover accent="true"><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">M</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq35.gif"/></alternatives></inline-formula>, detailed in Section “Graph neural network and training details”, is designed to act locally similarly to <inline-formula id="IEq36"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathcal{M}}}}}}$$\end{document}</tex-math><mml:math id="M80"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">M</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq36.gif"/></alternatives></inline-formula>. In this case, the locality is imposed by a modified attention mechanism inspired by ref. <sup><xref ref-type="bibr" rid="CR41">41</xref></sup>. The advantage of imposing locality allows our architecture to be <italic>inductive</italic>: If the GNN is trained on a wide range of local structures—i.e. nodes with different neighborhood sizes (or degrees) and states—it can then be used on any other networks within that range. This suggests that the topology of <italic>G</italic> will have a strong impact on the quality of the trained models, an intuition that is confirmed below. Simiarly to Eq. (<xref rid="Equ3" ref-type="">3</xref>), we can write each individual node outcome computed by the GNN using a function <inline-formula id="IEq37"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{f}$$\end{document}</tex-math><mml:math id="M82"><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq37.gif"/></alternatives></inline-formula> such that<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{y}}_{i} = \hat{f}\left({x}_{i},{{{\Phi }}}_{i},{x}_{{{{{{{\mathcal{N}}}}}}}_{i}},{{{\Phi }}}_{{{{{{{\mathcal{N}}}}}}}_{i}},{{{\Omega }}}_{i{{{{{{\mathcal{N}}}}}}}_{i}};{{{\boldsymbol{\Theta }}}}\right)$$\end{document}</tex-math><mml:math id="M84"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">Θ</mml:mi></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2021_24732_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq38"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{y}}_{i}$$\end{document}</tex-math><mml:math id="M86"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq38.gif"/></alternatives></inline-formula> is the outcome of node <italic>v</italic><sub><italic>i</italic></sub> predicted by <inline-formula id="IEq39"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{{{{{{\mathcal{M}}}}}}}$$\end{document}</tex-math><mml:math id="M88"><mml:mover accent="true"><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">M</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq39.gif"/></alternatives></inline-formula>.</p>
              <p id="Par10">The objective described by Eq. (<xref rid="Equ4" ref-type="">4</xref>) must be encoded into a global loss function, denoted <inline-formula id="IEq40"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathcal{L}}}}}}({{{{{\boldsymbol{\Theta }}}}}})$$\end{document}</tex-math><mml:math id="M90"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">Θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq40.gif"/></alternatives></inline-formula>. Like the outcome functions, <inline-formula id="IEq41"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathcal{L}}}}}}({{{{{\boldsymbol{\Theta }}}}}})$$\end{document}</tex-math><mml:math id="M92"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">Θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq41.gif"/></alternatives></inline-formula> can be decomposed locally, where the local losses of each node <inline-formula id="IEq42"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L({y}_{i},{\hat{y}}_{i})$$\end{document}</tex-math><mml:math id="M94"><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq42.gif"/></alternatives></inline-formula> are arithmetically averaged over all possible node inputs <inline-formula id="IEq43"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$({x}_{i},{{{\Phi }}}_{i},{x}_{{{{{{{\mathcal{N}}}}}}}_{i}},{{{\Phi }}}_{{{{{{{\mathcal{N}}}}}}}_{i}},{{{\Omega }}}_{i{{{{{{\mathcal{N}}}}}}}_{i}})$$\end{document}</tex-math><mml:math id="M96"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq43.gif"/></alternatives></inline-formula>, where <italic>y</italic><sub><italic>i</italic></sub> and <inline-formula id="IEq44"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{y}}_{i}$$\end{document}</tex-math><mml:math id="M98"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq44.gif"/></alternatives></inline-formula> are given by Eqs. (<xref rid="Equ3" ref-type="">3</xref>) and (<xref rid="Equ5" ref-type="">5</xref>), respectively. By using an arithmetic mean to the evaluation of <inline-formula id="IEq45"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathcal{L}}}}}}({{{{{\boldsymbol{\Theta }}}}}})$$\end{document}</tex-math><mml:math id="M100"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">Θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq45.gif"/></alternatives></inline-formula>, we assume that the node inputs are equally important and uniformly distributed. Consequently, the model should be trained equally well on all of them. This consideration is critical because in practice we only have access to a finite number of inputs in <italic>D</italic> and <italic>G</italic>, for which the node input distribution, denoted <inline-formula id="IEq46"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho(k_i, x_i, \Phi_i, x_{{{{\mathcal{N}}}}_i}, \Phi_{{{{\mathcal{N}}}}_i}, \Omega_{i, {{{\mathcal{N}}}}_i})$$\end{document}</tex-math><mml:math id="M102"><mml:mi>ρ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq46.gif"/></alternatives></inline-formula>, is typically far from being uniform. Hence, in order to train effective models, we recalibrate the inputs using the following global loss<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathcal{L}}}}}}({{{{{\boldsymbol{\Theta }}}}}})=\mathop{\sum}\limits_{t\in {{{{{\mathcal{T}}}}}}^{\prime} }\ \mathop{\sum}\limits_{{v}_{i}\in {{{{{\mathcal{V}}}}}}^{\prime} (t)}\frac{{w}_{i}(t)}{Z^{\prime} }L\left({y}_{i}(t),{\hat{y}}_{i}(t)\right)$$\end{document}</tex-math><mml:math id="M104"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">Θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">T</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:mspace width="0.33em"/><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">V</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mi>L</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2021_24732_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>where <italic>w</italic><sub><italic>i</italic></sub>(<italic>t</italic>) is a weight assigned to node <italic>v</italic><sub><italic>i</italic></sub> at time <italic>t</italic>, and <inline-formula id="IEq47"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Z^{\prime} ={\sum }_{t\in {{{{{\mathcal{T}}}}}}^{\prime} }{\sum }_{{v}_{i}\in {{{{{\mathcal{V}}}}}}^{\prime} (t)}{w}_{i}(t)$$\end{document}</tex-math><mml:math id="M106"><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">T</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">V</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq47.gif"/></alternatives></inline-formula> is a normalization factor. Here, the training node set <inline-formula id="IEq48"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathcal{V}}}}}}^{\prime} (t)\subseteq {{{{{\mathcal{V}}}}}}$$\end{document}</tex-math><mml:math id="M108"><mml:msup><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">V</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⊆</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">V</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq48.gif"/></alternatives></inline-formula> and the training time set <inline-formula id="IEq49"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathcal{T}}}}}}^{\prime} \subseteq [1,T]$$\end{document}</tex-math><mml:math id="M110"><mml:msup><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">T</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>⊆</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq49.gif"/></alternatives></inline-formula> allow us to partition the training dataset for validation and testing when required.</p>
              <p id="Par11">The choice of weights needs to reflect the importance of each node at each time. Because we wish to lower the influence of overrepresented inputs and increase that of rare inputs, a sound choice of weights is<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${w}_{i}(t)\propto \rho {\left({k}_{i},{x}_{i},{{{\Phi }}}_{i},{x}_{{{{{{{\mathcal{N}}}}}}}_{i}},{{{\Phi }}}_{{{{{{{\mathcal{N}}}}}}}_{i}},{{{\Omega }}}_{i{{{{{{\mathcal{N}}}}}}}_{i}}\right)}^{-\lambda }$$\end{document}</tex-math><mml:math id="M112"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:mi>ρ</mml:mi><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:msup></mml:math><graphic xlink:href="41467_2021_24732_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>where <italic>k</italic><sub><italic>i</italic></sub> is the degree of node <italic>v</italic><sub><italic>i</italic></sub> in <italic>G</italic>, and 0≤<italic>λ</italic>≤1 is an hyperparameter. Equation (<xref rid="Equ7" ref-type="">7</xref>) is an ideal choice, because it corresponds to a principled importance sampling approximation of Eq. (<xref rid="Equ6" ref-type="">6</xref>)<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>, which is relaxed via the exponent <italic>λ</italic>. We obtain a pure importance sampling scheme when <italic>λ</italic> = 1. Note that the weights can rarely be exactly computed using Eq. (<xref rid="Equ7" ref-type="">7</xref>), because the distribution <italic>ρ</italic> is typically computationally intensive to obtain from data, especially for continuous <inline-formula id="IEq50"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathcal{S}}}}}}$$\end{document}</tex-math><mml:math id="M114"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq50.gif"/></alternatives></inline-formula> with metadata. We illustrate various ways to evaluate the weights in Sec. “Importance weights” and Sec. I in the Supplementary Information.</p>
              <p id="Par12">We now illustrate the accuracy of our approach by applying it to four types of synthetic dynamics of various natures (see Sec. “Dynamics” for details on the dynamics). We first consider a <italic>simple contagion</italic> dynamics: The discrete-time susceptible-infected-susceptible (SIS) dynamics. In this dynamics, nodes are either susceptible (<italic>S</italic>) or infected (<italic>I</italic>) by some disease, i.e. <inline-formula id="IEq51"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathcal{S}}}}}}=\left\{S,I\right\}=\left\{0,1\right\}$$\end{document}</tex-math><mml:math id="M116"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">S</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq51.gif"/></alternatives></inline-formula>, and transition between each state stochastically according to an infection probability function <italic>α</italic>(<italic>ℓ</italic>), where <italic>ℓ</italic> is the number of infected neighbors of a node, and a constant recovery probability <italic>β</italic>. A notable feature of simple contagion dynamics is that susceptible nodes get infected by the disease through their infected neighbors independently. This reflects the assumption that disease transmission behaves identically whether a person has a large number of infected neighbors or not.</p>
              <p id="Par13">Second, we relax this assumption by considering a <italic>complex contagion</italic> dynamics with a nonmonotonic infection function <italic>α</italic>(<italic>ℓ</italic>) where the aforementioned transmission events are no longer independent<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>. This contagion dynamics has an interesting interpretation in the context of the propagation of a social behavior, where the local popularity of a behavior (large <italic>ℓ</italic>) hinders its adoption. The independent transmission assumption can also be lifted when multiple diseases are interacting<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. Thus, we also consider an asymmetric <italic>interacting contagion</italic> dynamics with two diseases. In this case, <inline-formula id="IEq52"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathcal{S}}}}}}=\left\{{S}_{1}{S}_{2},{I}_{1}{S}_{2},{S}_{1}{I}_{2},{I}_{1}{I}_{2}\right\}=\left\{0,1,2,3\right\}$$\end{document}</tex-math><mml:math id="M118"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">S</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq52.gif"/></alternatives></inline-formula> where <italic>U</italic><sub>1</sub><italic>V</italic><sub>2</sub> corresponds to a state where a node is in state <italic>U</italic> with respect to the first disease and in state <italic>V</italic> with respect to the second disease. The interaction between the diseases happens via a coupling that is active only when a node is infected by at least one disease, otherwise it behaves identically to the simple contagion dynamics. This coupling may increase or decrease the virulence of the other disease.</p>
              <p id="Par14">Whereas the previously presented dynamics capture various features of contagion phenomena, real datasets containing this level of detail about the interactions among individuals are rare<sup><xref ref-type="bibr" rid="CR43">43</xref>–<xref ref-type="bibr" rid="CR45">45</xref></sup>. A class of dynamics for which dataset are easier to find is that of mass-action <italic>metapopulation</italic> dynamics<sup><xref ref-type="bibr" rid="CR46">46</xref>–<xref ref-type="bibr" rid="CR49">49</xref></sup>, where the status of the individuals are gathered by geographical regions. These dynamics typically evolve on the weighted networks of the individuals’ mobility between regions and the state of a region consists in the number of people that are in each individual health state. As a fourth case study, we consider a type of deterministic metapopulation dynamics where the population size is constant and where people can either be susceptible (<italic>S</italic>), infected (<italic>I</italic>) or recovered from the disease (<italic>R</italic>). As a result, we define the state of the node as three-dimensional vectors specifying the fraction of people in each state—i.e. <inline-formula id="IEq53"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathcal{S}}}}}}={{{{{\mathcal{R}}}}}}={[0,1]}^{3}$$\end{document}</tex-math><mml:math id="M120"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">S</mml:mi><mml:mo>=</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">R</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq53.gif"/></alternatives></inline-formula>.</p>
              <p id="Par15">Figure <xref rid="Fig1" ref-type="fig">1</xref> shows the GNN predictions for the infection and recovery probabilities of the simple and complex contagion dynamics as a function of the number of infected neighbors <italic>ℓ</italic>. We then compare these probabilities with their ground truths, i.e. Eq. (<xref rid="Equ20" ref-type="">20</xref>) using Eqs. (<xref rid="Equ18" ref-type="">18</xref>)–(<xref rid="Equ22" ref-type="">22</xref>) for the infection functions. We also show the maximum likelihood estimators (MLE) of the transition probabilities computed from the fraction of nodes in state <italic>x</italic> and with <italic>ℓ</italic> infected neighbors that transitioned to state <italic>y</italic> in the complete dataset <italic>D</italic>. The MLE, which are typically used in this kind of inference problem<sup><xref ref-type="bibr" rid="CR50">50</xref></sup>, stands as a reference to benchmark the performance of our approach.<fig id="Fig1"><label>Fig. 1</label><caption><title>Predictions of GNN trained on a Barabási-Albert random network <sup><xref ref-type="bibr" rid="CR72">72</xref></sup> (BA).</title><p><bold>a</bold> Transition probabilities of the simple contagion dynamics.<bold> b</bold> Transition probabilities of the complex contagion dynamics. The solid and dashed lines correspond to the transition probabilities of the dynamics used to generate the training data (labeled GT for "ground truth''), and predicted by the GNN, respectively. Symbols correspond to the maximum likelihood estimation (MLE) of the transition probabilities computed from the dataset <italic>D</italic>. The colors indicate the type of transition: infection (<italic>S</italic> → <italic>I</italic>) in blue and recovery (<italic>I</italic> → <italic>S</italic>) in red. The standard deviations, as a result of averaging the outcomes given <italic>ℓ</italic>, are shown using a colored area around the lines (typically narrower than the width of the lines) and using vertical bars for the symbols.</p></caption><graphic xlink:href="41467_2021_24732_Fig1_HTML" id="d32e3159"/></fig></p>
              <p id="Par16">We find that the GNN learns remarkably well the transition probabilities of the simple and complex contagion dynamics. In fact, the predictions of the GNN seem to be systematically smoother than the ones provided by the MLE. This is because the MLE is computed for each individual pair (<italic>x</italic>, <italic>ℓ</italic>) from disjoint subsets of the training dataset. This implies that a large number of samples of each pair (<italic>x</italic>, <italic>ℓ</italic>) is needed for the MLE to be accurate; a condition rarely met in realistic settings, especially for high degree nodes. This also means that the MLE cannot be used directly to interpolate beyond the pairs (<italic>x</italic>, <italic>ℓ</italic>) present in the training dataset, in sharp contrast with the GNN which, by definition, can interpolate within the dataset <italic>D</italic>. Furthermore, all of its parameters are hierarchically involved during training, meaning that the GNN benefits from any sample to improve all of its predictions, which are then smoother and more consistent. Further still, we found that not all GNN architectures can reproduce the level of accuracy obtained in Fig. <xref rid="Fig1" ref-type="fig">1</xref> (see Sec. <xref rid="MOESM1" ref-type="media">III</xref> F of the Supplementary Information). In fact, we showed that many standard GNN aggregation mechanisms are ineffective at learning the simple and complex contagion dynamics, most likely because they were specifically designed with structure learning in mind rather than dynamics learning.</p>
              <p id="Par17">It is worth mentioning that the GNN is not specifically designed nor trained to compute the transition probabilities as a function of a single variable, namely the number of infected <italic>ℓ</italic>. In reality, the GNN computes its outcome from the complete multivariate state of the neighbors of a node. The interacting contagion and the metapopulation dynamics, unlike the simple and complex contagions, are examples of such multivariate cases. Their outcome is thus harder to visualize in a representation similar to Fig. <xref rid="Fig1" ref-type="fig">1</xref>. Figure <xref rid="Fig2" ref-type="fig">2</xref>a–h address this issue by comparing each of the GNN predictions <inline-formula id="IEq054"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{y}}_{i}(t)$$\end{document}</tex-math><mml:math id="M122"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq054.gif"/></alternatives></inline-formula> with its corresponding target <italic>y</italic><sub><italic>i</italic></sub>(<italic>t</italic>) in the dataset <italic>D</italic>. We quantify the global performance of the models in different scenarios, for the different dynamics and underlying network structures, using the Pearson correlation coefficient <italic>r</italic> between the predictions and targets (see Sec. “Graph neural network and training details”). We also compute the error, defined from the Pearson coefficient as 1 − <italic>r</italic> for each degree class <italic>k</italic> (i.e. between the predictions and targets of only the nodes of degree <italic>k</italic>). This allows us to quantify the GNN performance for every local structure.<fig id="Fig2"><label>Fig. 2</label><caption><title>GNN learning performance on different dynamics and structures.</title><p><bold>a</bold>, <bold>b</bold>, <bold>c</bold>, <bold>d</bold> GNN trained on Erdős–Rényi networks (ER). ﻿<bold>e</bold>, <bold>f</bold>, <bold>g</bold>, <bold>h</bold> GNN trained on Barabási-Albert networks (BA). <bold>i</bold>, <bold>j</bold>, <bold>k</bold>, <bold>l</bold> Error as a function of the number of neighbors. Each point shown on the panels <bold>a</bold>–<bold>h</bold> corresponds to a different pair <inline-formula id="IEq54"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$({y}_{i}(t),{\hat{y}}_{i}(t))$$\end{document}</tex-math><mml:math id="M124"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq54.gif"/></alternatives></inline-formula> in the complete dataset <italic>D</italic>. We also indicate the Pearson coefficient <italic>r</italic> on each panel to measure the correlation between the predictions and the targets and use it as a global performance measure. The panels <bold>i</bold>–<bold>l</bold> show the errors (1 − <italic>r</italic>) as a function of the number of neighbors for GNN trained on ER and BA networks, and those of the corresponding MLE. These errors are obtained from the Pearson coefficients computed from subsets of the prediction-target pairs where all nodes have degree <italic>k</italic>.</p></caption><graphic xlink:href="41467_2021_24732_Fig2_HTML" id="d32e3379"/></fig></p>
              <p id="Par18">Figures <xref rid="Fig2" ref-type="fig">2</xref>i–k confirm that the GNN provides more accurate predictions than the MLE in general and across all degrees. This is especially true in the case of the interacting contagion, where the accuracy of the MLE seems to deteriorate rapidly for large degree nodes. This is a consequence of how scarce the inputs are for this dynamics compared to both the simple and complex contagion dynamics for training datasets of the same size, and of how fast the size of the set of possible inputs scales, thereby quickly rendering MLE completely ineffective for small training datasets. The GNN, on the other hand, is less affected by the scarcity of the data, since any sample improves its global performance, as discussed above.</p>
              <p id="Par19">Figure <xref rid="Fig2" ref-type="fig">2</xref> also exposes the crucial role of the network <italic>G</italic> on which the dynamics evolves in the global performance of the GNN. Namely, the heterogeneous degree distributions of Barabási-Albert networks (BA)—or any heterogeneous degree distribution—offer a wider range of degrees than those of homogeneous Erdős-Rényi networks (ER). We can take advantage of this heterogeneity to train GNN models that generalize well across a larger range of local structures, as seen in Fig. <xref rid="Fig2" ref-type="fig">2</xref>i–l (see also Sec. III of the Supplementary Information). However, the predictions on BA networks are not systematically always better for low degrees than those on ER networks, as seen in the interacting and metapopulation cases. This nonetheless suggests a wide applicability of our approach for real complex systems, whose underlying network structures recurrently exhibit a heterogeneous degree distribution<sup><xref ref-type="bibr" rid="CR51">51</xref></sup>.</p>
              <p id="Par20">We now test the trained GNN on unseen network structures by recovering the bifurcation diagrams of the four dynamics. In the infinite-size limit <inline-formula id="IEq55"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$| {{{{{\mathcal{V}}}}}}| \to \infty$$\end{document}</tex-math><mml:math id="M126"><mml:mo>∣</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">V</mml:mi><mml:mo>∣</mml:mo><mml:mo>→</mml:mo><mml:mi>∞</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq55.gif"/></alternatives></inline-formula>, these dynamics have two possible long-term outcomes: the absorbing state where the diseases quickly die out, and the endemic/epidemic state in which a macroscopic fraction of nodes remains (endemic) or has been infected over time (epidemic)<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR10">10</xref>,<xref ref-type="bibr" rid="CR52">52</xref></sup>. These possible long-term outcomes exchange stability during a phase transition which is continuous for the simple contagion and metapopulation dynamics, and discontinuous for the complex and interacting contagion dynamics. The position of the phase transition depends on the parameters of the dynamics as well as on the topology of the network. Note that for the interacting contagion dynamics, the stability of absorbing and endemic states do not change at the same point, giving rise to a bistable regime where both states are stable.</p>
              <p id="Par21">Figure <xref rid="Fig3" ref-type="fig">3</xref> shows the different bifurcation diagrams obtained by performing numerical simulations with the trained GNN models [using Eq. (<xref rid="Equ5" ref-type="">5</xref>)] while varying the average degree of networks, on which the GNN has not been trained. Quantitatively, the predictions are again strikingly accurate—essentially perfect for the simple and complex contagion dynamics—which is remarkable given that the bifurcation diagrams were obtained on networks the GNN had never seen before. These results illustrate how insights can be gained about the underlying process concerning the existence of phase transitions and their order, among other things. They also suggest how the GNN can be used for diverse applications, such as predicting the dynamics under various network structures (e.g. designing intervention strategies that affect the way individuals interact and are therefore connected).<fig id="Fig3"><label>Fig. 3</label><caption><title>Bifurcation diagrams of the trained GNN.</title><p><bold>a</bold> Simple contagion dynamics. <bold>b</bold> Complex contagion dynamics. <bold>c</bold> Interacting contagion dynamics. <bold>d</bold> Metapopulation dynamics. In these experiments, we used Poisson networks composed of <inline-formula id="IEq02"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|{{{\mathcal{V}}}}| = 2000$$\end{document}</tex-math><mml:math id="M128"><mml:mo>∣</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">V</mml:mi><mml:mo>∣</mml:mo><mml:mo>=</mml:mo><mml:mn>2000</mml:mn></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq02.gif"/></alternatives></inline-formula> nodes with different average degrees <inline-formula id="IEq03"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\langle k \rangle$$\end{document}</tex-math><mml:math id="M130"><mml:mo>⟨</mml:mo><mml:mi>k</mml:mi><mml:mo>⟩</mml:mo></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq03.gif"/></alternatives></inline-formula>. The prevalence is defined as the average fraction of nodes that are asymptotically infected by at least one disease and the outbreak size corresponds to the average fraction of nodes that have recovered. These quantities are obtained from numerical simulations using the "ground truth" (GT) dynamics (blue circles) and the GNN trained on Barabási-Albert networks (orange triangles). The error bars correspond to the standard deviations of these numerical simulations. The trained GNN used are the same ones as those used for Fig. <xref rid="Fig2" ref-type="fig">2</xref>. As a reference, we also indicate with dashed lines the value(s) of average degree 〈<italic>k</italic>〉 corresponding to the network(s) on which the GNN were trained. On <bold>d</bold>, more than one value of 〈<italic>k</italic>〉 appear as multiple networks with different average degrees were used to train the GNN (see Sec. "Graph neural networks and training details").</p></caption><graphic xlink:href="41467_2021_24732_Fig3_HTML" id="d32e3504"/></fig></p>
              <p id="Par22">Finally, we illustrate the applicability of our approach by training our GNN model using the evolution of COVID-19 in Spain between January 1st 2020 and March 27th 2021 (see Fig. <xref rid="Fig4" ref-type="fig">4</xref>). This dataset consists of the daily number of new cases (i.e. incidence) for each of the 50 provinces of Spain as well as Ceuta and Melilla<sup><xref ref-type="bibr" rid="CR53">53</xref></sup>. We also use a network of the mobility flow recorded in 2018<sup><xref ref-type="bibr" rid="CR54">54</xref></sup> as a proxy to model the interaction network between these 52 regions. This network is multiplex—each layer corresponding to a different mode of transportation—, directed and weighted (average daily mobility flow).<fig id="Fig4"><label>Fig. 4</label><caption><title>Spain COVID-19 dataset.</title><p><bold>a</bold> Spain mobility multiplex network<sup><xref ref-type="bibr" rid="CR54">54</xref></sup>. The thickness of the edges is proportional to the average number of people transitioning between all connected node pairs. The size of the nodes is proportional to the population <italic>N</italic><sub><italic>i</italic></sub> living in the province. <bold>b</bold> Time series of the incidence for the 52 provinces of Spain between January 2020 and March 2021<sup><xref ref-type="bibr" rid="CR53">53</xref></sup>. Each province is identified by its corresponding ISO code. Each incidence time series has been rescaled by its maximum value for the purpose of visualization. The shaded area indicates the training and validation datasets (in-sample) from January 1st 2020 to December 1st 2021. The remaining dataset is used for testing.</p></caption><graphic xlink:href="41467_2021_24732_Fig4_HTML" id="d32e3547"/></fig></p>
              <p id="Par23">We compare the performance of our approach with that of different baselines: Four data-driven techniques—three competing neural network architectures<sup><xref ref-type="bibr" rid="CR37">37</xref>,<xref ref-type="bibr" rid="CR55">55</xref></sup> and a linear vector autoregressive model (VAR)<sup><xref ref-type="bibr" rid="CR56">56</xref>,<xref ref-type="bibr" rid="CR57">57</xref></sup>—, and an equivalent mechanistic metapopulation model (Metapop.) driven by a simple contagion mechanism<sup><xref ref-type="bibr" rid="CR58">58</xref></sup>. Among the three neural network architectures, we used the model of ref. <sup><xref ref-type="bibr" rid="CR37">37</xref></sup> (KP-GNN) that has been used to predict the evolution of COVID-19 in the US. In a way of an ablation study, the other two GNN architectures embody the assumptions that the nodes of the networks are mutually independent (IND), or that the nodes are arbitrarily codependent (FC) in a way that is learned by the neural network. Note that there exists a wide variety of GNN architectures designed to handle dynamics <italic>of</italic> networks<sup><xref ref-type="bibr" rid="CR38">38</xref></sup>—networks whose topology evolves over time—but that these architectures are not typically adapted for learning dynamics <italic>on</italic> networks (see Sec. III F of the Supplementary Information). Finally, we used the parameters of ref. <sup><xref ref-type="bibr" rid="CR59">59</xref></sup> for the metapopulation model. Section “COVID-19 outbreak in Spain” provides more details on the baselines.</p>
              <p id="Par24">Figure <xref rid="Fig5" ref-type="fig">5</xref> shows that all data-driven models can generate highly accurate in-sample predictions, with the exception of the KP-GNN model which appears to have a hard time learning the dynamics, possibly because of its aggregation mechanism (see Sec. <xref rid="MOESM1" ref-type="media">III</xref>F of the Supplementary Information). This further substantiates the idea that many GNN architectures designed for structure learning, like the graph convolutional network<sup><xref ref-type="bibr" rid="CR60">60</xref></sup> at the core the KP-GNN model, are suboptimal for dynamics learning problems. However, the other architectures do not appear to have the same capability to generalize the dynamics out-of-sample: The FC and the VAR models, especially, tend to overfit more than the GNN and the IND models. While this was expected for the linear VAR model, the FC model overfits because it is granted too much freedom in the way it learns how the nodes interact with one another. Interestingly, the IND and the GNN models seem to perform similarly, which hints at the possibility that the specifics of the mobility network might not have contributed significantly to the dynamics. This is perhaps not surprising since social distancing and confinement measures were in place during the period covered by the dataset. Indeed, our results indicate that the global effective dynamics was mostly driven by internal processes within each individual province, rather than driven by the interaction between them. This last observation suggests that our GNN model is robust to spurious connections in the interaction network.<fig id="Fig5"><label>Fig. 5</label><caption><title>Learning the Spain COVID-19 dataset.</title><p><bold>a</bold>, <bold>b</bold> Comparison between the targets and the predictions in the in-sample and the out-of-sample datasets for our GNN model (blue) and for other models (KP-GNN in orange, IND in pink, FC in purple and VAR in green; see main text). The accuracy of the predictions is quantified by the Pearson correlation coefficient provided in the legend. <bold>c</bold> Forecasts by our GNN model for individual time series of the provincial daily incidence compared with the ground truth. Underestimation and overestimation are respectively shown in blue and red. Each time series has been rescaled as in Fig. <xref rid="Fig4" ref-type="fig">4</xref>b and are ordered according to mean square error of the GNN’s predictions. <bold>d</bold> Forecasts for the global incidence (sum of the daily incidence in every province). The solid gray line indicates the ground truth (GT); the dashed blue line, the dashed orange line and dotted green line show the forecast of our GNN model, of KP-GNN and of VAR, respectively. We also show the forecast of an equivalent metapopulation model (red dash-dotted line) which has its own scale (red axis on the right) to improve the visualization; the other lines share the same axis on the left. Similarly to Fig. <xref rid="Fig4" ref-type="fig">4</xref>, we differentiate the in-sample from the out-of-sample forecasts using a shaded background.</p></caption><graphic xlink:href="41467_2021_24732_Fig5_HTML" id="d32e3626"/></fig></p>
              <p id="Par25">Finally, Fig. <xref rid="Fig5" ref-type="fig">5</xref>d shows that the metapopulation model is systematically overestimating the incidence by over an order of magnitude. Again, this is likely due to the confinement measures in place during that period which were not reflected in the original parameters of the dynamics<sup><xref ref-type="bibr" rid="CR59">59</xref></sup>. Additional mechanisms accounting for this interplay between social restrictions and the prevalence of the disease—e.g. complex contagion mechanisms<sup><xref ref-type="bibr" rid="CR12">12</xref></sup> or time-dependent parameters<sup><xref ref-type="bibr" rid="CR61">61</xref></sup>—would therefore be in order to extend the validity of the metapopulation model to the full length of the dataset. Interestingly, a signature of this interplay is encoded in the daily incidence data and our GNN model appears to be able to capture it to some extent.</p>
            </sec>
            <sec id="Sec3" sec-type="discussion">
              <title>Discussion</title>
              <p id="Par26">We introduced a data-driven approach that learns effective mechanisms governing the propagation of diverse dynamics on complex networks. We proposed a reliable training protocol, and we validated the projections of our GNN architecture on simple, complex, interacting contagion and metapopulation dynamics using synthetic networks. Interestingly, we found that many standard GNN architectures do not handle correctly the problem of learning contagion dynamics from time series. Also, we found that our approach performs better when trained on data whose underlying network structure is heterogeneous, which could prove useful in real-world applications of our method given the ubiquitousness of scale-free networks<sup><xref ref-type="bibr" rid="CR62">62</xref></sup>.</p>
              <p id="Par27">By recovering the bifurcation diagram of various dynamics, we illustrated how our approach can leverage time series from an unknown dynamical process to gain insights about its properties—e.g. the existence of a phase transition and its order. We have also shown how to use this framework on real datasets, which in turn could then be used to help build better effective models. In a way, we see this approach as the equivalent of a numerical Petri dish—offering a new way to experiment and gain insights about an unknown dynamics—that is complementary to traditional mechanistic modeling to design better intervention procedures, containment countermeasures and to perform model selection.</p>
              <p id="Par28">Although we focused the presentation of our method on contagion dynamics, its potential applicability reaches many other realms of complex systems modeling where intricate mechanisms are at play. We believe this work establishes solid foundations for the use of deep learning in the design of realistic effective models of complex systems.</p>
              <p id="Par29">Gathering detailed epidemiological datasets is a complex and labor-intensive process, meaning that datasets suitable for our approach are currently the exception rather than the norm. The current COVID-19 pandemic has, however, shown how an adequate international reaction to an emerging infectious pathogen critically depends on the free flow of information. New initiatives like Golbal health<sup><xref ref-type="bibr" rid="CR63">63</xref></sup> are good examples of how the international epidemiological community is coming together to share data more openly and to make available comprehensive datasets to all researchers. Thanks to such initiatives, it is likely that future pandemics will see larger amount of data available to the scientific community in real time. It is therefore crucial for the community to start developing tools, such as the one presented here, to leverage these datasets so that we are ready for the next pandemic.</p>
            </sec>
            <sec id="Sec4">
              <title>Methods</title>
              <sec id="Sec5">
                <title>Graph neural network and training details</title>
                <p id="Par30">In this section, we briefly present our GNN architecture, the training settings, the synthetic data generation procedure and the hyperparmeters used in our experiments.</p>
                <sec id="Sec6">
                  <title>Architecture</title>
                  <p id="Par31">We use the GNN architecture shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref> and detailed in Table <xref rid="Tab1" ref-type="table">1</xref>. First, we transform the state <italic>x</italic><sub><italic>i</italic></sub> of every node with a shared multilayer perception (MLP), denoted <inline-formula id="IEq56"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{f}}_{{{{{{\rm{in}}}}}}}:{{{{{\mathcal{S}}}}}}\to {{\mathbb{R}}}^{d}$$\end{document}</tex-math><mml:math id="M132"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">S</mml:mi><mml:mo>→</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq56.gif"/></alternatives></inline-formula> where <italic>d</italic> is the resulting number of node features, such that<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\xi }_{i}={\hat{f}}_{{{{{{\rm{in}}}}}}}({x}_{i}).$$\end{document}</tex-math><mml:math id="M134"><mml:msub><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math><graphic xlink:href="41467_2021_24732_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>We concatenate the node attributes Φ<sub><italic>i</italic></sub> to <italic>x</italic><sub><italic>i</italic></sub>, when these attributes are available, in which case <inline-formula id="IEq57"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{f}}_{{{{{{\rm{in}}}}}}}:{{{{{\mathcal{S}}}}}}\times {{\mathbb{R}}}^{Q}\to {{\mathbb{R}}}^{d}$$\end{document}</tex-math><mml:math id="M136"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">in</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">S</mml:mi><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:msup><mml:mo>→</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq57.gif"/></alternatives></inline-formula>. At this point, <italic>ξ</italic><sub><italic>i</italic></sub> is a vector of features representing the state (and attributes) of node <italic>v</italic><sub><italic>i</italic></sub>. Then, we aggregate the features of the first neighbors using a modified attention mechanism <inline-formula id="IEq58"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{f}}_{{{{{{\rm{att}}}}}}}$$\end{document}</tex-math><mml:math id="M138"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">att</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq58.gif"/></alternatives></inline-formula>, inspired by ref. <sup><xref ref-type="bibr" rid="CR41">41</xref></sup> (see Section “Attention mechanism”),<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\nu }_{i}={\hat{f}}_{{{{{{\rm{att}}}}}}}({\xi }_{i},{\xi }_{{{{{{{\mathcal{N}}}}}}}_{i}}),$$\end{document}</tex-math><mml:math id="M140"><mml:msub><mml:mrow><mml:mi>ν</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">att</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41467_2021_24732_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>where we recall that <inline-formula id="IEq59"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\mathcal{N}}}}}}}_{i}=\{{v}_{j}| {e}_{ij}\in {{{{{\mathcal{E}}}}}}\}$$\end{document}</tex-math><mml:math id="M142"><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">E</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq59.gif"/></alternatives></inline-formula> is the set of nodes connected to node <italic>v</italic><sub><italic>i</italic></sub>. We also include the edge attributes Ω<sub><italic>i</italic><italic>j</italic></sub> into the attention mechanism, when they are available. To do so, we transform the edge attributes Ω<sub><italic>i</italic><italic>j</italic></sub> into abstract edge features, such that <inline-formula id="IEq60"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\psi }_{ij}={\hat{f}}_{{{{{{\rm{edge}}}}}}}({{{\Omega }}}_{ij})$$\end{document}</tex-math><mml:math id="M144"><mml:msub><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">edge</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq60.gif"/></alternatives></inline-formula> where <inline-formula id="IEq61"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{f}}_{{{{{{\rm{edge}}}}}}}:{{\mathbb{R}}}^{P}\to {{\mathbb{R}}}^{{d}_{{{{{{\rm{edge}}}}}}}}$$\end{document}</tex-math><mml:math id="M146"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">edge</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msup><mml:mo>→</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">edge</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq61.gif"/></alternatives></inline-formula> is also a MLP, before they are used in the aggregation. Finally, we compute the outcome <inline-formula id="IEq62"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{y}}_{i}$$\end{document}</tex-math><mml:math id="M148"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq62.gif"/></alternatives></inline-formula> of each node <italic>v</italic><sub><italic>i</italic></sub> with another MLP <inline-formula id="IEq63"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{f}}_{{{{{{\rm{out}}}}}}}:{{\mathbb{R}}}^{d}\to {{{{{\mathcal{R}}}}}}$$\end{document}</tex-math><mml:math id="M150"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">out</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msup><mml:mo>→</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">R</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq63.gif"/></alternatives></inline-formula> such that<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{y}}_{i}={\hat{f}}_{{{{{{\rm{out}}}}}}}({\nu }_{i})\ .$$\end{document}</tex-math><mml:math id="M152"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">out</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>ν</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.33em"/><mml:mo>.</mml:mo></mml:math><graphic xlink:href="41467_2021_24732_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula><fig id="Fig6"><label>Fig. 6</label><caption><title>Visualization of the GNN architecture.</title><p>The blocks of different colors represent mathematical operations. The red blocks correspond to trainable affine transformation parametrized by weights and biases. The purple blocks represent activation functions between each layer. The core of the model is the attention module<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>, which is represented in blue. The orange block at the end is an activation function that transforms the output into the proper outcomes.</p></caption><graphic xlink:href="41467_2021_24732_Fig6_HTML" id="d32e4198"/></fig><table-wrap id="Tab1"><label>Table 1</label><caption><p>Layer by layer description of the GNN models for each dynamics.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Dynamics</th><th>Simple</th><th>Complex</th><th>Interacting</th><th>Metapopulation</th><th>COVID-19</th></tr></thead><tbody><tr><td>Input layers</td><td><inline-formula id="IEq65"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{l}{{{{{\rm{Linear}}}}}}(1,32)\hfill\\ {{{{{\rm{ReLU}}}}}}\hfill\\ {{{{{\rm{Linear}}}}}}(32,32)\\ {{{{{\rm{ReLU}}}}}}\hfill\end{array}$$\end{document}</tex-math><mml:math id="M154"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">Linear</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>32</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">ReLU</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">Linear</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>32</mml:mn><mml:mo>,</mml:mo><mml:mn>32</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">ReLU</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq65.gif"/></alternatives></inline-formula></td><td><inline-formula id="IEq66"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{l}{{{{{\rm{Linear}}}}}}(1,32)\hfill\\ {{{{{\rm{ReLU}}}}}}\hfill\\ {{{{{\rm{Linear}}}}}}(32,32)\hfill\\ {{{{{\rm{ReLU}}}}}}\hfill\end{array}$$\end{document}</tex-math><mml:math id="M156"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">Linear</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>32</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">ReLU</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">Linear</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>32</mml:mn><mml:mo>,</mml:mo><mml:mn>32</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">ReLU</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq66.gif"/></alternatives></inline-formula></td><td><inline-formula id="IEq67"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{l}\kern-0.5pc{{{{{\rm{Linear}}}}}}(1,32)\\ {{{{{\rm{ReLU}}}}}}\hfill\\ {{{{{\rm{Linear}}}}}}(32,32)\hfill\\ {{{{{\rm{ReLU}}}}}}\hfill\\ {{{{{\rm{Linear}}}}}}(32,32)\hfill\\ {{{{{\rm{ReLU}}}}}}\hfill\end{array}$$\end{document}</tex-math><mml:math id="M158"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">Linear</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>32</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">ReLU</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">Linear</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>32</mml:mn><mml:mo>,</mml:mo><mml:mn>32</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">ReLU</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">Linear</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>32</mml:mn><mml:mo>,</mml:mo><mml:mn>32</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">ReLU</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq67.gif"/></alternatives></inline-formula></td><td><inline-formula id="IEq68"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{l}{{{{{\rm{Linear}}}}}}{(4,32)}^{* }\hfill\\ {{{{{\rm{ReLU}}}}}}\hfill\\ {{{{{\rm{Linear}}}}}}(32,32)\hfill\\ {{{{{\rm{ReLU}}}}}}\hfill\\ {{{{{\rm{Linear}}}}}}(32,32)\hfill\\ {{{{{\rm{ReLU}}}}}}\hfill\\ {{{{{\rm{Linear}}}}}}(32,32)\hfill\\ {{{{{\rm{ReLU}}}}}}\hfill\end{array}$$\end{document}</tex-math><mml:math id="M160"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">Linear</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>32</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">ReLU</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">Linear</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>32</mml:mn><mml:mo>,</mml:mo><mml:mn>32</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">ReLU</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">Linear</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>32</mml:mn><mml:mo>,</mml:mo><mml:mn>32</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">ReLU</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">Linear</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>32</mml:mn><mml:mo>,</mml:mo><mml:mn>32</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">ReLU</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq68.gif"/></alternatives></inline-formula></td><td><inline-formula id="IEq69"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{l}{{{{{\rm{RNN}}}}}}{(2,4;L)}^{* }\hfill\\ {{{{{\rm{ReLU}}}}}}\hfill\\ {{{{{\rm{RNN}}}}}}(4,8;L)\hfill\\ {{{{{\rm{ReLU}}}}}}\hfill\\ {{{{{\rm{RNN}}}}}}{(8,16;L)}^{* * }\hfill\\ {{{{{\rm{ReLU}}}}}}\hfill\\ {{{{{\rm{Linear}}}}}}(16,32)\hfill\\ {{{{{\rm{ReLU}}}}}}\hfill\end{array}$$\end{document}</tex-math><mml:math id="M162"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">RNN</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>;</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">ReLU</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">RNN</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>8</mml:mn><mml:mo>;</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">ReLU</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">RNN</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>8</mml:mn><mml:mo>,</mml:mo><mml:mn>16</mml:mn><mml:mo>;</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>*</mml:mo><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">ReLU</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">Linear</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>16</mml:mn><mml:mo>,</mml:mo><mml:mn>32</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">ReLU</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq69.gif"/></alternatives></inline-formula></td></tr><tr><td>Number of attention layers</td><td>2</td><td>2</td><td>4</td><td>8<sup>†</sup></td><td>5<sup>††</sup></td></tr><tr><td>Output layers</td><td><inline-formula id="IEq70"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{l}{{{{{\rm{Linear}}}}}}(32,32)\hfill\\ {{{{{\rm{ReLU}}}}}}\hfill\\ {{{{{\rm{Linear}}}}}}(32,2)\hfill\\ {{{{{\rm{Softmax}}}}}}\hfill\end{array}$$\end{document}</tex-math><mml:math id="M164"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">Linear</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>32</mml:mn><mml:mo>,</mml:mo><mml:mn>32</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">ReLU</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">Linear</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>32</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">Softmax</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq70.gif"/></alternatives></inline-formula></td><td><inline-formula id="IEq71"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{l}{{{{{\rm{Linear}}}}}}(32,32)\hfill\\ {{{{{\rm{ReLU}}}}}}\hfill\\ {{{{{\rm{Linear}}}}}}(32,2)\hfill\\ {{{{{\rm{Softmax}}}}}}\hfill\end{array}$$\end{document}</tex-math><mml:math id="M166"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">Linear</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>32</mml:mn><mml:mo>,</mml:mo><mml:mn>32</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">ReLU</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">Linear</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>32</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">Softmax</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq71.gif"/></alternatives></inline-formula></td><td><inline-formula id="IEq72"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{l}{{{{{\rm{Linear}}}}}}(32,32)\hfill\\ {{{{{\rm{ReLU}}}}}}\hfill\\ {{{{{\rm{Linear}}}}}}(32,32)\hfill\\ {{{{{\rm{ReLU}}}}}}\hfill\\ {{{{{\rm{Linear}}}}}}(32,4)\hfill\\ {{{{{\rm{Softmax}}}}}}\hfill\end{array}$$\end{document}</tex-math><mml:math id="M168"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">Linear</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>32</mml:mn><mml:mo>,</mml:mo><mml:mn>32</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">ReLU</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">Linear</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>32</mml:mn><mml:mo>,</mml:mo><mml:mn>32</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">ReLU</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">Linear</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>32</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">Softmax</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq72.gif"/></alternatives></inline-formula></td><td><inline-formula id="IEq73"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{l}{{{{{\rm{Linear}}}}}}(32,32)\hfill\\ {{{{{\rm{ReLU}}}}}}\hfill\\ {{{{{\rm{Linear}}}}}}(32,32)\hfill\\ {{{{{\rm{ReLU}}}}}}\hfill\\ {{{{{\rm{Linear}}}}}}(32,32)\hfill\\ {{{{{\rm{ReLU}}}}}}\hfill\\ {{{{{\rm{Linear}}}}}}(32,3)\hfill\\ {{{{{\rm{Softmax}}}}}}\hfill\end{array}$$\end{document}</tex-math><mml:math id="M170"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">Linear</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>32</mml:mn><mml:mo>,</mml:mo><mml:mn>32</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">ReLU</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">Linear</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>32</mml:mn><mml:mo>,</mml:mo><mml:mn>32</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">ReLU</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">Linear</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>32</mml:mn><mml:mo>,</mml:mo><mml:mn>32</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">ReLU</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">Linear</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>32</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">Softmax</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq73.gif"/></alternatives></inline-formula></td><td><inline-formula id="IEq74"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{l}{{{{{\rm{Linear}}}}}}{(32,16)}\hfill\\ {{{{{\rm{ReLU}}}}}}\hfill\\ {{{{{\rm{Linear}}}}}}(16,8)\hfill\\ {{{{{\rm{ReLU}}}}}}\hfill\\ {{{{{\rm{Linear}}}}}}(8,4)\hfill\\ {{{{{\rm{ReLU}}}}}}\hfill\\ {{{{{\rm{Linear}}}}}}(4,1)\hfill\end{array}$$\end{document}</tex-math><mml:math id="M172"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">Linear</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>32</mml:mn><mml:mo>,</mml:mo><mml:mn>16</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">ReLU</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">Linear</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>16</mml:mn><mml:mo>,</mml:mo><mml:mn>8</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">ReLU</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">Linear</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>8</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">ReLU</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">Linear</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq74.gif"/></alternatives></inline-formula></td></tr><tr><td>Number of parameters</td><td>6 698</td><td>6 698</td><td>11 188</td><td>99 883</td><td>7 190</td></tr></tbody></table><table-wrap-foot><p>For each sequence, the operations are applied from top to bottom. The operations represented by Linear(<italic>m</italic>, <italic>n</italic>) correspond to linear (or affine) transformations of the form <italic>f</italic>(<bold><italic>x</italic></bold>) = <bold><italic>W</italic></bold><bold><italic>x</italic></bold> + <bold><italic>b</italic></bold>, where <inline-formula id="IEq75"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\boldsymbol{x}}}}}}\in {{\mathbb{R}}}^{m}$$\end{document}</tex-math><mml:math id="M174"><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq75.gif"/></alternatives></inline-formula> is the input, <inline-formula id="IEq76"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\boldsymbol{W}}}}}}\in {{\mathbb{R}}}^{n\times m}$$\end{document}</tex-math><mml:math id="M176"><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq76.gif"/></alternatives></inline-formula> and <inline-formula id="IEq77"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\boldsymbol{b}}}}}}\in {{\mathbb{R}}}^{n}$$\end{document}</tex-math><mml:math id="M178"><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq77.gif"/></alternatives></inline-formula> are trainable parameters. The operation RNN(<italic>m</italic>, <italic>n</italic>; <italic>L</italic>) corresponds to an Elman recurrent neural network module<sup><xref ref-type="bibr" rid="CR68">68</xref></sup> with <italic>m</italic> input features and <italic>n</italic> output features applied on sequences of length <italic>L</italic><sup><xref ref-type="bibr" rid="CR68">68</xref></sup>. The operations ReLU and <inline-formula id="IEq78"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\rm{Softmax}}}}}}$$\end{document}</tex-math><mml:math id="M180"><mml:mi mathvariant="normal">Softmax</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq78.gif"/></alternatives></inline-formula> are activation functions given by <inline-formula id="IEq79"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\rm{ReLU}}}}}}(x)=\max \left\{x,0\right\}$$\end{document}</tex-math><mml:math id="M182"><mml:mi mathvariant="normal">ReLU</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>max</mml:mi><mml:mfenced close="}" open="{"><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq79.gif"/></alternatives></inline-formula> and <inline-formula id="IEq80"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\rm{Softmax}}}}}}({{{{{\boldsymbol{x}}}}}})=\frac{\exp ({{{{{\boldsymbol{x}}}}}})}{{\sum }_{i}\exp ({x}_{i})}$$\end{document}</tex-math><mml:math id="M184"><mml:mi mathvariant="normal">Softmax</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq80.gif"/></alternatives></inline-formula>.</p><p><sup>*</sup> Here, the dimension of the input is increased by one, because we aggregated to the state of the nodes <italic>x</italic><sub><italic>i</italic></sub> their rescaled and centered population size <italic>N</italic><sub><italic>i</italic></sub>.</p><p><sup>**</sup> Here, only the features of the last element of the sequence—those corresponding to the state <italic>X</italic><sub><italic>t</italic></sub>—are kept to proceed further into the architecture.</p><p><sup>†</sup> Because the networks are weighted for the metapopulation dynamics, we initially transform the edge weights into abstract feature representations using a sequence of layers, i.e. <inline-formula id="IEq81"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left({{{{{\rm{Linear}}}}}}(1,4),{{{{{\rm{ReLU}}}}}},{{{{{\rm{Linear}}}}}}(4,4)\right)$$\end{document}</tex-math><mml:math id="M186"><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="normal">Linear</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="normal">ReLU</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Linear</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq81.gif"/></alternatives></inline-formula> applied from left to right, before using them in the attention modules. These layers are trained alongside all the other layers.</p><p><sup>††</sup> The network is also weighted in this case, hence we used the same set up as for the metapopulation GNN model to transform the edge weights. Also, note that the five attention modules are each associated to a different layer in the multiplex network.</p></table-wrap-foot></table-wrap></p>
                </sec>
                <sec id="Sec7">
                  <title>Attention mechanism</title>
                  <p id="Par32">We use an attention mechanism inspired by the graph attention network architecture (GAT)<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>. The attention mechanism consists of three trainable functions <inline-formula id="IEq64"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathcal{A}}}}}}:{{\mathbb{R}}}^{d}\to {\mathbb{R}}$$\end{document}</tex-math><mml:math id="M188"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">A</mml:mi><mml:mo>:</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msup><mml:mo>→</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq64.gif"/></alternatives></inline-formula>, <inline-formula id="IEq065"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathcal{B}}}}}}:{{\mathbb{R}}}^{d}\to {\mathbb{R}}$$\end{document}</tex-math><mml:math id="M190"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">B</mml:mi><mml:mo>:</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msup><mml:mo>→</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq065.gif"/></alternatives></inline-formula> and <inline-formula id="IEq066"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathcal{C}}}}}}:{{\mathbb{R}}}^{{d}_{{{{{{\rm{edge}}}}}}}}\to {\mathbb{R}}$$\end{document}</tex-math><mml:math id="M192"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">C</mml:mi><mml:mo>:</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">edge</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>→</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq066.gif"/></alternatives></inline-formula>, that combine the feature vectors <italic>ξ</italic><sub><italic>i</italic></sub>, <italic>ξ</italic><sub><italic>j</italic></sub> and <italic>ψ</italic><sub><italic>i</italic><italic>j</italic></sub> of a connected pair of nodes <italic>v</italic><sub><italic>i</italic></sub> and <italic>v</italic><sub><italic>j</italic></sub>, where we recall that <italic>d</italic> and <italic>d</italic><sub>edge</sub> are the number of node and edge features, respectively. Then, the attention coefficient <italic>a</italic><sub><italic>i</italic><italic>j</italic></sub> is computed as follows<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${a}_{ij}=\sigma \left[{{{{{\mathcal{A}}}}}}\left({\xi }_{i}\right)+{{{{{\mathcal{B}}}}}}\left({\xi }_{j}\right)+{{{{{\mathcal{C}}}}}}\left({\psi }_{ij}\right)\right]$$\end{document}</tex-math><mml:math id="M194"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>σ</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">A</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">B</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">C</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2021_24732_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq067"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma (x)={[1+{e}^{-x}]}^{-1}$$\end{document}</tex-math><mml:math id="M196"><mml:mi>σ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq067.gif"/></alternatives></inline-formula> is the logistic function. Notice that, by using this logistic function, the value of the attention coefficients is constrained to the open interval (0, 1), where <italic>a</italic><sub><italic>i</italic><italic>j</italic></sub> = 0 implies that the feature <italic>ξ</italic><sub><italic>j</italic></sub> does not change the value of <italic>ν</italic><sub><italic>i</italic></sub>, and <italic>a</italic><sub><italic>i</italic><italic>j</italic></sub> = 1 implies that it maximally changes the value of <italic>ν</italic><sub><italic>i</italic></sub>. In principle, <italic>a</italic><sub><italic>i</italic><italic>j</italic></sub> quantifies the influence of the state of node <italic>v</italic><sub><italic>j</italic></sub> over the outcome of node <italic>v</italic><sub><italic>i</italic></sub>. In reality, the representation learned by the GNN can be non-sparse, meaning that the neighbor features <inline-formula id="IEq068"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\xi }_{{{{{{{\mathcal{N}}}}}}}_{i}}$$\end{document}</tex-math><mml:math id="M198"><mml:msub><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq068.gif"/></alternatives></inline-formula> can be combined in such a way that their noncontributing parts are canceled out without having <italic>a</italic><sub><italic>i</italic><italic>j</italic></sub> being necessarily zero. This can result in the failure of this interpretation of this attention coefficients (see the Supplementary Information for further details). Nevertheless, the attention coefficients can be used to assess how connected nodes interact together.</p>
                  <p id="Par33">We compute the aggregated feature vectors <inline-formula id="IEq069"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nu_i$$\end{document}</tex-math><mml:math id="M200"><mml:msub><mml:mrow><mml:mi>ν</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq069.gif"/></alternatives></inline-formula> of node <inline-formula id="IEq070"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_i$$\end{document}</tex-math><mml:math id="M202"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq070.gif"/></alternatives></inline-formula> as<disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\nu }_{i}={\hat{f}}_{{{{{{\rm{att}}}}}}}({\xi }_{i},{\xi }_{{{{{{{\mathcal{N}}}}}}}_{i}})={\xi }_{i}+\mathop{\sum}\limits_{{v}_{j}\in {{{{{{\mathcal{N}}}}}}}_{i}}{a}_{ij}{\xi }_{j}.$$\end{document}</tex-math><mml:math id="M204"><mml:msub><mml:mrow><mml:mi>ν</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">att</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:math><graphic xlink:href="41467_2021_24732_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula>It is important to stress that, at this point, <inline-formula id="IEq071"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nu_i$$\end{document}</tex-math><mml:math id="M206"><mml:msub><mml:mrow><mml:mi>ν</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq071.gif"/></alternatives></inline-formula> contains some information about <inline-formula id="IEq072"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_i$$\end{document}</tex-math><mml:math id="M208"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq072.gif"/></alternatives></inline-formula> and all of its neighbors in a pairwise manner. In all our experiments, we fix <inline-formula id="IEq073"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathcal{A}}}}}}$$\end{document}</tex-math><mml:math id="M210"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">A</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq073.gif"/></alternatives></inline-formula>, <inline-formula id="IEq074"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathcal{B}}}}}}$$\end{document}</tex-math><mml:math id="M212"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">B</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq074.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq075"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathcal{C}}}}}}$$\end{document}</tex-math><mml:math id="M214"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">C</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq075.gif"/></alternatives></inline-formula> to be affine transformations with trainable weight matrix and bias vector. Also, we use multiple attention modules in parallel to increase the expressive power of the GNN architecture, as suggested by ref. <sup><xref ref-type="bibr" rid="CR41">41</xref></sup>.</p>
                  <p id="Par34">The attention mechanism described by Eq. (<xref rid="Equ11" ref-type="">11</xref>) is slightly different from the vanilla version of ref. <sup><xref ref-type="bibr" rid="CR41">41</xref></sup>. Similarly to other well-known GNN architectures<sup><xref ref-type="bibr" rid="CR33">33</xref>,<xref ref-type="bibr" rid="CR60">60</xref>,<xref ref-type="bibr" rid="CR64">64</xref></sup>, the aggregation scheme of the vanilla GAT is designed as an average of the feature vectors of the neighbors—where, by definition, <inline-formula id="IEq076"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\sum }_{{v}_{j}\in {{{{{{\mathcal{N}}}}}}}_{i}}{a}_{ij}=1$$\end{document}</tex-math><mml:math id="M216"><mml:msub><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq076.gif"/></alternatives></inline-formula> for all <inline-formula id="IEq077"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_i$$\end{document}</tex-math><mml:math id="M218"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq077.gif"/></alternatives></inline-formula>—rather than as a general weighted sum like for Eq. (<xref rid="Equ12" ref-type="">12</xref>). This is often reasonable in the context of structure learning, where the node features represent some coordinates in a metric space where connected nodes are likely to be close<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>. Yet, in the general case, this type of constraint was shown to lessen dramatically the expressive power of the GNN architecture<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>. We also reached the same conclusion while using average-like GNN architectures (see Sec. III F of the Supplementary Information). By contrast, the aggregation scheme described by Eq. (<xref rid="Equ12" ref-type="">12</xref>) allows our architecture to represent various dynamic processes on networks accurately.</p>
                </sec>
                <sec id="Sec8">
                  <title>Training settings</title>
                  <p id="Par35">In all experiments on synthetic data, we use the cross entropy loss as the local loss function,<disp-formula id="Equ13"><label>13</label><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L\left({y}_{i},{\hat{y}}_{i}\right)=-\mathop{\sum}\limits_{m}{y}_{i,m}{{{{{\mathrm{log}}}}}}\,{\hat{y}}_{i,m},$$\end{document}</tex-math><mml:math id="M220"><mml:mi>L</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal">log</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41467_2021_24732_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula>where <italic>y</italic><sub><italic>i</italic>,<italic>m</italic></sub> corresponds to the <italic>m</italic>-th element of the outcome vector of node <italic>v</italic><sub><italic>i</italic></sub>, which either is a transition probability for the stochastic contagion dynamics or a fraction of people for the metapopulation dynamics. For the simple, complex and interacting contagion dynamics, we used the observed outcomes, i.e. using <inline-formula id="IEq078"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}_i \to {\tilde{y}}_i$$\end{document}</tex-math><mml:math id="M222"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>~</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq078.gif"/></alternatives></inline-formula> in Eq. (<xref rid="Equ13" ref-type="">13</xref>), corresponding to the stochastic state of node <italic>v</italic><sub><italic>i</italic></sub> at the next time step, as the target in the loss function. While we noticed a diminished performance when using the observed outcomes as opposed to the true transition probabilities (see Sec. III E of the Supplementary Information), this setting is more realistic and shows what happens when the targets are noisy. The effect of noise can be tempered by increasing the size of the dataset (see the Supplementary Information). For the metapopulation dynamics, since this model is deterministic, we used the true targets without adding noise.</p>
                </sec>
                <sec id="Sec9">
                  <title>Performance measures</title>
                  <p id="Par36">We use the Pearson correlation coefficient <italic>r</italic> as a global performance measure defined on a set of targets <italic>Y</italic> and predictions <inline-formula id="IEq079"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{Y}$$\end{document}</tex-math><mml:math id="M224"><mml:mover accent="true"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq079.gif"/></alternatives></inline-formula> as<disp-formula id="Equ14"><label>14</label><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r=\frac{{\mathbb{E}}\left[\right.(Y-{\mathbb{E}}[Y])(\hat{Y}-{\mathbb{E}}[\hat{Y}])\left]\right.}{\sqrt{{\mathbb{E}}\left[\right.{(Y-{\mathbb{E}}[Y])}^{2}\left]\right.\ {\mathbb{E}}\left[\right.{(\hat{Y}-{\mathbb{E}}[\hat{Y}])}^{2}\left]\right.}}$$\end{document}</tex-math><mml:math id="M226"><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mfenced open="["><mml:mrow/></mml:mfenced><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>Y</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mo>−</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mfenced open="]"><mml:mrow/></mml:mfenced></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mfenced open="["><mml:mrow/></mml:mfenced><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>Y</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mfenced open="]"><mml:mrow/></mml:mfenced><mml:mspace width="0.33em"/><mml:mi mathvariant="double-struck">E</mml:mi><mml:mfenced open="["><mml:mrow/></mml:mfenced><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mo>−</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mfenced open="]"><mml:mrow/></mml:mfenced></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2021_24732_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq080"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb{E}}[W]$$\end{document}</tex-math><mml:math id="M228"><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq080.gif"/></alternatives></inline-formula> denotes the expectation of <italic>W</italic>. Also, because the maximum correlation occurs at <italic>r</italic> = 1, we also define 1 − <italic>r</italic> as the global error on the set of target-prediction pairs.</p>
                </sec>
                <sec id="Sec10">
                  <title>Synthetic data generation</title>
                  <p id="Par37">We generate data from each dynamics using the following algorithm:<list list-type="order"><list-item><p id="Par38">Sample a network <italic>G</italic> from a given generative model (e.g. the Erdős-Rényi <italic>G</italic>(<italic>N</italic>, <italic>M</italic>) or the Barabási-Albert network models).</p></list-item><list-item><p id="Par39">Initialize the state of the system <inline-formula id="IEq081"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X(0)={\left({x}_{i}(0)\right)}_{i = 1..N}$$\end{document}</tex-math><mml:math id="M230"><mml:mi>X</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq081.gif"/></alternatives></inline-formula>. For the simple, complex and interacting contagion dynamics, sample uniformly the number of nodes in each state. For the metapopulation dynamics, sample the population size for each node from a Poisson distribution of average 10<sup>4</sup> and then sample the number of infected people within each node from a binomial distribution of parameter 10<sup>−5</sup>. For instance, a network of <inline-formula id="IEq82"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$| {{{{{\mathcal{V}}}}}}| =1{0}^{3}$$\end{document}</tex-math><mml:math id="M232"><mml:mo>∣</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">V</mml:mi><mml:mo>∣</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq82.gif"/></alternatives></inline-formula> nodes will be initialized with a total of 100 infected people, on average, distributed among the nodes.</p></list-item><list-item><p id="Par40">At time <italic>t</italic>, compute the observed outcome—<italic>Y</italic><sub><italic>t</italic></sub> for the metapopulation dynamics, and <inline-formula id="IEq83"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\tilde{Y}}_{t}$$\end{document}</tex-math><mml:math id="M234"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>~</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq83.gif"/></alternatives></inline-formula> for the three stochastic dynamics. Then, record the states <italic>X</italic><sub><italic>t</italic></sub> and <italic>Y</italic><sub><italic>t</italic></sub> (or <inline-formula id="IEq84"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\tilde{Y}}_{t}$$\end{document}</tex-math><mml:math id="M236"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>~</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq84.gif"/></alternatives></inline-formula>).</p></list-item><list-item><p id="Par41">Repeat step 3 until <inline-formula id="IEq85"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(t\,{{{{{\mathrm{mod}}}}}}\,\,{t}_{s})=0$$\end{document}</tex-math><mml:math id="M238"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">mod</mml:mi><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq85.gif"/></alternatives></inline-formula>, where <italic>t</italic><sub><italic>s</italic></sub> is a resampling time. At this moment, apply step 2 to reinitialize the states <italic>X</italic><sub><italic>t</italic></sub> and repeat step 3.</p></list-item><list-item><p id="Par42">Stop when <italic>t</italic> = <italic>T</italic>, where <italic>T</italic> is the targeted number of samples.</p></list-item></list></p>
                  <p id="Par43">The resampling step parametrized by <italic>t</italic><sub><italic>s</italic></sub> indirectly controls the diversity of the training dataset. We allow <italic>t</italic><sub><italic>s</italic></sub> to be small for the contagion dynamics (<italic>t</italic><sub><italic>s</italic></sub> = 2) and larger for the metapopulation dynamics (<italic>t</italic><sub><italic>s</italic></sub> = 100) to emphasize on the performance of the GNN rather than the quality of the training dataset, while acknowledging that different values of <italic>t</italic><sub><italic>s</italic></sub> could lead to poor training (see Sec. III D of the Supplementary Information).</p>
                  <p id="Par44">We trained the simple, complex and interacting contagion GNN models on networks of size <inline-formula id="IEq86"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$| {{{{{\mathcal{V}}}}}}| =1{0}^{3}$$\end{document}</tex-math><mml:math id="M240"><mml:mo>∣</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">V</mml:mi><mml:mo>∣</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq86.gif"/></alternatives></inline-formula> nodes and on time series of length <italic>T</italic> = 10<sup>4</sup>. To generate the networks, we either used Erdős-Rényi (ER) random networks <italic>G</italic>(<italic>N</italic>, <italic>M</italic>) or Barabási-Albert (BA) random networks. In both cases, the parameters of the generative network models are chosen such that the average degree is fixed to 〈<italic>k</italic>〉 = 4.</p>
                  <p id="Par45">To train our models on the metapopulation dynamics, we generated 10 networks of <inline-formula id="IEq87"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$| {{{{{\mathcal{V}}}}}}| =100$$\end{document}</tex-math><mml:math id="M242"><mml:mo>∣</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">V</mml:mi><mml:mo>∣</mml:mo><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq87.gif"/></alternatives></inline-formula> nodes and generated for each of them time series of <italic>t</italic><sub><italic>s</italic></sub> = 100 time steps. This number of time steps roughly corresponds to the moment where the epidemic dies out. Simiarly to the previous experiments, we used the ER and the BA models to generate the networks, where the parameters were chosen such that 〈<italic>k</italic>〉 = 4. However, because this dynamics is not stochastic, we varied the average degree of the networks to increase the variability in the time series. This was done by randomly removing a fraction <inline-formula id="IEq88"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p=1-{{{{{\mathrm{ln}}}}}}\,\left(1-\mu +e\mu \right)$$\end{document}</tex-math><mml:math id="M244"><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi mathvariant="normal">ln</mml:mi><mml:mspace width="0.25em"/><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mo>+</mml:mo><mml:mi>e</mml:mi><mml:mi>μ</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq88.gif"/></alternatives></inline-formula> of their edges, where <italic>μ</italic> was sampled for each network uniformly between 0 and 1. In this scenario, the networks were directed and weighted, with each edge weight <italic>e</italic><sub><italic>i</italic><italic>j</italic></sub> being uniformly distributed between 0 and 1.</p>
                </sec>
                <sec id="Sec11">
                  <title>Hyperparameters</title>
                  <p id="Par46">The optimization of the parameters was performed using the rectified Adam algorithm<sup><xref ref-type="bibr" rid="CR65">65</xref></sup>, which is hyperparameterized by <italic>b</italic><sub>1</sub> = 0.9 and <italic>b</italic><sub>2</sub> = 0.999, as suggested in ref. <sup><xref ref-type="bibr" rid="CR65">65</xref></sup>.</p>
                  <p id="Par47">To build a validation dataset, we selected a fraction of the node states randomly for each time step. More specifically, we randomly chose node <italic>v</italic><sub><italic>i</italic></sub> at time <italic>t</italic> proportionally to its importance weight <italic>w</italic><sub><italic>i</italic></sub>(<italic>t</italic>). For all experiments on synthetic dynamics, we randomly selected 10 nodes per time step to be part of the validation set, on average. For all experiments, the learning rate <italic>ϵ</italic> was reduced by a factor 2 every 10 epochs with initial value <italic>ϵ</italic><sub>0</sub> = 0.001. A weight decay of 10<sup>−4</sup> was used as well to help regularize the training. We trained all models for 30 epochs, and selected the GNN model with the lowest loss on validation datasets. We fixed the importance sampling bias exponents for the training to <italic>λ</italic> = 0.5 in the simple, complex and interacting contagion cases, and fixed it to <italic>λ</italic> = 1 in the metapopulation case.</p>
                </sec>
              </sec>
              <sec id="Sec12">
                <title>Importance weights</title>
                <p id="Par48">In this section, we show how to implement the importance weights in the different cases. Other versions of the importance weights are also available in Sec. I of the Supplementary Information.</p>
                <sec id="Sec13">
                  <title>Discrete state stochastic dynamics</title>
                  <p id="Par49">When <inline-formula id="IEq89"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathcal{S}}}}}}$$\end{document}</tex-math><mml:math id="M246"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq89.gif"/></alternatives></inline-formula> is a finite countable set, the importance weights can be computed exactly using Eq. (<xref rid="Equ7" ref-type="">7</xref>),<disp-formula id="Equ15"><label>15</label><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${w}_{i}(t)\propto {\left[\rho \left({k}_{i},{x}_{i}(t),{x}_{{{{{{{\mathcal{N}}}}}}}_{i}}(t)\right)\right]}^{-\lambda }$$\end{document}</tex-math><mml:math id="M248"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:mi>ρ</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:msup></mml:math><graphic xlink:href="41467_2021_24732_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq90"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho \left(k,x,{x}_{{{{{{\mathcal{N}}}}}}}\right)$$\end{document}</tex-math><mml:math id="M250"><mml:mi>ρ</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq90.gif"/></alternatives></inline-formula> is the probability to observe a node of degree <italic>k</italic> in state <italic>x</italic> with a neighborhood in state <inline-formula id="IEq91"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{{{{{{\mathcal{N}}}}}}}$$\end{document}</tex-math><mml:math id="M252"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq91.gif"/></alternatives></inline-formula> in the complete dataset <italic>D</italic>. The inputs can be simplified from <inline-formula id="IEq92"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(k,x,{x}_{{{{{{\mathcal{N}}}}}}})$$\end{document}</tex-math><mml:math id="M254"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq92.gif"/></alternatives></inline-formula> to (<italic>k</italic>, <italic>x</italic>, <bold><italic>ℓ</italic></bold>) without loss of generality, where <bold><italic>ℓ</italic></bold> is a vector whose entries are the number of neighbors in each state. The distribution is then estimated from the complete dataset <italic>D</italic> by computing the fraction of inputs that are in every configuration<disp-formula id="Equ16"><label>16</label><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho (k,x,{{{{{\boldsymbol{\ell }}}}}})=	 \, \frac{1}{| {{{{{\mathcal{V}}}}}}| T}\mathop{\sum }\limits_{i=1}^{| {{{{{\mathcal{V}}}}}}| }I\left({k}_{i}=k\right)\\ \, 	\times \mathop{\sum }\limits_{t=1}^{T}I\left({x}_{i}(t)=x\right)\ \ I\left({{{{{{\boldsymbol{\ell }}}}}}}_{i}(t)={{\ell }}\!\right)$$\end{document}</tex-math><mml:math id="M256"><mml:mi>ρ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">ℓ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>∣</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">V</mml:mi><mml:mo>∣</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>∣</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">V</mml:mi><mml:mo>∣</mml:mo></mml:mrow></mml:munderover><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mfenced><mml:mspace width="0.25em"/><mml:mo>×</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mfenced><mml:mspace width="0.33em"/><mml:mspace width="0.33em"/><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">ℓ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>ℓ</mml:mi><mml:mspace width="0.3em"/></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2021_24732_Article_Equ16.gif" position="anchor"/></alternatives></disp-formula>where <italic>I</italic>(⋅) is the indicator function.</p>
                </sec>
                <sec id="Sec14">
                  <title>Continuous state deterministic dynamics</title>
                  <p id="Par50">The case of continuous states—e.g. for metapopulation dynamics—is more challenging than its discrete counterpart, especially if the node and edge attributes, Φ<sub><italic>i</italic></sub> and Ω<sub><italic>i</italic><italic>j</italic></sub>, need to be accounted for. One of the challenges is that we cannot count the inputs like in the discrete case. As a result, the estimated distribution <italic>ρ</italic> cannot be estimated directly using Eq. (<xref rid="Equ16" ref-type="">16</xref>), and we use instead<disp-formula id="Equ17"><label>17</label><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${w}_{i}(t)=\left[\right.P({k}_{i})\,{{\Sigma }}({{{\Phi }}}_{i},{{{\Omega }}}_{i}| {k}_{i})\,{{\Pi }}\left(\bar{x}(t)\right){\left]\right.}^{-\lambda }$$\end{document}</tex-math><mml:math id="M258"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfenced open="["><mml:mrow/></mml:mfenced><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">Π</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mfenced open="]"><mml:mrow/></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:msup></mml:math><graphic xlink:href="41467_2021_24732_Article_Equ17.gif" position="anchor"/></alternatives></disp-formula>where <italic>P</italic>(<italic>k</italic><sub><italic>i</italic></sub>) is the fraction of nodes with degree <italic>k</italic><sub><italic>i</italic></sub>, Σ(Φ<sub><italic>i</italic></sub>, Ω<sub><italic>i</italic></sub>∣<italic>k</italic><sub><italic>i</italic></sub>) is the joint probability density function (pdf) conditioned on the degree <italic>k</italic><sub><italic>i</italic></sub> for the node attributes Φ<sub><italic>i</italic></sub> and the sum of the edge attributes <inline-formula id="IEq93"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{\Omega }}}_{i}\equiv {\sum }_{{v}_{j}\in {{{{{{\mathcal{N}}}}}}}_{i}}{{{\Omega }}}_{ij}$$\end{document}</tex-math><mml:math id="M260"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≡</mml:mo><mml:msub><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq93.gif"/></alternatives></inline-formula>, and where <inline-formula id="IEq94"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\Pi }}\left(\bar{x}(t)\right)$$\end{document}</tex-math><mml:math id="M262"><mml:mi mathvariant="normal">Π</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq94.gif"/></alternatives></inline-formula> is the pdf for the average of node states at time <italic>t</italic><inline-formula id="IEq95"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{x}(t)=\frac{1}{| {{{{{\mathcal{V}}}}}}| }{\sum }_{{v}_{i}\in {{{{{\mathcal{V}}}}}}}{x}_{i}(t)$$\end{document}</tex-math><mml:math id="M264"><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>∣</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">V</mml:mi><mml:mo>∣</mml:mo></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">V</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq95.gif"/></alternatives></inline-formula>. The pdf are obtained using nonparametric Gaussian kernel density estimators (KDE)<sup><xref ref-type="bibr" rid="CR66">66</xref></sup>. Provided that the density values of the KDE are unbounded above, we normalize the pdf such that the density of each sample used to construct the KDE sum to one. Further details on how we designed the importance weights are provided in Sec. I of the Supplementary Information.</p>
                </sec>
              </sec>
              <sec id="Sec15">
                <title>Dynamics</title>
                <p id="Par51">In what follows, we describe in detail the contagion dynamics used for our experiments. We specify the node outcome function <italic>f</italic> introduced in Eq. (<xref rid="Equ3" ref-type="">3</xref>) and the parameters of the dynamics.</p>
                <sec id="Sec16">
                  <title>Simple contagion</title>
                  <p id="Par52">We consider the simple contagion dynamics called the susceptible-infected-susceptible (SIS) dynamics for which <inline-formula id="IEq96"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathcal{S}}}}}}=\left\{S,I\right\}=\left\{0,1\right\}$$\end{document}</tex-math><mml:math id="M266"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">S</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq96.gif"/></alternatives></inline-formula>—we use these two representations of <inline-formula id="IEq97"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathcal{S}}}}}}$$\end{document}</tex-math><mml:math id="M268"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq97.gif"/></alternatives></inline-formula> interchangeably. Because this dynamics is stochastic, we let <inline-formula id="IEq98"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathcal{R}}}}}}={[0,1]}^{2}$$\end{document}</tex-math><mml:math id="M270"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">R</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq98.gif"/></alternatives></inline-formula>. We define the infection function <italic>α</italic>(<italic>ℓ</italic>) as the probability that a susceptible node becomes infected given its number of infected neighbors <italic>ℓ</italic><disp-formula id="Equ18"><label>18</label><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Pr \left(S\to I| \ell \right)=\alpha \left(\ell \right)=1-{\left(1-\gamma \right)}^{\ell }\,,$$\end{document}</tex-math><mml:math id="M272"><mml:mi>Pr</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>S</mml:mi><mml:mo>→</mml:mo><mml:mi>I</mml:mi><mml:mo>∣</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>γ</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:msup><mml:mspace width="0.25em"/><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41467_2021_24732_Article_Equ18.gif" position="anchor"/></alternatives></disp-formula>where <italic>γ</italic> ∈ [0, 1] is the disease transmission probability. In other words, a node can be infected by any of its infected neighbors independently with probability <italic>γ</italic>. We also define the constant recovery probability as<disp-formula id="Equ19"><label>19</label><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Pr \left(I\to S\right)=\beta \ .$$\end{document}</tex-math><mml:math id="M274"><mml:mi>Pr</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>I</mml:mi><mml:mo>→</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>β</mml:mi><mml:mspace width="0.33em"/><mml:mo>.</mml:mo></mml:math><graphic xlink:href="41467_2021_24732_Article_Equ19.gif" position="anchor"/></alternatives></disp-formula>The node outcome function for the SIS dynamics is therefore<disp-formula id="Equ20"><label>20</label><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f({x}_{i},{x}_{{{{{{{\mathcal{N}}}}}}}_{i}})=\left\{\begin{array}{ll}\left(1-\alpha ({\ell }_{i}),\ \alpha ({\ell }_{i})\right)\quad &amp;\,{{\mbox{if}}}\,{x}_{i}=0\,{{\mbox{,}}}\,\\ (\beta ,\ 1-\beta )\quad\hfill &amp;\,{{\mbox{if}}}\,{x}_{i}=1\,{{\mbox{,}}}\,\end{array}\right.$$\end{document}</tex-math><mml:math id="M276"><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.33em"/><mml:mi>α</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfenced><mml:mspace width="1.0em"/></mml:mtd><mml:mtd columnalign="left"><mml:mspace width="0.25em"/><mml:mstyle><mml:mtext>if</mml:mtext></mml:mstyle><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="0.25em"/><mml:mstyle><mml:mtext>,</mml:mtext></mml:mstyle><mml:mspace width="0.25em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.33em"/><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="1.0em"/></mml:mtd><mml:mtd columnalign="left"><mml:mspace width="0.25em"/><mml:mstyle><mml:mtext>if</mml:mtext></mml:mstyle><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.25em"/><mml:mstyle><mml:mtext>,</mml:mtext></mml:mstyle><mml:mspace width="0.25em"/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2021_24732_Article_Equ20.gif" position="anchor"/></alternatives></disp-formula>where<disp-formula id="Equ21"><label>21</label><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\ell }_{i}=\mathop{\sum}\limits_{{v}_{j}\in {{{{{{\mathcal{N}}}}}}}_{i}}\delta ({x}_{j},1)$$\end{document}</tex-math><mml:math id="M278"><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mi>δ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41467_2021_24732_Article_Equ21.gif" position="anchor"/></alternatives></disp-formula>is the number of infected neighbors of <italic>v</italic><sub><italic>i</italic></sub> and <italic>δ</italic>(<italic>x</italic>, <italic>y</italic>) is the Kronecker delta. Note that for each case in Eq. (<xref rid="Equ20" ref-type="">20</xref>), the outcome is a two-dimensional probability vector, where the first entry is the probability that node <italic>v</italic><sub><italic>i</italic></sub> becomes/remains susceptible at the following time step, and the second entry is the probability that it becomes/remains infected. We used (<italic>γ</italic>, <italic>β</italic>) = (0.04, 0.08) in all experiments involving this simple contagion dynamics.</p>
                </sec>
                <sec id="Sec17">
                  <title>Complex contagion</title>
                  <p id="Par53">To lift the independent transmission assumption of the SIS dynamics, we consider a complex contagion dynamics for which the node outcome function has a similar form as Eq. (<xref rid="Equ20" ref-type="">20</xref>), but where the infection function <italic>α</italic>(<italic>ℓ</italic>) has the nonmonotonic form<disp-formula id="Equ22"><label>22</label><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha (\ell )=\frac{1}{z(\eta )}\frac{{\ell }^{3}}{{e}^{\ell /\eta }-1}$$\end{document}</tex-math><mml:math id="M280"><mml:mi>α</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>/</mml:mo><mml:mi>η</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2021_24732_Article_Equ22.gif" position="anchor"/></alternatives></disp-formula>where <italic>z</italic>(<italic>η</italic>) normalizes the infection function such that <italic>α</italic>(<italic>ℓ</italic><sup>*</sup>) = 1 at its global maximum <italic>ℓ</italic><sup>*</sup> and <italic>η</italic> &gt; 0 is a parameter controlling the position of <italic>ℓ</italic><sup>*</sup>. This function is inspired by the Planck distribution for the black-body radiation, although it was chosen for its general shape rather than for any physical meaning whatsoever. We used (<italic>η</italic>, <italic>β</italic>) = (8, 0.06) in all experiments involving this complex contagion dynamics.</p>
                </sec>
                <sec id="Sec18">
                  <title>Interacting contagion</title>
                  <p id="Par54">We define the interacting contagion as two SIS dynamics that are interacting and denote it as the SIS-SIS dynamics. In this case, we have <inline-formula id="IEq99"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathcal{S}}}}}}=\left\{{S}_{1}{S}_{2},{I}_{1}{S}_{2},{S}_{1}{I}_{2},{I}_{1}{I}_{2}\right\}=\left\{0,1,2,3\right\}$$\end{document}</tex-math><mml:math id="M282"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">S</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq99.gif"/></alternatives></inline-formula>. Simiarly to the SIS dynamics, we have <inline-formula id="IEq100"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathcal{R}}}}}}={[0,1]}^{4}$$\end{document}</tex-math><mml:math id="M284"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">R</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq100.gif"/></alternatives></inline-formula> and we define the infection probability functions<disp-formula id="Equ23"><label>23a</label><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\alpha }_{g}({\ell }_{g})=1-{(1-{\gamma }_{g})}^{{\ell }_{g}}\ \,{{\mbox{if}}}\,\ x=0$$\end{document}</tex-math><mml:math id="M286"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mspace width="0.33em"/><mml:mspace width="0.25em"/><mml:mstyle><mml:mtext>if</mml:mtext></mml:mstyle><mml:mspace width="0.25em"/><mml:mspace width="0.33em"/><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><graphic xlink:href="41467_2021_24732_Article_Equ23.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ24"><label>23b</label><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\alpha }_{g}^{* }({\ell }_{g})=1-{(1-\zeta {\gamma }_{g})}^{{\ell }_{g}}\ \,{{\mbox{if}}}\,\ x=1,2\,,$$\end{document}</tex-math><mml:math id="M288"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ζ</mml:mi><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mspace width="0.33em"/><mml:mspace width="0.25em"/><mml:mstyle><mml:mtext>if</mml:mtext></mml:mstyle><mml:mspace width="0.25em"/><mml:mspace width="0.33em"/><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mspace width="0.25em"/><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41467_2021_24732_Article_Equ24.gif" position="anchor"/></alternatives></disp-formula>where <italic>ζ</italic> ≥ 0 is a coupling constant and <italic>ℓ</italic><sub><italic>g</italic></sub> is the number of neighbors infected by disease <italic>g</italic>, and also define the recovery probabilities <italic>β</italic><sub><italic>g</italic></sub> for each disease (<italic>g</italic> = 1, 2). The case where <italic>ζ</italic> &gt; 1 corresponds to the situation in which the diseases are synergistic (i.e. being infected by one increases the probability of getting infected by the other), whereas competition is introduced if <italic>ζ</italic> &lt; 1 (being already infected by one decreases the probability of getting infected by the other). The case <italic>ζ</italic> = 1 falls back on two independent SIS dynamics that evolve simultaneously on the network. The outcome function is composed of 16 entries that are expressed as follows<disp-formula id="Equ25"><label>24</label><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\, 	f({x}_{i},{x}_{{{{{{{\mathcal{N}}}}}}}_{i}})\\ 	\, =\left\{\begin{array}{ll}\left(\left[\right.1-{\alpha }_{1}({\ell }_{i,1})\left]\ \right.\left[\right.1-{\alpha }_{2}({\ell }_{i,2})\left]\right.,\ {\alpha }_{1}({\ell }_{i,1})\ \left[\right.1-{\alpha }_{2}({\ell }_{i,2})\left]\right.,\ \left[\right.1-{\alpha }_{1}({\ell }_{i,1})\left]\right.\ {\alpha }_{2}({\ell }_{i,2}),\ {\alpha }_{1}({\ell }_{i,1}){\alpha }_{2}({\ell }_{i,2})\right)&amp;\,{{{\mbox{if}}}}\,\ {x}_{i}=0,\\ \left({\beta }_{1}\left[\right.1-{\alpha }_{2}^{* }({\ell }_{i,2})\left]\right.,\ \left[\right.1-{\beta }_{1}\left]\ \right.\left[\right.1-{\alpha }_{2}^{* }({\ell }_{i,2})\left]\right.,\ {\beta }_{1}{\alpha }_{2}^{* }({\ell }_{i,2}),\ \left[\right.1-{\beta }_{1}\left]\right.{\alpha }_{2}^{* }({\ell }_{i,2})\right)\hfill&amp;\,{{{\mbox{if}}}}\,\ {x}_{i}=1,\\ \left(\left[\right.1-{\alpha }_{1}^{* }({\ell }_{i,1})\left]\right.\ {\beta }_{2},\ {\alpha }_{1}^{* }({\ell }_{i,1}){\beta }_{2},\ \left[\right.1-{\alpha }_{1}^{* }({\ell }_{i,1})\left]\right.\ \left[\right.1-{\beta }_{2}\left]\right.,\ {\alpha }_{1}^{* }({\ell }_{i,1})\ \left[\right.1-{\beta }_{2}\left]\right.\right)\hfill&amp;\,{{{\mbox{if}}}}\,\ {x}_{i}=2,\\ \left({\beta }_{1}{\beta }_{2},\ [1-{\beta }_{1}]{\beta }_{2},\ {\beta }_{1}[1-{\beta }_{2}],\ [1-{\beta }_{1}][1-{\beta }_{2}]\right)\hfill&amp;\,{{{\mbox{if}}}}\,\ {x}_{i}=3.\end{array}\right.$$\end{document}</tex-math><mml:math id="M290"><mml:mspace width="0.25em"/><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mfenced close=")" open="("><mml:mrow><mml:mfenced open="["><mml:mrow/></mml:mfenced><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mfenced open="]"><mml:mrow><mml:mspace width="0.33em"/></mml:mrow></mml:mfenced><mml:mfenced open="["><mml:mrow/></mml:mfenced><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mfenced open="]"><mml:mrow/></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="0.33em"/><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.33em"/><mml:mfenced open="["><mml:mrow/></mml:mfenced><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mfenced open="]"><mml:mrow/></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="0.33em"/><mml:mfenced open="["><mml:mrow/></mml:mfenced><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mfenced open="]"><mml:mrow/></mml:mfenced><mml:mspace width="0.33em"/><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.33em"/><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfenced></mml:mtd><mml:mtd columnalign="left"><mml:mspace width="0.25em"/><mml:mstyle><mml:mtext>if</mml:mtext></mml:mstyle><mml:mspace width="0.25em"/><mml:mspace width="0.33em"/><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced open="["><mml:mrow/></mml:mfenced><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mfenced open="]"><mml:mrow/></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="0.33em"/><mml:mfenced open="["><mml:mrow/></mml:mfenced><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced open="]"><mml:mrow><mml:mspace width="0.33em"/></mml:mrow></mml:mfenced><mml:mfenced open="["><mml:mrow/></mml:mfenced><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mfenced open="]"><mml:mrow/></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="0.33em"/><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.33em"/><mml:mfenced open="["><mml:mrow/></mml:mfenced><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced open="]"><mml:mrow/></mml:mfenced><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfenced></mml:mtd><mml:mtd columnalign="left"><mml:mspace width="0.25em"/><mml:mstyle><mml:mtext>if</mml:mtext></mml:mstyle><mml:mspace width="0.25em"/><mml:mspace width="0.33em"/><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mfenced close=")" open="("><mml:mrow><mml:mfenced open="["><mml:mrow/></mml:mfenced><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mfenced open="]"><mml:mrow/></mml:mfenced><mml:mspace width="0.33em"/><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.33em"/><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.33em"/><mml:mfenced open="["><mml:mrow/></mml:mfenced><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mfenced open="]"><mml:mrow/></mml:mfenced><mml:mspace width="0.33em"/><mml:mfenced open="["><mml:mrow/></mml:mfenced><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mfenced open="]"><mml:mrow/></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="0.33em"/><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.33em"/><mml:mfenced open="["><mml:mrow/></mml:mfenced><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mfenced open="]"><mml:mrow/></mml:mfenced></mml:mrow></mml:mfenced></mml:mtd><mml:mtd columnalign="left"><mml:mspace width="0.25em"/><mml:mstyle><mml:mtext>if</mml:mtext></mml:mstyle><mml:mspace width="0.25em"/><mml:mspace width="0.33em"/><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.33em"/><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.33em"/><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.33em"/><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mfenced></mml:mtd><mml:mtd columnalign="left"><mml:mspace width="0.25em"/><mml:mstyle><mml:mtext>if</mml:mtext></mml:mstyle><mml:mspace width="0.25em"/><mml:mspace width="0.33em"/><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2021_24732_Article_Equ25.gif" position="anchor"/></alternatives></disp-formula>where we define <italic>ℓ</italic><sub><italic>i</italic>,<italic>g</italic></sub> as the number of neighbors of <italic>v</italic><sub><italic>i</italic></sub> that are infected by disease <italic>g</italic>. We used (<italic>γ</italic><sub>1</sub>, <italic>γ</italic><sub>2</sub>, <italic>β</italic><sub>1</sub>, <italic>β</italic><sub>2</sub>, <italic>ζ</italic>) = (0.01, 0.012, 0.19, 0.22, 50) in all experiments involving this interacting contagion dynamics.</p>
                </sec>
                <sec id="Sec19">
                  <title>Metapopulation</title>
                  <p id="Par55">The metapopulation dynamics considered is a deterministic version of the susceptible-infection-recovered (SIR) metapopulation model<sup><xref ref-type="bibr" rid="CR46">46</xref>–<xref ref-type="bibr" rid="CR49">49</xref></sup>. We consider that the nodes are populated by a fixed number of people <italic>N</italic><sub><italic>i</italic></sub>, which can be in three states—susceptible (S), infected (I) or recovered (R). We therefore track the number of people in every state at each time. Furthermore, we let the network <italic>G</italic> be weighted, with the weights describing the mobility flow of people between regions. In this case, <inline-formula id="IEq101"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{\Omega }}}_{ij}\in {\mathbb{R}}$$\end{document}</tex-math><mml:math id="M292"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq101.gif"/></alternatives></inline-formula> is the average number of people that are traveling from node <italic>v</italic><sub><italic>j</italic></sub> to node <italic>v</italic><sub><italic>i</italic></sub>. Finally, because we assume that the population size is on average steady, we let <italic>Φ</italic><sub><italic>i</italic></sub> = <italic>N</italic><sub><italic>i</italic></sub> be a node attribute and work with the fraction of people in every epidemiological state. More precisely, we define the state of node <italic>v</italic><sub><italic>j</italic></sub> by <italic>x</italic><sub><italic>j</italic></sub> = (<italic>s</italic><sub><italic>j</italic></sub>, <italic>i</italic><sub><italic>j</italic></sub>, <italic>r</italic><sub><italic>j</italic></sub>), where <italic>s</italic><sub><italic>j</italic></sub>, <italic>i</italic><sub><italic>j</italic></sub> and <italic>r</italic><sub><italic>j</italic></sub> are the fractions of susceptible, infected and recovered people, respectively. From these definitions, we define the node outcome function of this dynamics as<disp-formula id="Equ26"><label>25</label><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f({x}_{j},{x}_{{{{{{{\mathcal{N}}}}}}}_{j}},G)=\left(\begin{array}{l}{s}_{j}-{s}_{j}{\tilde{\alpha }}_{j}\\ {i}_{j}-\frac{{i}_{j}}{{\tau }_{r}}+{s}_{j}{\tilde{\alpha }}_{j}\\ {r}_{j}+\frac{{i}_{j}}{{\tau }_{r}}\end{array}\right)$$\end{document}</tex-math><mml:math id="M294"><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>G</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo>~</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo>~</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2021_24732_Article_Equ26.gif" position="anchor"/></alternatives></disp-formula>where<disp-formula id="Equ27"><label>26</label><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\tilde{\alpha }}_{j}=\alpha ({i}_{j},{N}_{j})+\mathop{\sum}\limits_{{v}_{l}\in {{{{{{\mathcal{N}}}}}}}_{j}}\frac{{k}_{j}{{{\Omega }}}_{jl}\alpha ({i}_{l},{N}_{l})}{{\sum }_{{v}_{n}\in {{{{{{\mathcal{N}}}}}}}_{j}}{{{\Omega }}}_{jn}}\ ,$$\end{document}</tex-math><mml:math id="M296"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo>~</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mspace width="0.33em"/><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41467_2021_24732_Article_Equ27.gif" position="anchor"/></alternatives></disp-formula>and <italic>k</italic><sub><italic>j</italic></sub> is the degree of node <italic>v</italic><sub><italic>j</italic></sub>. The function <italic>α</italic>(<italic>i</italic>, <italic>N</italic>) corresponds to the infection rate, per day, at which an individual is infected by someone visiting from a neighboring region with <italic>i</italic><italic>N</italic> infected people in it, and is equal to<disp-formula id="Equ28"><label>27</label><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha (i,N)=1-{\left(1-\frac{{R}_{0}}{{\tau }_{r}N}\right)}^{iN}\approx 1-{e}^{-\frac{{R}_{0}}{{\tau }_{r}}i}\ .$$\end{document}</tex-math><mml:math id="M298"><mml:mi>α</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:msup><mml:mo>≈</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mspace width="0.33em"/><mml:mo>.</mml:mo></mml:math><graphic xlink:href="41467_2021_24732_Article_Equ28.gif" position="anchor"/></alternatives></disp-formula>where <italic>R</italic><sub>0</sub> corresponds to the reproduction number and, <italic>τ</italic><sub><italic>r</italic></sub> is the average recovery time in days. In all experiments with this metapopulation dynamics, we used (<italic>R</italic><sub>0</sub>, <italic>τ</italic><sub><italic>r</italic></sub>) = (8.31, 7.5).</p>
                </sec>
              </sec>
              <sec id="Sec20">
                <title>COVID-19 outbreak in Spain</title>
                <sec id="Sec21">
                  <title>Dataset</title>
                  <p id="Par56">The dataset is composed of the daily incidence of the 52 Spanish provinces (including Ceuta and Melilla) monitored for 450 days between January 1<sup>st</sup> 2020 and March 27<sup>th</sup> 2021<sup><xref ref-type="bibr" rid="CR53">53</xref></sup>. The dataset is augmented with the origin-destination (OD) network of individual mobility<sup><xref ref-type="bibr" rid="CR54">54</xref></sup>. This mobility network is multiplex, directed and weighted, where the weight of each edge <inline-formula id="IEq102"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${e}_{ij}^{\nu }$$\end{document}</tex-math><mml:math id="M300"><mml:msubsup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>ν</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq102.gif"/></alternatives></inline-formula> represents the mobility flow from province <italic>v</italic><sub><italic>j</italic></sub> and to province <italic>v</italic><sub><italic>j</italic></sub> using transportation <inline-formula id="IEq103"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nu$$\end{document}</tex-math><mml:math id="M302"><mml:mi>ν</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq103.gif"/></alternatives></inline-formula>. The metadata associated to each node is the population of province <italic>v</italic><sub><italic>i</italic></sub><sup><xref ref-type="bibr" rid="CR67">67</xref></sup>, noted Φ<sub><italic>i</italic></sub> = <italic>N</italic><sub><italic>i</italic></sub>. The metadata associated to each edge, <inline-formula id="IEq104"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{\Omega }}}_{ij}^{\nu }$$\end{document}</tex-math><mml:math id="M304"><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>ν</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq104.gif"/></alternatives></inline-formula>, corresponds to the average number of people that moved from <italic>v</italic><sub><italic>j</italic></sub> to <italic>v</italic><sub><italic>i</italic></sub> using <inline-formula id="IEq105"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nu$$\end{document}</tex-math><mml:math id="M306"><mml:mi>ν</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq105.gif"/></alternatives></inline-formula> as the main means of transportation.</p>
                </sec>
                <sec id="Sec22">
                  <title>Models</title>
                  <p id="Par57">The GNN model used in Fig. <xref rid="Fig5" ref-type="fig">5</xref> is very similar to the metapopulation GNN model—with node and edge attributes—with the exception that different attention modules are used to model the different OD edge types (plane, car, coach, train, and boat, see Table <xref rid="Tab1" ref-type="table">1</xref>). To combine the features of each layer of the multiplex network, we average pooled the output features of the attention modules. We also generalize our model to take in input a sequence of <italic>L</italic> states of the system, that is<disp-formula id="Equ29"><label>28</label><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{Y}}_{t}=\hat{{{{{{\mathcal{M}}}}}}}({X}_{t:t-L+1},G;{{{{{\boldsymbol{\Theta }}}}}})$$\end{document}</tex-math><mml:math id="M308"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">M</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>:</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">Θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41467_2021_24732_Article_Equ29.gif" position="anchor"/></alternatives></disp-formula>where <italic>X</italic><sub><italic>t</italic>:<italic>t</italic>−<italic>L</italic>+1</sub> = (<italic>X</italic><sub><italic>t</italic></sub>, <italic>X</italic><sub><italic>t</italic>−1</sub>, ⋯ , <italic>X</italic><sub><italic>t</italic>−<italic>L</italic>+1</sub>) and <italic>L</italic> is a lag. At the local level, it reads<disp-formula id="Equ30"><label>29</label><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{y}}_{i}(t)= \, \hat{f}\left({x}_{i}(t:t-L+1)\right.,\\ \, \left.{{{\Phi }}}_{i},{x}_{{{{{{{\mathcal{N}}}}}}}_{i}}(t:t-L+1),{{{\Phi }}}_{{{{{{{\mathcal{N}}}}}}}_{i}},{{{\Omega }}}_{i{{{{{{\mathcal{N}}}}}}}_{i}};{{{{{\boldsymbol{\Theta }}}}}}\right)$$\end{document}</tex-math><mml:math id="M310"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mfenced open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>:</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mfenced close=")"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>:</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">Θ</mml:mi></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2021_24732_Article_Equ30.gif" position="anchor"/></alternatives></disp-formula>where <italic>x</italic><sub><italic>i</italic></sub>(<italic>t</italic>: <italic>t</italic> − <italic>L</italic> + 1) corresponds to the <italic>L</italic> previous state of node <italic>i</italic> from time <italic>t</italic> to time <italic>t</italic> − <italic>L</italic> + 1. As we now feed sequences of node states to the GNN, we use Elman recurrent neural networks<sup><xref ref-type="bibr" rid="CR68">68</xref></sup> to transform these sequences of states before aggregating them instead of linear layers, as shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref> and Table <xref rid="Tab1" ref-type="table">1</xref>. Additionally, because the outputs of the models are not probability vectors, like for the dynamics of Sec. “Dynamics”, but real numbers, we use the mean square error (MSE) loss to train the model:<disp-formula id="Equ31"><label>30</label><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L({y}_{i},{\hat{y}}_{i})={({y}_{i}-{\hat{y}}_{i})}^{2}\ .$$\end{document}</tex-math><mml:math id="M312"><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mspace width="0.33em"/><mml:mo>.</mml:mo></mml:math><graphic xlink:href="41467_2021_24732_Article_Equ31.gif" position="anchor"/></alternatives></disp-formula></p>
                  <p id="Par58">We use five different baseline models to compare with the performance of our GNN: Three additional neural network architectures, a vector autoregressive model (VAR)<sup><xref ref-type="bibr" rid="CR56">56</xref></sup> and an equivalent metapopulation model driven by a simple contagion mechanism. The first neural network architecture, denoted the KP-GNN model, was used in ref. <sup><xref ref-type="bibr" rid="CR37">37</xref></sup> to forecast the evolution COVID-19 in the US using a similar strategy as ours with respect to the mobility network. As described in ref. <sup><xref ref-type="bibr" rid="CR37">37</xref></sup>, we used a single-layered MLP with 64 hidden units to transform the input, and then we used two graph convolutional networks (GCN) in series, each with 32 hidden units, to perform the feature aggregation. Finally, we computed the output of the model using another single-layered MLP with 32 hidden units. The layers of this model are separated by ReLU activation functions and are sampled with a dropout rate of 0.5. Because this model is not directly adapted to multiplex networks, we merged all layers together into a single network and summed the weights of the edges. Then, as prescribed in ref. <sup><xref ref-type="bibr" rid="CR37">37</xref></sup>, we thresholded the merged network by keeping at most 32 neighbors with the highest edge weight for each node. We did not use our importance sampling procedure to train the KP-GNN model—letting <italic>λ</italic> = 0—to remain as close as possible to the original model.</p>
                  <p id="Par59">The other two neural network architectures are very similar to the GNN model we presented in Table <xref rid="Tab1" ref-type="table">1</xref>: The only different component is their aggregation mechanism. The IND model, where the nodes are assumed to be mutually independent, does not aggregate the features of the neighbors. It therefore acts like a univariate model, where the time series of each node are processed like different elements of a minibatch. In the FC model, the nodes interact via a single-layered MLP connecting all nodes together. The parameters of this MLP are learnable, which effectively allows the model to express any interaction patterns. Because the number of parameters of this MLP scales with <inline-formula id="IEq106"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d| {{{{{\mathcal{V}}}}}}{| }^{2}$$\end{document}</tex-math><mml:math id="M314"><mml:mi>d</mml:mi><mml:mo>∣</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">V</mml:mi><mml:msup><mml:mrow><mml:mo>∣</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq106.gif"/></alternatives></inline-formula>, where <italic>d</italic> is the number of node features after the input layers, we introduce another layer of 8 hidden units to compress the input features before aggregating them.</p>
                  <p id="Par60">The VAR model is a linear generative model adapted for multivariate time series forecasting<disp-formula id="Equ32"><label>31</label><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{Y}}_{t}=\hat{{{{{{\mathcal{M}}}}}}}({X}_{t},{X}_{t-1},\cdots \ ,{X}_{t-L+1})=\mathop{\sum }\limits_{l=0}^{L-1}{{{{{{\boldsymbol{A}}}}}}}_{l}{X}_{t-l}+{{{{{\boldsymbol{b}}}}}}+{{{{{{\boldsymbol{\epsilon }}}}}}}_{t}$$\end{document}</tex-math><mml:math id="M316"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi class="MJX-tex-caligraphic" mathvariant="script">M</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mspace width="0.33em"/><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">ϵ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2021_24732_Article_Equ32.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq107"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\boldsymbol{A}}}}}}}_{l}\in {{\mathbb{R}}}^{| {{{{{\mathcal{V}}}}}}| \times | {{{{{\mathcal{V}}}}}}| }$$\end{document}</tex-math><mml:math id="M318"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo>∣</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">V</mml:mi><mml:mo>∣</mml:mo><mml:mo>×</mml:mo><mml:mo>∣</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">V</mml:mi><mml:mo>∣</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq107.gif"/></alternatives></inline-formula> are weight matrices, <inline-formula id="IEq108"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\boldsymbol{b}}}}}}\in {{\mathbb{R}}}^{| {{{{{\mathcal{V}}}}}}| }$$\end{document}</tex-math><mml:math id="M320"><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo>∣</mml:mo><mml:mi class="MJX-tex-caligraphic" mathvariant="script">V</mml:mi><mml:mo>∣</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq108.gif"/></alternatives></inline-formula> is a trend vector and <bold><italic>ϵ</italic></bold><sub><italic>t</italic></sub> is an error term with <inline-formula id="IEq109"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb{E}}[{{{{{{\boldsymbol{\epsilon }}}}}}}_{t}]={{{{{\boldsymbol{0}}}}}}$$\end{document}</tex-math><mml:math id="M322"><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">ϵ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">0</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq109.gif"/></alternatives></inline-formula> and <inline-formula id="IEq110"><alternatives><tex-math id="M323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb{E}}[{{{{{{\boldsymbol{\epsilon }}}}}}}_{t}{{{{{{\boldsymbol{\epsilon }}}}}}}_{s}]={\delta }_{t,s}{{{{{\boldsymbol{\Sigma }}}}}}$$\end{document}</tex-math><mml:math id="M324"><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">ϵ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">ϵ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="bold-italic">Σ</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq110.gif"/></alternatives></inline-formula>, with <bold>Σ</bold> being a positive-semidefinite covariance matrix. While autoregressive models are often used to predict stock markets<sup><xref ref-type="bibr" rid="CR69">69</xref></sup>, they have also been used recently to forecast diverse COVID-19 outbreaks<sup><xref ref-type="bibr" rid="CR57">57</xref></sup>. This model is fitted to the COVID-19 time series dataset also by minimizing the MSE.</p>
                  <p id="Par61">The metapopulation model is essentially identical to the model presented in Sec. “Dynamics”. However, because we track the incidence, i.e. the number of newly infectious cases <italic>χ</italic><sub><italic>i</italic></sub>(<italic>t</italic>) in each province <italic>i</italic>, instead of the complete state (<italic>S</italic><sub><italic>i</italic></sub>, <italic>I</italic><sub><italic>i</italic></sub>, <italic>R</italic><sub><italic>i</italic></sub>) representing the number of individuals in each state, we allow the model to internally track the complete state based on the ground truth. At first, the whole population is susceptible, i.e. <italic>S</italic><sub><italic>i</italic></sub>(1) = <italic>N</italic><sub><italic>i</italic></sub>. Then, at each time step, we subtract the number of newly infectious cases in each node from <italic>S</italic><sub><italic>i</italic></sub>(<italic>t</italic>), and add it to <italic>I</italic><sub><italic>i</italic></sub>. Finally, the model allows a fraction <inline-formula id="IEq111"><alternatives><tex-math id="M325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{1}{{\tau }_{r}}$$\end{document}</tex-math><mml:math id="M326"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq111.gif"/></alternatives></inline-formula> of its infected people to recover. The evolution equations of this model are as follows<disp-formula id="Equ33"><label>32a</label><alternatives><tex-math id="M327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{i}(t+1)={S}_{i}(t)-{\chi }_{i}(t)\ ,$$\end{document}</tex-math><mml:math id="M328"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>χ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.33em"/><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41467_2021_24732_Article_Equ33.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ34"><label>32b</label><alternatives><tex-math id="M329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${I}_{i}(t+1)={I}_{i}(t)+{\chi }_{i}(t)-\frac{1}{{\tau }_{r}}{I}_{i}(t)\ ,$$\end{document}</tex-math><mml:math id="M330"><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>χ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.33em"/><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41467_2021_24732_Article_Equ34.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ35"><label>32c</label><alternatives><tex-math id="M331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${R}_{i}(t+1)={R}_{i}(t)+\frac{1}{{\tau }_{r}}{I}_{i}(t)\ .$$\end{document}</tex-math><mml:math id="M332"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.33em"/><mml:mo>.</mml:mo></mml:math><graphic xlink:href="41467_2021_24732_Article_Equ35.gif" position="anchor"/></alternatives></disp-formula></p>
                  <p id="Par62">Finally, we computed the incidence <inline-formula id="IEq112"><alternatives><tex-math id="M333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\chi }}_{i}(t)$$\end{document}</tex-math><mml:math id="M334"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>χ</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq112.gif"/></alternatives></inline-formula> predicted by the metapopulation model using the current internal state as follows:<disp-formula id="Equ36"><label>33</label><alternatives><tex-math id="M335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\chi }}_{i}(t)={S}_{i}{\tilde{\alpha }}_{i}\ ,$$\end{document}</tex-math><mml:math id="M336"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>χ</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo>~</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.33em"/><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41467_2021_24732_Article_Equ36.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq113"><alternatives><tex-math id="M337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\tilde{\alpha }}_{i}$$\end{document}</tex-math><mml:math id="M338"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo>~</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq113.gif"/></alternatives></inline-formula> is given by Eq. (<xref rid="Equ27" ref-type="">26</xref>), using the mobility network <italic>G</italic>, Eq. (<xref rid="Equ28" ref-type="">27</xref>) for <italic>α</italic>(<italic>i</italic>, <italic>N</italic>) and <inline-formula id="IEq114"><alternatives><tex-math id="M339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${i}_{j}=\frac{{I}_{j}}{{N}_{j}}$$\end{document}</tex-math><mml:math id="M340"><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq114.gif"/></alternatives></inline-formula>. Since the mobility weights <inline-formula id="IEq115"><alternatives><tex-math id="M341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{\Omega }}}_{ij}^{\nu }$$\end{document}</tex-math><mml:math id="M342"><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>ν</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq115.gif"/></alternatives></inline-formula> represent the average number of people traveling from province <italic>v</italic><sub><italic>j</italic></sub> to province <italic>v</italic><sub><italic>i</italic></sub>, we assumed all layers to be equivalent and aggregated each layer into a single typeless network where <inline-formula id="IEq116"><alternatives><tex-math id="M343">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{\Omega }}}_{ij}={\sum }_{\nu }{{{\Omega }}}_{ij}^{\nu }$$\end{document}</tex-math><mml:math id="M344"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>ν</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>ν</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2021_24732_Article_IEq116.gif"/></alternatives></inline-formula>. We fixed the parameters of the model to <italic>R</italic><sub>0</sub> = 2.5 and <italic>τ</italic><sub><italic>r</italic></sub> = 7.5, as these values were used in other contexts for modeling the propagation of COVID-19 in Spain<sup><xref ref-type="bibr" rid="CR59">59</xref></sup>.</p>
                </sec>
                <sec id="Sec23">
                  <title>Training</title>
                  <p id="Par63">We trained the GNN and other neural networks for 200 epochs, while decreasing the learning rate by a factor of 2 every 20 epochs with an initial value of 10<sup>−3</sup>. For our GNN, the IND and the FC models, we fixed the importance sampling bias exponent to <italic>λ</italic> = 0.5 and, like the models trained on synthetic data, we used a weight decay of 10<sup>−4</sup> (see Sec. “Training settings”). We fixed the lag of these models, including the VAR model, to <italic>L</italic> = 5. The KP-GNN model was trained using a weight decay of 10<sup>−5</sup> following ref. <sup><xref ref-type="bibr" rid="CR37">37</xref></sup>, and we chose a lag of <italic>L</italic> = 7. For all models, we constructed the validation dataset by randomly selecting a partition of the nodes at each time step proportionally to their importance weights <italic>w</italic><sub><italic>i</italic></sub>(<italic>t</italic>): 20% of the nodes are used for validation in this case. The test dataset was constructed by selecting the last 100 time steps of the time series of all nodes, which rough corresponds to the third wave of the outbreak in Spain.</p>
                </sec>
              </sec>
            </sec>
            <sec sec-type="supplementary-material">
              <title>Supplementary information</title>
              <sec id="Sec24">
                <supplementary-material content-type="local-data" id="MOESM1">
                  <media xlink:href="41467_2021_24732_MOESM1_ESM.pdf">
                    <caption>
                      <p>Supplementary Information</p>
                    </caption>
                  </media>
                </supplementary-material>
                <supplementary-material content-type="local-data" id="MOESM2">
                  <media xlink:href="41467_2021_24732_MOESM2_ESM.pdf">
                    <caption>
                      <p>Peer Review File</p>
                    </caption>
                  </media>
                </supplementary-material>
              </sec>
            </sec>
          </body>
          <back>
            <fn-group>
              <fn>
                <p><bold>Peer review information</bold> <italic>Nature Communications</italic> thanks Ritabrata Dutta and the other anonymous reviewer(s) for their contribution to the peer review of this work. Peer reviewer reports are available.</p>
              </fn>
              <fn>
                <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
              </fn>
            </fn-group>
            <sec>
              <title>Supplementary information</title>
              <p>The online version contains supplementary material available at 10.1038/s41467-021-24732-2.</p>
            </sec>
            <ack>
              <title>Acknowledgements</title>
              <p>The authors are grateful to Emily N. Cyr and Guillaume St-Onge for their comments and to Vincent Thibeault, Xavier Roy-Pomerleau, François Thibault, Patrick Desrosiers, Louis J. Dubé, Simon Hardy and Laurent Hébert-Dufresne for fruitful discussions. This work was supported by the Sentinelle Nord initiative from the Fonds d’excellence en recherche Apogée Canada (C.M., E.L., A.A.), the Conseil de recherches en sciences naturelles et en génie du Canada (C.M., A.A.) and the Fonds de recherche du Québec-Nature et technologie (E.L.).</p>
            </ack>
            <notes notes-type="author-contribution">
              <title>Author contributions</title>
              <p>C.M., E.L., and A.A. designed the study. C.M. and E.L. designed the models and methods. C.M. performed the numerical analysis. C.M. and A.A. wrote the paper.</p>
            </notes>
            <notes notes-type="data-availability">
              <title>Data availability</title>
              <p>The raw COVID-19, mobility and population datasets are publicly available respectively from<sup><xref ref-type="bibr" rid="CR53">53</xref>,<xref ref-type="bibr" rid="CR54">54</xref></sup>, and<sup><xref ref-type="bibr" rid="CR67">67</xref></sup>. The processed datasets shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref> and used in Fig. <xref rid="Fig5" ref-type="fig">5</xref> are available on Zenodo (10.5281/zenodo.5015063)<sup><xref ref-type="bibr" rid="CR70">70</xref></sup>.</p>
            </notes>
            <notes notes-type="data-availability">
              <title>Code availability</title>
              <p>The software developed for this project is available on Zenodo (10.5281/zenodo.4974521)<sup><xref ref-type="bibr" rid="CR71">71</xref></sup>.</p>
            </notes>
            <notes id="FPar1" notes-type="COI-statement">
              <title>Competing interests</title>
              <p id="Par64">The authors declare no competing interests.</p>
            </notes>
            <ref-list id="Bib1">
              <title>References</title>
              <ref id="CR1">
                <label>1.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Kermack</surname>
                      <given-names>WO</given-names>
                    </name>
                    <name>
                      <surname>McKendrick</surname>
                      <given-names>AG</given-names>
                    </name>
                  </person-group>
                  <article-title>A contribution to the mathematical theory of epidemics</article-title>
                  <source>Proc. R. Soc. A</source>
                  <year>1927</year>
                  <volume>115</volume>
                  <fpage>700</fpage>
                  <lpage>721</lpage>
                </element-citation>
              </ref>
              <ref id="CR2">
                <label>2.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Hethcote</surname>
                      <given-names>HW</given-names>
                    </name>
                  </person-group>
                  <article-title>The mathematics of infectious diseases</article-title>
                  <source>SIAM Rev.</source>
                  <year>2000</year>
                  <volume>42</volume>
                  <fpage>599</fpage>
                  <lpage>653</lpage>
                  <pub-id pub-id-type="doi">10.1137/S0036144500371907</pub-id>
                </element-citation>
              </ref>
              <ref id="CR3">
                <label>3.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Siettos</surname>
                      <given-names>CI</given-names>
                    </name>
                    <name>
                      <surname>Russo</surname>
                      <given-names>L</given-names>
                    </name>
                  </person-group>
                  <source>Virulence</source>
                  <year>2013</year>
                  <volume>4</volume>
                  <fpage>295</fpage>
                  <lpage>306</lpage>
                  <pub-id pub-id-type="doi">10.4161/viru.24041</pub-id>
                  <pub-id pub-id-type="pmid">23552814</pub-id>
                </element-citation>
              </ref>
              <ref id="CR4">
                <label>4.</label>
                <mixed-citation publication-type="other">Kiss, I. Z., Miller, J. C. &amp; Simon, P. L. <italic>Mathematics of Epidemics on Networks</italic> p. 598 10.1007/978-3-319-50806-1 (Springer, 2017).</mixed-citation>
              </ref>
              <ref id="CR5">
                <label>5.</label>
                <mixed-citation publication-type="other">Brauer, F., Castillo-Chavez, C. &amp; Feng, Z.  <italic>Mathematical Models in Epidemiology</italic>10.1007/978-1-4939-9828-9 (Springer, 2019)..</mixed-citation>
              </ref>
              <ref id="CR6">
                <label>6.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Grassly</surname>
                      <given-names>NC</given-names>
                    </name>
                    <name>
                      <surname>Fraser</surname>
                      <given-names>C</given-names>
                    </name>
                  </person-group>
                  <article-title>Mathematical models of infectious disease transmission</article-title>
                  <source>Nat. Rev. Microbiol.</source>
                  <year>2008</year>
                  <volume>6</volume>
                  <fpage>477</fpage>
                  <lpage>487</lpage>
                  <pub-id pub-id-type="doi">10.1038/nrmicro1845</pub-id>
                  <pub-id pub-id-type="pmid">18533288</pub-id>
                </element-citation>
              </ref>
              <ref id="CR7">
                <label>7.</label>
                <mixed-citation publication-type="other">Pastore y Piontti, A., Perra, N., Rossi, L., Samay, N. &amp; Vespignani, A. <italic>Charting the Next Pandemic: Modeling Infectious Disease Spreading in the Data Science Age</italic>10.1007/978-3-319-93290-3 (Springer, 2019).</mixed-citation>
              </ref>
              <ref id="CR8">
                <label>8.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Viboud</surname>
                      <given-names>C</given-names>
                    </name>
                    <name>
                      <surname>Vespignani</surname>
                      <given-names>A</given-names>
                    </name>
                  </person-group>
                  <article-title>The future of influenza forecasts</article-title>
                  <source>Proc. Natl Acad. Sci. USA</source>
                  <year>2019</year>
                  <volume>116</volume>
                  <fpage>2802</fpage>
                  <lpage>2804</lpage>
                  <pub-id pub-id-type="doi">10.1073/pnas.1822167116</pub-id>
                  <pub-id pub-id-type="pmid">30737293</pub-id>
                </element-citation>
              </ref>
              <ref id="CR9">
                <label>9.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Morens</surname>
                      <given-names>DM</given-names>
                    </name>
                    <name>
                      <surname>Taubenberger</surname>
                      <given-names>JK</given-names>
                    </name>
                    <name>
                      <surname>Fauci</surname>
                      <given-names>AS</given-names>
                    </name>
                  </person-group>
                  <article-title>Predominant role of bacterial pneumonia as a cause of death in pandemic influenza: implications for pandemic influenza preparedness</article-title>
                  <source>J. Infect. Dis.</source>
                  <year>2008</year>
                  <volume>198</volume>
                  <fpage>962</fpage>
                  <lpage>970</lpage>
                  <pub-id pub-id-type="doi">10.1086/591708</pub-id>
                  <pub-id pub-id-type="pmid">18710327</pub-id>
                </element-citation>
              </ref>
              <ref id="CR10">
                <label>10.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Sanz</surname>
                      <given-names>J</given-names>
                    </name>
                    <name>
                      <surname>Xia</surname>
                      <given-names>C-Y</given-names>
                    </name>
                    <name>
                      <surname>Meloni</surname>
                      <given-names>S</given-names>
                    </name>
                    <name>
                      <surname>Moreno</surname>
                      <given-names>Y</given-names>
                    </name>
                  </person-group>
                  <article-title>Dynamics of interacting diseases</article-title>
                  <source>Phys. Rev. X</source>
                  <year>2014</year>
                  <volume>4</volume>
                  <fpage>041005</fpage>
                </element-citation>
              </ref>
              <ref id="CR11">
                <label>11.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Nickbakhsh</surname>
                      <given-names>S</given-names>
                    </name>
                    <etal/>
                  </person-group>
                  <article-title>Virus–virus interactions impact the population dynamics of influenza and the common cold</article-title>
                  <source>Proc. Natl Acad. Sci. USA</source>
                  <year>2019</year>
                  <volume>116</volume>
                  <fpage>27142</fpage>
                  <lpage>27150</lpage>
                  <pub-id pub-id-type="doi">10.1073/pnas.1911083116</pub-id>
                </element-citation>
              </ref>
              <ref id="CR12">
                <label>12.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Hébert-Dufresne</surname>
                      <given-names>L</given-names>
                    </name>
                    <name>
                      <surname>Scarpino</surname>
                      <given-names>SV</given-names>
                    </name>
                    <name>
                      <surname>Young</surname>
                      <given-names>J-G</given-names>
                    </name>
                  </person-group>
                  <article-title>Macroscopic patterns of interacting contagions are indistinguishable from social reinforcement</article-title>
                  <source>Nat. Phys.</source>
                  <year>2020</year>
                  <volume>16</volume>
                  <fpage>426</fpage>
                  <lpage>431</lpage>
                  <pub-id pub-id-type="doi">10.1038/s41567-020-0791-2</pub-id>
                  <pub-id pub-id-type="pmid">34221104</pub-id>
                </element-citation>
              </ref>
              <ref id="CR13">
                <label>13.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Centola</surname>
                      <given-names>D</given-names>
                    </name>
                  </person-group>
                  <article-title>The spread of behavior in an online social network experiment</article-title>
                  <source>Science</source>
                  <year>2010</year>
                  <volume>329</volume>
                  <fpage>1194</fpage>
                  <lpage>1197</lpage>
                  <pub-id pub-id-type="doi">10.1126/science.1185231</pub-id>
                  <pub-id pub-id-type="pmid">20813952</pub-id>
                </element-citation>
              </ref>
              <ref id="CR14">
                <label>14.</label>
                <mixed-citation publication-type="other">Lehmann, S. &amp; Ahn, Y.-Y. eds.,  <italic>Complex Spreading Phenomena in Social Systems</italic>, Computational Social Sciences 10.1007/978-3-319-77332-2 (Springer, 2018).</mixed-citation>
              </ref>
              <ref id="CR15">
                <label>15.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Iacopini</surname>
                      <given-names>I</given-names>
                    </name>
                    <name>
                      <surname>Petri</surname>
                      <given-names>G</given-names>
                    </name>
                    <name>
                      <surname>Barrat</surname>
                      <given-names>A</given-names>
                    </name>
                    <name>
                      <surname>Latora</surname>
                      <given-names>V</given-names>
                    </name>
                  </person-group>
                  <article-title>Simplicial models of social contagion</article-title>
                  <source>Nat. Commun.</source>
                  <year>2019</year>
                  <volume>10</volume>
                  <fpage>2485</fpage>
                  <pub-id pub-id-type="doi">10.1038/s41467-019-10431-6</pub-id>
                  <pub-id pub-id-type="pmid">31171784</pub-id>
                </element-citation>
              </ref>
              <ref id="CR16">
                <label>16.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Biggerstaff</surname>
                      <given-names>M</given-names>
                    </name>
                    <etal/>
                  </person-group>
                  <article-title>Results from the second year of a collaborative effort to forecast influenza seasons in the United States</article-title>
                  <source>Epidemics</source>
                  <year>2018</year>
                  <volume>24</volume>
                  <fpage>26</fpage>
                  <lpage>33</lpage>
                  <pub-id pub-id-type="doi">10.1016/j.epidem.2018.02.003</pub-id>
                  <pub-id pub-id-type="pmid">29506911</pub-id>
                </element-citation>
              </ref>
              <ref id="CR17">
                <label>17.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Brunton</surname>
                      <given-names>SL</given-names>
                    </name>
                    <name>
                      <surname>Proctor</surname>
                      <given-names>JL</given-names>
                    </name>
                    <name>
                      <surname>Kutz</surname>
                      <given-names>JN</given-names>
                    </name>
                  </person-group>
                  <article-title>Discovering governing equations from data by sparse identification of nonlinear dynamical systems</article-title>
                  <source>Proc. Natl. Acad. Sci. USA</source>
                  <year>2016</year>
                  <volume>113</volume>
                  <fpage>3932</fpage>
                  <lpage>3937</lpage>
                  <pub-id pub-id-type="doi">10.1073/pnas.1517384113</pub-id>
                  <pub-id pub-id-type="pmid">27035946</pub-id>
                </element-citation>
              </ref>
              <ref id="CR18">
                <label>18.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Kutz</surname>
                      <given-names>JN</given-names>
                    </name>
                  </person-group>
                  <article-title>Deep learning in fluid dynamics</article-title>
                  <source>J. Fluid Mech.</source>
                  <year>2017</year>
                  <volume>814</volume>
                  <fpage>1</fpage>
                  <lpage>4</lpage>
                  <pub-id pub-id-type="doi">10.1017/jfm.2016.803</pub-id>
                </element-citation>
              </ref>
              <ref id="CR19">
                <label>19.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Pathak</surname>
                      <given-names>J</given-names>
                    </name>
                    <name>
                      <surname>Lu</surname>
                      <given-names>Z</given-names>
                    </name>
                    <name>
                      <surname>Hunt</surname>
                      <given-names>BR</given-names>
                    </name>
                    <name>
                      <surname>Girvan</surname>
                      <given-names>M</given-names>
                    </name>
                    <name>
                      <surname>Ott</surname>
                      <given-names>E</given-names>
                    </name>
                  </person-group>
                  <article-title>Using machine learning to replicate chaotic attractors and calculate Lyapunov exponents from data</article-title>
                  <source>Chaos</source>
                  <year>2017</year>
                  <volume>27</volume>
                  <fpage>121102</fpage>
                  <pub-id pub-id-type="doi">10.1063/1.5010300</pub-id>
                  <pub-id pub-id-type="pmid">29289043</pub-id>
                </element-citation>
              </ref>
              <ref id="CR20">
                <label>20.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Lusch</surname>
                      <given-names>B</given-names>
                    </name>
                    <name>
                      <surname>Kutz</surname>
                      <given-names>JN</given-names>
                    </name>
                    <name>
                      <surname>Brunton</surname>
                      <given-names>SL</given-names>
                    </name>
                  </person-group>
                  <article-title>Deep learning for universal linear embeddings of nonlinear dynamics</article-title>
                  <source>Nat. Commun.</source>
                  <year>2018</year>
                  <volume>9</volume>
                  <fpage>1</fpage>
                  <lpage>10</lpage>
                  <pub-id pub-id-type="doi">10.1038/s41467-018-07210-0</pub-id>
                  <pub-id pub-id-type="pmid">29317637</pub-id>
                </element-citation>
              </ref>
              <ref id="CR21">
                <label>21.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Pathak</surname>
                      <given-names>J</given-names>
                    </name>
                    <name>
                      <surname>Hunt</surname>
                      <given-names>B</given-names>
                    </name>
                    <name>
                      <surname>Girvan</surname>
                      <given-names>M</given-names>
                    </name>
                    <name>
                      <surname>Lu</surname>
                      <given-names>Z</given-names>
                    </name>
                    <name>
                      <surname>Ott</surname>
                      <given-names>E</given-names>
                    </name>
                  </person-group>
                  <article-title>Model-free prediction of large spatiotemporally chaotic systems from data: a reservoir computing approach</article-title>
                  <source>Phys. Rev. Lett.</source>
                  <year>2018</year>
                  <volume>120</volume>
                  <fpage>024102</fpage>
                  <pub-id pub-id-type="doi">10.1103/PhysRevLett.120.024102</pub-id>
                  <pub-id pub-id-type="pmid">29376715</pub-id>
                </element-citation>
              </ref>
              <ref id="CR22">
                <label>22.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>de Silva</surname>
                      <given-names>BM</given-names>
                    </name>
                    <name>
                      <surname>Higdon</surname>
                      <given-names>DM</given-names>
                    </name>
                    <name>
                      <surname>Brunton</surname>
                      <given-names>SL</given-names>
                    </name>
                    <name>
                      <surname>Kutz</surname>
                      <given-names>JN</given-names>
                    </name>
                  </person-group>
                  <article-title>Discovery of physics from data: universal laws and discrepancies</article-title>
                  <source>Front. Artif. Intell.</source>
                  <year>2020</year>
                  <volume>3</volume>
                  <fpage>25</fpage>
                  <pub-id pub-id-type="doi">10.3389/frai.2020.00025</pub-id>
                  <pub-id pub-id-type="pmid">33733144</pub-id>
                </element-citation>
              </ref>
              <ref id="CR23">
                <label>23.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Chen</surname>
                      <given-names>X</given-names>
                    </name>
                    <etal/>
                  </person-group>
                  <article-title>Mapping topological characteristics of dynamical systems into neural networks: a reservoir computing approach</article-title>
                  <source>Phys. Rev. E</source>
                  <year>2020</year>
                  <volume>102</volume>
                  <fpage>033314</fpage>
                  <pub-id pub-id-type="doi">10.1103/PhysRevE.102.033314</pub-id>
                  <pub-id pub-id-type="pmid">33075895</pub-id>
                </element-citation>
              </ref>
              <ref id="CR24">
                <label>24.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Dutta</surname>
                      <given-names>R</given-names>
                    </name>
                    <name>
                      <surname>Mira</surname>
                      <given-names>A</given-names>
                    </name>
                    <name>
                      <surname>Onnela</surname>
                      <given-names>J-P</given-names>
                    </name>
                  </person-group>
                  <article-title>Bayesian inference of spreading processes on networks</article-title>
                  <source>Proc. R. Soc. A</source>
                  <year>2018</year>
                  <volume>474</volume>
                  <fpage>20180129</fpage>
                  <pub-id pub-id-type="doi">10.1098/rspa.2018.0129</pub-id>
                  <pub-id pub-id-type="pmid">30100809</pub-id>
                </element-citation>
              </ref>
              <ref id="CR25">
                <label>25.</label>
                <mixed-citation publication-type="other">Shah, C. et al. Finding Patient Zero: Learning Contagion Source with Graph Neural Networks <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/2006.11913">http://arxiv.org/abs/2006.11913</ext-link> (2020).</mixed-citation>
              </ref>
              <ref id="CR26">
                <label>26.</label>
                <mixed-citation publication-type="other">Rodrigues, F. A., Peron, T., Connaughton, C., Kurths, J. &amp; Moreno, Y. A machine learning approach to predicting dynamical observables from network structure <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1910.00544">http://arxiv.org/abs/1910.00544</ext-link> (2019).</mixed-citation>
              </ref>
              <ref id="CR27">
                <label>27.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Salova</surname>
                      <given-names>A</given-names>
                    </name>
                    <name>
                      <surname>Emenheiser</surname>
                      <given-names>J</given-names>
                    </name>
                    <name>
                      <surname>Rupe</surname>
                      <given-names>A</given-names>
                    </name>
                    <name>
                      <surname>Crutchfield</surname>
                      <given-names>JP</given-names>
                    </name>
                    <name>
                      <surname>D’Souza</surname>
                      <given-names>RM</given-names>
                    </name>
                  </person-group>
                  <article-title>Koopman operator and its approximations for systems with symmetries</article-title>
                  <source>Chaos</source>
                  <year>2019</year>
                  <volume>29</volume>
                  <fpage>093128</fpage>
                  <pub-id pub-id-type="doi">10.1063/1.5099091</pub-id>
                  <pub-id pub-id-type="pmid">31575142</pub-id>
                </element-citation>
              </ref>
              <ref id="CR28">
                <label>28.</label>
                <mixed-citation publication-type="other">Laurence, E., Murphy, C., St-Onge, G., Roy-Pomerleau, X. &amp; Thibeault, V. Detecting structural perturbations from time series with deep learning <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/2006.05232">http://arxiv.org/abs/2006.05232</ext-link> (2020).</mixed-citation>
              </ref>
              <ref id="CR29">
                <label>29.</label>
                <mixed-citation publication-type="other">Zhang, Z., Cui, P. &amp; Zhu, W. Deep Learning on Graphs: A Survey <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1812.04202">http://arxiv.org/abs/1812.04202</ext-link> (2018).</mixed-citation>
              </ref>
              <ref id="CR30">
                <label>30.</label>
                <mixed-citation publication-type="other">Zhou, J. et al. Graph Neural Networks: A Review of Methods and Applications <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1812.08434">http://arxiv.org/abs/1812.08434</ext-link> (2018).</mixed-citation>
              </ref>
              <ref id="CR31">
                <label>31.</label>
                <mixed-citation publication-type="other">Xu, K., Hu, W., Leskovec, J. &amp; Jegelka, S. How Powerful are Graph Neural Networks? <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1810.00826">http://arxiv.org/abs/1810.00826</ext-link> (2018).</mixed-citation>
              </ref>
              <ref id="CR32">
                <label>32.</label>
                <mixed-citation publication-type="other">Perozzi, B., Al-Rfou, R. &amp; Skiena, S. Deepwalk: Online learning of social representations, in <italic>Proceedings of the 20th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining</italic> p. 701–710 (New York, NY, USA, 2014).</mixed-citation>
              </ref>
              <ref id="CR33">
                <label>33.</label>
                <mixed-citation publication-type="other">Hamilton, W. L., Ying, R. &amp; Leskovec, J. Representation Learning on Graphs: Methods and Applications <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1709.05584">http://arxiv.org/abs/1709.05584</ext-link> (2017).</mixed-citation>
              </ref>
              <ref id="CR34">
                <label>34.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Zhang</surname>
                      <given-names>Z</given-names>
                    </name>
                    <etal/>
                  </person-group>
                  <article-title>A general deep learning framework for network reconstruction and dynamics learning</article-title>
                  <source>Appl. Netw. Sci.</source>
                  <year>2019</year>
                  <volume>4</volume>
                  <fpage>110</fpage>
                  <pub-id pub-id-type="doi">10.1007/s41109-019-0194-4</pub-id>
                </element-citation>
              </ref>
              <ref id="CR35">
                <label>35.</label>
                <mixed-citation publication-type="other">Fout, A., Byrd, J., Shariat, B. &amp; Ben-Hur, A. Protein Interface Prediction using Graph Convolutional Networks, in <italic>Adv. Neural Inf. Process. Syst. 30</italic> pp. 6530–6539 (2017).</mixed-citation>
              </ref>
              <ref id="CR36">
                <label>36.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Zitnik</surname>
                      <given-names>M</given-names>
                    </name>
                    <name>
                      <surname>Agrawal</surname>
                      <given-names>M</given-names>
                    </name>
                    <name>
                      <surname>Leskovec</surname>
                      <given-names>J</given-names>
                    </name>
                  </person-group>
                  <article-title>Modeling polypharmacy side effects with graph convolutional networks</article-title>
                  <source>Bioinformatics</source>
                  <year>2018</year>
                  <volume>34</volume>
                  <fpage>i457</fpage>
                  <lpage>i466</lpage>
                  <pub-id pub-id-type="doi">10.1093/bioinformatics/bty294</pub-id>
                  <pub-id pub-id-type="pmid">29949996</pub-id>
                </element-citation>
              </ref>
              <ref id="CR37">
                <label>37.</label>
                <mixed-citation publication-type="other">Kapoor, A. et al. "Examining covid-19 forecasting using spatio-temporal graph neural networks, <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/2007.03113">http://arxiv.org/abs/2007.03113</ext-link> (2020).</mixed-citation>
              </ref>
              <ref id="CR38">
                <label>38.</label>
                <mixed-citation publication-type="other">Skarding, J., Gabrys, B. &amp; Musial, K., Foundations and modelling of dynamic networks using dynamic graph neural networks: a survey, <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/2005.07496">http://arxiv.org/abs/2005.07496</ext-link> (2020).</mixed-citation>
              </ref>
              <ref id="CR39">
                <label>39.</label>
                <mixed-citation publication-type="other">Fritz, C., Dorigatti, E. &amp; Rügamer, D. Combining graph neural networks and spatio-temporal disease models to predict covid-19 cases in germany <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/2101.00661">http://arxiv.org/abs/2101.00661</ext-link> (2021).</mixed-citation>
              </ref>
              <ref id="CR40">
                <label>40.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Gao</surname>
                      <given-names>J</given-names>
                    </name>
                    <etal/>
                  </person-group>
                  <article-title>STAN: spatio-temporal attention network for pandemic prediction using real-world evidence</article-title>
                  <source>J. Am. Med. Inform. Assoc</source>
                  <year>2021</year>
                  <volume>28</volume>
                  <fpage>733</fpage>
                  <lpage>743</lpage>
                  <pub-id pub-id-type="doi">10.1093/jamia/ocaa322</pub-id>
                  <pub-id pub-id-type="pmid">33486527</pub-id>
                </element-citation>
              </ref>
              <ref id="CR41">
                <label>41.</label>
                <mixed-citation publication-type="other">Veličković, P. et al. Graph Attention Networks <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1710.10903">http://arxiv.org/abs/1710.10903</ext-link> (2018).</mixed-citation>
              </ref>
              <ref id="CR42">
                <label>42.</label>
                <mixed-citation publication-type="other">Rubinstein, R. Y. &amp; Kroese, D. P. <italic>Simulation and the Monte Carlo Method</italic>, 3rd ed. p. 414 (Wiley, 2016).</mixed-citation>
              </ref>
              <ref id="CR43">
                <label>43.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Isella</surname>
                      <given-names>L</given-names>
                    </name>
                    <etal/>
                  </person-group>
                  <article-title>What’s in a crowd? Analysis of face-to-face behavioral networks</article-title>
                  <source>J. Theor. Biol.</source>
                  <year>2011</year>
                  <volume>271</volume>
                  <fpage>166</fpage>
                  <lpage>180</lpage>
                  <pub-id pub-id-type="doi">10.1016/j.jtbi.2010.11.033</pub-id>
                  <pub-id pub-id-type="pmid">21130777</pub-id>
                </element-citation>
              </ref>
              <ref id="CR44">
                <label>44.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Mastrandrea</surname>
                      <given-names>R</given-names>
                    </name>
                    <name>
                      <surname>Fournet</surname>
                      <given-names>J</given-names>
                    </name>
                    <name>
                      <surname>Barrat</surname>
                      <given-names>A</given-names>
                    </name>
                  </person-group>
                  <article-title>Contact patterns in a high school: a comparison between data collected using wearable sensors, contact diaries and friendship surveys</article-title>
                  <source>PLoS ONE</source>
                  <year>2015</year>
                  <volume>10</volume>
                  <fpage>e0136497</fpage>
                  <pub-id pub-id-type="doi">10.1371/journal.pone.0136497</pub-id>
                  <pub-id pub-id-type="pmid">26325289</pub-id>
                </element-citation>
              </ref>
              <ref id="CR45">
                <label>45.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Génois</surname>
                      <given-names>M</given-names>
                    </name>
                    <name>
                      <surname>Barrat</surname>
                      <given-names>A</given-names>
                    </name>
                  </person-group>
                  <article-title>Can co-location be used as a proxy for face-to-face contacts?</article-title>
                  <source>EPJ Data Sci.</source>
                  <year>2018</year>
                  <volume>7</volume>
                  <fpage>11</fpage>
                  <pub-id pub-id-type="doi">10.1140/epjds/s13688-018-0140-1</pub-id>
                </element-citation>
              </ref>
              <ref id="CR46">
                <label>46.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Colizza</surname>
                      <given-names>V</given-names>
                    </name>
                    <name>
                      <surname>Pastor-Satorras</surname>
                      <given-names>R</given-names>
                    </name>
                    <name>
                      <surname>Vespignani</surname>
                      <given-names>A</given-names>
                    </name>
                  </person-group>
                  <article-title>Reaction-diffusion processes and metapopulation models in heterogeneous networks</article-title>
                  <source>Nat. Phys.</source>
                  <year>2007</year>
                  <volume>3</volume>
                  <fpage>276</fpage>
                  <lpage>282</lpage>
                  <pub-id pub-id-type="doi">10.1038/nphys560</pub-id>
                </element-citation>
              </ref>
              <ref id="CR47">
                <label>47.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Balcan</surname>
                      <given-names>D</given-names>
                    </name>
                    <etal/>
                  </person-group>
                  <article-title>Modeling the spatial spread of infectious diseases: the global epidemic and mobility computational model</article-title>
                  <source>J. Comput. Sci.</source>
                  <year>2010</year>
                  <volume>1</volume>
                  <fpage>132</fpage>
                  <lpage>145</lpage>
                  <pub-id pub-id-type="doi">10.1016/j.jocs.2010.07.002</pub-id>
                  <pub-id pub-id-type="pmid">21415939</pub-id>
                </element-citation>
              </ref>
              <ref id="CR48">
                <label>48.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Ajelli</surname>
                      <given-names>M</given-names>
                    </name>
                    <etal/>
                  </person-group>
                  <article-title>The RAPIDD Ebola forecasting challenge: model description and synthetic data generation</article-title>
                  <source>Epidemics</source>
                  <year>2018</year>
                  <volume>22</volume>
                  <fpage>3</fpage>
                  <lpage>12</lpage>
                  <pub-id pub-id-type="doi">10.1016/j.epidem.2017.09.001</pub-id>
                  <pub-id pub-id-type="pmid">28951016</pub-id>
                </element-citation>
              </ref>
              <ref id="CR49">
                <label>49.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Soriano-Paños</surname>
                      <given-names>D</given-names>
                    </name>
                    <name>
                      <surname>Lotero</surname>
                      <given-names>L</given-names>
                    </name>
                    <name>
                      <surname>Arenas</surname>
                      <given-names>A</given-names>
                    </name>
                    <name>
                      <surname>Gómez-Gardeñes</surname>
                      <given-names>J</given-names>
                    </name>
                  </person-group>
                  <article-title>Spreading processes in multiplex metapopulations containing different mobility networks</article-title>
                  <source>Phys. Rev. X</source>
                  <year>2018</year>
                  <volume>8</volume>
                  <fpage>031039</fpage>
                </element-citation>
              </ref>
              <ref id="CR50">
                <label>50.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Eichelsbacher</surname>
                      <given-names>P</given-names>
                    </name>
                    <name>
                      <surname>Ganesh</surname>
                      <given-names>A</given-names>
                    </name>
                  </person-group>
                  <article-title>Bayesian inference for Markov chains</article-title>
                  <source>J. Appl. Probab.</source>
                  <year>2002</year>
                  <volume>39</volume>
                  <fpage>91</fpage>
                  <lpage>99</lpage>
                  <pub-id pub-id-type="doi">10.1239/jap/1019737990</pub-id>
                </element-citation>
              </ref>
              <ref id="CR51">
                <label>51.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Voitalov</surname>
                      <given-names>I</given-names>
                    </name>
                    <name>
                      <surname>van der Hoorn</surname>
                      <given-names>P</given-names>
                    </name>
                    <name>
                      <surname>van der Hofstad</surname>
                      <given-names>R</given-names>
                    </name>
                    <name>
                      <surname>Krioukov</surname>
                      <given-names>D</given-names>
                    </name>
                  </person-group>
                  <article-title>Scale-free networks well done</article-title>
                  <source>Phys. Rev. Research</source>
                  <year>2019</year>
                  <volume>1</volume>
                  <fpage>033034</fpage>
                  <pub-id pub-id-type="doi">10.1103/PhysRevResearch.1.033034</pub-id>
                </element-citation>
              </ref>
              <ref id="CR52">
                <label>52.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Pastor-Satorras</surname>
                      <given-names>R</given-names>
                    </name>
                    <name>
                      <surname>Castellano</surname>
                      <given-names>C</given-names>
                    </name>
                    <name>
                      <surname>Van Mieghem</surname>
                      <given-names>P</given-names>
                    </name>
                    <name>
                      <surname>Vespignani</surname>
                      <given-names>A</given-names>
                    </name>
                  </person-group>
                  <article-title>Epidemic processes in complex networks</article-title>
                  <source>Rev. Mod. Phys.</source>
                  <year>2015</year>
                  <volume>87</volume>
                  <fpage>925</fpage>
                  <lpage>979</lpage>
                  <pub-id pub-id-type="doi">10.1103/RevModPhys.87.925</pub-id>
                </element-citation>
              </ref>
              <ref id="CR53">
                <label>53.</label>
                <mixed-citation publication-type="other">COVID-19 en España, <ext-link ext-link-type="uri" xlink:href="https://cnecovid.isciii.es">https://cnecovid.isciii.es</ext-link> (2020a) [Accessed: 27-March-2021].</mixed-citation>
              </ref>
              <ref id="CR54">
                <label>54.</label>
                <mixed-citation publication-type="other">"Observatorio del Transporte y la Logística en España, <ext-link ext-link-type="uri" xlink:href="https://observatoriotransporte.mitma.gob.es/estudio-experimental">https://observatoriotransporte.mitma.gob.es/estudio-experimental</ext-link> (2018). [Accessed: 11-August-2020].</mixed-citation>
              </ref>
              <ref id="CR55">
                <label>55.</label>
                <mixed-citation publication-type="other">Tian, Y., Luthra, Ish. &amp; Zhang, "Forecasting covid-19 cases using machine learning models,” 10.1101/2020.07.02.20145474 (2020).</mixed-citation>
              </ref>
              <ref id="CR56">
                <label>56.</label>
                <mixed-citation publication-type="other">Wei, W. W. S. <italic>Multivariate time series analysis and applications</italic> (John Wiley, Sons, 2018).</mixed-citation>
              </ref>
              <ref id="CR57">
                <label>57.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Rustam</surname>
                      <given-names>F</given-names>
                    </name>
                    <etal/>
                  </person-group>
                  <article-title>Covid-19 future forecasting using supervised machine learning models</article-title>
                  <source>IEEE Access</source>
                  <year>2020</year>
                  <volume>8</volume>
                  <fpage>101489</fpage>
                  <lpage>101499</lpage>
                  <pub-id pub-id-type="doi">10.1109/ACCESS.2020.2997311</pub-id>
                </element-citation>
              </ref>
              <ref id="CR58">
                <label>58.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Colizza</surname>
                      <given-names>V</given-names>
                    </name>
                    <name>
                      <surname>Barrat</surname>
                      <given-names>A</given-names>
                    </name>
                    <name>
                      <surname>Barthelemy</surname>
                      <given-names>M</given-names>
                    </name>
                    <name>
                      <surname>Valleron</surname>
                      <given-names>A-J</given-names>
                    </name>
                    <name>
                      <surname>Vespignani</surname>
                      <given-names>A</given-names>
                    </name>
                  </person-group>
                  <article-title>Modeling the Worldwide Spread” of Pandemic Influenza: Baseline Case and Containment Interventions</article-title>
                  <source>PLOS Med.</source>
                  <year>2007</year>
                  <volume>4</volume>
                  <fpage>e13</fpage>
                  <pub-id pub-id-type="doi">10.1371/journal.pmed.0040013</pub-id>
                  <pub-id pub-id-type="pmid">17253899</pub-id>
                </element-citation>
              </ref>
              <ref id="CR59">
                <label>59.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Aleta</surname>
                      <given-names>A</given-names>
                    </name>
                    <name>
                      <surname>Moreno</surname>
                      <given-names>Y</given-names>
                    </name>
                  </person-group>
                  <article-title>Evaluation of the potential incidence of COVID-19 and effectiveness of containment measures in Spain: A data-driven approach</article-title>
                  <source>BMC Med.</source>
                  <year>2020</year>
                  <volume>18</volume>
                  <fpage>157</fpage>
                  <pub-id pub-id-type="doi">10.1186/s12916-020-01619-5</pub-id>
                  <pub-id pub-id-type="pmid">32456689</pub-id>
                </element-citation>
              </ref>
              <ref id="CR60">
                <label>60.</label>
                <mixed-citation publication-type="other">Kipf, T. N. &amp; Welling, M. Semi-Supervised Classification with Graph Convolutional Networks <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1609.02907">http://arxiv.org/abs/1609.02907</ext-link> (2016).</mixed-citation>
              </ref>
              <ref id="CR61">
                <label>61.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Wang</surname>
                      <given-names>Q</given-names>
                    </name>
                    <name>
                      <surname>Xie</surname>
                      <given-names>S</given-names>
                    </name>
                    <name>
                      <surname>Wang</surname>
                      <given-names>Y</given-names>
                    </name>
                    <name>
                      <surname>Zeng</surname>
                      <given-names>D</given-names>
                    </name>
                  </person-group>
                  <article-title>Survival-Convolution Models for Predicting COVID-19 Cases and Assessing Effects of Mitigation Strategies</article-title>
                  <source>Front. Public Health</source>
                  <year>2020</year>
                  <volume>8</volume>
                  <fpage>325</fpage>
                  <pub-id pub-id-type="doi">10.3389/fpubh.2020.00325</pub-id>
                  <pub-id pub-id-type="pmid">32719764</pub-id>
                </element-citation>
              </ref>
              <ref id="CR62">
                <label>62.</label>
                <element-citation publication-type="journal">
                  <person-group person-group-type="author">
                    <name>
                      <surname>Voitalov</surname>
                      <given-names>I</given-names>
                    </name>
                    <name>
                      <surname>van der Hoorn</surname>
                      <given-names>P</given-names>
                    </name>
                    <name>
                      <surname>van der Hofstad</surname>
                      <given-names>R</given-names>
                    </name>
                    <name>
                      <surname>Krioukov</surname>
                      <given-names>D</given-names>
                    </name>
                  </person-group>
                  <article-title>Scale-free networks well done</article-title>
                  <source>Phys. Rev. Research</source>
                  <year>2019</year>
                  <volume>1</volume>
                  <fpage>033034</fpage>
                  <pub-id pub-id-type="doi">10.1103/PhysRevResearch.1.033034</pub-id>
                </element-citation>
              </ref>
              <ref id="CR63">
                <label>63.</label>
                <mixed-citation publication-type="other">Global.health: A Data Science Initiative, <ext-link ext-link-type="uri" xlink:href="https://global.health">https://global.health</ext-link> (2020), [Accessed: 21-May-2021].</mixed-citation>
              </ref>
              <ref id="CR64">
                <label>64.</label>
                <mixed-citation publication-type="other">Morris, C. et al. Weisfeiler and Leman Go Neural: Higher-order Graph Neural Networks <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1810.02244">http://arxiv.org/abs/1810.02244</ext-link> (2018).</mixed-citation>
              </ref>
              <ref id="CR65">
                <label>65.</label>
                <mixed-citation publication-type="other">Liu, L. et al. On the Variance of the Adaptive Learning Rate and Beyond <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1908.03265">http://arxiv.org/abs/1908.03265</ext-link> (2019).</mixed-citation>
              </ref>
              <ref id="CR66">
                <label>66.</label>
                <mixed-citation publication-type="other">Conover, W. J. <italic>Practical nonparametric statistics</italic> (John Wiley &amp; Sons, 1998) p. 350.</mixed-citation>
              </ref>
              <ref id="CR67">
                <label>67.</label>
                <mixed-citation publication-type="other">Instituto Nacional de Estadística, <ext-link ext-link-type="uri" xlink:href="https://www.ine.es">https://www.ine.es</ext-link> (2020b), [Accessed: 11-August-2020].</mixed-citation>
              </ref>
              <ref id="CR68">
                <label>68.</label>
                <mixed-citation publication-type="other">Goodfellow, I., Bengio, Y. &amp; Courtville, A. <italic>Deep Learning</italic> (MIT Press, 2016).</mixed-citation>
              </ref>
              <ref id="CR69">
                <label>69.</label>
                <mixed-citation publication-type="other">Sims, C. A. Macroeconomics and reality, Econometrica, 1–48 10.2307/1912017 (1980).</mixed-citation>
              </ref>
              <ref id="CR70">
                <label>70.</label>
                <mixed-citation publication-type="other">Murphy, C., Laurence, E. &amp; Allard, A. DynamicaLab/data-dynalearn, 10.5281/zenodo.5015063 (2021a).</mixed-citation>
              </ref>
              <ref id="CR71">
                <label>71.</label>
                <mixed-citation publication-type="other">Murphy, C., Laurence, E. &amp; Allard, A. DynamicaLab/code-dynalearn 10.5281/zenodo.4974521 (2021b).</mixed-citation>
              </ref>
              <ref id="CR72">
                <label>72.</label>
                <mixed-citation publication-type="other">Barabási, A.-L.  <italic>Network Science</italic> p. 474 <ext-link ext-link-type="uri" xlink:href="http://networksciencebook.com">http://networksciencebook.com</ext-link> (Cambridge University Press, 2016).</mixed-citation>
              </ref>
            </ref-list>
          </back>
        </article>
      </metadata>
    </record>
  </GetRecord>
</OAI-PMH>
